---
uid: visual-studio/overview/2012/windows-azure-authentication
title: "Windows Azure autenticación | Documentos de Microsoft"
author: Rick-Anderson
description: "Herramientas de Microsoft ASP.NET para Windows Azure Active Directory simplifica el proceso de habilitar la autenticación para las aplicaciones web hospedadas en sitios Web de Windows Azure..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2013
ms.topic: article
ms.assetid: a3cef801-a54b-4ebd-93c3-55764e2e14b1
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /visual-studio/overview/2012/windows-azure-authentication
msc.type: authoredcontent
ms.openlocfilehash: 1cb38d66bd0373159e54abf822fba9c5829774ac
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="windows-azure-authentication"></a><span data-ttu-id="4b6bd-103">Windows autenticación de Azure</span><span class="sxs-lookup"><span data-stu-id="4b6bd-103">Windows Azure Authentication</span></span>
====================
<span data-ttu-id="4b6bd-104">Por [Rick Anderson](https://github.com/Rick-Anderson)</span><span class="sxs-lookup"><span data-stu-id="4b6bd-104">by [Rick Anderson](https://github.com/Rick-Anderson)</span></span>

> <span data-ttu-id="4b6bd-105">Herramientas de Microsoft ASP.NET para Windows Azure Active Directory simplifica el proceso de habilitar la autenticación para las aplicaciones web hospedadas en [sitios Web Windows Azure](https://www.windowsazure.com/en-us/home/features/web-sites/).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-105">Microsoft ASP.NET tools for Windows Azure Active Directory makes it simple to enable authentication for web applications hosted on [Windows Azure Web Sites](https://www.windowsazure.com/en-us/home/features/web-sites/).</span></span> <span data-ttu-id="4b6bd-106">Puede utilizar la autenticación de Windows Azure para autenticar a los usuarios de Office 365 a su organización, las cuentas corporativas que se sincronizan desde su Active Directory local o los usuarios creados en su propio dominio personalizado de Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-106">You can use Windows Azure Authentication to authenticate Office 365 users from your organization, corporate accounts synced from your on-premise Active Directory or users created in your own custom Windows Azure Active Directory domain.</span></span> <span data-ttu-id="4b6bd-107">Habilitar la autenticación de Windows Azure configura su aplicación para autenticar a los usuarios con una sola [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) inquilino.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-107">Enabling Windows Azure Authentication configures your application to authenticate users using a single [Windows Azure Active Directory](https://docs.microsoft.com/azure/active-directory/) tenant.</span></span>
> 
> <span data-ttu-id="4b6bd-108">La herramienta de autenticación de Windows Azure de ASP.NET no se admite para los roles de web en un servicio de nube, pero tenemos previsto volver a hacerlo en una versión futura.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-108">The ASP.NET Windows Azure Authentication tool is not supported for web roles in a cloud service but we plan to do so in a future release.</span></span> <span data-ttu-id="4b6bd-109">[Windows Identity Foundation](https://msdn.microsoft.com/en-us/library/hh291066(v=VS.110).aspx) (WIF) se admite en los roles de web de Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-109">[Windows Identity Foundation](https://msdn.microsoft.com/en-us/library/hh291066(v=VS.110).aspx) (WIF) is supported in Windows Azure web roles.</span></span>
> 
> <span data-ttu-id="4b6bd-110">Para obtener más información acerca de cómo configurar la sincronización entre su Active Directory local y su inquilino de Windows Azure Active Directory vea [usar AD FS 2.0 para implementar y administrar el inicio de sesión único](https://technet.microsoft.com/en-us/library/jj205462.aspx).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-110">For details on how to setup synchronization between your on-premise Active Directory and your Windows Azure Active Directory tenant please see [Use AD FS 2.0 to implement and manage single sign-on](https://technet.microsoft.com/en-us/library/jj205462.aspx).</span></span>
> 
> <span data-ttu-id="4b6bd-111">Windows Azure Active Directory está disponible actualmente como una [servicio de vista previa gratis](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-111">Windows Azure Active Directory is currently available as a [free preview service](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>


## <a name="requirements"></a><span data-ttu-id="4b6bd-112">Requisitos:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-112">Requirements:</span></span>

- <span data-ttu-id="4b6bd-113">Visual Studio 2012 o [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/en-us/products/express)</span><span class="sxs-lookup"><span data-stu-id="4b6bd-113">Visual Studio 2012 or [Visual Studio Express 2012](https://www.microsoft.com/visualstudio/11/en-us/products/express)</span></span>
- <span data-ttu-id="4b6bd-114">[Web de extensiones para Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) o [las extensiones de herramientas de Web para Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span><span class="sxs-lookup"><span data-stu-id="4b6bd-114">[Web Tools Extensions for Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282228&amp;clcid=0x409) or [Web Tools Extensions for Visual Studio Express 2012](https://go.microsoft.com/fwlink/?LinkID=282231&amp;clcid=0x409)</span></span>
- <span data-ttu-id="4b6bd-115">[Herramientas de Microsoft ASP.NET para Windows Azure Active Directory: Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) o [herramientas de Microsoft ASP.NET para Windows Azure Active Directory: Visual Studio Express 2012 para Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span><span class="sxs-lookup"><span data-stu-id="4b6bd-115">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://go.microsoft.com/fwlink/?LinkID=282306) or [Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio Express 2012 for Web](https://go.microsoft.com/fwlink/?LinkId=282652)</span></span>

## <a name="create-an-aspnet-web-application-with-visual-studio-2012"></a><span data-ttu-id="4b6bd-116">Crear una aplicación Web ASP.NET con Visual Studio 2012</span><span class="sxs-lookup"><span data-stu-id="4b6bd-116">Create an ASP.NET Web Application with Visual Studio 2012</span></span>

<span data-ttu-id="4b6bd-117">Puede crear cualquier aplicación Web con Visual Studio 2012, este tutorial usa la plantilla de intranet de ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-117">You can create any Web Application with Visual Studio 2012, this tutorial uses the ASP.NET MVC intranet template.</span></span>

1. <span data-ttu-id="4b6bd-118">Cree una nueva aplicación de Intranet de ASP.NET MVC 4 y acepte todos los valores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-118">Create a new ASP.NET MVC 4 Intranet Application and accept all the defaults.</span></span> <span data-ttu-id="4b6bd-119">(Debe ser un In **recorrido** net y no en **pecifique** proyecto net).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-119">(It must be an In **tra** net and not In **ter** net project).</span></span>  
     ![](windows-azure-authentication/_static/image1.png)

## <a name="enable-window-azure-authentication-when-you-are-a-global-administrator-of-the-tenet"></a><span data-ttu-id="4b6bd-120">Habilitar la autenticación de Azure de ventana (si es un administrador Global del principio)</span><span class="sxs-lookup"><span data-stu-id="4b6bd-120">Enable Window Azure Authentication (When you are a Global Administrator of the Tenet)</span></span>

<span data-ttu-id="4b6bd-121">Si no tiene un inquilino de Windows Azure Active Directory existente (por ejemplo, a través de una cuenta de Office 365 existente) puede crear un nuevo inquilino por registrarse para una [nueva cuenta de Windows Azure Active Directory](http://g.microsoftonline.com/0AX00en/5).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-121">If you do not have an existing Windows Azure Active Directory tenant (For example, through an existing Office 365 account) you can create a new tenant by signing up for a [new Windows Azure Active Directory account](http://g.microsoftonline.com/0AX00en/5).</span></span>

1. <span data-ttu-id="4b6bd-122">En el menú proyecto, seleccione **habilitar la autenticación de Windows Azure**:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-122">From the Project menu select **Enable Windows Azure Authentication**:</span></span>  
  
 ![](windows-azure-authentication/_static/image2.png)

2. <span data-ttu-id="4b6bd-123">Escriba el dominio para el inquilino de Windows Azure Active Directory (por ejemplo, contoso.onmicrosoft.com) y haga clic en **habilitar**:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-123">Enter the domain for your Windows Azure Active Directory tenant (for example, contoso.onmicrosoft.com) and click **Enable**:</span></span>

![](windows-azure-authentication/_static/image3.png)

3. <span data-ttu-id="4b6bd-124">En la autenticación Web cuadro de diálogo de inicio de sesión como administrador para su inquilino de Windows Azure Active Directory:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-124">In the Web Authentication dialog sign in as an administrator for your Windows Azure Active Directory tenant:</span></span>  
  
 ![](windows-azure-authentication/_static/image4.png)

![](windows-azure-authentication/_static/image5.png)

## <a name="enable-window-azure-by-a-non-administrator-of-the-tenet"></a><span data-ttu-id="4b6bd-125">Habilitar Windows Azure no es el administrador del principio</span><span class="sxs-lookup"><span data-stu-id="4b6bd-125">Enable Window Azure by a non-administrator of the Tenet</span></span>

<span data-ttu-id="4b6bd-126">Si no tiene privilegios de administrador Global para el inquilino de Windows Azure Active Directory, puede desactivar la casilla de verificación para el aprovisionamiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-126">If you do not have Global Administrator privilege for your Windows Azure Active Directory tenant, you can uncheck the checkbox for provisioning the application.</span></span>

![](windows-azure-authentication/_static/image6.png)

<span data-ttu-id="4b6bd-127">Se mostrará el cuadro de diálogo la **dominio**, **Id. de entidad de aplicación** y **dirección URL de respuesta** que son necesarios para el aprovisionamiento de la aplicación con Azure Active Directory principio.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-127">The dialog will display the **Domain**, **Application Principal Id** and **Reply URL** which are required for provisioning the application with an Azure Active Directory tenet.</span></span> <span data-ttu-id="4b6bd-128">Debe proporcionar esta información a alguien que tiene privilegios suficientes para aprovisionar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-128">You need to give this information to someone who has sufficient privilege to provision the application.</span></span> <span data-ttu-id="4b6bd-129">Vea[cómo implementar el inicio de sesión único con Windows Azure Active Directory: aplicación de ASP.NET](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) para obtener más información sobre cómo usar el cmdlet para crear la entidad de servicio manualmente.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-129">See[How to implement single sign-on with Windows Azure Active Directory - ASP.NET Application](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect) for details on how to use cmdlet to create the service principal manually.</span></span>  
<span data-ttu-id="4b6bd-130">Una vez que la aplicación se haya aprovisionado correctamente, puede hacer clic en **continuar actualizar web.config con la configuración seleccionada**.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-130">Once the application has been successfully provisioned, you can click on **Continue to update web.config with the selected settings**.</span></span> <span data-ttu-id="4b6bd-131">Si desea continuar desarrollando la aplicación mientras se espera para que se produzca, puede hacer clic en el aprovisionamiento **Cerrar para recordar la configuración en el archivo de proyecto**.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-131">If you want to continue developing the application while waiting for provisioning to happen, you can click **Close to remember the settings in project file**.</span></span> <span data-ttu-id="4b6bd-132">La próxima vez que invoque habilitar la autenticación de Windows Azure y desactive la casilla de verificación de aprovisionamiento, verá la misma configuración y puede hacer clic en **continuar**, a continuación, haga clic en, **aplicar esta configuración en el archivo web.config**.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-132">The next time you invoke Enable Windows Azure Authentication and uncheck the provisioning checkbox, you will see the same settings and you can click **Continue**, then click, **Apply these settings in web.config**.</span></span>

1. <span data-ttu-id="4b6bd-133">Espere mientras la aplicación se configura para la autenticación de Windows Azure y se suministra con Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-133">Wait while your application is configured for Windows Azure Authentication and provisioned with Windows Azure Active Directory.</span></span>
2. <span data-ttu-id="4b6bd-134">Una vez que se ha habilitado la autenticación de Windows Azure para su aplicación, haga clic en **cerrar:**</span><span class="sxs-lookup"><span data-stu-id="4b6bd-134">Once Windows Azure Authentication has been enabled for your application, click **Close:**</span></span> 

    ![](windows-azure-authentication/_static/image7.png)
3. <span data-ttu-id="4b6bd-135">Presione F5 para ejecutar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-135">Hit F5 to run your application.</span></span> <span data-ttu-id="4b6bd-136">Se debe obtener redirigirá automáticamente a la página de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-136">You should automatically get redirected to login page.</span></span> <span data-ttu-id="4b6bd-137">Use las credenciales de usuario de directorio principio para iniciar sesión en la aplicación...</span><span class="sxs-lookup"><span data-stu-id="4b6bd-137">Use the directory tenet user credentials to login to the application..</span></span>  

    ![](windows-azure-authentication/_static/image1.jpg)
4. <span data-ttu-id="4b6bd-138">Dado que la aplicación la está usando un certificado de prueba autofirmado recibirá una advertencia en el Explorador de que el certificado no fue emitido por una entidad de certificación de confianza.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-138">Because your application is currently using a self-signed test certificate you will receive a warning from the browser that the certificate was not issued by a trusted certificate authority.</span></span>

    <span data-ttu-id="4b6bd-139">Esta advertencia puede omitirse durante el desarrollo local, haga clic en **continuar a este sitio Web:**</span><span class="sxs-lookup"><span data-stu-id="4b6bd-139">This warning can be safely ignored during local development by clicking **Continue to this website:**</span></span> 

    ![](windows-azure-authentication/_static/image8.png)
5. <span data-ttu-id="4b6bd-140">Ahora correctamente iniciada la sesión la aplicación mediante la autenticación de Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-140">You have now successfully logged in to your application using Windows Azure Authentication!</span></span>

    ![](windows-azure-authentication/_static/image2.jpg)

<span data-ttu-id="4b6bd-141">Habilitar Windows Azure autenticación realiza los siguientes cambios en la aplicación:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-141">Enabling Windows Azure authentication makes the following changes to your application:</span></span>

- <span data-ttu-id="4b6bd-142">Una falsificación de solicitudes cruzada a sitio ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) clase ( *aplicación\_Start\AntiXsrfConfig.cs* ) se agrega al proyecto.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-142">An Anti-Cross-Site Request Forgery ([CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF))) class ( *App\_Start\AntiXsrfConfig.cs* ) is added to your project.</span></span>
- <span data-ttu-id="4b6bd-143">Los paquetes de NuGet `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` se agrega al proyecto.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-143">The NuGet packages `System.IdentityModel.Tokens.ValidatingIssuerNameRegistry` is added to your project.</span></span>
- <span data-ttu-id="4b6bd-144">Configuración de Windows Identity Foundation en la aplicación se configurará para aceptar los tokens de seguridad de su inquilino de Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-144">Windows Identity Foundation settings in your application will be configured to accept security tokens from your Windows Azure Active Directory tenant.</span></span> <span data-ttu-id="4b6bd-145">Haga clic en la imagen siguiente para ver una vista expandida de los cambios realizados en el *Web.config* archivo.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-145">Click on the image below to see an expanded view of the changes made to the *Web.config* file.</span></span>  
  
     ![](windows-azure-authentication/_static/image9.png)
- <span data-ttu-id="4b6bd-146">Se aprovisionará un servicio principal para su aplicación en su inquilino de Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-146">A service principal for your application in your Windows Azure Active Directory tenant will be provisioned.</span></span>
- <span data-ttu-id="4b6bd-147">HTTPS está habilitada.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-147">HTTPS is enabled.</span></span>

## <a name="deploy-the-application-to-windows-azure"></a><span data-ttu-id="4b6bd-148">Implementar la aplicación en Windows Azure</span><span class="sxs-lookup"><span data-stu-id="4b6bd-148">Deploy the application to Windows Azure</span></span>

<span data-ttu-id="4b6bd-149">Para obtener instrucciones detalladas, consulte [implementar una aplicación Web de ASP.NET a un sitio Web de Windows Azure](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-149">For complete instructions, see [Deploying an ASP.NET Web Application to a Windows Azure Web Site](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>

<span data-ttu-id="4b6bd-150">Para publicar una aplicación mediante la autenticación de Windows Azure en un sitio Web de Azure:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-150">To publish an application using Windows Azure Authentication to an Azure Web Site:</span></span>

1. <span data-ttu-id="4b6bd-151">Haga clic con el botón secundario en la aplicación y seleccione **publicar:**</span><span class="sxs-lookup"><span data-stu-id="4b6bd-151">Right click on your application and select **Publish:**</span></span> 

    ![](windows-azure-authentication/_static/image3.jpg)
2. <span data-ttu-id="4b6bd-152">En el cuadro de diálogo de publicación Web descargar e importar un perfil de publicación para el sitio Web de Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-152">From the Publish Web dialog download and import a publishing profile for your Azure Web Site.</span></span>

    ![](windows-azure-authentication/_static/image4.jpg)
3. <span data-ttu-id="4b6bd-153">El **conexión** pestaña muestra la **dirección URL de destino** (URL de orientados al público para la aplicación).</span><span class="sxs-lookup"><span data-stu-id="4b6bd-153">The **Connection** tab shows the **Destination URL** (the public facing URL for your application).</span></span> <span data-ttu-id="4b6bd-154">Haga clic en **validar conexión** para probar la conexión:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-154">Click **Validate Connection** to test your connection:</span></span>

    ![](windows-azure-authentication/_static/image5.jpg)
4. <span data-ttu-id="4b6bd-155">Si se ha publicado para este sitio Web de Azure previamente considere la posibilidad de comprobar la **quitar archivos adicionales en destino** configuración para garantizar que la aplicación se publica correctamente.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-155">If you have published to this Azure Web Site previously consider checking the **Remove additional files at destination** setting to ensure your application publishes cleanly.</span></span> <span data-ttu-id="4b6bd-156">Observe el **habilitar la autenticación de Windows Azure** casilla de verificación está slected.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-156">Notice the **Enable Windows Azure Authentication** check box is slected.</span></span>  

    ![](windows-azure-authentication/_static/image10.png)
5. <span data-ttu-id="4b6bd-157">Opcional: En la **vista previa** ficha haga clic en **iniciar Preview** para ver los archivos que se implementan.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-157">Optional: On the **Preview** tab click **Start Preview** to see the files deployed.</span></span>

    ![](windows-azure-authentication/_static/image6.jpg)
6. <span data-ttu-id="4b6bd-158">Haga clic en **publicar.**</span><span class="sxs-lookup"><span data-stu-id="4b6bd-158">Click **Publish.**</span></span>

    <span data-ttu-id="4b6bd-159">Se le pedirá para habilitar la autenticación de Windows Azure para el host de destino.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-159">You will be prompted to enable Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="4b6bd-160">Haga clic en **habilitar** para continuar:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-160">Click **Enable** to continue:</span></span>

    ![](windows-azure-authentication/_static/image11.png)
7. <span data-ttu-id="4b6bd-161">Escriba sus credenciales de administrador para su inquilino de Windows Azure Active Directory:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-161">Enter your administrator credentials for your Windows Azure Active Directory tenant:</span></span>

    ![](windows-azure-authentication/_static/image7.jpg)
8. <span data-ttu-id="4b6bd-162">Una vez que la aplicación se ha publicado correctamente, se abrirá un explorador para el sitio web publicado.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-162">Once your application has been successfully published, a browser will open to the published web site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="4b6bd-163">Puede tardar hasta cinco minutos (normalmente debe menos) de la aplicación para que aprovisionar completamente con Windows Azure Active Directory después de habilitar la autenticación de Windows Azure para el host de destino.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-163">It may take up to five minutes (typically must less) for your application to be fully provisioned with Windows Azure Active Directory after enabling Windows Azure Authentication for the target host.</span></span> <span data-ttu-id="4b6bd-164">Cuando primero ejecutar la aplicación si recibe el error ACS50001: no se encontró el usuario de confianza con el nombre '[dominio]', a continuación, espere unos minutos y vuelva a ejecutar la aplicación de nuevo.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-164">When you first run your application if you receive error ACS50001: Relying party with name ‘[realm]' was not found, then wait a few minutes and try running the application again.</span></span>
9. <span data-ttu-id="4b6bd-165">Cuando se le solicite, inicie sesión como un usuario en el directorio:</span><span class="sxs-lookup"><span data-stu-id="4b6bd-165">When prompted, log in as a user in your directory:</span></span>

    ![](windows-azure-authentication/_static/image8.jpg)
10. <span data-ttu-id="4b6bd-166">Ahora se correctamente registrado en Azure hospeda la aplicación mediante la autenticación de Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-166">You have now successfully logged into your Azure hosted application using Windows Azure Authentication.</span></span>  
  
     ![](windows-azure-authentication/_static/image9.jpg)

## <a name="known-issues"></a><span data-ttu-id="4b6bd-167">Problemas conocidos</span><span class="sxs-lookup"><span data-stu-id="4b6bd-167">Known Issues</span></span>

#### <a name="role-based-authorization-fails-when-using-windows-azure-authenticationopop"></a><span data-ttu-id="4b6bd-168">Se produce un error en la autorización basada en roles cuando se usa la autenticación de Windows Azure < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-168">Role-based authorization fails when using Windows Azure Authentication<o:p></o:p></span></span>

<span data-ttu-id="4b6bd-169">Autenticación de Windows Azure no proporciona actualmente la notificación de rol es necesario para que se pueda realizar autorización basada en roles.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-169">Windows Azure Authentication does not currently provide the necessary role claim so that role-based authorization can be performed.</span></span> <span data-ttu-id="4b6bd-170">Se debe recuperar manualmente el rol del usuario autenticado de Windows Azure Active Directory. < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-170">The role of the authenticated user must be manually retrieved from Windows Azure Active Directory.<o:p></o:p></span></span>

#### <a name="browsing-to-an-application-with-windows-azure-authentication-results-in-the-error-acs20016-the-domain-of-the-logged-in-user-livecom-does-not-match-any-allowed-domain-of-this-stsopop"></a><span data-ttu-id="4b6bd-171">Para una aplicación con la autenticación de Windows Azure se produce el error "ACS20016 el dominio del usuario que ha iniciado sesión (live.com) no se corresponde con cualquier permite el examen de dominio de este STS" < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-171">Browsing to an application with Windows Azure Authentication results in the error "ACS20016 The domain of the logged in user (live.com) does not match any allowed domain of this STS"<o:p></o:p></span></span>

<span data-ttu-id="4b6bd-172">Si ya ha iniciado una sesión una Account de Microsoft (por ejemplo hotmail.com, live.com, outlook.com) e intenta tener acceso a una aplicación que ha habilitado la autenticación de Windows Azure pueden obtener una respuesta de 400 error porque el dominio de su Account de Microsoft no se reconoce en Windows Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-172">If you are already logged in to a Microsoft Account (for example hotmail.com, live.com, outlook.com) and you attempt to access an application that has enabled Windows Azure Authentication you may get a 400 error response because the domain of your Microsoft Account is not recognized by Windows Azure Active Directory.</span></span> <span data-ttu-id="4b6bd-173">Para iniciar sesión en la aplicación, cierre sesión en tu Account Microsoft primero. < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-173">To log into the application, log out from your Microsoft Account first.<o:p></o:p></span></span>

#### <a name="logging-into-an-application-with-windows-azure-authentication-enabled-and-a-x509certificatevalidationmode-other-than-none-results-in-certificate-validation-errors-for-the-accountsaccesscontrolwindowsnet-certificateopop"></a><span data-ttu-id="4b6bd-174">Iniciar una sesión en una aplicación con la autenticación de Windows Azure habilitada y un X509CertificateValidationMode distinto de da como resultado errores de validación de certificado para el certificado accounts.accesscontrol.windows.net < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-174">Logging into an application with Windows Azure Authentication enabled and a X509CertificateValidationMode other than None results in certificate validation errors for the accounts.accesscontrol.windows.net certificate<o:p></o:p></span></span>

<span data-ttu-id="4b6bd-175">Validación del certificado no es necesario y debe dejarse a deshabilitado.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-175">Certificate validation is not required and should be left disabled.</span></span> <span data-ttu-id="4b6bd-176">La huella digital del certificado de emisor se valida el WSFederationAuthenticationModule. < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-176">The thumbprint of the issuer certificate is validated by the WSFederationAuthenticationModule.<o:p></o:p></span></span>

#### <a name="when-attempting-to-enable-windows-azure-authentication-the-web-authentication-dialog-shows-the-error-acs20016-the-domain-of-the-logged-in-user-contosoonmicrosoftcom-does-not-match-any-allowed-domain-of-this-stsopop"></a><span data-ttu-id="4b6bd-177">Al intentar habilitar la autenticación de Windows Azure el cuadro de diálogo de autenticación Web muestra el error "ACS20016: el dominio de la sesión del usuario (contoso.onmicrosoft.com) no coincide con ningún dominio permitido de este STS." < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-177">When attempting to enable Windows Azure Authentication the Web Authentication dialog shows the error "ACS20016: The domain of the logged in user (contoso.onmicrosoft.com) does not match any allowed domain of this STS."<o:p></o:p></span></span>

<span data-ttu-id="4b6bd-178">Puede ver este error cuando correctamente anteriormente haber iniciado sesión con una cuenta diferente de Windows Azure Active Directory desde dentro del mismo proceso de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-178">You may see this error when you have previously successfully logged in using a different Windows Azure Active Directory account from within the same Visual Studio process.</span></span> <span data-ttu-id="4b6bd-179">Cierre la sesión de la cuenta especificada o reinicie Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-179">Log out from the specified account or restart Visual Studio.</span></span> <span data-ttu-id="4b6bd-180">Si anteriormente se registran y se selecciona la opción "Mantener iniciada", a continuación, puede que necesite desactivar su las cookies del explorador. < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-180">If you previously logged in and selected the option to "Keep me signed in" then you may need to clear your browser cookies.<o:p></o:p></span></span>

## <a name="acs20012-the-request-is-not-a-valid-ws-federation-protocol-message-opop"></a><span data-ttu-id="4b6bd-181">ACS20012: La solicitud no es un mensaje de protocolo de WS-Federation válido < o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-181">ACS20012: The request is not a valid WS-Federation protocol message <o:p></o:p></span></span>

<span data-ttu-id="4b6bd-182">Esto puede ocurrir si se ha iniciado sesión con algún otro identificador de Microsoft a uno de los servicios de Azure.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-182">This can happen if you are already logged in with some other Microsoft ID to one of the Azure services.</span></span> <span data-ttu-id="4b6bd-183">Ventana del explorador de uso privado como InPrivate en Internet Explorer o incógnito en Chrome o borrar todas las cookies.</span><span class="sxs-lookup"><span data-stu-id="4b6bd-183">Use Private browser window like InPrivate in IE or Incognito in Chrome or clear all the cookies.</span></span> <span data-ttu-id="4b6bd-184">< o: p >< / o: p ></span><span class="sxs-lookup"><span data-stu-id="4b6bd-184"><o:p></o:p></span></span>

## <a name="additional-resources"></a><span data-ttu-id="4b6bd-185">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="4b6bd-185">Additional Resources</span></span>

- <span data-ttu-id="4b6bd-186">[Herramientas de Microsoft ASP.NET para Windows Azure en Visual Studio 2012 Active Directory](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) : Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="4b6bd-186">[Microsoft ASP.NET Tools for Windows Azure Active Directory – Visual Studio 2012](https://blogs.msdn.com/b/vbertocci/archive/2013/02/18/microsoft-asp-net-tools-for-windows-azure-active-directory-visual-studio-2012.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="4b6bd-187">Windows Azure características: identidad</span><span class="sxs-lookup"><span data-stu-id="4b6bd-187">Windows Azure Features: Identity</span></span>](https://docs.microsoft.com/azure/active-directory/)
- [<span data-ttu-id="4b6bd-188">TechNet: Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="4b6bd-188">TechNet: Windows Azure Active Directory</span></span>](https://technet.microsoft.com/en-us/library/hh967619.aspx)
- [<span data-ttu-id="4b6bd-189">Windows Azure Active Directory: desarrollar aplicaciones para su organización</span><span class="sxs-lookup"><span data-stu-id="4b6bd-189">Windows Azure Active Directory: Develop Apps for your organization</span></span>](https://activedirectory.windowsazure.com/Develop/Single-Tenant.aspx)
- [<span data-ttu-id="4b6bd-190">Windows Azure Active Directory: desarrollar aplicaciones para varias organizaciones</span><span class="sxs-lookup"><span data-stu-id="4b6bd-190">Windows Azure Active Directory: Develop Apps for multiple organizations</span></span>](https://activedirectory.windowsazure.com/Develop/Multi-Tenant.aspx)
- [<span data-ttu-id="4b6bd-191">Cómo implementar un inicio de sesión único con Windows Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="4b6bd-191">How to implement single sign-on with Windows Azure Active Directory</span></span>](https://github.com/Azure-Samples/active-directory-dotnet-webapp-openidconnect)
- <span data-ttu-id="4b6bd-192">[Inicio de sesión único con Windows Azure Active Directory: profundización](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) : Vittorio Bertocci</span><span class="sxs-lookup"><span data-stu-id="4b6bd-192">[Single Sign-On with Windows Azure Active Directory: a Deep Dive](https://blogs.msdn.com/b/vbertocci/archive/2012/07/05/single-sign-on-with-windows-azure-active-directory-a-deep-dive.aspx) – Vittorio Bertocci</span></span>
- [<span data-ttu-id="4b6bd-193">Usar AD FS 2.0 para implementar y administrar el inicio de sesión único</span><span class="sxs-lookup"><span data-stu-id="4b6bd-193">Use AD FS 2.0 to implement and manage single sign-on</span></span>](https://technet.microsoft.com/en-us/library/jj205462.aspx)
