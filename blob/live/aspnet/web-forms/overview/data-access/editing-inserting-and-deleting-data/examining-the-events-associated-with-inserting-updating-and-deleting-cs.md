---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs
title: Examinar los eventos asociados a insertar, actualizar y eliminar (C#) | Documentos de Microsoft
author: rick-anderson
description: "En este tutorial que examinaremos con los eventos que se producen antes, durante y después de insertar, actualizar o eliminar el funcionamiento de un control Web de datos ASP.NET. W...."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: dab291a0-a8b5-46fa-9dd8-3d35b249201f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs
msc.type: authoredcontent
ms.openlocfilehash: 30f6ecef1a03153619df1b3ba4e709f3742c6927
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="examining-the-events-associated-with-inserting-updating-and-deleting-c"></a><span data-ttu-id="74506-104">Examinar los eventos asociados a insertar, actualizar y eliminar (C#)</span><span class="sxs-lookup"><span data-stu-id="74506-104">Examining the Events Associated with Inserting, Updating, and Deleting (C#)</span></span>
====================
<span data-ttu-id="74506-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="74506-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="74506-106">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_CS.exe) o [descarga de PDF](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/datatutorial17cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="74506-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_17_CS.exe) or [Download PDF](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/datatutorial17cs1.pdf)</span></span>

> <span data-ttu-id="74506-107">En este tutorial que examinaremos con los eventos que se producen antes, durante y después de insertar, actualizar o eliminar el funcionamiento de un control Web de datos ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="74506-107">In this tutorial we'll examine using the events that occur before, during, and after an insert, update, or delete operation of an ASP.NET data Web control.</span></span> <span data-ttu-id="74506-108">También veremos cómo personalizar la interfaz de edición para actualizar solo un subconjunto de los campos de producto.</span><span class="sxs-lookup"><span data-stu-id="74506-108">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>


## <a name="introduction"></a><span data-ttu-id="74506-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="74506-109">Introduction</span></span>

<span data-ttu-id="74506-110">Cuando se usa integradas de inserción, editar o eliminar funciones de los controles GridView, DetailsView o FormView, una serie de pasos transcurrir cuando el usuario final complete el proceso de agregar un nuevo registro o actualizar o eliminar un registro existente.</span><span class="sxs-lookup"><span data-stu-id="74506-110">When using the built-in inserting, editing, or deleting features of the GridView, DetailsView, or FormView controls, a variety of steps transpire when the end user completes the process of adding a new record or updating or deleting an existing record.</span></span> <span data-ttu-id="74506-111">Como se explicó en la [tutorial anterior](an-overview-of-inserting-updating-and-deleting-data-cs.md), cuando se edita una fila en GridView el botón de edición se reemplaza con botones Actualizar y Cancelar y activar BoundFields en cuadros de texto.</span><span class="sxs-lookup"><span data-stu-id="74506-111">As we discussed in the [previous tutorial](an-overview-of-inserting-updating-and-deleting-data-cs.md), when a row is edited in the GridView the Edit button is replaced by Update and Cancel buttons and the BoundFields turn into TextBoxes.</span></span> <span data-ttu-id="74506-112">Después de que el usuario final actualiza los datos y hace clic en actualizar, se realizan los pasos siguientes en la devolución de datos:</span><span class="sxs-lookup"><span data-stu-id="74506-112">After the end user updates the data and clicks Update, the following steps are performed on postback:</span></span>

1. <span data-ttu-id="74506-113">GridView rellena su ObjectDataSource `UpdateParameters` con campos de identificación único del registro editado (a través de la `DataKeyNames` propiedad) junto con los valores especificados por el usuario</span><span class="sxs-lookup"><span data-stu-id="74506-113">The GridView populates its ObjectDataSource's `UpdateParameters` with the edited record's unique identifying field(s) (via the `DataKeyNames` property) along with the values entered by the user</span></span>
2. <span data-ttu-id="74506-114">GridView invoca su ObjectDataSource `Update()` método, que a su vez, se invoca el método adecuado en el objeto subyacente (`ProductsDAL.UpdateProduct`, en nuestro tutorial anterior)</span><span class="sxs-lookup"><span data-stu-id="74506-114">The GridView invokes its ObjectDataSource's `Update()` method, which in turn invokes the appropriate method in the underlying object (`ProductsDAL.UpdateProduct`, in our previous tutorial)</span></span>
3. <span data-ttu-id="74506-115">Los datos subyacentes, que ahora incluyen los cambios actualizados, se vuelve a enlazar a GridView</span><span class="sxs-lookup"><span data-stu-id="74506-115">The underlying data, which now includes the updated changes, is rebound to the GridView</span></span>

<span data-ttu-id="74506-116">Durante esta secuencia de pasos, se activan un número de eventos, lo que nos permite crear controladores de eventos para agregar lógica personalizada cuando sea necesario.</span><span class="sxs-lookup"><span data-stu-id="74506-116">During this sequence of steps, a number of events fire, enabling us to create event handlers to add custom logic where needed.</span></span> <span data-ttu-id="74506-117">Por ejemplo, antes del paso 1, GridView `RowUpdating` desencadena el evento.</span><span class="sxs-lookup"><span data-stu-id="74506-117">For example, prior to Step 1, the GridView's `RowUpdating` event fires.</span></span> <span data-ttu-id="74506-118">En este momento, cancelar la solicitud de actualización si se produce algún error de validación.</span><span class="sxs-lookup"><span data-stu-id="74506-118">We can, at this point, cancel the update request if there is some validation error.</span></span> <span data-ttu-id="74506-119">Cuando el `Update()` se invoca el método, el ObjectDataSource `Updating` desencadena el evento, lo que proporciona una oportunidad para agregar o personalizar los valores de cualquiera de los `UpdateParameters`.</span><span class="sxs-lookup"><span data-stu-id="74506-119">When the `Update()` method is invoked, the ObjectDataSource's `Updating` event fires, providing an opportunity to add or customize the values of any of the `UpdateParameters`.</span></span> <span data-ttu-id="74506-120">Después de que el ObjectDataSource subyacente del método del objeto ha terminado de ejecutarse, el ObjectDataSource `Updated` evento se desencadena.</span><span class="sxs-lookup"><span data-stu-id="74506-120">After the ObjectDataSource's underlying object's method has completed executing, the ObjectDataSource's `Updated` event is raised.</span></span> <span data-ttu-id="74506-121">Un controlador de eventos para el `Updated` evento puede inspeccionar los detalles sobre la operación de actualización, como el número de filas afectado y si no se ha producido una excepción.</span><span class="sxs-lookup"><span data-stu-id="74506-121">An event handler for the `Updated` event can inspect the details about the update operation, such as how many rows were affected and whether or not an exception occurred.</span></span> <span data-ttu-id="74506-122">Por último, después del paso 2, GridView `RowUpdated` desencadena el evento; un controlador de eventos para este evento puede examinar la información adicional sobre la operación de actualización sólo realiza.</span><span class="sxs-lookup"><span data-stu-id="74506-122">Finally, after Step 2, the GridView's `RowUpdated` event fires; an event handler for this event can examine additional information about the update operation just performed.</span></span>

<span data-ttu-id="74506-123">Figura 1 muestra esta serie de eventos y pasos al actualizar un control GridView.</span><span class="sxs-lookup"><span data-stu-id="74506-123">Figure 1 depicts this series of events and steps when updating a GridView.</span></span> <span data-ttu-id="74506-124">El patrón de eventos en la figura 1 no es único para la actualización con un control GridView.</span><span class="sxs-lookup"><span data-stu-id="74506-124">The event pattern in Figure 1 is not unique to updating with a GridView.</span></span> <span data-ttu-id="74506-125">Insertar, actualizar o eliminar datos de GridView, DetailsView o FormView precipita la misma secuencia de eventos previas y posteriores al niveles para el control de datos Web y ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="74506-125">Inserting, updating, or deleting data from the GridView, DetailsView, or FormView precipitates the same sequence of pre- and post-level events for both the data Web control and the ObjectDataSource.</span></span>


<span data-ttu-id="74506-126">[![Una serie de previo e incendio de eventos posteriores a la hora de actualizar datos en un control GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="74506-126">[![A Series of Pre- and Post-Events Fire When Updating Data in a GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image2.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image1.png)</span></span>

<span data-ttu-id="74506-127">**Figura 1**: una serie de previas y eventos posteriores a la activan al actualizar los datos de un control GridView ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="74506-127">**Figure 1**: A Series of Pre- and Post-Events Fire When Updating Data in a GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image3.png))</span></span>


<span data-ttu-id="74506-128">En este tutorial que examinaremos usa estos eventos para extender el integradas de inserción, actualización y eliminación de las capacidades de los datos ASP.NET controla la Web.</span><span class="sxs-lookup"><span data-stu-id="74506-128">In this tutorial we'll examine using these events to extend the built-in inserting, updating, and deleting capabilities of the ASP.NET data Web controls.</span></span> <span data-ttu-id="74506-129">También veremos cómo personalizar la interfaz de edición para actualizar solo un subconjunto de los campos de producto.</span><span class="sxs-lookup"><span data-stu-id="74506-129">We'll also see how to customize the editing interface to only update a subset of the product fields.</span></span>

## <a name="step-1-updating-a-productsproductnameandunitpricefields"></a><span data-ttu-id="74506-130">Paso 1: Actualizar un producto`ProductName`y`UnitPrice`campos</span><span class="sxs-lookup"><span data-stu-id="74506-130">Step 1: Updating a Product's`ProductName`and`UnitPrice`Fields</span></span>

<span data-ttu-id="74506-131">En las interfaces de edición en el tutorial anterior *todos los* campos de producto que no son de solo lectura tenía que debe incluirse.</span><span class="sxs-lookup"><span data-stu-id="74506-131">In the editing interfaces from the previous tutorial *all* product fields that were not read-only had to be included.</span></span> <span data-ttu-id="74506-132">Si deseáramos quitar un campo de GridView - diga `QuantityPerUnit` : al actualizar los datos del control Web de datos no debe establecer el ObjectDataSource `QuantityPerUnit` `UpdateParameters` valor.</span><span class="sxs-lookup"><span data-stu-id="74506-132">If we were to remove a field from the GridView - say `QuantityPerUnit` - when updating the data the data Web control would not set the ObjectDataSource's `QuantityPerUnit` `UpdateParameters` value.</span></span> <span data-ttu-id="74506-133">ObjectDataSource pasaría, a continuación, en un `null` valor en el `UpdateProduct` método de capa de lógica empresarial (BLL), que cambiaría el registro de base de datos modificada `QuantityPerUnit` columna a una `NULL` valor.</span><span class="sxs-lookup"><span data-stu-id="74506-133">The ObjectDataSource would then pass in a `null` value into the `UpdateProduct` Business Logic Layer (BLL) method, which would change the edited database record's `QuantityPerUnit` column to a `NULL` value.</span></span> <span data-ttu-id="74506-134">De forma similar, si un campo obligatorio, como `ProductName`, se quita de la interfaz de edición, se producirá un error de la actualización con un "*columna 'ProductName' no permite valores NULL*" excepción.</span><span class="sxs-lookup"><span data-stu-id="74506-134">Similarly, if a required field, such as `ProductName`, is removed from the editing interface, the update will fail with a "*Column 'ProductName' does not allow nulls*" exception.</span></span> <span data-ttu-id="74506-135">El motivo de este comportamiento era porque se configuró el ObjectDataSource para llamar a la `ProductsBLL` la clase `UpdateProduct` método, que espera un parámetro de entrada para cada uno de los campos de producto.</span><span class="sxs-lookup"><span data-stu-id="74506-135">The reason for this behavior was because the ObjectDataSource was configured to call the `ProductsBLL` class's `UpdateProduct` method, which expected an input parameter for each of the product fields.</span></span> <span data-ttu-id="74506-136">Por lo tanto, el ObjectDataSource `UpdateParameters` colección contiene un parámetro para cada uno de lo método de parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="74506-136">Therefore, the ObjectDataSource's `UpdateParameters` collection contained a parameter for each of the method's input parameters.</span></span>

<span data-ttu-id="74506-137">Si desea proporcionar un control Web que permite al usuario final actualizar solo un subconjunto de los campos de datos, es necesario o bien establecer mediante programación la falta `UpdateParameters` valores en el ObjectDataSource `Updating` controlador de eventos o crear e invocar un método BLL que espera a que solo un subconjunto de los campos.</span><span class="sxs-lookup"><span data-stu-id="74506-137">If we want to provide a data Web control that allows the end user to only update a subset of fields, then we need to either programmatically set the missing `UpdateParameters` values in the ObjectDataSource's `Updating` event handler or create and call a BLL method that expects only a subset of the fields.</span></span> <span data-ttu-id="74506-138">Vamos a examinar este último enfoque.</span><span class="sxs-lookup"><span data-stu-id="74506-138">Let's explore this latter approach.</span></span>

<span data-ttu-id="74506-139">En concreto, vamos a crear una página que muestre solo los `ProductName` y `UnitPrice` campos de un control GridView editable.</span><span class="sxs-lookup"><span data-stu-id="74506-139">Specifically, let's create a page that displays just the `ProductName` and `UnitPrice` fields in an editable GridView.</span></span> <span data-ttu-id="74506-140">Interfaz de edición de esta GridView solo permitirá al usuario que actualice los campos que se muestran dos, `ProductName` y `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="74506-140">This GridView's editing interface will only allow the user to update the two displayed fields, `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="74506-141">Puesto que esta interfaz edición proporciona solo un subconjunto de los campos de un producto, o es necesario crear un ObjectDataSource que usa la capa BLL existente `UpdateProduct` método y los valores de campo de producto que faltan estableció mediante programación en su `Updating` eventos controlador, o se necesita crear un nuevo método BLL que espera que sólo el subconjunto de los campos definidos en GridView.</span><span class="sxs-lookup"><span data-stu-id="74506-141">Since this editing interface only provides a subset of a product's fields, we either need to create an ObjectDataSource that uses the existing BLL's `UpdateProduct` method and has the missing product field values set programmatically in its `Updating` event handler, or we need to create a new BLL method that expects only the subset of fields defined in the GridView.</span></span> <span data-ttu-id="74506-142">Para este tutorial, vamos a usar esta última opción y crear una sobrecarga de la `UpdateProduct` /método siguiente, que toma solo tres parámetros de entrada: `productName`, `unitPrice`, y `productID`:</span><span class="sxs-lookup"><span data-stu-id="74506-142">For this tutorial, let's use the latter option and create an overload of the `UpdateProduct` method, one that takes in just three input parameters: `productName`, `unitPrice`, and `productID`:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample1.cs)]

<span data-ttu-id="74506-143">Al igual que el original `UpdateProduct` esta sobrecarga de método, inicia y comprueba si hay un producto en la base de datos con los valores especificados `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="74506-143">Like the original `UpdateProduct` method, this overload starts by checking to see if there is a product in the database with the specified `ProductID`.</span></span> <span data-ttu-id="74506-144">Si no, devuelve `false`, que indica que el error en la solicitud para actualizar la información de producto.</span><span class="sxs-lookup"><span data-stu-id="74506-144">If not, it returns `false`, indicating that the request to update the product information failed.</span></span> <span data-ttu-id="74506-145">En caso contrario, actualiza el registro de producto existente `ProductName` y `UnitPrice` campos en consecuencia y confirma la actualización mediante una llamada a la TableAdpater `Update()` método, pasando el `ProductsRow` instancia.</span><span class="sxs-lookup"><span data-stu-id="74506-145">Otherwise it updates the existing product record's `ProductName` and `UnitPrice` fields accordingly and commits the update by calling the TableAdpater's `Update()` method, passing in the `ProductsRow` instance.</span></span>

<span data-ttu-id="74506-146">Con esta adición a nuestro `ProductsBLL` (clase), estamos listos crear la interfaz de GridView simplificada.</span><span class="sxs-lookup"><span data-stu-id="74506-146">With this addition to our `ProductsBLL` class, we're ready to create the simplified GridView interface.</span></span> <span data-ttu-id="74506-147">Abra la `DataModificationEvents.aspx` en el `EditInsertDelete` carpeta y agregar un control GridView a la página.</span><span class="sxs-lookup"><span data-stu-id="74506-147">Open the `DataModificationEvents.aspx` in the `EditInsertDelete` folder and add a GridView to the page.</span></span> <span data-ttu-id="74506-148">Crear un nuevo origen ObjectDataSource y configúrelo para utilizar el `ProductsBLL` clase con su `Select()` asignación del método a `GetProducts` y su `Update()` asignación del método para el `UpdateProduct` sobrecarga que toma solo en el `productName`, `unitPrice`, y `productID` parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="74506-148">Create a new ObjectDataSource and configure it to use the `ProductsBLL` class with its `Select()` method mapping to `GetProducts` and its `Update()` method mapping to the `UpdateProduct` overload that takes in only the `productName`, `unitPrice`, and `productID` input parameters.</span></span> <span data-ttu-id="74506-149">La figura 2 muestra el Asistente para crear orígenes de datos al asignar el ObjectDataSource `Update()` método a la `ProductsBLL` de la nueva clase `UpdateProduct` sobrecarga del método.</span><span class="sxs-lookup"><span data-stu-id="74506-149">Figure 2 shows the Create Data Source wizard when mapping the ObjectDataSource's `Update()` method to the `ProductsBLL` class's new `UpdateProduct` method overload.</span></span>


<span data-ttu-id="74506-150">[![Asignar Update() método de ObjectDataSource a la nueva sobrecarga UpdateProduct](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="74506-150">[![Map the ObjectDataSource's Update() Method to the New UpdateProduct Overload](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image5.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image4.png)</span></span>

<span data-ttu-id="74506-151">**Figura 2**: asignar el ObjectDataSource `Update()` método el nuevo `UpdateProduct` de sobrecarga ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="74506-151">**Figure 2**: Map the ObjectDataSource's `Update()` Method to the New `UpdateProduct` Overload ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image6.png))</span></span>


<span data-ttu-id="74506-152">Puesto que nuestro ejemplo inicialmente solo necesitarán la capacidad de modificar datos, pero no permite insertar o eliminar registros, tómese un momento para indicar explícitamente que el ObjectDataSource `Insert()` y `Delete()` métodos no deberían asignarse a cualquiera de los `ProductsBLL` métodos de la clase, vaya a las pestañas INSERT y DELETE y elija (ninguno) en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="74506-152">Since our example will initially just need the ability to edit data, but not to insert or delete records, take a moment to explicitly indicate that the ObjectDataSource's `Insert()` and `Delete()` methods shouldn't be mapped to any of the `ProductsBLL` class's methods by going to the INSERT and DELETE tabs and choosing (None) from the drop-down list.</span></span>


<span data-ttu-id="74506-153">[![Elija (ninguno) en la lista desplegable de las fichas DELETE y INSERT](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="74506-153">[![Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image8.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image7.png)</span></span>

<span data-ttu-id="74506-154">**Figura 3**: elija (ninguno) de la lista desplegable para la INSERCIÓN y eliminar pestañas ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="74506-154">**Figure 3**: Choose (None) From the Drop-Down List for the INSERT and DELETE Tabs ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image9.png))</span></span>


<span data-ttu-id="74506-155">Después de completar este asistente Active la casilla Habilitar edición de etiquetas inteligentes de GridView.</span><span class="sxs-lookup"><span data-stu-id="74506-155">After completing this wizard check the Enable Editing checkbox from the GridView's smart tag.</span></span>

<span data-ttu-id="74506-156">Con la finalización del Asistente Crear origen de datos y enlazar a GridView, Visual Studio ha creado la sintaxis declarativa para ambos controles.</span><span class="sxs-lookup"><span data-stu-id="74506-156">With the completion of the Create Data Source wizard and binding that to the GridView, Visual Studio has created the declarative syntax for both controls.</span></span> <span data-ttu-id="74506-157">Vaya a la vista de origen para inspeccionar marcado declarativo de ObjectDataSource, que se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="74506-157">Go to the Source view to inspect the ObjectDataSource's declarative markup, which is shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample2.aspx)]

<span data-ttu-id="74506-158">Puesto que no hay ninguna asignación para el ObjectDataSource `Insert()` y `Delete()` métodos, no hay ningún `InsertParameters` o `DeleteParameters` secciones.</span><span class="sxs-lookup"><span data-stu-id="74506-158">Since there are no mappings for the ObjectDataSource's `Insert()` and `Delete()` methods, there are no `InsertParameters` or `DeleteParameters` sections.</span></span> <span data-ttu-id="74506-159">Además, desde el `Update()` método se asigna a la `UpdateProduct` sobrecarga del método que solo acepta tres parámetros de entrada, el `UpdateParameters` sección tiene solo tres `Parameter` instancias.</span><span class="sxs-lookup"><span data-stu-id="74506-159">Furthermore, since the `Update()` method is mapped to the `UpdateProduct` method overload that only accepts three input parameters, the `UpdateParameters` section has just three `Parameter` instances.</span></span>

<span data-ttu-id="74506-160">Tenga en cuenta que el ObjectDataSource `OldValuesParameterFormatString` propiedad está establecida en `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="74506-160">Note that the ObjectDataSource's `OldValuesParameterFormatString` property is set to `original_{0}`.</span></span> <span data-ttu-id="74506-161">Esta propiedad se establece automáticamente en Visual Studio cuando se usa al Asistente para configurar orígenes de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-161">This property is set automatically by Visual Studio when using the Configure Data Source wizard.</span></span> <span data-ttu-id="74506-162">Sin embargo, puesto que nuestros métodos BLL no espera que el original `ProductID` valor que se pasa, quite por completo esta asignación de propiedad de la sintaxis declarativa de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="74506-162">However, since our BLL methods don't expect the original `ProductID` value to be passed in, remove this property assignment altogether from the ObjectDataSource's declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="74506-163">Si simplemente limpiar el `OldValuesParameterFormatString` valor de la propiedad de la ventana de propiedades en la vista de diseño, la propiedad seguirá existiendo en la sintaxis declarativa, pero se establecerá en una cadena vacía.</span><span class="sxs-lookup"><span data-stu-id="74506-163">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but will be set to an empty string.</span></span> <span data-ttu-id="74506-164">Quite la propiedad por completo de la sintaxis declarativa, o bien, en la ventana Propiedades, establezca el valor en el valor predeterminado, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="74506-164">Either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>


<span data-ttu-id="74506-165">Mientras el ObjectDataSource solo tiene `UpdateParameters` para el producto name, precio y ID, Visual Studio ha agregado un BoundField o CampoCasillaVerificación en GridView para cada uno de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="74506-165">While the ObjectDataSource only has `UpdateParameters` for the product's name, price, and ID, Visual Studio has added a BoundField or CheckBoxField in the GridView for each of the product's fields.</span></span>


<span data-ttu-id="74506-166">[![GridView contiene un BoundField o CampoCasillaVerificación para cada uno de los campos del producto](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="74506-166">[![The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image11.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image10.png)</span></span>

<span data-ttu-id="74506-167">**Figura 4**: GridView contiene un BoundField o CampoCasillaVerificación para cada uno de los campos del producto ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="74506-167">**Figure 4**: The GridView Contains a BoundField or CheckBoxField for Each of the Product's Fields ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image12.png))</span></span>


<span data-ttu-id="74506-168">Cuando el usuario final edita un producto y haga clic en el botón de actualización, GridView enumera los campos que no fueran de solo lectura.</span><span class="sxs-lookup"><span data-stu-id="74506-168">When the end user edits a product and clicks its Update button, the GridView enumerates those fields that were not read-only.</span></span> <span data-ttu-id="74506-169">A continuación, Establece el valor del parámetro correspondiente en el ObjectDataSource `UpdateParameters` colección para el valor especificado por el usuario.</span><span class="sxs-lookup"><span data-stu-id="74506-169">It then sets the value of the corresponding parameter in the ObjectDataSource's `UpdateParameters` collection to the value entered by the user.</span></span> <span data-ttu-id="74506-170">Si no es un parámetro correspondiente, GridView suma uno a la colección.</span><span class="sxs-lookup"><span data-stu-id="74506-170">If there is not a corresponding parameter, the GridView adds one to the collection.</span></span> <span data-ttu-id="74506-171">Por lo tanto, si nuestro GridView contiene BoundFields y CheckBoxFields para todos los campos del producto, ObjectDataSource terminará invocar el `UpdateProduct` sobrecarga que toma en todos estos parámetros, a pesar del hecho de que el ObjectDataSource marcado declarativo especifica solo tres parámetros de entrada (Véase la figura 5).</span><span class="sxs-lookup"><span data-stu-id="74506-171">Therefore, if our GridView contains BoundFields and CheckBoxFields for all of the product's fields, the ObjectDataSource will end up invoking the `UpdateProduct` overload that takes in all of these parameters, despite the fact that the ObjectDataSource's declarative markup specifies only three input parameters (see Figure 5).</span></span> <span data-ttu-id="74506-172">De forma similar, si hay alguna combinación de no son de solo lectura producto campos en el control GridView que no se corresponde con los parámetros de entrada para un `UpdateProduct` sobrecarga, se producirá una excepción al intentar actualizar.</span><span class="sxs-lookup"><span data-stu-id="74506-172">Similarly, if there is some combination of non-read-only product fields in the GridView that doesn't correspond to the input parameters for a `UpdateProduct` overload, an exception will be raised when attempting to update.</span></span>


<span data-ttu-id="74506-173">[![Usará GridView agregar parámetros a la colección de UpdateParameters de ObjectDataSource](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="74506-173">[![The GridView Will Add Parameters to the ObjectDataSource's UpdateParameters Collection](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image14.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image13.png)</span></span>

<span data-ttu-id="74506-174">**Figura 5**: GridView el le y agregar los parámetros a la ObjectDataSource `UpdateParameters` colección ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="74506-174">**Figure 5**: The GridView Will Add Parameters to the ObjectDataSource's `UpdateParameters` Collection ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image15.png))</span></span>


<span data-ttu-id="74506-175">Para asegurarse de que el ObjectDataSource invoca el `UpdateProduct` sobrecarga que toma solo nombre del producto, precio y de Id., es necesario restringir GridView a tener campos editables para simplemente el `ProductName` y `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="74506-175">To ensure that the ObjectDataSource invokes the `UpdateProduct` overload that takes in just the product's name, price, and ID, we need to restrict the GridView to having editable fields for just the `ProductName` and `UnitPrice`.</span></span> <span data-ttu-id="74506-176">Esto puede realizarse mediante la eliminación de los demás BoundFields y CheckBoxFields, estableciendo los demás campos `ReadOnly` propiedad `true`, o alguna combinación de los dos.</span><span class="sxs-lookup"><span data-stu-id="74506-176">This can be accomplished by removing the other BoundFields and CheckBoxFields, by setting those other fields' `ReadOnly` property to `true`, or by some combination of the two.</span></span> <span data-ttu-id="74506-177">Para este tutorial vamos a basta con quitar todos los campos de GridView excepto la `ProductName` y `UnitPrice` BoundFields, tras el cual marcado declarativo del GridView tendrá un aspecto similar:</span><span class="sxs-lookup"><span data-stu-id="74506-177">For this tutorial let's simply remove all GridView fields except the `ProductName` and `UnitPrice` BoundFields, after which the GridView's declarative markup will look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample3.aspx)]

<span data-ttu-id="74506-178">Aunque el `UpdateProduct` sobrecarga espera tres parámetros de entrada, sólo tenemos dos BoundFields en nuestra GridView.</span><span class="sxs-lookup"><span data-stu-id="74506-178">Even though the `UpdateProduct` overload expects three input parameters, we only have two BoundFields in our GridView.</span></span> <span data-ttu-id="74506-179">Esto es porque el `productID` parámetro de entrada es un valor de clave principal y pasan a través del valor de la `DataKeyNames` propiedad para la fila editada.</span><span class="sxs-lookup"><span data-stu-id="74506-179">This is because the `productID` input parameter is a primary key value and passed in through the value of the `DataKeyNames` property for the edited row.</span></span>

<span data-ttu-id="74506-180">Nuestro GridView, junto con el `UpdateProduct` sobrecarga, permite al usuario editar únicamente el nombre y el precio de un producto sin perder algunos de los otros campos de producto.</span><span class="sxs-lookup"><span data-stu-id="74506-180">Our GridView, along with the `UpdateProduct` overload, allows a user to edit just the name and price of a product without losing any of the other product fields.</span></span>


<span data-ttu-id="74506-181">[![La interfaz permite la edición únicamente el producto nombre y precio](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="74506-181">[![The Interface Allows Editing Just the Product's Name and Price](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image17.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image16.png)</span></span>

<span data-ttu-id="74506-182">**Figura 6**: el permite interfaz edición únicamente el producto nombre y precio ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="74506-182">**Figure 6**: The Interface Allows Editing Just the Product's Name and Price ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="74506-183">Como se describe en el tutorial anterior, es sumamente importante que GridView posible estado de vista de s habilitado (comportamiento predeterminado).</span><span class="sxs-lookup"><span data-stu-id="74506-183">As discussed in the previous tutorial, it is vitally important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="74506-184">Si establece la s GridView `EnableViewState` propiedad `false`, se corre el riesgo de tener usuarios simultáneos involuntariamente eliminen o modifiquen los registros.</span><span class="sxs-lookup"><span data-stu-id="74506-184">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="74506-185">Vea [advertencia: problema de simultaneidad con ASP.NET 2.0 GridView/DetailsView/FormViews que admiten la edición o eliminación y cuyo estado de vista está deshabilitado](http://scottonwriting.net/sowblog/archive/2006/10/03/163215.aspx) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="74506-185">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/archive/2006/10/03/163215.aspx) for more information.</span></span>


## <a name="improving-theunitpriceformatting"></a><span data-ttu-id="74506-186">Mejorar la`UnitPrice`formato</span><span class="sxs-lookup"><span data-stu-id="74506-186">Improving the`UnitPrice`Formatting</span></span>

<span data-ttu-id="74506-187">Mientras que en el ejemplo de GridView se muestra en la figura 6 funciona, el `UnitPrice` campo no tiene el formato en absoluto, lo que resulta en una pantalla de precios que no tiene ninguna divisa símbolos y tiene cuatro decimales.</span><span class="sxs-lookup"><span data-stu-id="74506-187">While the GridView example shown in Figure 6 works, the `UnitPrice` field is not formatted at all, resulting in a price display that lacks any currency symbols and has four decimal places.</span></span> <span data-ttu-id="74506-188">Para aplicar una formato para las filas no editables de moneda, basta con establecer la `UnitPrice` del BoundField `DataFormatString` propiedad `{0:c}` y su `HtmlEncode` propiedad `false`.</span><span class="sxs-lookup"><span data-stu-id="74506-188">To apply a currency formatting for the non-editable rows, simply set the `UnitPrice` BoundField's `DataFormatString` property to `{0:c}` and its `HtmlEncode` property to `false`.</span></span>


<span data-ttu-id="74506-189">[![Establecer el UnitPrice DataFormatString y HtmlEncode propiedades según corresponda](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="74506-189">[![Set the UnitPrice's DataFormatString and HtmlEncode Properties Accordingly](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image20.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image19.png)</span></span>

<span data-ttu-id="74506-190">**Figura 7**: establecer el `UnitPrice`del `DataFormatString` y `HtmlEncode` propiedades según corresponda ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="74506-190">**Figure 7**: Set the `UnitPrice`'s `DataFormatString` and `HtmlEncode` Properties Accordingly ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image21.png))</span></span>


<span data-ttu-id="74506-191">Con este cambio, las filas no editables formatee el precio como una moneda; Sin embargo, la fila modificada, aún muestra el valor sin el símbolo de moneda y con cuatro decimales.</span><span class="sxs-lookup"><span data-stu-id="74506-191">With this change, the non-editable rows format the price as a currency; the edited row, however, still displays the value without the currency symbol and with four decimal places.</span></span>


<span data-ttu-id="74506-192">[![Filas no editables son ahora un formato como valores de moneda](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="74506-192">[![Non-Editable Rows are Now Formatted as Currency Values](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image23.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image22.png)</span></span>

<span data-ttu-id="74506-193">**Figura 8**: no se puede modificar filas son ahora formato de valores de moneda ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="74506-193">**Figure 8**: Non-Editable Rows are Now Formatted as Currency Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image24.png))</span></span>


<span data-ttu-id="74506-194">Las instrucciones de formato especificadas en el `DataFormatString` propiedad se puede aplicar a la interfaz de edición estableciendo la BoundField `ApplyFormatInEditMode` propiedad `true` (el valor predeterminado es `false`).</span><span class="sxs-lookup"><span data-stu-id="74506-194">The formatting instructions specified in the `DataFormatString` property can be applied to the editing interface by setting the BoundField's `ApplyFormatInEditMode` property to `true` (the default is `false`).</span></span> <span data-ttu-id="74506-195">Tómese un momento para establecer esta propiedad en `true`.</span><span class="sxs-lookup"><span data-stu-id="74506-195">Take a moment to set this property to `true`.</span></span>


<span data-ttu-id="74506-196">[![Establecer propiedad de ApplyFormatInEditMode de UnitPrice BoundField en true](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="74506-196">[![Set the UnitPrice BoundField's ApplyFormatInEditMode property to true](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image26.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image25.png)</span></span>

<span data-ttu-id="74506-197">**Figura 9**: establecer el `UnitPrice` del BoundField `ApplyFormatInEditMode` propiedad `true` ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="74506-197">**Figure 9**: Set the `UnitPrice` BoundField's `ApplyFormatInEditMode` property to `true` ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image27.png))</span></span>


<span data-ttu-id="74506-198">Con este cambio, el valor de la `UnitPrice` aparece en el texto editado fila también se da formato como una moneda.</span><span class="sxs-lookup"><span data-stu-id="74506-198">With this change, the value of the `UnitPrice` displayed in the edited row is also formatted as a currency.</span></span>


<span data-ttu-id="74506-199">[![Valor de la fila editada UnitPrice es ahora un formato como una moneda](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="74506-199">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image29.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image28.png)</span></span>

<span data-ttu-id="74506-200">**Figura 10**: The editar la fila `UnitPrice` valor es ahora el formato como una moneda ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="74506-200">**Figure 10**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image30.png))</span></span>


<span data-ttu-id="74506-201">Sin embargo, actualizar un producto con el símbolo de moneda en el cuadro de texto, como $ las 19: 00 produce un `FormatException`.</span><span class="sxs-lookup"><span data-stu-id="74506-201">However, updating a product with the currency symbol in the textbox such as $19.00 throws a `FormatException`.</span></span> <span data-ttu-id="74506-202">Cuando intente asignar los valores proporcionados por el usuario a la ObjectDataSource GridView `UpdateParameters` colección no es capaz de convertir la `UnitPrice` cadena "$ las 19: 00" en el `decimal` requerido por el parámetro (consulte la figura 11).</span><span class="sxs-lookup"><span data-stu-id="74506-202">When the GridView attempts to assign the user-supplied values to the ObjectDataSource's `UpdateParameters` collection it is unable to convert the `UnitPrice` string "$19.00" into the `decimal` required by the parameter (see Figure 11).</span></span> <span data-ttu-id="74506-203">Para remediar este problema podemos crear un controlador de eventos del control de GridView `RowUpdating` eventos y para que analizar proporcionada por el usuario `UnitPrice` como un formato de moneda `decimal`.</span><span class="sxs-lookup"><span data-stu-id="74506-203">To remedy this we can create an event handler for the GridView's `RowUpdating` event and have it parse the user-supplied `UnitPrice` as a currency-formatted `decimal`.</span></span>

<span data-ttu-id="74506-204">La GridView `RowUpdating` eventos acepta como su segundo parámetro de un objeto de tipo [GridViewUpdateEventArgs](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), que incluye un `NewValues` diccionario como uno de sus propiedades que contiene los valores proporcionados por el usuario están preparados para asignado a la ObjectDataSource `UpdateParameters` colección.</span><span class="sxs-lookup"><span data-stu-id="74506-204">The GridView's `RowUpdating` event accepts as its second parameter an object of type [GridViewUpdateEventArgs](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridviewupdateeventargs(VS.80).aspx), which includes a `NewValues` dictionary as one of its properties that holds the user-supplied values ready to be assigned to the ObjectDataSource's `UpdateParameters` collection.</span></span> <span data-ttu-id="74506-205">Se puede sobrescribir la existente `UnitPrice` valor en el `NewValues` colección con un valor decimal se analiza mediante el formato de moneda con las siguientes líneas de código en el `RowUpdating` controlador de eventos:</span><span class="sxs-lookup"><span data-stu-id="74506-205">We can overwrite the existing `UnitPrice` value in the `NewValues` collection with a decimal value parsed using the currency format with the following lines of code in the `RowUpdating` event handler:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample4.cs)]

<span data-ttu-id="74506-206">Si el usuario ha especificado un `UnitPrice` valor (por ejemplo, "$ las 19: 00"), este valor se sobrescribe con el valor decimal calculado por [Decimal.Parse](https://msdn.microsoft.com/en-us/library/system.decimal.parse(VS.80).aspx), analizar el valor como una moneda.</span><span class="sxs-lookup"><span data-stu-id="74506-206">If the user has supplied a `UnitPrice` value (such as "$19.00"), this value is overwritten with the decimal value computed by [Decimal.Parse](https://msdn.microsoft.com/en-us/library/system.decimal.parse(VS.80).aspx), parsing the value as a currency.</span></span> <span data-ttu-id="74506-207">Esto correctamente analizará la coma decimal en el caso de los símbolos de moneda, comas, decimales y así sucesivamente y utiliza el [enumeración NumberStyles](https://msdn.microsoft.com/en-US/library/system.globalization.numberstyles(VS.80).aspx) en el [System.Globalization](https://msdn.microsoft.com/en-US/library/abeh092z(VS.80).aspx) espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="74506-207">This will correctly parse the decimal in the event of any currency symbols, commas, decimal points, and so on, and uses the [NumberStyles enumeration](https://msdn.microsoft.com/en-US/library/system.globalization.numberstyles(VS.80).aspx) in the [System.Globalization](https://msdn.microsoft.com/en-US/library/abeh092z(VS.80).aspx) namespace.</span></span>

<span data-ttu-id="74506-208">La figura 11 muestra tanto el problema causado por los símbolos de divisa en proporcionada por el usuario `UnitPrice`, así como la manera de GridView `RowUpdating` controlador de eventos se puede utilizar para analizar correctamente dicha entrada.</span><span class="sxs-lookup"><span data-stu-id="74506-208">Figure 11 shows both the problem caused by currency symbols in the user-supplied `UnitPrice`, along with how the GridView's `RowUpdating` event handler can be utilized to correctly parse such input.</span></span>


<span data-ttu-id="74506-209">[![Valor de la fila editada UnitPrice es ahora un formato como una moneda](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="74506-209">[![The Edited Row's UnitPrice Value is Now Formatted as a Currency](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image32.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image31.png)</span></span>

<span data-ttu-id="74506-210">**Figura 11**: The editar la fila `UnitPrice` valor es ahora el formato como una moneda ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="74506-210">**Figure 11**: The Edited Row's `UnitPrice` Value is Now Formatted as a Currency ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image33.png))</span></span>


## <a name="step-2-prohibitingnull-unitprices"></a><span data-ttu-id="74506-211">Paso 2: prohibición`NULL UnitPrices`</span><span class="sxs-lookup"><span data-stu-id="74506-211">Step 2: Prohibiting`NULL UnitPrices`</span></span>

<span data-ttu-id="74506-212">Mientras la base de datos está configurado para permitir `NULL` valores en el `Products` la tabla `UnitPrice` columna, que podríamos desear evitar que los usuarios visitar esta página concreta de especificar un `NULL` `UnitPrice` valor.</span><span class="sxs-lookup"><span data-stu-id="74506-212">While the database is configured to allow `NULL` values in the `Products` table's `UnitPrice` column, we may want to prevent users visiting this particular page from specifying a `NULL` `UnitPrice` value.</span></span> <span data-ttu-id="74506-213">Es decir, si un usuario no se puede escribir un `UnitPrice` valor cuando se edita una fila de producto, en lugar de guardar los resultados en la base de datos que desea mostrar un mensaje que informa al usuario que, a través de esta página, los productos editados deben tener un precio especificado.</span><span class="sxs-lookup"><span data-stu-id="74506-213">That is, if a user fails to enter a `UnitPrice` value when editing a product row, rather than save the results to the database we want to display a message informing the user that, through this page, any edited products must have a price specified.</span></span>

<span data-ttu-id="74506-214">El `GridViewUpdateEventArgs` objeto pasa a la GridView `RowUpdating` contiene el controlador de eventos un `Cancel` propiedad que, si establece en `true`, finaliza el proceso de actualización.</span><span class="sxs-lookup"><span data-stu-id="74506-214">The `GridViewUpdateEventArgs` object passed into the GridView's `RowUpdating` event handler contains a `Cancel` property that, if set to `true`, terminates the updating process.</span></span> <span data-ttu-id="74506-215">Vamos a ampliar el `RowUpdating` controlador de eventos para establecer `e.Cancel` a `true` y mostrar un mensaje que explica por qué si la `UnitPrice` valor en el `NewValues` colección es `null`.</span><span class="sxs-lookup"><span data-stu-id="74506-215">Let's extend the `RowUpdating` event handler to set `e.Cancel` to `true` and display a message explaining why if the `UnitPrice` value in the `NewValues` collection is `null`.</span></span>

<span data-ttu-id="74506-216">Empiece agregando un control Web Label a la página con el nombre `MustProvideUnitPriceMessage`.</span><span class="sxs-lookup"><span data-stu-id="74506-216">Start by adding a Label Web control to the page named `MustProvideUnitPriceMessage`.</span></span> <span data-ttu-id="74506-217">Este control de etiqueta se mostrará si el usuario no se puede especificar un `UnitPrice` valor al actualizar un producto.</span><span class="sxs-lookup"><span data-stu-id="74506-217">This Label control will be displayed if the user fails to specify a `UnitPrice` value when updating a product.</span></span> <span data-ttu-id="74506-218">Establezca la etiqueta `Text` propiedad "Debe proporcionar un precio para el producto".</span><span class="sxs-lookup"><span data-stu-id="74506-218">Set the Label's `Text` property to "You must provide a price for the product."</span></span> <span data-ttu-id="74506-219">También he creado una nueva clase CSS en `Styles.css` denominado `Warning` con la siguiente definición:</span><span class="sxs-lookup"><span data-stu-id="74506-219">I've also created a new CSS class in `Styles.css` named `Warning` with the following definition:</span></span>


[!code-css[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample5.css)]

<span data-ttu-id="74506-220">Por último, establezca la etiqueta `CssClass` propiedad `Warning`.</span><span class="sxs-lookup"><span data-stu-id="74506-220">Finally, set the Label's `CssClass` property to `Warning`.</span></span> <span data-ttu-id="74506-221">En este momento el diseñador debe mostrar el mensaje de advertencia en un color rojo, negrita, cursiva, tamaño de fuente extra grande por encima del control GridView, tal como se muestra en la figura 12.</span><span class="sxs-lookup"><span data-stu-id="74506-221">At this point the Designer should show the warning message in a red, bold, italic, extra large font size above the GridView, as shown in Figure 12.</span></span>


<span data-ttu-id="74506-222">[![Se ha agregado una etiqueta por encima de GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="74506-222">[![A Label Has Been Added Above the GridView](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image35.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image34.png)</span></span>

<span data-ttu-id="74506-223">**Figura 12**: una etiqueta tiene ha agregado anteriormente el GridView ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="74506-223">**Figure 12**: A Label Has Been Added Above the GridView ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image36.png))</span></span>


<span data-ttu-id="74506-224">De forma predeterminada, esta etiqueta debe ocultarse, por tanto, establecer su `Visible` propiedad `false` en el `Page_Load` controlador de eventos:</span><span class="sxs-lookup"><span data-stu-id="74506-224">By default, this Label should be hidden, so set its `Visible` property to `false` in the `Page_Load` event handler:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample6.cs)]

<span data-ttu-id="74506-225">Si el usuario intenta actualizar un producto sin especificar el `UnitPrice`, desea cancelar la actualización y mostrar la etiqueta de advertencia.</span><span class="sxs-lookup"><span data-stu-id="74506-225">If the user attempts to update a product without specifying the `UnitPrice`, we want to cancel the update and display the warning label.</span></span> <span data-ttu-id="74506-226">Aumentar la GridView `RowUpdating` controlador de eventos como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="74506-226">Augment the GridView's `RowUpdating` event handler as follows:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample7.cs)]

<span data-ttu-id="74506-227">Si un usuario intenta guardar un producto sin especificar un precio, se cancela la actualización y se muestra un mensaje útil.</span><span class="sxs-lookup"><span data-stu-id="74506-227">If a user attempts to save a product without specifying a price, the update is cancelled and a helpful message is displayed.</span></span> <span data-ttu-id="74506-228">Mientras que la base de datos (y la lógica de negocios) permite `NULL` `UnitPrice` s, esta página ASP.NET determinada no lo hace.</span><span class="sxs-lookup"><span data-stu-id="74506-228">While the database (and business logic) allows for `NULL` `UnitPrice` s, this particular ASP.NET page does not.</span></span>


<span data-ttu-id="74506-229">[![Un usuario no puede dejar en blanco UnitPrice](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="74506-229">[![A User Cannot Leave UnitPrice Blank](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image38.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image37.png)</span></span>

<span data-ttu-id="74506-230">**Figura 13**: un usuario no puede dejar `UnitPrice` en blanco ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="74506-230">**Figure 13**: A User Cannot Leave `UnitPrice` Blank ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image39.png))</span></span>


<span data-ttu-id="74506-231">Hasta ahora hemos visto cómo utilizar la GridView `RowUpdating` evento para modificar mediante programación los valores de parámetro asignados a la ObjectDataSource `UpdateParameters` colección así como el modo para cancelar la actualización procesar por completo.</span><span class="sxs-lookup"><span data-stu-id="74506-231">So far we have seen how to use the GridView's `RowUpdating` event to programmatically alter the parameter values assigned to the ObjectDataSource's `UpdateParameters` collection as well as how to cancel the updating process altogether.</span></span> <span data-ttu-id="74506-232">Estos conceptos se mantienen en los controles DetailsView y FormView y también se aplican a la inserción y eliminación.</span><span class="sxs-lookup"><span data-stu-id="74506-232">These concepts carry over to the DetailsView and FormView controls and also apply to inserting and deleting.</span></span>

<span data-ttu-id="74506-233">También pueden realizar estas tareas en el nivel de ObjectDataSource mediante controladores de eventos para su `Inserting`, `Updating`, y `Deleting` eventos.</span><span class="sxs-lookup"><span data-stu-id="74506-233">These tasks can also be done at the ObjectDataSource level through event handlers for its `Inserting`, `Updating`, and `Deleting` events.</span></span> <span data-ttu-id="74506-234">Estos eventos se desencadenan antes de que se invoca el método asociado del objeto subyacente y proporcionan una oportunidad de última oportunidad para modificar la colección de parámetros de entrada o cancelar la operación directamente.</span><span class="sxs-lookup"><span data-stu-id="74506-234">These events fire before the associated method of the underlying object is invoked and provide a last-chance opportunity to modify the input parameters collection or cancel the operation outright.</span></span> <span data-ttu-id="74506-235">Los controladores de eventos para estos tres eventos se pasan un objeto de tipo [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) que tiene dos propiedades interesantes:</span><span class="sxs-lookup"><span data-stu-id="74506-235">The event handlers for these three events are passed an object of type [ObjectDataSourceMethodEventArgs](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs(VS.80).aspx) that has two properties of interest:</span></span>

- <span data-ttu-id="74506-236">[Cancelar](https://msdn.microsoft.com/en-US/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), que, si establece en `true`, cancela la operación que se está realiza</span><span class="sxs-lookup"><span data-stu-id="74506-236">[Cancel](https://msdn.microsoft.com/en-US/library/system.componentmodel.canceleventargs.cancel(VS.80).aspx), which, if set to `true`, cancels the operation being performed</span></span>
- <span data-ttu-id="74506-237">[InputParameters](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), que es la colección de `InsertParameters`, `UpdateParameters`, o `DeleteParameters`, dependiendo de si es el controlador de eventos para el `Inserting`, `Updating`, o `Deleting` eventos</span><span class="sxs-lookup"><span data-stu-id="74506-237">[InputParameters](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.objectdatasourcemethodeventargs.inputparameters(VS.80).aspx), which is the collection of `InsertParameters`, `UpdateParameters`, or `DeleteParameters`, depending on whether the event handler is for the `Inserting`, `Updating`, or `Deleting` event</span></span>

<span data-ttu-id="74506-238">Para ilustrar trabajar con los valores de parámetro en el nivel de ObjectDataSource, vamos a incluir DetailsView en nuestra página que permite a los usuarios agregar un nuevo producto.</span><span class="sxs-lookup"><span data-stu-id="74506-238">To illustrate working with the parameter values at the ObjectDataSource level, let's include a DetailsView in our page that allows the users to add a new product.</span></span> <span data-ttu-id="74506-239">Se usará este DetailsView para proporcionar una interfaz para agregar rápidamente un nuevo producto en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-239">This DetailsView will be used to provide an interface for quickly adding a new product to the database.</span></span> <span data-ttu-id="74506-240">Debe tener una interfaz de usuario coherente al agregar un nuevo producto vamos a permitir que el usuario especifique solo los valores de la `ProductName` y `UnitPrice` campos.</span><span class="sxs-lookup"><span data-stu-id="74506-240">To keep a consistent user interface when adding a new product let's allow the user to only enter values for the `ProductName` and `UnitPrice` fields.</span></span> <span data-ttu-id="74506-241">De forma predeterminada, los valores que no se proporcionan en la interfaz de inserción de DetailsView se establecerá en un `NULL` valor de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-241">By default, those values that aren't supplied in the DetailsView's inserting interface will be set to a `NULL` database value.</span></span> <span data-ttu-id="74506-242">Sin embargo, podemos usar la ObjectDataSource `Inserting` eventos para insertar valores predeterminados diferentes, como veremos en breve.</span><span class="sxs-lookup"><span data-stu-id="74506-242">However, we can use the ObjectDataSource's `Inserting` event to inject different default values, as we'll see shortly.</span></span>

## <a name="step-3-providing-an-interface-to-add-new-products"></a><span data-ttu-id="74506-243">Paso 3: Proporcionar una interfaz para agregar nuevos productos</span><span class="sxs-lookup"><span data-stu-id="74506-243">Step 3: Providing an Interface to Add New Products</span></span>

<span data-ttu-id="74506-244">Arrastre un DetailsView desde el cuadro de herramientas en el diseñador, encima del control GridView, borrar sus `Height` y `Width` propiedades y se enlaza a ObjectDataSource ya presente en la página.</span><span class="sxs-lookup"><span data-stu-id="74506-244">Drag a DetailsView from the Toolbox onto the Designer above the GridView, clear out its `Height` and `Width` properties, and bind it to the ObjectDataSource already present on the page.</span></span> <span data-ttu-id="74506-245">Esto agregará una BoundField o CampoCasillaVerificación para cada uno de los campos del producto.</span><span class="sxs-lookup"><span data-stu-id="74506-245">This will add a BoundField or CheckBoxField for each of the product's fields.</span></span> <span data-ttu-id="74506-246">Puesto que deseamos utilizar esta DetailsView para agregar nuevos productos, es necesario activar la opción de habilitar la inserción de la etiqueta inteligente; Sin embargo, no es posible este tipo porque la ObjectDataSource `Insert()` método no está asignado a un método en el `ProductsBLL` clase (Recuerde que se debe establecer esta asignación (ninguno) al configurar el origen de datos consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="74506-246">Since we want to use this DetailsView to add new products, we need to check the Enable Inserting option from the smart tag; however, there's no such option because the ObjectDataSource's `Insert()` method is not mapped to a method in the `ProductsBLL` class (recall that we set this mapping to (None) when configuring the data source see Figure 3).</span></span>

<span data-ttu-id="74506-247">Para configurar el origen ObjectDataSource, seleccione el vínculo Configurar origen de datos en su etiqueta inteligente, iniciar al asistente.</span><span class="sxs-lookup"><span data-stu-id="74506-247">To configure the ObjectDataSource, select the Configure Data Source link from its smart tag, launching the wizard.</span></span> <span data-ttu-id="74506-248">La primera pantalla le permite cambiar el objeto subyacente que ObjectDataSource está enlazado Deje `ProductsBLL`.</span><span class="sxs-lookup"><span data-stu-id="74506-248">The first screen allows you to change the underlying object the ObjectDataSource is bound to; leave it set to `ProductsBLL`.</span></span> <span data-ttu-id="74506-249">La siguiente pantalla muestra las asignaciones de métodos de ObjectDataSource para el objeto subyacente.</span><span class="sxs-lookup"><span data-stu-id="74506-249">The next screen lists the mappings from the ObjectDataSource's methods to the underlying object's.</span></span> <span data-ttu-id="74506-250">Aunque se indica explícitamente que el `Insert()` y `Delete()` métodos no deben asignarse a cualquier método, si va a las pestañas INSERT y DELETE verá que una asignación está allí.</span><span class="sxs-lookup"><span data-stu-id="74506-250">Even though we explicitly indicated that the `Insert()` and `Delete()` methods should not be mapped to any methods, if you go to the INSERT and DELETE tabs you'll see that a mapping is there.</span></span> <span data-ttu-id="74506-251">Esto es porque el `ProductsBLL`del `AddProduct` y `DeleteProduct` métodos utilizan la `DataObjectMethodAttribute` atributo para indicar que son los métodos predeterminados para `Insert()` y `Delete()`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="74506-251">This is because the `ProductsBLL`'s `AddProduct` and `DeleteProduct` methods use the `DataObjectMethodAttribute` attribute to indicate that they are the default methods for `Insert()` and `Delete()`, respectively.</span></span> <span data-ttu-id="74506-252">Por lo tanto, el Asistente de ObjectDataSource selecciona estos cada vez que ejecute al asistente a menos que haya algún otro valor especificado explícitamente.</span><span class="sxs-lookup"><span data-stu-id="74506-252">Hence, the ObjectDataSource wizard selects these each time you run the wizard unless there's some other value explicitly specified.</span></span>

<span data-ttu-id="74506-253">Deje el `Insert()` método que apunta a la `AddProduct` método, pero volver a establecer la lista desplegable de la ficha eliminación en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="74506-253">Leave the `Insert()` method pointing to the `AddProduct` method, but again set the DELETE tab's drop-down list to (None).</span></span>


<span data-ttu-id="74506-254">[![Establece la lista de desplegable de la pestaña Insertar en el método de AddProduct](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="74506-254">[![Set the INSERT Tab's Drop-Down List to the AddProduct Method](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image41.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image40.png)</span></span>

<span data-ttu-id="74506-255">**Figura 14**: establece la lista de desplegable de la pestaña Insertar en el `AddProduct` método ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="74506-255">**Figure 14**: Set the INSERT Tab's Drop-Down List to the `AddProduct` Method ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image42.png))</span></span>


<span data-ttu-id="74506-256">[![Establecer la lista desplegable de la ficha eliminación en (ninguno)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="74506-256">[![Set the DELETE Tab's Drop-Down List to (None)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image44.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image43.png)</span></span>

<span data-ttu-id="74506-257">**Figura 15**: establecer lista de desplegable de la ficha eliminar a (ninguno) ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="74506-257">**Figure 15**: Set the DELETE Tab's Drop-Down List to (None) ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image45.png))</span></span>


<span data-ttu-id="74506-258">Después de realizar estos cambios, la sintaxis declarativa de ObjectDataSource se ampliará para incluir una `InsertParameters` colección, tal y como se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="74506-258">After making these changes, the ObjectDataSource's declarative syntax will be expanded to include an `InsertParameters` collection, as shown below:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample8.aspx)]

<span data-ttu-id="74506-259">Volver a ejecutar el Asistente para agregar de nuevo el `OldValuesParameterFormatString` propiedad.</span><span class="sxs-lookup"><span data-stu-id="74506-259">Rerunning the wizard added back the `OldValuesParameterFormatString` property.</span></span> <span data-ttu-id="74506-260">Tómese un momento para borrar esta propiedad si se establece en el valor predeterminado (`{0}`) o se quita por completo de la sintaxis declarativa.</span><span class="sxs-lookup"><span data-stu-id="74506-260">Take a moment to clear this property by setting it to the default value (`{0}`) or removing it altogether from the declarative syntax.</span></span>

<span data-ttu-id="74506-261">Con ObjectDataSource ofreciendo funcionalidad de inserción, etiquetas inteligentes de DetailsView ahora incluirá la casilla de verificación Habilitar inserción; Vuelva al diseñador y seleccione esta opción.</span><span class="sxs-lookup"><span data-stu-id="74506-261">With the ObjectDataSource providing inserting capabilities, the DetailsView's smart tag will now include the Enable Inserting checkbox; return to the Designer and check this option.</span></span> <span data-ttu-id="74506-262">A continuación, reducir el DetailsView para que solo tiene dos BoundFields - `ProductName` y `UnitPrice` - y el CommandField.</span><span class="sxs-lookup"><span data-stu-id="74506-262">Next, pare down the DetailsView so that it only has two BoundFields - `ProductName` and `UnitPrice` - and the CommandField.</span></span> <span data-ttu-id="74506-263">En este momento la sintaxis declarativa de DetailsView debería ser similar:</span><span class="sxs-lookup"><span data-stu-id="74506-263">At this point the DetailsView's declarative syntax should look like:</span></span>


[!code-aspx[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample9.aspx)]

<span data-ttu-id="74506-264">La figura 16 muestra esta página cuando se ven a través de un explorador en este momento.</span><span class="sxs-lookup"><span data-stu-id="74506-264">Figure 16 shows this page when viewed through a browser at this point.</span></span> <span data-ttu-id="74506-265">Como puede ver, DetailsView muestra el nombre y el precio del producto primer (Chai).</span><span class="sxs-lookup"><span data-stu-id="74506-265">As you can see, the DetailsView lists the name and price of the first product (Chai).</span></span> <span data-ttu-id="74506-266">Sin embargo, se lo que queremos es una interfaz de inserción que proporciona un medio para el usuario agregar rápidamente un nuevo producto a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-266">What we want, however, is an inserting interface that provides a means for the user to quickly add a new product to the database.</span></span>


<span data-ttu-id="74506-267">[![DetailsView es representada actualmente en modo de solo lectura](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="74506-267">[![The DetailsView is Currently Rendered in Read-Only Mode](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image47.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image46.png)</span></span>

<span data-ttu-id="74506-268">**Figura 16**: The DetailsView está representada actualmente en modo de solo lectura ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="74506-268">**Figure 16**: The DetailsView is Currently Rendered in Read-Only Mode ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image48.png))</span></span>


<span data-ttu-id="74506-269">Para poder mostrar DetailsView en su modo de inserción es necesario establecer la `DefaultMode` propiedad `Inserting`.</span><span class="sxs-lookup"><span data-stu-id="74506-269">In order to show the DetailsView in its inserting mode we need to set the `DefaultMode` property to `Inserting`.</span></span> <span data-ttu-id="74506-270">Esto representa la DetailsView en modo de inserción cuando visita por primera vez y mantiene allí después de insertar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="74506-270">This renders the DetailsView in insert mode when first visited and keeps it there after inserting a new record.</span></span> <span data-ttu-id="74506-271">Como se muestra en la figura 17, tal DetailsView proporciona una interfaz rápida para agregar un nuevo registro.</span><span class="sxs-lookup"><span data-stu-id="74506-271">As Figure 17 shows, such a DetailsView provides a quick interface for adding a new record.</span></span>


<span data-ttu-id="74506-272">[![DetailsView proporciona una interfaz para agregar rápidamente un nuevo producto](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="74506-272">[![The DetailsView Provides an Interface for Quickly Adding a New Product](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image50.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image49.png)</span></span>

<span data-ttu-id="74506-273">**Figura 17**: DetailsView proporciona una interfaz para agregar rápidamente un nuevo producto ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="74506-273">**Figure 17**: The DetailsView Provides an Interface for Quickly Adding a New Product ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image51.png))</span></span>


<span data-ttu-id="74506-274">Cuando el usuario escribe un nombre de producto y el precio (por ejemplo, "Acme yate" y 1.99, como se muestra en la figura 17) y hace clic en Insertar, seguidamente, tiene lugar una devolución de datos y comenzará el flujo de trabajo de inserción, hasta la preinstalación en un nuevo registro de producto que se va a agregar a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-274">When the user enters a product name and price (such as "Acme Water" and 1.99, as in Figure 17) and clicks Insert, a postback ensues and the inserting workflow commences, culminating in a new product record being added to the database.</span></span> <span data-ttu-id="74506-275">DetailsView mantiene su interfaz de inserción y GridView es automáticamente vuelve a enlazar a su origen de datos para incluir el nuevo producto, tal como se muestra en la figura 18.</span><span class="sxs-lookup"><span data-stu-id="74506-275">The DetailsView maintains its inserting interface and the GridView is automatically rebound to its data source in order to include the new product, as shown in Figure 18.</span></span>


![El producto](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image52.png)

<span data-ttu-id="74506-277">**Figura 18**: el producto "Agua Acme" se ha agregado a la base de datos</span><span class="sxs-lookup"><span data-stu-id="74506-277">**Figure 18**: The Product "Acme Water" Has Been Added to the Database</span></span>


<span data-ttu-id="74506-278">Mientras el control GridView en la figura 18, no muestra los campos de producto que carecen de la interfaz de DetailsView `CategoryID`, `SupplierID`, `QuantityPerUnit`, y así sucesivamente se asignan `NULL` valores de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-278">While the GridView in Figure 18 doesn't show it, the product fields lacking from the DetailsView interface `CategoryID`, `SupplierID`, `QuantityPerUnit`, and so on are assigned `NULL` database values.</span></span> <span data-ttu-id="74506-279">Puede ver esto mediante la realización de los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="74506-279">You can see this by performing the following steps:</span></span>

1. <span data-ttu-id="74506-280">Vaya al explorador de servidores en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="74506-280">Go to the Server Explorer in Visual Studio</span></span>
2. <span data-ttu-id="74506-281">Al expandir el `NORTHWND.MDF` nodo base de datos</span><span class="sxs-lookup"><span data-stu-id="74506-281">Expanding the `NORTHWND.MDF` database node</span></span>
3. <span data-ttu-id="74506-282">Haga doble clic en el `Products` nodo de la tabla de base de datos</span><span class="sxs-lookup"><span data-stu-id="74506-282">Right-click on the `Products` database table node</span></span>
4. <span data-ttu-id="74506-283">Seleccione Mostrar datos de tabla</span><span class="sxs-lookup"><span data-stu-id="74506-283">Select Show Table Data</span></span>

<span data-ttu-id="74506-284">Esto mostrará una lista de todos los registros en la `Products` tabla.</span><span class="sxs-lookup"><span data-stu-id="74506-284">This will list all of the records in the `Products` table.</span></span> <span data-ttu-id="74506-285">Tal y como figura 19 muestra, todas las columnas de nuestro nuevo producto distinto de `ProductID`, `ProductName`, y `UnitPrice` tienen `NULL` valores.</span><span class="sxs-lookup"><span data-stu-id="74506-285">As Figure 19 shows, all of our new product's columns other than `ProductID`, `ProductName`, and `UnitPrice` have `NULL` values.</span></span>


<span data-ttu-id="74506-286">[![Los campos de producto no proporciona en DetailsView son asignados valores NULL](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="74506-286">[![The Product Fields Not Provided in the DetailsView are Assigned NULL Values](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image54.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image53.png)</span></span>

<span data-ttu-id="74506-287">**Figura 19**: el producto campos no proporciona en DetailsView se asignan `NULL` valores ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="74506-287">**Figure 19**: The Product Fields Not Provided in the DetailsView are Assigned `NULL` Values ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image55.png))</span></span>


<span data-ttu-id="74506-288">Queremos podemos proporcionar un valor predeterminado distinto de `NULL` para uno o varios de estos valores de columna, ya sea porque `NULL` no es la mejor opción de manera predeterminada o porque no admite la columna de base de datos propia `NULL` s.</span><span class="sxs-lookup"><span data-stu-id="74506-288">We may want to provide a default value other than `NULL` for one or more of these column values, either because `NULL` isn't the best default option or because the database column itself doesn't allow `NULL` s.</span></span> <span data-ttu-id="74506-289">Para lograr esto podemos establecer mediante programación los valores de los parámetros de la DetailsView `InputParameters` colección.</span><span class="sxs-lookup"><span data-stu-id="74506-289">To accomplish this we can programmatically set the values of the parameters of the DetailsView's `InputParameters` collection.</span></span> <span data-ttu-id="74506-290">Esta asignación puede hacerse ya sea en el evento controlador para el DetailsView `ItemInserting` evento o el ObjectDataSource `Inserting` eventos.</span><span class="sxs-lookup"><span data-stu-id="74506-290">This assignment can be done either in the event handler for the DetailsView's `ItemInserting` event or the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="74506-291">Puesto que ya hemos observado en el uso de los eventos anteriores y posteriores al niveles en los datos Web controlar el nivel, vamos a explorar con eventos de ObjectDataSource en este momento.</span><span class="sxs-lookup"><span data-stu-id="74506-291">Since we've already looked at using the pre- and post-level events at the data Web control level, let's explore using the ObjectDataSource's events this time.</span></span>

## <a name="step-4-assigning-values-to-thecategoryidandsupplieridparameters"></a><span data-ttu-id="74506-292">Paso 4: Asignar valores a la`CategoryID`y`SupplierID`parámetros</span><span class="sxs-lookup"><span data-stu-id="74506-292">Step 4: Assigning Values to the`CategoryID`and`SupplierID`Parameters</span></span>

<span data-ttu-id="74506-293">Para este tutorial imaginemos que para nuestra aplicación, al agregar un nuevo producto a través de esta interfaz se debe asignar un `CategoryID` y `SupplierID` valor 1.</span><span class="sxs-lookup"><span data-stu-id="74506-293">For this tutorial let's imagine that for our application when adding a new product through this interface it should be assigned a `CategoryID` and `SupplierID` value of 1.</span></span> <span data-ttu-id="74506-294">Como se mencionó anteriormente, ObjectDataSource tiene un par de eventos previos y posteriores al niveles que desencadenen durante el proceso de modificación de datos.</span><span class="sxs-lookup"><span data-stu-id="74506-294">As mentioned earlier, the ObjectDataSource has a pair of pre- and post-level events that fire during the data modification process.</span></span> <span data-ttu-id="74506-295">Cuando su `Insert()` se invoca el método, ObjectDataSource genera en primer lugar su `Inserting` evento, a continuación, llama al método que su `Insert()` método se ha asignado a y, por último, se genera el `Inserted` eventos.</span><span class="sxs-lookup"><span data-stu-id="74506-295">When its `Insert()` method is invoked, the ObjectDataSource first raises its `Inserting` event, then calls the method that its `Insert()` method has been mapped to, and finally raises the `Inserted` event.</span></span> <span data-ttu-id="74506-296">El `Inserting` controlador de eventos, obtienen nos una última oportunidad para ajustar los parámetros de entrada o cancelar la operación directamente.</span><span class="sxs-lookup"><span data-stu-id="74506-296">The `Inserting` event handler affords us one last opportunity to tweak the input parameters or cancel the operation outright.</span></span>

> [!NOTE]
> <span data-ttu-id="74506-297">En una aplicación del mundo real puede que quieras para permitir que el usuario especifique la categoría y el proveedor o seleccionará este valor para ellos en función de algunos criterios o business lógica (en lugar de a ciegas seleccionando un Id. de 1).</span><span class="sxs-lookup"><span data-stu-id="74506-297">In a real-world application you would likely want to either let the user specify the category and supplier or would pick this value for them based on some criteria or business logic (rather than blindly selecting an ID of 1).</span></span> <span data-ttu-id="74506-298">En cualquier caso, el ejemplo muestra cómo establecer mediante programación el valor de un parámetro de entrada de eventos de nivel previamente de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="74506-298">Regardless, the example illustrates how to programmatically set the value of an input parameter from the ObjectDataSource's pre-level event.</span></span>


<span data-ttu-id="74506-299">Tómese un momento para crear un controlador de eventos para el ObjectDataSource `Inserting` eventos.</span><span class="sxs-lookup"><span data-stu-id="74506-299">Take a moment to create an event handler for the ObjectDataSource's `Inserting` event.</span></span> <span data-ttu-id="74506-300">Observe que el segundo parámetro de entrada del controlador de eventos es un objeto de tipo `ObjectDataSourceMethodEventArgs`, que tiene una propiedad para tener acceso a la colección de parámetros (`InputParameters`) y una propiedad que se va a cancelar la operación (`Cancel`).</span><span class="sxs-lookup"><span data-stu-id="74506-300">Notice that the event handler's second input parameter is an object of type `ObjectDataSourceMethodEventArgs`, which has a property to access the parameters collection (`InputParameters`) and a property to cancel the operation (`Cancel`).</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample10.cs)]

<span data-ttu-id="74506-301">En este momento, el `InputParameters` propiedad contiene el ObjectDataSource `InsertParameters` colección con los valores asignados de DetailsView.</span><span class="sxs-lookup"><span data-stu-id="74506-301">At this point, the `InputParameters` property contains the ObjectDataSource's `InsertParameters` collection with the values assigned from the DetailsView.</span></span> <span data-ttu-id="74506-302">Para cambiar el valor de uno de estos parámetros, basta con usar: `e.InputParameters["paramName"] = value`.</span><span class="sxs-lookup"><span data-stu-id="74506-302">To change the value of one of these parameters, simply use: `e.InputParameters["paramName"] = value`.</span></span> <span data-ttu-id="74506-303">Por lo tanto, para establecer el `CategoryID` y `SupplierID` a valores de 1, ajustar el `Inserting` controlador de eventos debe ser similar a lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="74506-303">Therefore, to set the `CategoryID` and `SupplierID` to values of 1, adjust the `Inserting` event handler to look like the following:</span></span>


[!code-csharp[Main](examining-the-events-associated-with-inserting-updating-and-deleting-cs/samples/sample11.cs)]

<span data-ttu-id="74506-304">Esta vez cuando se agrega un nuevo producto (por ejemplo, Acme Soda), el `CategoryID` y `SupplierID` columnas del nuevo producto se establecen en 1 (Véase la figura 20).</span><span class="sxs-lookup"><span data-stu-id="74506-304">This time when adding a new product (such as Acme Soda), the `CategoryID` and `SupplierID` columns of the new product are set to 1 (see Figure 20).</span></span>


<span data-ttu-id="74506-305">[![Nuevos productos ahora tienen sus CategoryID y SupplierID valores establecidos en 1](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="74506-305">[![New Products Now Have Their CategoryID and SupplierID Values Set to 1](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image57.png)](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image56.png)</span></span>

<span data-ttu-id="74506-306">**Figura 20**: Their de productos nueva ahora tienen `CategoryID` y `SupplierID` valores establecido en 1 ([haga clic aquí para ver la imagen a tamaño completo](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image58.png))</span><span class="sxs-lookup"><span data-stu-id="74506-306">**Figure 20**: New Products Now Have Their `CategoryID` and `SupplierID` Values Set to 1 ([Click to view full-size image](examining-the-events-associated-with-inserting-updating-and-deleting-cs/_static/image58.png))</span></span>


## <a name="summary"></a><span data-ttu-id="74506-307">Resumen</span><span class="sxs-lookup"><span data-stu-id="74506-307">Summary</span></span>

<span data-ttu-id="74506-308">Durante la edición, insertar y eliminar proceso, el control de datos Web y ObjectDataSource continuar a través de un número de eventos previos y posteriores al niveles.</span><span class="sxs-lookup"><span data-stu-id="74506-308">During the editing, inserting, and deleting process, both the data Web control and the ObjectDataSource proceed through a number of pre- and post-level events.</span></span> <span data-ttu-id="74506-309">En este tutorial se examinan los eventos de niveles previamente y hemos visto cómo usarlos para personalizar los parámetros de entrada o cancelar la operación de modificación de datos totalmente tanto para el control Web de datos y eventos de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="74506-309">In this tutorial we examined the pre-level events and saw how to use these to customize the input parameters or cancel the data modification operation altogether both from the data Web control and ObjectDataSource's events.</span></span> <span data-ttu-id="74506-310">En el siguiente tutorial se examinará crear y usar controladores de eventos para los eventos posteriores al niveles.</span><span class="sxs-lookup"><span data-stu-id="74506-310">In the next tutorial we'll look at creating and using event handlers for the post-level events.</span></span>

<span data-ttu-id="74506-311">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="74506-311">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="74506-312">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="74506-312">About the Author</span></span>

<span data-ttu-id="74506-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="74506-313">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="74506-314">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="74506-314">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="74506-315">Su último libro es [ *SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="74506-315">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="74506-316">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="74506-316">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="74506-317">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="74506-317">Special Thanks To</span></span>

<span data-ttu-id="74506-318">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="74506-318">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="74506-319">Los revisores iniciales para este tutorial fueron Jackie Goor y Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="74506-319">Lead reviewers for this tutorial were Jackie Goor and Liz Shulok.</span></span> <span data-ttu-id="74506-320">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="74506-320">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="74506-321">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="74506-321">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="74506-322">[Anterior](an-overview-of-inserting-updating-and-deleting-data-cs.md)
[Siguiente](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)</span><span class="sxs-lookup"><span data-stu-id="74506-322">[Previous](an-overview-of-inserting-updating-and-deleting-data-cs.md)
[Next](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)</span></span>
