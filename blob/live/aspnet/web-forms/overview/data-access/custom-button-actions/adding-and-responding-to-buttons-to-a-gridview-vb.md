---
uid: web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
title: Agregar y responder a los botones a un control GridView (VB) | Documentos de Microsoft
author: rick-anderson
description: "En este tutorial se examinará cómo agregar botones personalizados, a una plantilla y a los campos de un control GridView o DetailsView. En concreto, te enviaremos un mensaje GE..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/13/2006
ms.topic: article
ms.assetid: 06c6bbd2-4bdc-435b-87a3-df2c868f4baa
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb
msc.type: authoredcontent
ms.openlocfilehash: ba66c867df93a9e1a0bb7897052ace7300b672af
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="adding-and-responding-to-buttons-to-a-gridview-vb"></a><span data-ttu-id="218f1-104">Agregar y responder a los botones a un control GridView (VB)</span><span class="sxs-lookup"><span data-stu-id="218f1-104">Adding and Responding to Buttons to a GridView (VB)</span></span>
====================
<span data-ttu-id="218f1-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="218f1-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="218f1-106">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) o [descarga de PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="218f1-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_28_VB.exe) or [Download PDF](adding-and-responding-to-buttons-to-a-gridview-vb/_static/datatutorial28vb1.pdf)</span></span>

> <span data-ttu-id="218f1-107">En este tutorial se examinará cómo agregar botones personalizados, a una plantilla y a los campos de un control GridView o DetailsView.</span><span class="sxs-lookup"><span data-stu-id="218f1-107">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="218f1-108">En concreto, vamos a crear una interfaz que tiene un FormView que permite al usuario desplazarse a través de los proveedores.</span><span class="sxs-lookup"><span data-stu-id="218f1-108">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span>


## <a name="introduction"></a><span data-ttu-id="218f1-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="218f1-109">Introduction</span></span>

<span data-ttu-id="218f1-110">Mientras muchos escenarios de informes implican el acceso de solo lectura a los datos del informe, s no infrecuente que los informes incluyan la capacidad para realizar acciones según los datos mostrados.</span><span class="sxs-lookup"><span data-stu-id="218f1-110">While many reporting scenarios involve read-only access to the report data, it s not uncommon for reports to include the ability to perform actions based upon the data displayed.</span></span> <span data-ttu-id="218f1-111">Normalmente esto implica la adición de un control Button, LinkButton o ImageButton Web con cada registro que se muestra en el informe que, al hacer clic, provoca una devolución de datos y algún código de servidor, se invoca.</span><span class="sxs-lookup"><span data-stu-id="218f1-111">Typically this involved adding a Button, LinkButton, or ImageButton Web control with each record displayed in the report that, when clicked, causes a postback and invokes some server-side code.</span></span> <span data-ttu-id="218f1-112">Editar y eliminar los datos en una base de registro por registro son el ejemplo más común.</span><span class="sxs-lookup"><span data-stu-id="218f1-112">Editing and deleting the data on a record-by-record basis is the most common example.</span></span> <span data-ttu-id="218f1-113">De hecho, como hemos visto a partir de la [información general de insertar, actualizar y eliminar datos](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) es muy común que los controles GridView, DetailsView y FormView pueden admitir esta funcionalidad sin tutorial, edición y eliminación de la necesario para escribir una sola línea de código.</span><span class="sxs-lookup"><span data-stu-id="218f1-113">In fact, as we saw starting with the [Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, editing and deleting is so common that the GridView, DetailsView, and FormView controls can support such functionality without the need for writing a single line of code.</span></span>

<span data-ttu-id="218f1-114">Además para modificar y eliminar botones, el control GridView, DetailsView y FormView controles pueden incluir también botones, LinkButton o ImageButtons que, al hacer clic, realizar alguna lógica personalizada de servidor.</span><span class="sxs-lookup"><span data-stu-id="218f1-114">In addition to Edit and Delete buttons, the GridView, DetailsView, and FormView controls can also include Buttons, LinkButtons, or ImageButtons that, when clicked, perform some custom server-side logic.</span></span> <span data-ttu-id="218f1-115">En este tutorial se examinará cómo agregar botones personalizados, a una plantilla y a los campos de un control GridView o DetailsView.</span><span class="sxs-lookup"><span data-stu-id="218f1-115">In this tutorial we'll look at how to add custom buttons, both to a template and to the fields of a GridView or DetailsView control.</span></span> <span data-ttu-id="218f1-116">En concreto, vamos a crear una interfaz que tiene un FormView que permite al usuario desplazarse a través de los proveedores.</span><span class="sxs-lookup"><span data-stu-id="218f1-116">In particular, we'll build an interface that has a FormView that allows the user to page through the suppliers.</span></span> <span data-ttu-id="218f1-117">Para un proveedor determinado, FormView mostrará información acerca del proveedor junto con un control de botón Web que, si hace clic en, marcará todos sus productos asociados como discontinuo.</span><span class="sxs-lookup"><span data-stu-id="218f1-117">For a given supplier, the FormView will show information about the supplier along with a Button Web control that, if clicked, will mark all of their associated products as discontinued.</span></span> <span data-ttu-id="218f1-118">Además, un control GridView muestra los productos proporcionados por el proveedor seleccionado, con cada fila que contenga aumentar precio y botones de precio de descuento que, si hace clic en, aumentar o reducir el producto s `UnitPrice` en un 10% (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="218f1-118">Additionally, a GridView lists those products provided by the selected supplier, with each row containing Increase Price and Discount Price Buttons that, if clicked, raise or reduce the product s `UnitPrice` by 10% (see Figure 1).</span></span>


<span data-ttu-id="218f1-119">[![FormView y GridView contienen botones que realizan acciones personalizadas](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-119">[![Both the FormView and GridView Contain Buttons That Perform Custom Actions](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image2.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image1.png)</span></span>

<span data-ttu-id="218f1-120">**Figura 1**: ambos FormView y GridView contienen botones que realizan acciones personalizadas ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-120">**Figure 1**: Both the FormView and GridView Contain Buttons That Perform Custom Actions ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image3.png))</span></span>


## <a name="step-1-adding-the-button-tutorial-web-pages"></a><span data-ttu-id="218f1-121">Paso 1: Agregar las páginas Web Tutorial de botón</span><span class="sxs-lookup"><span data-stu-id="218f1-121">Step 1: Adding the Button Tutorial Web Pages</span></span>

<span data-ttu-id="218f1-122">Antes de adentrarnos en cómo agregar un botones personalizados, permiten s primero Tómese un momento para crear las páginas ASP.NET en el proyecto de sitio Web que se necesitará para este tutorial.</span><span class="sxs-lookup"><span data-stu-id="218f1-122">Before we look at how to add a custom buttons, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial.</span></span> <span data-ttu-id="218f1-123">Empiece por agregar una nueva carpeta denominada `CustomButtons`.</span><span class="sxs-lookup"><span data-stu-id="218f1-123">Start by adding a new folder named `CustomButtons`.</span></span> <span data-ttu-id="218f1-124">A continuación, agregue las siguientes dos páginas ASP.NET a la carpeta y asegúrese de que asociar cada página con el `Site.master` página maestra:</span><span class="sxs-lookup"><span data-stu-id="218f1-124">Next, add the following two ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `CustomButtons.aspx`


![Agregar las páginas ASP.NET para los tutoriales relacionados con botones personalizados](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image4.png)

<span data-ttu-id="218f1-126">**Figura 2**: agregar las páginas ASP.NET para los tutoriales relacionados con botones personalizados</span><span class="sxs-lookup"><span data-stu-id="218f1-126">**Figure 2**: Add the ASP.NET Pages for the Custom Buttons-Related Tutorials</span></span>


<span data-ttu-id="218f1-127">Al igual que en las otras carpetas, `Default.aspx` en el `CustomButtons` carpeta enumerará los tutoriales en su sección.</span><span class="sxs-lookup"><span data-stu-id="218f1-127">Like in the other folders, `Default.aspx` in the `CustomButtons` folder will list the tutorials in its section.</span></span> <span data-ttu-id="218f1-128">Recuerde que el `SectionLevelTutorialListing.ascx` Control de usuario proporciona esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="218f1-128">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="218f1-129">Por lo tanto, agregue este Control de usuario para `Default.aspx` arrastrándolo desde el Explorador de soluciones en la página s la vista Diseño.</span><span class="sxs-lookup"><span data-stu-id="218f1-129">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="218f1-130">[![Agregar el Control de usuario SectionLevelTutorialListing.ascx a Default.aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-130">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image6.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image5.png)</span></span>

<span data-ttu-id="218f1-131">**Figura 3**: agregar la `SectionLevelTutorialListing.ascx` Control de usuario a `Default.aspx` ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-131">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image7.png))</span></span>


<span data-ttu-id="218f1-132">Por último, agregue las páginas como entradas para el `Web.sitemap` archivo.</span><span class="sxs-lookup"><span data-stu-id="218f1-132">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="218f1-133">En concreto, agregue el siguiente marcado después de la paginación y la ordenación `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="218f1-133">Specifically, add the following markup after the Paging and Sorting `<siteMapNode>`:</span></span>


[!code-xml[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample1.xml)]

<span data-ttu-id="218f1-134">Después de actualizar `Web.sitemap`, tómese un momento para ver el sitio Web de tutoriales a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="218f1-134">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="218f1-135">El menú de la izquierda ahora incluye elementos para modificar, insertar y eliminar los tutoriales.</span><span class="sxs-lookup"><span data-stu-id="218f1-135">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![El mapa del sitio incluye ahora la entrada para el Tutorial de botones personalizados](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image8.png)

<span data-ttu-id="218f1-137">**Figura 4**: la asignación de sitio incluye ahora la entrada para el Tutorial de botones personalizados</span><span class="sxs-lookup"><span data-stu-id="218f1-137">**Figure 4**: The Site Map Now Includes the Entry for the Custom Buttons Tutorial</span></span>


## <a name="step-2-adding-a-formview-that-lists-the-suppliers"></a><span data-ttu-id="218f1-138">Paso 2: Agregar un FormView que enumera los proveedores</span><span class="sxs-lookup"><span data-stu-id="218f1-138">Step 2: Adding a FormView that Lists the Suppliers</span></span>

<span data-ttu-id="218f1-139">Permiten s empezar a trabajar con este tutorial agregando FormView que enumera los proveedores.</span><span class="sxs-lookup"><span data-stu-id="218f1-139">Let s get started with this tutorial by adding the FormView that lists the suppliers.</span></span> <span data-ttu-id="218f1-140">Según lo descrito en la introducción, esta FormView permitirá al usuario para paginar a través de los proveedores, que muestra los productos suministrados por el proveedor en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="218f1-140">As discussed in the Introduction, this FormView will allow the user to page through the suppliers, showing the products provided by the supplier in a GridView.</span></span> <span data-ttu-id="218f1-141">Además, este FormView incluirá un botón que, al hacer clic, marcará todos los productos de proveedor s dentro de esta categoría.</span><span class="sxs-lookup"><span data-stu-id="218f1-141">Additionally, this FormView will include a Button that, when clicked, will mark all of the supplier s products as discontinued.</span></span> <span data-ttu-id="218f1-142">Antes de que se hacen referencia a nosotros mismos con la adición del botón personalizado a FormView, permiten s primero basta con crear FormView para que se muestre la información del proveedor.</span><span class="sxs-lookup"><span data-stu-id="218f1-142">Before we concern ourselves with adding the custom button to the FormView, let s first just create the FormView so that it displays the supplier information.</span></span>

<span data-ttu-id="218f1-143">Comience abriendo la `CustomButtons.aspx` página en el `CustomButtons` carpeta.</span><span class="sxs-lookup"><span data-stu-id="218f1-143">Start by opening the `CustomButtons.aspx` page in the `CustomButtons` folder.</span></span> <span data-ttu-id="218f1-144">Agregar un FormView a la página arrastrándolo desde el cuadro de herramientas en el diseñador y el conjunto de sus `ID` propiedad `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="218f1-144">Add a FormView to the page by dragging it from the Toolbox onto the Designer and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="218f1-145">Desde la etiqueta inteligente de FormView s, optar por crear un nuevo origen ObjectDataSource denominado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="218f1-145">From the FormView s smart tag, opt to create a new ObjectDataSource named `SuppliersDataSource`.</span></span>


<span data-ttu-id="218f1-146">[![Crear un nuevo origen ObjectDataSource denominado SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-146">[![Create a New ObjectDataSource Named SuppliersDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image10.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image9.png)</span></span>

<span data-ttu-id="218f1-147">**Figura 5**: crear un nuevo ObjectDataSource denominado `SuppliersDataSource` ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-147">**Figure 5**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image11.png))</span></span>


<span data-ttu-id="218f1-148">Configure este nuevo ObjectDataSource de tal modo que realiza una consulta desde el `SuppliersBLL` clase s. `GetSuppliers()` (método) (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="218f1-148">Configure this new ObjectDataSource such that it queries from the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 6).</span></span> <span data-ttu-id="218f1-149">Puesto que este FormView no proporciona una interfaz para actualizar la información del proveedor, seleccione opción el (ninguno) en la lista desplegable en la pestaña de la actualización.</span><span class="sxs-lookup"><span data-stu-id="218f1-149">Since this FormView does not provide an interface for updating the supplier information, select the (None) option from the drop-down list in the UPDATE tab.</span></span>


<span data-ttu-id="218f1-150">[![Configurar el origen de datos para utilizar la clase SuppliersBLL s GetSuppliers() (método)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-150">[![Configure the Data Source to use the SuppliersBLL Class s GetSuppliers() Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image13.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image12.png)</span></span>

<span data-ttu-id="218f1-151">**Figura 6**: configurar el origen de datos para utilizar el `SuppliersBLL` clase s `GetSuppliers()` método ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-151">**Figure 6**: Configure the Data Source to use the `SuppliersBLL` Class s `GetSuppliers()` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image14.png))</span></span>


<span data-ttu-id="218f1-152">Después de configurar el ObjectDataSource, Visual Studio generará una `InsertItemTemplate`, `EditItemTemplate`, y `ItemTemplate` de FormView.</span><span class="sxs-lookup"><span data-stu-id="218f1-152">After configuring the ObjectDataSource, Visual Studio will generate an `InsertItemTemplate`, `EditItemTemplate`, and `ItemTemplate` for the FormView.</span></span> <span data-ttu-id="218f1-153">Quitar el `InsertItemTemplate` y `EditItemTemplate` y modificar el `ItemTemplate` para que muestre solo el proveedor s empresa nombre y número de teléfono.</span><span class="sxs-lookup"><span data-stu-id="218f1-153">Remove the `InsertItemTemplate` and `EditItemTemplate` and modify the `ItemTemplate` so that it displays just the supplier s company name and phone number.</span></span> <span data-ttu-id="218f1-154">Por último, activar compatibilidad con la paginación para FormView activando la casilla de verificación Habilitar paginación de su etiqueta inteligente (o estableciendo su `AllowPaging` propiedad `True`).</span><span class="sxs-lookup"><span data-stu-id="218f1-154">Finally, turn on paging support for the FormView by checking the Enable Paging checkbox from its smart tag (or by setting its `AllowPaging` property to `True`).</span></span> <span data-ttu-id="218f1-155">Después de estos cambios el marcado declarativo de s de página debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="218f1-155">After these changes your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample2.aspx)]

<span data-ttu-id="218f1-156">La figura 7 muestra la página CustomButtons.aspx cuando se ven a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="218f1-156">Figure 7 shows the CustomButtons.aspx page when viewed through a browser.</span></span>


<span data-ttu-id="218f1-157">[![FormView enumera los campos de teléfono del proveedor seleccionado actualmente y CompanyName](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-157">[![The FormView Lists the CompanyName and Phone Fields from the Currently Selected Supplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image16.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image15.png)</span></span>

<span data-ttu-id="218f1-158">**Figura 7**: las listas de FormView el `CompanyName` y `Phone` campos desde el proveedor seleccionado actualmente ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-158">**Figure 7**: The FormView Lists the `CompanyName` and `Phone` Fields from the Currently Selected Supplier ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image17.png))</span></span>


## <a name="step-3-adding-a-gridview-that-lists-the-selected-supplier-s-products"></a><span data-ttu-id="218f1-159">Paso 3: Agregar un control GridView que muestra los productos de s del proveedor seleccionado</span><span class="sxs-lookup"><span data-stu-id="218f1-159">Step 3: Adding a GridView that Lists the Selected Supplier s Products</span></span>

<span data-ttu-id="218f1-160">Antes de agregar el botón de productos todo suspender a la plantilla de s FormView, dejamos s Agregar un control GridView debajo FormView que contiene los productos suministrados por el proveedor seleccionado.</span><span class="sxs-lookup"><span data-stu-id="218f1-160">Before we add the Discontinue All Products Button to the FormView s template, let s first add a GridView beneath the FormView that lists the products provided by the selected supplier.</span></span> <span data-ttu-id="218f1-161">Para lograr esto, agregue un control GridView a la página, establezca su `ID` propiedad `SuppliersProducts`, y agregar un nuevo origen ObjectDataSource denominado `SuppliersProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="218f1-161">To accomplish this, add a GridView to the page, set its `ID` property to `SuppliersProducts`, and add a new ObjectDataSource named `SuppliersProductsDataSource`.</span></span>


<span data-ttu-id="218f1-162">[![Crear un nuevo origen ObjectDataSource denominado SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-162">[![Create a New ObjectDataSource Named SuppliersProductsDataSource](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image19.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image18.png)</span></span>

<span data-ttu-id="218f1-163">**Figura 8**: crear un nuevo ObjectDataSource denominado `SuppliersProductsDataSource` ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-163">**Figure 8**: Create a New ObjectDataSource Named `SuppliersProductsDataSource` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image20.png))</span></span>


<span data-ttu-id="218f1-164">Configurar este ObjectDataSource para utilizar la clase ProductsBLL s `GetProductsBySupplierID(supplierID)` (método) (consulte la figura 9).</span><span class="sxs-lookup"><span data-stu-id="218f1-164">Configure this ObjectDataSource to use the ProductsBLL class s `GetProductsBySupplierID(supplierID)` method (see Figure 9).</span></span> <span data-ttu-id="218f1-165">Mientras esta GridView permitirá a un precio del producto s se ajusten, ganó t usar integrado en la edición o eliminación de características de GridView.</span><span class="sxs-lookup"><span data-stu-id="218f1-165">While this GridView will allow for a product s price to be adjusted, it won t be using the built-in editing or deleting features from the GridView.</span></span> <span data-ttu-id="218f1-166">Por lo tanto, podemos establecer la lista desplegable en (ninguno) para las operaciones de asignación ObjectDataSource pestañas UPDATE, INSERT y DELETE.</span><span class="sxs-lookup"><span data-stu-id="218f1-166">Therefore, we can set the drop-down list to (None) for the ObjectDataSource s UPDATE, INSERT, and DELETE tabs.</span></span>


<span data-ttu-id="218f1-167">[![Configurar el origen de datos para utilizar la clase ProductsBLL s GetProductsBySupplierID(supplierID) (método)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-167">[![Configure the Data Source to use the ProductsBLL Class s GetProductsBySupplierID(supplierID) Method](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image22.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image21.png)</span></span>

<span data-ttu-id="218f1-168">**Figura 9**: configurar el origen de datos para utilizar el `ProductsBLL` clase s `GetProductsBySupplierID(supplierID)` método ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-168">**Figure 9**: Configure the Data Source to use the `ProductsBLL` Class s `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image23.png))</span></span>


<span data-ttu-id="218f1-169">Puesto que la `GetProductsBySupplierID(supplierID)` método acepta un parámetro de entrada, el Asistente ObjectDataSource nos solicita el origen de este valor de parámetro.</span><span class="sxs-lookup"><span data-stu-id="218f1-169">Since the `GetProductsBySupplierID(supplierID)` method accepts an input parameter, the ObjectDataSource wizard prompts us for the source of this parameter value.</span></span> <span data-ttu-id="218f1-170">Para pasar el `SupplierID` valor de FormView, establezca la lista desplegable de origen de parámetro en el Control y la lista desplegable de ControlID para `Suppliers` (el Id. de FormView creado en el paso 2).</span><span class="sxs-lookup"><span data-stu-id="218f1-170">To pass in the `SupplierID` value from the FormView, set the Parameter source drop-down list to Control and the ControlID drop-down list to `Suppliers` (the ID of the FormView created in Step 2).</span></span>


<span data-ttu-id="218f1-171">[![Indicar que la columna supplierID parámetro debe provenir del control FormView de proveedores](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-171">[![Indicate that the supplierID Parameter Should Come from the Suppliers FormView Control](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image25.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image24.png)</span></span>

<span data-ttu-id="218f1-172">**Figura 10**: indicar que el  *`supplierID`*  parámetro debe provenir de la `Suppliers` FormView Control ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-172">**Figure 10**: Indicate that the *`supplierID`* Parameter Should Come from the `Suppliers` FormView Control ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image26.png))</span></span>


<span data-ttu-id="218f1-173">Después de completar al Asistente de ObjectDataSource GridView contendrá un BoundField o CampoCasillaVerificación para cada uno de los campos de datos de producto s.</span><span class="sxs-lookup"><span data-stu-id="218f1-173">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product s data fields.</span></span> <span data-ttu-id="218f1-174">Permiten s recortar esto para mostrar simplemente el `ProductName` y `UnitPrice` BoundFields junto con el `Discontinued` CampoCasillaVerificación; Además, permiten el formato s el `UnitPrice` BoundField tal que el texto tiene el formato como una moneda.</span><span class="sxs-lookup"><span data-stu-id="218f1-174">Let s trim this down to show just the `ProductName` and `UnitPrice` BoundFields along with the `Discontinued` CheckBoxField; furthermore, let s format the `UnitPrice` BoundField such that its text is formatted as a currency.</span></span> <span data-ttu-id="218f1-175">El control GridView y `SuppliersProductsDataSource` marcado declarativo de ObjectDataSource s debería ser similar al código siguiente:</span><span class="sxs-lookup"><span data-stu-id="218f1-175">Your GridView and `SuppliersProductsDataSource` ObjectDataSource s declarative markup should look similar to the following markup:</span></span>


[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample3.aspx)]

<span data-ttu-id="218f1-176">En este momento nuestro tutorial muestra un informe maestro/detalles, lo que permite al usuario seleccionar un proveedor de FormView en la parte superior y ver los productos suministrados por ese proveedor a través de GridView en la parte inferior.</span><span class="sxs-lookup"><span data-stu-id="218f1-176">At this point our tutorial displays a master/details report, allowing the user to pick a supplier from the FormView at the top and to view the products provided by that supplier through the GridView at the bottom.</span></span> <span data-ttu-id="218f1-177">La figura 11 muestra una captura de pantalla de esta página al seleccionar el proveedor Comercial Tasmania de FormView.</span><span class="sxs-lookup"><span data-stu-id="218f1-177">Figure 11 shows a screen shot of this page when selecting the Tokyo Traders supplier from the FormView.</span></span>


<span data-ttu-id="218f1-178">[![Los productos de s del proveedor seleccionado se muestran en el control GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-178">[![The Selected Supplier s Products are Displayed in the GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image28.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image27.png)</span></span>

<span data-ttu-id="218f1-179">**Figura 11**: el proveedor seleccionado s productos se muestran en el control GridView ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-179">**Figure 11**: The Selected Supplier s Products are Displayed in the GridView ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image29.png))</span></span>


## <a name="step-4-creating-dal-and-bll-methods-to-discontinue-all-products-for-a-supplier"></a><span data-ttu-id="218f1-180">Paso 4: Crear DAL y BLL métodos para suspender todos los productos para un proveedor</span><span class="sxs-lookup"><span data-stu-id="218f1-180">Step 4: Creating DAL and BLL Methods to Discontinue All Products for a Supplier</span></span>

<span data-ttu-id="218f1-181">Antes de que podemos agregar un botón a FormView que, al hacer clic, se interrumpe todos los productos de proveedor s, primero tenemos que agregar un método a la capa DAL y BLL que lleva a cabo esta acción.</span><span class="sxs-lookup"><span data-stu-id="218f1-181">Before we can add a Button to the FormView that, when clicked, discontinues all of the supplier s products, we first need to add a method to both the DAL and BLL that performs this action.</span></span> <span data-ttu-id="218f1-182">En concreto, este método se denominará `DiscontinueAllProductsForSupplier(supplierID)`.</span><span class="sxs-lookup"><span data-stu-id="218f1-182">In particular, this method will be named `DiscontinueAllProductsForSupplier(supplierID)`.</span></span> <span data-ttu-id="218f1-183">Cuando se hace clic en el botón de FormView s, se podrá invocar este método en la capa de lógica empresarial, pasar en el proveedor seleccionado s `SupplierID`; BLL, a continuación, llamará al método correspondiente capa de acceso a datos, que se van a emitir un `UPDATE` instrucción la base de datos que los productos de proveedor especificado s se interrumpe.</span><span class="sxs-lookup"><span data-stu-id="218f1-183">When the FormView s Button is clicked, we'll invoke this method in the Business Logic Layer, passing in the selected supplier s `SupplierID`; the BLL will then call down to the corresponding Data Access Layer method, which will issue an `UPDATE` statement to the database that discontinues the specified supplier s products.</span></span>

<span data-ttu-id="218f1-184">Como hemos trabajado en nuestros tutoriales anteriores, vamos a usar un enfoque de abajo arriba, a partir de crear el método DAL, a continuación, el método BLL y por último, implementar la funcionalidad en la página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="218f1-184">As we have done in our previous tutorials, we'll use a bottom-up approach, starting with creating the DAL method, then the BLL method, and finally implementing the functionality in the ASP.NET page.</span></span> <span data-ttu-id="218f1-185">Abra la `Northwind.xsd` DataSet con tipo en el `App_Code/DAL` carpeta y agregue un nuevo método para el `ProductsTableAdapter` (haga doble clic en el `ProductsTableAdapter` y elija Agregar consulta).</span><span class="sxs-lookup"><span data-stu-id="218f1-185">Open the `Northwind.xsd` Typed DataSet in the `App_Code/DAL` folder and add a new method to the `ProductsTableAdapter` (right-click on the `ProductsTableAdapter` and choose Add Query).</span></span> <span data-ttu-id="218f1-186">Si lo hace, se abrirá el Asistente para configuración de consultas de TableAdapter, que nos recorre el proceso de agregar el nuevo método.</span><span class="sxs-lookup"><span data-stu-id="218f1-186">Doing so will bring up the TableAdapter Query Configuration wizard, which walks us through the process of adding the new method.</span></span> <span data-ttu-id="218f1-187">Empiece por que indica que el método de la capa DAL utilizará una instrucción de SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="218f1-187">Start by indicating that our DAL method will use an ad-hoc SQL statement.</span></span>


<span data-ttu-id="218f1-188">[![Cree el método DAL con una instrucción de SQL Ad Hoc](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-188">[![Create the DAL Method Using an Ad-Hoc SQL Statement](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image31.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image30.png)</span></span>

<span data-ttu-id="218f1-189">**Figura 12**: crear el método de la capa DAL mediante una instrucción de SQL Ad Hoc ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-189">**Figure 12**: Create the DAL Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image32.png))</span></span>


<span data-ttu-id="218f1-190">A continuación, el asistente le preguntará nos en cuanto a qué tipo de consulta para crear.</span><span class="sxs-lookup"><span data-stu-id="218f1-190">Next, the wizard prompts us as to what type of query to create.</span></span> <span data-ttu-id="218f1-191">Puesto que la `DiscontinueAllProductsForSupplier(supplierID)` método será necesario actualizar la `Products` tabla de base de datos, establecer el `Discontinued` campo en 1 para todos los productos suministrados por especificado  *`supplierID`* , necesitamos crear una consulta que actualiza los datos.</span><span class="sxs-lookup"><span data-stu-id="218f1-191">Since the `DiscontinueAllProductsForSupplier(supplierID)` method will need to update the `Products` database table, setting the `Discontinued` field to 1 for all products provided by the specified *`supplierID`*, we need to create a query that updates data.</span></span>


<span data-ttu-id="218f1-192">[![Elija el tipo de consulta de actualización](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-192">[![Choose the UPDATE Query Type](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image34.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image33.png)</span></span>

<span data-ttu-id="218f1-193">**Figura 13**: elija el tipo de consulta de actualización ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-193">**Figure 13**: Choose the UPDATE Query Type ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image35.png))</span></span>


<span data-ttu-id="218f1-194">La siguiente pantalla del asistente proporciona s TableAdapter existente `UPDATE` instrucción, que actualiza cada uno de los campos definidos en el `Products` DataTable.</span><span class="sxs-lookup"><span data-stu-id="218f1-194">The next wizard screen provides the TableAdapter s existing `UPDATE` statement, which updates each of the fields defined in the `Products` DataTable.</span></span> <span data-ttu-id="218f1-195">Reemplace el texto de consulta con la siguiente instrucción:</span><span class="sxs-lookup"><span data-stu-id="218f1-195">Replace this query text with the following statement:</span></span>


[!code-sql[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample4.sql)]

<span data-ttu-id="218f1-196">Después de escribir esta consulta y haga clic en siguiente, la última pantalla del asistente pide el nombre del nuevo método s usar `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="218f1-196">After entering this query and clicking Next, the last wizard screen asks for the new method s name use `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="218f1-197">Complete el asistente, haga clic en el botón Finalizar.</span><span class="sxs-lookup"><span data-stu-id="218f1-197">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="218f1-198">Al volver al diseñador de DataSet verá un nuevo método en el `ProductsTableAdapter` denominado `DiscontinueAllProductsForSupplier(@SupplierID)`.</span><span class="sxs-lookup"><span data-stu-id="218f1-198">Upon returning to the DataSet Designer you should see a new method in the `ProductsTableAdapter` named `DiscontinueAllProductsForSupplier(@SupplierID)`.</span></span>


<span data-ttu-id="218f1-199">[![Nombre de la nueva DiscontinueAllProductsForSupplier DAL (método)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-199">[![Name the New DAL Method DiscontinueAllProductsForSupplier](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image37.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image36.png)</span></span>

<span data-ttu-id="218f1-200">**Figura 14**: nombre del nuevo método de DAL `DiscontinueAllProductsForSupplier` ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-200">**Figure 14**: Name the New DAL Method `DiscontinueAllProductsForSupplier` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image38.png))</span></span>


<span data-ttu-id="218f1-201">Con el `DiscontinueAllProductsForSupplier(supplierID)` método creado en la capa de acceso a datos, la siguiente tarea consiste en crear el `DiscontinueAllProductsForSupplier(supplierID)` método en la capa de lógica de negocios.</span><span class="sxs-lookup"><span data-stu-id="218f1-201">With the `DiscontinueAllProductsForSupplier(supplierID)` method created in the Data Access Layer, our next task is to create the `DiscontinueAllProductsForSupplier(supplierID)` method in the Business Logic Layer.</span></span> <span data-ttu-id="218f1-202">Para ello, abra el `ProductsBLL` archivo de clase y agregue lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="218f1-202">To accomplish this, open the `ProductsBLL` class file and add the following:</span></span>


[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample5.vb)]

<span data-ttu-id="218f1-203">Este método se llama simplemente hacia abajo hasta la `DiscontinueAllProductsForSupplier(supplierID)` método en la capa DAL, pasando a través de proporcionado  *`supplierID`*  el valor del parámetro.</span><span class="sxs-lookup"><span data-stu-id="218f1-203">This method simply calls down to the `DiscontinueAllProductsForSupplier(supplierID)` method in the DAL, passing along the provided *`supplierID`* parameter value.</span></span> <span data-ttu-id="218f1-204">Si se produjeron las reglas de negocio que solo permiten a un proveedor de productos de s se interrumpa en determinadas circunstancias, deben implementar esas reglas en este caso, en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="218f1-204">If there were any business rules that only allowed a supplier s products to be discontinued under certain circumstances, those rules should be implemented here, in the BLL.</span></span>

> [!NOTE]
> <span data-ttu-id="218f1-205">A diferencia de la `UpdateProduct` sobrecargas en el `ProductsBLL` (clase), el `DiscontinueAllProductsForSupplier(supplierID)` firma del método no incluye el `DataObjectMethodAttribute` atributo (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span><span class="sxs-lookup"><span data-stu-id="218f1-205">Unlike the `UpdateProduct` overloads in the `ProductsBLL` class, the `DiscontinueAllProductsForSupplier(supplierID)` method signature does not include the `DataObjectMethodAttribute` attribute (`<System.ComponentModel.DataObjectMethodAttribute(System.ComponentModel.DataObjectMethodType.Update, Boolean)>`).</span></span> <span data-ttu-id="218f1-206">Esto impide la `DiscontinueAllProductsForSupplier(supplierID)` método en la lista de desplegable ObjectDataSource s s del Asistente para configurar origen de datos en la pestaña de la actualización. Se ha omitido este atributo porque se llamará a la `DiscontinueAllProductsForSupplier(supplierID)` (método) directamente desde un controlador de eventos en nuestra página de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="218f1-206">This precludes the `DiscontinueAllProductsForSupplier(supplierID)` method from the ObjectDataSource s Configure Data Source wizard s drop-down list in the UPDATE tab. I ve omitted this attribute because we'll be calling the `DiscontinueAllProductsForSupplier(supplierID)` method directly from an event handler in our ASP.NET page.</span></span>


## <a name="step-5-adding-a-discontinue-all-products-button-to-the-formview"></a><span data-ttu-id="218f1-207">Paso 5: Agregar un botón de todos los productos para FormView de prestar</span><span class="sxs-lookup"><span data-stu-id="218f1-207">Step 5: Adding a Discontinue All Products Button to the FormView</span></span>

<span data-ttu-id="218f1-208">Con el `DiscontinueAllProductsForSupplier(supplierID)` método BLL y DAL que se ejecuta, el último paso para agregar la capacidad de suspender todos los productos para el proveedor seleccionado es agregar un control de botón Web a las operaciones de asignación FormView `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="218f1-208">With the `DiscontinueAllProductsForSupplier(supplierID)` method in the BLL and DAL complete, the final step for adding the ability to discontinue all products for the selected supplier is to add a Button Web control to the FormView s `ItemTemplate`.</span></span> <span data-ttu-id="218f1-209">S permiten agregar un botón de este tipo por debajo del número de teléfono de proveedor s con el texto del botón, interrumpir todos los productos y una `ID` el valor de propiedad `DiscontinueAllProductsForSupplier`.</span><span class="sxs-lookup"><span data-stu-id="218f1-209">Let s add such a Button below the supplier s phone number with the button text, Discontinue All Products and an `ID` property value of `DiscontinueAllProductsForSupplier`.</span></span> <span data-ttu-id="218f1-210">Puede agregar este control de botón Web a través del diseñador haciendo clic en el vínculo Editar plantillas en la etiqueta inteligente de FormView s (consulte la figura 15), o directamente a través de la sintaxis declarativa.</span><span class="sxs-lookup"><span data-stu-id="218f1-210">You can add this Button Web control through the Designer by clicking on the Edit Templates link in the FormView s smart tag (see Figure 15), or directly through the declarative syntax.</span></span>


<span data-ttu-id="218f1-211">[![Agregar un interrumpir todos los productos botón Web Control FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-211">[![Add a Discontinue All Products Button Web Control to the FormView s ItemTemplate](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image40.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image39.png)</span></span>

<span data-ttu-id="218f1-212">**Figura 15**: agregar un interrumpir todos los productos Web Control de botón a las operaciones de asignación FormView `ItemTemplate` ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-212">**Figure 15**: Add a Discontinue All Products Button Web Control to the FormView s `ItemTemplate` ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image41.png))</span></span>


<span data-ttu-id="218f1-213">Cuando se hace clic en el botón una visita de usuario que tiene lugar la página, una devolución de datos y las operaciones de asignación FormView [ `ItemCommand` evento](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.itemcommand.aspx) se activa.</span><span class="sxs-lookup"><span data-stu-id="218f1-213">When the Button is clicked by a user visiting the page, a postback ensues and the FormView s [`ItemCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.itemcommand.aspx) fires.</span></span> <span data-ttu-id="218f1-214">Para ejecutar código personalizado en respuesta a este botón se hizo clic, podemos crear un controlador de eventos para este evento.</span><span class="sxs-lookup"><span data-stu-id="218f1-214">To execute custom code in response to this Button being clicked, we can create an event handler for this event.</span></span> <span data-ttu-id="218f1-215">Comprender, sin embargo, que la `ItemCommand` cada vez que se activa el evento *cualquier* control Button, LinkButton o ImageButton Web se hace clic en FormView.</span><span class="sxs-lookup"><span data-stu-id="218f1-215">Understand, though, that the `ItemCommand` event fires whenever *any* Button, LinkButton, or ImageButton Web control is clicked within the FormView.</span></span> <span data-ttu-id="218f1-216">Esto significa que cuando el usuario se mueve de una página a otra en FormView, la `ItemCommand` desencadena el evento; de lo mismo cuando el usuario hace clic en nuevo, editar o eliminar en un FormView que admite la inserción, actualización o eliminación.</span><span class="sxs-lookup"><span data-stu-id="218f1-216">That means that when the user moves from one page to another in the FormView, the `ItemCommand` event fires; same thing when the user clicks New, Edit, or Delete in a FormView that supports inserting, updating, or deleting.</span></span>

<span data-ttu-id="218f1-217">Puesto que el `ItemCommand` se activa sin tener en cuenta se hace clic en el botón, en caso de controlador necesitamos una manera de determinar si se ha hecho clic en el botón de productos todo suspender o si es algún otro botón.</span><span class="sxs-lookup"><span data-stu-id="218f1-217">Since the `ItemCommand` fires regardless of what button is clicked, in the event handler we need a way to determine if the Discontinue All Products Button was clicked or if it was some other button.</span></span> <span data-ttu-id="218f1-218">Para ello, podemos establecer el control de botón Web s `CommandName` propiedad con un valor de identificación.</span><span class="sxs-lookup"><span data-stu-id="218f1-218">To accomplish this, we can set the Button Web control s `CommandName` property to some identifying value.</span></span> <span data-ttu-id="218f1-219">Cuando se presiona el botón, esto `CommandName` valor se pasa a la `ItemCommand` controlador de eventos, lo que nos permite determinar si el botón de productos todo suspender fue el botón ha hecho clic.</span><span class="sxs-lookup"><span data-stu-id="218f1-219">When the Button is clicked, this `CommandName` value is passed into the `ItemCommand` event handler, enabling us to determine whether the Discontinue All Products Button was the button clicked.</span></span> <span data-ttu-id="218f1-220">Establecer la s interrumpir todos los productos botón `CommandName` propiedad DiscontinueProducts.</span><span class="sxs-lookup"><span data-stu-id="218f1-220">Set the Discontinue All Products Button s `CommandName` property to DiscontinueProducts .</span></span>

<span data-ttu-id="218f1-221">Por último, permiten s usar un cuadro de diálogo de confirmación del lado cliente para asegurarse de que el usuario realmente quiere dejar de los productos del proveedor seleccionado s.</span><span class="sxs-lookup"><span data-stu-id="218f1-221">Finally, let s use a client-side confirm dialog box to ensure that the user really wants to discontinue the selected supplier s products.</span></span> <span data-ttu-id="218f1-222">Como vimos en el [Agregar cliente confirmación cuando se elimina](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) tutorial, esto puede realizarse con una pequeña parte de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="218f1-222">As we saw in the [Adding Client-Side Confirmation When Deleting](../editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb.md) tutorial, this can be accomplished with a bit of JavaScript.</span></span> <span data-ttu-id="218f1-223">En particular, establezca la propiedad de OnClientClick de s de control de botón Web en`return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span><span class="sxs-lookup"><span data-stu-id="218f1-223">In particular, set the Button Web control s OnClientClick property to `return confirm('This will mark _all_ of this supplier\'s products as discontinued. Are you certain you want to do this?');`</span></span>

<span data-ttu-id="218f1-224">Después de realizar estos cambios, la sintaxis declarativa de FormView s debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="218f1-224">After making these changes, the FormView s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample6.aspx)]

<span data-ttu-id="218f1-225">A continuación, cree un controlador de eventos para el s FormView `ItemCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="218f1-225">Next, create an event handler for the FormView s `ItemCommand` event.</span></span> <span data-ttu-id="218f1-226">En este controlador de eventos, es necesario determinar primero si se ha hecho clic en el botón de productos todo suspender.</span><span class="sxs-lookup"><span data-stu-id="218f1-226">In this event handler we need to first determine whether the Discontinue All Products Button was clicked.</span></span> <span data-ttu-id="218f1-227">Si por lo tanto, desea crear una instancia de la `ProductsBLL` clase e invocar su `DiscontinueAllProductsForSupplier(supplierID)` método, pasando el `SupplierID` de FormView seleccionado:</span><span class="sxs-lookup"><span data-stu-id="218f1-227">If so, we want to create an instance of the `ProductsBLL` class and invoke its `DiscontinueAllProductsForSupplier(supplierID)` method, passing in the `SupplierID` of the selected FormView:</span></span>


[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample7.vb)]

<span data-ttu-id="218f1-228">Tenga en cuenta que la `SupplierID` del proveedor seleccionado actual en FormView puede tener acceso mediante las operaciones de asignación FormView [ `SelectedValue` propiedad](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span><span class="sxs-lookup"><span data-stu-id="218f1-228">Note that the `SupplierID` of the current selected supplier in the FormView can be accessed using the FormView s [`SelectedValue` property](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.formview.selectedvalue.aspx).</span></span> <span data-ttu-id="218f1-229">El `SelectedValue` propiedad devuelve el valor del registro que se muestra en el FormView de clave de los primeros datos.</span><span class="sxs-lookup"><span data-stu-id="218f1-229">The `SelectedValue` property returns the first data key value for the record being displayed in the FormView.</span></span> <span data-ttu-id="218f1-230">Las operaciones de asignación FormView [ `DataKeyNames` propiedad](https://msdn.microsoft.com/en-us/system.web.ui.webcontrols.formview.datakeynames.aspx), lo que indica que los datos se extraen los campos desde el que los datos de los valores de clave, se establece automáticamente en `SupplierID` por Visual Studio cuando se enlaza el ObjectDataSource a la parte posterior de FormView en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="218f1-230">The FormView s [`DataKeyNames` property](https://msdn.microsoft.com/en-us/system.web.ui.webcontrols.formview.datakeynames.aspx), which indicates the data fields from which the data key values are pulled from, was automatically set to `SupplierID` by Visual Studio when binding the ObjectDataSource to the FormView back in Step 2.</span></span>

<span data-ttu-id="218f1-231">Con el `ItemCommand` controlador de eventos creado, tómese un momento para probar la página.</span><span class="sxs-lookup"><span data-stu-id="218f1-231">With the `ItemCommand` event handler created, take a moment to test out the page.</span></span> <span data-ttu-id="218f1-232">Vaya a la Quesos de Cooperativa 'Venta Cabras' proveedor (se s del proveedor quinto en FormView para mí).</span><span class="sxs-lookup"><span data-stu-id="218f1-232">Browse to the Cooperativa de Quesos 'Las Cabras' supplier (it s the fifth supplier in the FormView for me).</span></span> <span data-ttu-id="218f1-233">Este proveedor proporciona dos productos, Queso Cabrales y Queso Manchego La Pastora, ambos de los cuales son *no* suspendido.</span><span class="sxs-lookup"><span data-stu-id="218f1-233">This supplier provides two products, Queso Cabrales and Queso Manchego La Pastora, both of which are *not* discontinued.</span></span>

<span data-ttu-id="218f1-234">Imagine que Alemania Cooperativa Quesos 'Venta Cabras' ha salido del negocio y, por tanto, son los productos se interrumpa.</span><span class="sxs-lookup"><span data-stu-id="218f1-234">Imagine that Cooperativa de Quesos 'Las Cabras' has gone out of business and therefore its products are to be discontinued.</span></span> <span data-ttu-id="218f1-235">Haga clic en el botón de todos los productos de prestar.</span><span class="sxs-lookup"><span data-stu-id="218f1-235">Click the Discontinue All Products Button.</span></span> <span data-ttu-id="218f1-236">Aparecerá el cuadro de diálogo de confirmación del lado cliente cuadro (Véase la figura 16).</span><span class="sxs-lookup"><span data-stu-id="218f1-236">This will display the client-side confirm dialog box (see Figure 16).</span></span>


<span data-ttu-id="218f1-237">[![Cooperativa de Quesos venta Cabras proporciona dos productos activos](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-237">[![Cooperativa de Quesos Las Cabras Supplies Two Active Products](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image43.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image42.png)</span></span>

<span data-ttu-id="218f1-238">**Figura 16**: Cooperativa de Quesos venta Cabras proporciona dos productos activos ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-238">**Figure 16**: Cooperativa de Quesos Las Cabras Supplies Two Active Products ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image44.png))</span></span>


<span data-ttu-id="218f1-239">Si hace clic en Aceptar en el cuadro de diálogo de confirmación de cliente, el envío del formulario continuará, provocando una devolución de datos en el que las operaciones de asignación FormView `ItemCommand` desencadenará el evento.</span><span class="sxs-lookup"><span data-stu-id="218f1-239">If you click OK in the client-side confirm dialog box, the form submission will proceed, causing a postback in which the FormView s `ItemCommand` event will fire.</span></span> <span data-ttu-id="218f1-240">El controlador de eventos se crea, a continuación, se ejecutará, invocar el `DiscontinueAllProductsForSupplier(supplierID)` método y dejar el Queso Cabrales y Queso Manchego La Pastora productos.</span><span class="sxs-lookup"><span data-stu-id="218f1-240">The event handler we created will then execute, invoking the `DiscontinueAllProductsForSupplier(supplierID)` method and discontinuing both the Queso Cabrales and Queso Manchego La Pastora products.</span></span>

<span data-ttu-id="218f1-241">Si ha deshabilitado el estado de vista de GridView s, GridView es que se va a enlazar al almacén de datos subyacente en cada devolución de datos y, por tanto, inmediatamente se actualizará para reflejar que estos dos productos ahora se suspenden (Véase la figura 17).</span><span class="sxs-lookup"><span data-stu-id="218f1-241">If you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect that these two products are now discontinued (see Figure 17).</span></span> <span data-ttu-id="218f1-242">Si, sin embargo, no ha deshabilitado el estado de vista en el control GridView, debe enlazar manualmente los datos en GridView después de realizar este cambio.</span><span class="sxs-lookup"><span data-stu-id="218f1-242">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="218f1-243">Para ello, basta con realizar una llamada a las operaciones de asignación GridView `DataBind()` método inmediatamente después de invocar el `DiscontinueAllProductsForSupplier(supplierID)` método.</span><span class="sxs-lookup"><span data-stu-id="218f1-243">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `DiscontinueAllProductsForSupplier(supplierID)` method.</span></span>


<span data-ttu-id="218f1-244">[![Después el botón interrumpir todos los productos, los productos de proveedor s son actualiza en consecuencia](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-244">[![After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image46.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image45.png)</span></span>

<span data-ttu-id="218f1-245">**Figura 17**: después el botón interrumpir todos los productos, los productos de proveedor s son actualiza en consecuencia ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-245">**Figure 17**: After Clicking the Discontinue All Products Button, the Supplier s Products are Updated Accordingly ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image47.png))</span></span>


## <a name="step-6-creating-an-updateproduct-overload-in-the-business-logic-layer-for-adjusting-a-product-s-price"></a><span data-ttu-id="218f1-246">Paso 6: Crear una sobrecarga UpdateProduct en la capa de lógica de negocios para ajustar un precio del producto s</span><span class="sxs-lookup"><span data-stu-id="218f1-246">Step 6: Creating an UpdateProduct Overload in the Business Logic Layer for Adjusting a Product s Price</span></span>

<span data-ttu-id="218f1-247">Al igual que con interrumpir todos los productos en el botón FormView, con el fin de agregar los botones para aumentar y disminuir el precio de un producto de GridView necesitamos agregar primero los métodos adecuados de la capa de acceso a datos y capa de lógica empresarial.</span><span class="sxs-lookup"><span data-stu-id="218f1-247">Like with the Discontinue All Products Button in the FormView, in order to add buttons for increasing and decreasing the price for a product in the GridView we need to first add the appropriate Data Access Layer and Business Logic Layer methods.</span></span> <span data-ttu-id="218f1-248">Puesto que ya tenemos un método que actualiza una fila única de producto en la capa DAL, podemos proporcionar esta funcionalidad mediante la creación de una nueva sobrecarga para el `UpdateProduct` método en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="218f1-248">Since we already have a method that updates a single product row in the DAL, we can provide such functionality by creating a new overload for the `UpdateProduct` method in the BLL.</span></span>

<span data-ttu-id="218f1-249">Nuestro pasado `UpdateProduct` sobrecargas realizadas en una combinación de campos de producto como valores escalares de entrada y, a continuación, se ha actualizado el solo aquellos campos para el producto especificado.</span><span class="sxs-lookup"><span data-stu-id="218f1-249">Our past `UpdateProduct` overloads have taken in some combination of product fields as scalar input values and have then updated just those fields for the specified product.</span></span> <span data-ttu-id="218f1-250">Esta sobrecarga se pasa en su lugar en el producto s y varían ligeramente respecto a este estándar `ProductID` y el porcentaje por el que se va a ajustar la `UnitPrice` (en lugar de pasar el nuevo, ajustar `UnitPrice` propio).</span><span class="sxs-lookup"><span data-stu-id="218f1-250">For this overload we'll vary slightly from this standard and instead pass in the product s `ProductID` and the percentage by which to adjust the `UnitPrice` (as opposed to passing in the new, adjusted `UnitPrice` itself).</span></span> <span data-ttu-id="218f1-251">Este enfoque simplificará el código que se necesita para escribir en la clase de código subyacente de la página ASP.NET, ya que no queremos t tiene que preocuparse por determinar el producto actual s `UnitPrice`.</span><span class="sxs-lookup"><span data-stu-id="218f1-251">This approach will simplify the code we need to write in the ASP.NET page code-behind class, since we don t have to bother with determining the current product s `UnitPrice`.</span></span>

<span data-ttu-id="218f1-252">El `UpdateProduct` sobrecarga para este tutorial se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="218f1-252">The `UpdateProduct` overload for this tutorial is shown below:</span></span>


[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample8.vb)]

<span data-ttu-id="218f1-253">Esta sobrecarga recupera información sobre el producto especificado a través de la capa DAL `GetProductByProductID(productID)` método.</span><span class="sxs-lookup"><span data-stu-id="218f1-253">This overload retrieves information about the specified product through the DAL s `GetProductByProductID(productID)` method.</span></span> <span data-ttu-id="218f1-254">A continuación, se comprueba si el producto s `UnitPrice` se asigna a una base de datos `NULL` valor.</span><span class="sxs-lookup"><span data-stu-id="218f1-254">It then checks to see whether the product s `UnitPrice` is assigned a database `NULL` value.</span></span> <span data-ttu-id="218f1-255">Si es así, el precio se deja sin modificar.</span><span class="sxs-lookup"><span data-stu-id="218f1-255">If it is, the price is left unaltered.</span></span> <span data-ttu-id="218f1-256">Si no, sin embargo, hay no`NULL` `UnitPrice` valor, el método actualiza el producto s `UnitPrice` por el porcentaje especificado (`unitPriceAdjustmentPercent`).</span><span class="sxs-lookup"><span data-stu-id="218f1-256">If, however, there is a non-`NULL` `UnitPrice` value, the method updates the product s `UnitPrice` by the specified percent (`unitPriceAdjustmentPercent`).</span></span>

## <a name="step-7-adding-the-increase-and-decrease-buttons-to-the-gridview"></a><span data-ttu-id="218f1-257">Paso 7: Agregar los botones de disminución y aumento a GridView</span><span class="sxs-lookup"><span data-stu-id="218f1-257">Step 7: Adding the Increase and Decrease Buttons to the GridView</span></span>

<span data-ttu-id="218f1-258">El control GridView (y DetailsView) son ambos formada por una colección de campos.</span><span class="sxs-lookup"><span data-stu-id="218f1-258">The GridView (and DetailsView) are both made up of a collection of fields.</span></span> <span data-ttu-id="218f1-259">Además de BoundFields, CheckBoxFields y TemplateFields, ASP.NET incluye el ButtonField, que, como su nombre implica, se representa como una columna con un botón, LinkButton o ImageButton para cada fila.</span><span class="sxs-lookup"><span data-stu-id="218f1-259">In addition to BoundFields, CheckBoxFields, and TemplateFields, ASP.NET includes the ButtonField, which, as its name implies, renders as a column with a Button, LinkButton, or ImageButton for each row.</span></span> <span data-ttu-id="218f1-260">Similar a la FormView, haga clic en *cualquier* botón dentro de la GridView botones de paginación, editar o eliminar botones, botones de ordenación y así sucesivamente provoca una devolución de datos y genera las operaciones de asignación GridView [ `RowCommand` eventos](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span><span class="sxs-lookup"><span data-stu-id="218f1-260">Similar to the FormView, clicking *any* button within the GridView paging buttons, Edit or Delete buttons, sorting buttons, and so on causes a postback and raises the GridView s [`RowCommand` event](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx).</span></span>

<span data-ttu-id="218f1-261">El ButtonField tiene un `CommandName` propiedad que asigna el valor especificado a cada uno de sus botones `CommandName` propiedades.</span><span class="sxs-lookup"><span data-stu-id="218f1-261">The ButtonField has a `CommandName` property that assigns the specified value to each of its Buttons `CommandName` properties.</span></span> <span data-ttu-id="218f1-262">Al igual que con la FormView el `CommandName` valor es utilizado por el `RowCommand` controlador de eventos para determinar qué botón se hizo clic.</span><span class="sxs-lookup"><span data-stu-id="218f1-262">Like with the FormView, the `CommandName` value is used by the `RowCommand` event handler to determine which button was clicked.</span></span>

<span data-ttu-id="218f1-263">S permiten agregar dos ButtonFields nuevo a GridView, uno con un texto del botón precio + 10% y el otro con el texto precio -10%.</span><span class="sxs-lookup"><span data-stu-id="218f1-263">Let s add two new ButtonFields to the GridView, one with a button text Price +10% and the other with the text Price -10%.</span></span> <span data-ttu-id="218f1-264">Para agregar estos ButtonFields, haga clic en el vínculo Editar columnas de la etiqueta inteligente de GridView s, seleccione el tipo de campo ButtonField en la lista en la parte superior izquierda y haga clic en el botón Agregar.</span><span class="sxs-lookup"><span data-stu-id="218f1-264">To add these ButtonFields, click on the Edit Columns link from the GridView s smart tag, select the ButtonField field type from the list in the upper left and click the Add button.</span></span>


![Agregar dos ButtonFields a GridView](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image48.png)

<span data-ttu-id="218f1-266">**Figura 18**: agregar dos ButtonFields a GridView</span><span class="sxs-lookup"><span data-stu-id="218f1-266">**Figure 18**: Add Two ButtonFields to the GridView</span></span>


<span data-ttu-id="218f1-267">Mover el dos ButtonFields para que aparezcan como los dos primeros campos de GridView.</span><span class="sxs-lookup"><span data-stu-id="218f1-267">Move the two ButtonFields so that they appear as the first two GridView fields.</span></span> <span data-ttu-id="218f1-268">A continuación, establezca el `Text` propiedades de estos dos ButtonFields para fijar los precios + 10% y el precio -10% y el `CommandName` propiedades IncreasePrice y DecreasePrice, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="218f1-268">Next, set the `Text` properties of these two ButtonFields to Price +10% and Price -10% and the `CommandName` properties to IncreasePrice and DecreasePrice, respectively.</span></span> <span data-ttu-id="218f1-269">De forma predeterminada, un ButtonField representa su columna de botones como LinkButton.</span><span class="sxs-lookup"><span data-stu-id="218f1-269">By default, a ButtonField renders its column of buttons as LinkButtons.</span></span> <span data-ttu-id="218f1-270">Esto se puede cambiar, sin embargo, a través de las operaciones de asignación ButtonField [ `ButtonType` propiedad](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span><span class="sxs-lookup"><span data-stu-id="218f1-270">This can be changed, however, through the ButtonField s [`ButtonType` property](https://msdn.microsoft.com/en-US/library/system.web.ui.webcontrols.buttonfieldbase.buttontype.aspx).</span></span> <span data-ttu-id="218f1-271">Permiten s tienen estos dos ButtonFields representados como botones de comando regulares; Por consiguiente, establecer el `ButtonType` propiedad `Button`.</span><span class="sxs-lookup"><span data-stu-id="218f1-271">Let s have these two ButtonFields rendered as regular push buttons; therefore, set the `ButtonType` property to `Button`.</span></span> <span data-ttu-id="218f1-272">Figura 19 muestra los campos de cuadro de diálogo una vez realizados estos cambios; Después de que es el marcado declarativo de s de GridView.</span><span class="sxs-lookup"><span data-stu-id="218f1-272">Figure 19 shows the Fields dialog box after these changes have been made; following that is the GridView s declarative markup.</span></span>


![Configurar el texto de ButtonFields, CommandName y ButtonType propiedades](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image49.png)

<span data-ttu-id="218f1-274">**Figura 19**: configurar la ButtonFields `Text`, `CommandName`, y `ButtonType` propiedades</span><span class="sxs-lookup"><span data-stu-id="218f1-274">**Figure 19**: Configure the ButtonFields `Text`, `CommandName`, and `ButtonType` Properties</span></span>


[!code-aspx[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample9.aspx)]

<span data-ttu-id="218f1-275">Con estos ButtonFields creados, el último paso es crear un controlador de eventos para el s GridView `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="218f1-275">With these ButtonFields created, the final step is to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="218f1-276">Este controlador de eventos, si se desencadenó porque el precio + 10% o % de precio -10 se hizo clic, debe determinar la `ProductID` para la fila cuyo botón se hizo clic y, a continuación, invocar el `ProductsBLL` clase s. `UpdateProduct` método, pasando el apropiado `UnitPrice` ajuste porcentaje junto con la `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="218f1-276">This event handler, if fired because either the Price +10% or Price -10% buttons were clicked, needs to determine the `ProductID` for the row whose button was clicked and then invoke the `ProductsBLL` class s `UpdateProduct` method, passing in the appropriate `UnitPrice` percentage adjustment along with the `ProductID`.</span></span> <span data-ttu-id="218f1-277">El código siguiente realiza estas tareas:</span><span class="sxs-lookup"><span data-stu-id="218f1-277">The following code performs these tasks:</span></span>

[!code-vb[Main](adding-and-responding-to-buttons-to-a-gridview-vb/samples/sample10.vb)]

<span data-ttu-id="218f1-278">Para determinar el `ProductID` para la fila cuyo precio + 10 se hizo clic en el botón de precio -10% o %, necesitamos que puede consultar la s GridView `DataKeys` colección.</span><span class="sxs-lookup"><span data-stu-id="218f1-278">In order to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we need to consult the GridView s `DataKeys` collection.</span></span> <span data-ttu-id="218f1-279">Esta colección contiene los valores de los campos especificados en la `DataKeyNames` propiedad para cada fila de GridView.</span><span class="sxs-lookup"><span data-stu-id="218f1-279">This collection holds the values of the fields specified in the `DataKeyNames` property for each GridView row.</span></span> <span data-ttu-id="218f1-280">Desde el s GridView `DataKeyNames` propiedad se estableció en ProductID por Visual Studio cuando se enlaza el ObjectDataSource a GridView, `DataKeys(rowIndex).Value` proporciona el `ProductID` para el elemento especificado *rowIndex*.</span><span class="sxs-lookup"><span data-stu-id="218f1-280">Since the GridView s `DataKeyNames` property was set to ProductID by Visual Studio when binding the ObjectDataSource to the GridView, `DataKeys(rowIndex).Value` provides the `ProductID` for the specified *rowIndex*.</span></span>

<span data-ttu-id="218f1-281">El ButtonField pasa automáticamente en el *rowIndex* de la fila cuyo botón se hizo clic a través de la `e.CommandArgument` parámetro.</span><span class="sxs-lookup"><span data-stu-id="218f1-281">The ButtonField automatically passes in the *rowIndex* of the row whose button was clicked through the `e.CommandArgument` parameter.</span></span> <span data-ttu-id="218f1-282">Por lo tanto, para determinar el `ProductID` para la fila cuyo precio + 10 se hizo clic en el botón de precio -10% o %, usaremos: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span><span class="sxs-lookup"><span data-stu-id="218f1-282">Therefore, to determine the `ProductID` for the row whose Price +10% or Price -10% button was clicked, we use: `Convert.ToInt32(SuppliersProducts.DataKeys(Convert.ToInt32(e.CommandArgument)).Value)`.</span></span>

<span data-ttu-id="218f1-283">Como con el botón interrumpir todos los productos, si se ha deshabilitado el estado de vista de GridView s, GridView es que se va a enlazar al almacén de datos subyacente en cada devolución de datos y por lo tanto, inmediatamente se actualizará para reflejar un cambio de precio que podría producirse al hacer clic en cualquiera de los botones.</span><span class="sxs-lookup"><span data-stu-id="218f1-283">As with the Discontinue All Products button, if you have disabled the GridView s view state, the GridView is being rebound to the underlying data store on every postback, and therefore will immediately be updated to reflect a price change that occurs from clicking either of the buttons.</span></span> <span data-ttu-id="218f1-284">Si, sin embargo, no ha deshabilitado el estado de vista en el control GridView, debe enlazar manualmente los datos en GridView después de realizar este cambio.</span><span class="sxs-lookup"><span data-stu-id="218f1-284">If, however, you have not disabled view state in the GridView, you will need to manually rebind the data to the GridView after making this change.</span></span> <span data-ttu-id="218f1-285">Para ello, basta con realizar una llamada a las operaciones de asignación GridView `DataBind()` método inmediatamente después de invocar el `UpdateProduct` método.</span><span class="sxs-lookup"><span data-stu-id="218f1-285">To accomplish this, simply make a call to the GridView s `DataBind()` method immediately after invoking the `UpdateProduct` method.</span></span>

<span data-ttu-id="218f1-286">Figura 20 muestra la página cuando se visualizan los productos suministrados por Homestead de su abuela Kelly.</span><span class="sxs-lookup"><span data-stu-id="218f1-286">Figure 20 shows the page when viewing the products provided by Grandma Kelly's Homestead.</span></span> <span data-ttu-id="218f1-287">Figura 21 muestra los resultados después el precio + 10% botón se ha hecho clic dos veces en el botón de precio -10% y Boysenberry Spread de su abuela una vez para salsa de arándanos Northwoods.</span><span class="sxs-lookup"><span data-stu-id="218f1-287">Figure 21 shows the results after the Price +10% button has been clicked twice for Grandma's Boysenberry Spread and the Price -10% button once for Northwoods Cranberry Sauce.</span></span>


<span data-ttu-id="218f1-288">[![GridView incluye precio + 10% y botones de precio -10%](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-288">[![The GridView Includes Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image51.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image50.png)</span></span>

<span data-ttu-id="218f1-289">**Figura 20**: el precio de inclusión de GridView + 10% y el precio -10% botones ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-289">**Figure 20**: The GridView Includes Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image52.png))</span></span>


<span data-ttu-id="218f1-290">[![Se han actualizado los precios para el producto primero y tercero mediante el precio + 10% y botones de precio -10%](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="218f1-290">[![The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image54.png)](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image53.png)</span></span>

<span data-ttu-id="218f1-291">**Figura 21**: los precios para el primer y tercer producto se han actualizado mediante el precio + 10% y el precio -10% botones ([haga clic aquí para ver la imagen a tamaño completo](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span><span class="sxs-lookup"><span data-stu-id="218f1-291">**Figure 21**: The Prices for the First and Third Product Have Been Updated via the Price +10% and Price -10% Buttons ([Click to view full-size image](adding-and-responding-to-buttons-to-a-gridview-vb/_static/image55.png))</span></span>


> [!NOTE]
> <span data-ttu-id="218f1-292">El control GridView (y DetailsView) también pueden tener botones, LinkButton o ImageButtons agrega a sus TemplateFields.</span><span class="sxs-lookup"><span data-stu-id="218f1-292">The GridView (and DetailsView) can also have Buttons, LinkButtons, or ImageButtons added to their TemplateFields.</span></span> <span data-ttu-id="218f1-293">Como con BoundField, estos botones, al hacer clic, inducirían un postback, cuando se genera la s GridView `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="218f1-293">As with the BoundField, these Buttons, when clicked, will induce a postback, raising the GridView s `RowCommand` event.</span></span> <span data-ttu-id="218f1-294">Al agregar botones TemplateField, sin embargo, el botón s `CommandArgument` no se establece automáticamente en el índice de la fila tal cual al usar ButtonFields.</span><span class="sxs-lookup"><span data-stu-id="218f1-294">When adding buttons in a TemplateField, however, the Button s `CommandArgument` is not automatically set to the index of the row as it is when using ButtonFields.</span></span> <span data-ttu-id="218f1-295">Si necesita determinar el índice de fila del botón que se ha hecho clic dentro de la `RowCommand` controlador de eventos, deberá establecer manualmente el botón s `CommandArgument` propiedad en su sintaxis declarativa en TemplateField, con un código como:</span><span class="sxs-lookup"><span data-stu-id="218f1-295">If you need to determine the row index of the button that was clicked within the `RowCommand` event handler, you'll need to manually set the Button s `CommandArgument` property in its declarative syntax within the TemplateField, using code like:</span></span>  
> <span data-ttu-id="218f1-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span><span class="sxs-lookup"><span data-stu-id="218f1-296">`<asp:Button runat="server" ... CommandArgument='<%# CType(Container, GridViewRow).RowIndex %>' />`.</span></span>


## <a name="summary"></a><span data-ttu-id="218f1-297">Resumen</span><span class="sxs-lookup"><span data-stu-id="218f1-297">Summary</span></span>

<span data-ttu-id="218f1-298">Pueden incluir los controles GridView, DetailsView y FormView todos los botones, LinkButton o ImageButtons.</span><span class="sxs-lookup"><span data-stu-id="218f1-298">The GridView, DetailsView, and FormView controls all can include Buttons, LinkButtons, or ImageButtons.</span></span> <span data-ttu-id="218f1-299">Estos botones, al hacer clic, hacer una devolución de datos y generar el `ItemCommand` eventos en los controles FormView y DetailsView y `RowCommand` evento en GridView.</span><span class="sxs-lookup"><span data-stu-id="218f1-299">Such buttons, when clicked, cause a postback and raise the `ItemCommand` event in the FormView and DetailsView controls and the `RowCommand` event in the GridView.</span></span> <span data-ttu-id="218f1-300">Estos controles Web de datos tienen una funcionalidad integrada para controlar las acciones comunes relacionadas con el comando, como eliminar o modificar registros.</span><span class="sxs-lookup"><span data-stu-id="218f1-300">These data Web controls have built-in functionality to handle common command-related actions, such as deleting or editing records.</span></span> <span data-ttu-id="218f1-301">Sin embargo, se puede usar los botones que, al hacer clic en, responder a la ejecución de nuestro propio código personalizado.</span><span class="sxs-lookup"><span data-stu-id="218f1-301">However, we can also use buttons that, when clicked, respond with executing our own custom code.</span></span>

<span data-ttu-id="218f1-302">Para lograr esto, debemos crear un controlador de eventos para el `ItemCommand` o `RowCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="218f1-302">To accomplish this, we need to create an event handler for the `ItemCommand` or `RowCommand` event.</span></span> <span data-ttu-id="218f1-303">En este controlador de eventos primero comprobamos entrante `CommandName` valor para determinar qué botón se hizo clic y, a continuación, tome las medidas adecuadas de personalizado.</span><span class="sxs-lookup"><span data-stu-id="218f1-303">In this event handler we first check the incoming `CommandName` value to determine which button was clicked and then take appropriate custom action.</span></span> <span data-ttu-id="218f1-304">En este tutorial, hemos visto cómo usar los botones y ButtonFields de suspender todos los productos para un proveedor especificado o para aumentar o disminuir el precio de un producto determinado en un 10%.</span><span class="sxs-lookup"><span data-stu-id="218f1-304">In this tutorial we saw how to use buttons and ButtonFields to discontinue all products for a specified supplier or to increase or decrease the price of a particular product by 10%.</span></span>

<span data-ttu-id="218f1-305">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="218f1-305">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="218f1-306">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="218f1-306">About the Author</span></span>

<span data-ttu-id="218f1-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="218f1-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="218f1-308">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="218f1-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="218f1-309">Su último libro es [ *SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="218f1-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="218f1-310">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="218f1-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="218f1-311">Anterior</span><span class="sxs-lookup"><span data-stu-id="218f1-311">Previous</span></span>](adding-and-responding-to-buttons-to-a-gridview-cs.md)
