---
uid: mvc/overview/older-versions-1/contact-manager/iteration-7-add-ajax-functionality-cs
title: 'Iteración #7: la funcionalidad de Ajax de agregar (C#) | Documentos de Microsoft'
author: microsoft
description: En la iteración séptima, mejorar la capacidad de respuesta y el rendimiento de nuestra aplicación agregando compatibilidad para Ajax.
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2009
ms.topic: article
ms.assetid: f1b0809e-8909-444e-b6bb-a5cd1dea3f72
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions-1/contact-manager/iteration-7-add-ajax-functionality-cs
msc.type: authoredcontent
ms.openlocfilehash: 35d62383a571725749b2fc629bbb17954657b2f6
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
---
<a name="iteration-7--add-ajax-functionality-c"></a><span data-ttu-id="147c1-103">Iteración #7: la funcionalidad de Ajax de agregar (C#)</span><span class="sxs-lookup"><span data-stu-id="147c1-103">Iteration #7 – Add Ajax functionality (C#)</span></span>
====================
<span data-ttu-id="147c1-104">por [Microsoft](https://github.com/microsoft)</span><span class="sxs-lookup"><span data-stu-id="147c1-104">by [Microsoft](https://github.com/microsoft)</span></span>

[<span data-ttu-id="147c1-105">Descargar código</span><span class="sxs-lookup"><span data-stu-id="147c1-105">Download Code</span></span>](iteration-7-add-ajax-functionality-cs/_static/contactmanager_7_cs1.zip)

> <span data-ttu-id="147c1-106">En la iteración séptima, mejorar la capacidad de respuesta y el rendimiento de nuestra aplicación agregando compatibilidad para Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-106">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>


## <a name="building-a-contact-management-aspnet-mvc-application-c"></a><span data-ttu-id="147c1-107">Creación de una aplicación de MVC de ASP.NET de administración de contactos (C#)</span><span class="sxs-lookup"><span data-stu-id="147c1-107">Building a Contact Management ASP.NET MVC Application (C#)</span></span>

<span data-ttu-id="147c1-108">En esta serie de tutoriales, creamos una aplicación de administración de contactos toda desde el principio para finalizar.</span><span class="sxs-lookup"><span data-stu-id="147c1-108">In this series of tutorials, we build an entire Contact Management application from start to finish.</span></span> <span data-ttu-id="147c1-109">La aplicación de ponerse en contacto con el administrador permite almacenar información de contacto - nombres, números de teléfono y direcciones de correo electrónico: para obtener una lista de personas.</span><span class="sxs-lookup"><span data-stu-id="147c1-109">The Contact Manager application enables you to store contact information - names, phone numbers and email addresses - for a list of people.</span></span>

<span data-ttu-id="147c1-110">Se compile la aplicación en varias iteraciones.</span><span class="sxs-lookup"><span data-stu-id="147c1-110">We build the application over multiple iterations.</span></span> <span data-ttu-id="147c1-111">Con cada iteración, se mejora gradualmente la aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-111">With each iteration, we gradually improve the application.</span></span> <span data-ttu-id="147c1-112">El objetivo de este enfoque de iteración varias es para que pueda entender el motivo de cada cambio.</span><span class="sxs-lookup"><span data-stu-id="147c1-112">The goal of this multiple iteration approach is to enable you to understand the reason for each change.</span></span>

- <span data-ttu-id="147c1-113">Iteración #1: crear la aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-113">Iteration #1 - Create the application.</span></span> <span data-ttu-id="147c1-114">En la primera iteración, se creará el póngase en contacto con el Administrador de la manera más sencilla posible.</span><span class="sxs-lookup"><span data-stu-id="147c1-114">In the first iteration, we create the Contact Manager in the simplest way possible.</span></span> <span data-ttu-id="147c1-115">Se agrega compatibilidad para las operaciones de base de datos básicos: crear, lectura, actualización y eliminación (CRUD).</span><span class="sxs-lookup"><span data-stu-id="147c1-115">We add support for basic database operations: Create, Read, Update, and Delete (CRUD).</span></span>

- <span data-ttu-id="147c1-116">Iteración #2: hacer que la aplicación sea bonito.</span><span class="sxs-lookup"><span data-stu-id="147c1-116">Iteration #2 - Make the application look nice.</span></span> <span data-ttu-id="147c1-117">En esta iteración, mejorar la apariencia de la aplicación mediante la modificación de la página principal de vista de MVC de ASP.NET predeterminada y en cascada hoja de estilos.</span><span class="sxs-lookup"><span data-stu-id="147c1-117">In this iteration, we improve the appearance of the application by modifying the default ASP.NET MVC view master page and cascading style sheet.</span></span>

- <span data-ttu-id="147c1-118">Iteración #3: agregar validación del formulario.</span><span class="sxs-lookup"><span data-stu-id="147c1-118">Iteration #3 - Add form validation.</span></span> <span data-ttu-id="147c1-119">En la tercera iteración, agregamos la validación del formulario básico.</span><span class="sxs-lookup"><span data-stu-id="147c1-119">In the third iteration, we add basic form validation.</span></span> <span data-ttu-id="147c1-120">Es evitar que los usuarios enviar un formulario sin completar los campos obligatorios.</span><span class="sxs-lookup"><span data-stu-id="147c1-120">We prevent people from submitting a form without completing required form fields.</span></span> <span data-ttu-id="147c1-121">También hemos validar direcciones de correo electrónico y números de teléfono.</span><span class="sxs-lookup"><span data-stu-id="147c1-121">We also validate email addresses and phone numbers.</span></span>

- <span data-ttu-id="147c1-122">Iteración #4: hacer que la aplicación de acoplamiento flexible.</span><span class="sxs-lookup"><span data-stu-id="147c1-122">Iteration #4 - Make the application loosely coupled.</span></span> <span data-ttu-id="147c1-123">En esta tercera iteración, aprovechamos de varios patrones de diseño de software para que resulten más fáciles de mantener y modificar la aplicación póngase en contacto con el administrador.</span><span class="sxs-lookup"><span data-stu-id="147c1-123">In this third iteration, we take advantage of several software design patterns to make it easier to maintain and modify the Contact Manager application.</span></span> <span data-ttu-id="147c1-124">Por ejemplo, se refactoriza nuestra aplicación para que use el modelo de repositorio y el modelo de inserción de dependencias.</span><span class="sxs-lookup"><span data-stu-id="147c1-124">For example, we refactor our application to use the Repository pattern and the Dependency Injection pattern.</span></span>

- <span data-ttu-id="147c1-125">Iteración #5: crear pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="147c1-125">Iteration #5 - Create unit tests.</span></span> <span data-ttu-id="147c1-126">En la iteración quinto, hacemos nuestra aplicación más fácil de mantener y modificar mediante la adición de pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="147c1-126">In the fifth iteration, we make our application easier to maintain and modify by adding unit tests.</span></span> <span data-ttu-id="147c1-127">Hemos simular nuestro clases del modelo de datos y generar pruebas unitarias para nuestros controladores y la lógica de validación.</span><span class="sxs-lookup"><span data-stu-id="147c1-127">We mock our data model classes and build unit tests for our controllers and validation logic.</span></span>

- <span data-ttu-id="147c1-128">Iteración 6 #: Use desarrollo controlado por pruebas.</span><span class="sxs-lookup"><span data-stu-id="147c1-128">Iteration #6 - Use test-driven development.</span></span> <span data-ttu-id="147c1-129">En esta iteración sexto, se agregan nuevas funciones a nuestra aplicación escribiendo pruebas unitarias en primer lugar y escribir código frente a las pruebas unitarias.</span><span class="sxs-lookup"><span data-stu-id="147c1-129">In this sixth iteration, we add new functionality to our application by writing unit tests first and writing code against the unit tests.</span></span> <span data-ttu-id="147c1-130">En esta iteración, agregamos grupos de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-130">In this iteration, we add contact groups.</span></span>

- <span data-ttu-id="147c1-131">Iteración #7 - agregar funcionalidad de Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-131">Iteration #7 - Add Ajax functionality.</span></span> <span data-ttu-id="147c1-132">En la iteración séptima, mejorar la capacidad de respuesta y el rendimiento de nuestra aplicación agregando compatibilidad para Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-132">In the seventh iteration, we improve the responsiveness and performance of our application by adding support for Ajax.</span></span>

## <a name="this-iteration"></a><span data-ttu-id="147c1-133">Esta iteración</span><span class="sxs-lookup"><span data-stu-id="147c1-133">This Iteration</span></span>

<span data-ttu-id="147c1-134">En esta iteración de la aplicación Administrador de contacto, se refactoriza nuestra aplicación hacer uso de Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-134">In this iteration of the Contact Manager application, we refactor our application to make use of Ajax.</span></span> <span data-ttu-id="147c1-135">Aprovechando las ventajas de Ajax, hacemos nuestra aplicación mayor capacidad de respuesta.</span><span class="sxs-lookup"><span data-stu-id="147c1-135">By taking advantage of Ajax, we make our application more responsive.</span></span> <span data-ttu-id="147c1-136">Podemos evitar representar una página completa cuando se necesita actualizar solo una región determinada en una página.</span><span class="sxs-lookup"><span data-stu-id="147c1-136">We can avoid rendering an entire page when we need to update only a certain region in a page.</span></span>

<span data-ttu-id="147c1-137">La vista de índice se podrá refactorizar para que no queremos t deba volver a mostrar la página completa cada vez que un usuario selecciona un nuevo grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-137">We'll refactor our Index view so that we don t need to redisplay the entire page whenever someone selects a new contact group.</span></span> <span data-ttu-id="147c1-138">En su lugar, cuando un usuario hace clic en un grupo de contactos, comenzaremos simplemente actualizar la lista de contactos y deje el resto de la página por sí sola.</span><span class="sxs-lookup"><span data-stu-id="147c1-138">Instead, when someone clicks a contact group, we'll just update the list of contacts and leave the rest of the page alone.</span></span>

<span data-ttu-id="147c1-139">También se podrá cambiar la manera nuestro Eliminar vínculo funciona.</span><span class="sxs-lookup"><span data-stu-id="147c1-139">We'll also change the way our delete link works.</span></span> <span data-ttu-id="147c1-140">En lugar de mostrar una página de confirmación independiente, se mostrará un cuadro de diálogo de confirmación de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="147c1-140">Instead of displaying a separate confirmation page, we'll display a JavaScript confirmation dialog.</span></span> <span data-ttu-id="147c1-141">Si lo confirma que desea eliminar un contacto, se realiza una operación DELETE de HTTP en el servidor para eliminar el registro de contacto de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="147c1-141">If you confirm that you want to delete a contact, an HTTP DELETE operation is performed against the server to delete the contact record from the database.</span></span>

<span data-ttu-id="147c1-142">Además, se aprovechará de jQuery para agregar efectos de animación a la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="147c1-142">Furthermore, we will take advantage of jQuery to add animation effects to our Index view.</span></span> <span data-ttu-id="147c1-143">Se mostrará una animación cuando la nueva lista de contactos se han recuperado desde el servidor.</span><span class="sxs-lookup"><span data-stu-id="147c1-143">We'll display an animation when the new list of contacts is being fetched from the server.</span></span>

<span data-ttu-id="147c1-144">Por último, podrá beneficiarse de la compatibilidad de marco de AJAX de ASP.NET para administrar el historial del explorador.</span><span class="sxs-lookup"><span data-stu-id="147c1-144">Finally, we'll take advantage of the ASP.NET AJAX framework support for managing browser history.</span></span> <span data-ttu-id="147c1-145">Vamos a crear los puntos del historial siempre que se realiza una llamada Ajax para actualizar la lista de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-145">We'll create history points whenever we perform an Ajax call to update the contact list.</span></span> <span data-ttu-id="147c1-146">De este modo, el explorador hacia atrás y hacia delante botones will funcione.</span><span class="sxs-lookup"><span data-stu-id="147c1-146">That way, the browser backward and forward buttons will work.</span></span>

## <a name="why-use-ajax"></a><span data-ttu-id="147c1-147">¿Por qué usar Ajax?</span><span class="sxs-lookup"><span data-stu-id="147c1-147">Why use Ajax?</span></span>

<span data-ttu-id="147c1-148">El uso de Ajax tiene muchas ventajas.</span><span class="sxs-lookup"><span data-stu-id="147c1-148">Using Ajax has many benefits.</span></span> <span data-ttu-id="147c1-149">En primer lugar, puede agregar funcionalidad de Ajax en el resultado de una mejor experiencia de usuario de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-149">First, adding Ajax functionality to an application results in a better user experience.</span></span> <span data-ttu-id="147c1-150">En una aplicación web normal, la página completa debe enviarse al servidor cada vez que un usuario realiza una acción.</span><span class="sxs-lookup"><span data-stu-id="147c1-150">In a normal web application, the entire page must be posted back to the server each and every time a user performs an action.</span></span> <span data-ttu-id="147c1-151">Cada vez que realice una acción, los bloqueos de explorador y el usuario deben esperar hasta que se capturan y se vuelve a mostrar toda la página.</span><span class="sxs-lookup"><span data-stu-id="147c1-151">Whenever you perform an action, the browser locks and the user must wait until the entire page is fetched and redisplayed.</span></span>

<span data-ttu-id="147c1-152">Esto sería una experiencia de inaceptable en el caso de una aplicación de escritorio.</span><span class="sxs-lookup"><span data-stu-id="147c1-152">This would be an unacceptable experience in the case of a desktop application.</span></span> <span data-ttu-id="147c1-153">Sin embargo, normalmente, se duración con esta experiencia de usuario incorrectos en el caso de una aplicación web porque no se supiera que podríamos hacer mejor.</span><span class="sxs-lookup"><span data-stu-id="147c1-153">But, traditionally, we lived with this bad user experience in the case of a web application because we did not know that we could do any better.</span></span> <span data-ttu-id="147c1-154">Pensábamos que era una limitación de las aplicaciones web en los que, en realidad, es simplemente una limitación de nuestro imaginación.</span><span class="sxs-lookup"><span data-stu-id="147c1-154">We thought it was a limitation of web applications when, in actuality, it was just a limitation of our imaginations.</span></span>

<span data-ttu-id="147c1-155">En una aplicación Ajax, que no t necesario para hacer que la experiencia del usuario detenga solo para actualizar una página.</span><span class="sxs-lookup"><span data-stu-id="147c1-155">In an Ajax application, you don t need to bring the user experience to a halt just to update a page.</span></span> <span data-ttu-id="147c1-156">En su lugar, puede realizar una solicitud asincrónica en segundo plano para actualizar la página.</span><span class="sxs-lookup"><span data-stu-id="147c1-156">Instead, you can perform an asynchronous request in the background to update the page.</span></span> <span data-ttu-id="147c1-157">Cuando no fuerza de t al usuario que espere mientras se actualiza la parte de la página.</span><span class="sxs-lookup"><span data-stu-id="147c1-157">You don t force the user to wait while part of the page gets updated.</span></span>

<span data-ttu-id="147c1-158">Aprovechando las ventajas de Ajax, también puede mejorar el rendimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-158">By taking advantage of Ajax, you also can improve the performance of your application.</span></span> <span data-ttu-id="147c1-159">Considere la posibilidad de funcionamiento de la aplicación Administrador contacto ahora sin la funcionalidad de Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-159">Consider how the Contact Manager application works right now without Ajax functionality.</span></span> <span data-ttu-id="147c1-160">Al hacer clic en un grupo de contactos, toda la vista de índice debe volver a mostrarse.</span><span class="sxs-lookup"><span data-stu-id="147c1-160">When you click a contact group, the entire Index view must be redisplayed.</span></span> <span data-ttu-id="147c1-161">La lista de contactos y la lista de grupos de contactos se deben recuperar desde el servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="147c1-161">The list of contacts and list of contact groups must be retrieved from the database server.</span></span> <span data-ttu-id="147c1-162">Todos estos datos deben pasarse a través de la conexión de servidor web en el explorador web.</span><span class="sxs-lookup"><span data-stu-id="147c1-162">All of this data must be passed across the wire from web server to web browser.</span></span>

<span data-ttu-id="147c1-163">Sin embargo, después de que se agregue la funcionalidad de Ajax a nuestra aplicación, podemos evitar volver a mostrar toda la página cuando un usuario hace clic en un grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-163">After we add Ajax functionality to our application, however, we can avoid redisplaying the entire page when a user clicks a contact group.</span></span> <span data-ttu-id="147c1-164">Ya no es necesario obtener los grupos de contactos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="147c1-164">We no longer need to grab the contact groups from the database.</span></span> <span data-ttu-id="147c1-165">También no queremos t necesario distribuir toda la vista de índice en línea.</span><span class="sxs-lookup"><span data-stu-id="147c1-165">We also don t need to push the entire Index view across the wire.</span></span> <span data-ttu-id="147c1-166">Aprovechando las ventajas de Ajax, se reduce la cantidad de trabajo que debe realizar en el servidor de base de datos y se reduce la cantidad de tráfico de red requerido por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-166">By taking advantage of Ajax, we reduce the amount of work that our database server must perform and we reduce the amount of network traffic required by our application.</span></span>

## <a name="don-t-be-afraid-of-ajax"></a><span data-ttu-id="147c1-167">Don t ser atreve de Ajax</span><span class="sxs-lookup"><span data-stu-id="147c1-167">Don t be Afraid of Ajax</span></span>

<span data-ttu-id="147c1-168">Algunos desarrolladores evitar el uso de Ajax porque preocuparse de los exploradores.</span><span class="sxs-lookup"><span data-stu-id="147c1-168">Some developers avoid using Ajax because they worry about downlevel browsers.</span></span> <span data-ttu-id="147c1-169">Desean asegurarse de que sus aplicaciones web seguirán funcionando cuando obtiene acceso a un explorador que no admite JavaScript.</span><span class="sxs-lookup"><span data-stu-id="147c1-169">They want to make sure that their web applications will still work when accessed by a browser that does not support JavaScript.</span></span> <span data-ttu-id="147c1-170">Dado que Ajax depende de JavaScript, algunos desarrolladores evite usar Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-170">Because Ajax depends on JavaScript, some developers avoid using Ajax.</span></span>

<span data-ttu-id="147c1-171">Sin embargo, si tiene cuidado acerca de cómo implementar Ajax puede compilar aplicaciones que funcionan con exploradores de nivel superior y de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="147c1-171">However, if you are careful about how you implement Ajax then you can build applications that work with both uplevel and downlevel browsers.</span></span> <span data-ttu-id="147c1-172">Nuestra aplicación póngase en contacto con el administrador funcionarán con los exploradores que admiten JavaScript y exploradores que no lo hacen.</span><span class="sxs-lookup"><span data-stu-id="147c1-172">Our Contact Manager application will work with browsers that support JavaScript and browsers that do not.</span></span>

<span data-ttu-id="147c1-173">Si usa la aplicación Administrador de contacto con un explorador que admita JavaScript tendrá una mejor experiencia de usuario.</span><span class="sxs-lookup"><span data-stu-id="147c1-173">If you use the Contact Manager application with a browser that supports JavaScript then you will have a better user experience.</span></span> <span data-ttu-id="147c1-174">Por ejemplo, al hacer clic en un grupo de contactos, se actualizará solo la región de la página que muestra los contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-174">For example, when you click a contact group, only the region of the page that displays contacts will be updated.</span></span>

<span data-ttu-id="147c1-175">Si, por otro lado, se utiliza la aplicación Administrador de contacto con un explorador que no admite JavaScript (o que tenga JavaScript deshabilitado), tendrá una experiencia de usuario deseable ligeramente inferior.</span><span class="sxs-lookup"><span data-stu-id="147c1-175">If, on the other hand, you use the Contact Manager application with a browser that does not support JavaScript (or that has JavaScript disabled) then you will have a slightly less desirable user experience.</span></span> <span data-ttu-id="147c1-176">Por ejemplo, al hacer clic en un grupo de contactos, toda la vista de índice debe enviarse volver al explorador con el fin de mostrar la lista de búsqueda de coincidencias de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-176">For example, when you click a contact group, the entire Index view must be posted back to the browser in order to display the matching list of contacts.</span></span>

## <a name="adding-the-required-javascript-files"></a><span data-ttu-id="147c1-177">Agregar los archivos JavaScript necesarios</span><span class="sxs-lookup"><span data-stu-id="147c1-177">Adding the Required JavaScript Files</span></span>

<span data-ttu-id="147c1-178">Necesitaremos usar tres archivos de JavaScript para agregar funcionalidad Ajax a nuestra aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-178">We'll need to use three JavaScript files to add Ajax functionality to our application.</span></span> <span data-ttu-id="147c1-179">Las tres de estos archivos se incluyen en la carpeta de Scripts de una nueva aplicación MVC de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="147c1-179">All three of these files are included in the Scripts folder of a new ASP.NET MVC application.</span></span>

<span data-ttu-id="147c1-180">Si tiene previsto usar Ajax en varias páginas de la aplicación, a continuación, tiene sentido incluir los archivos JavaScript necesarios en la página de aplicación s vista maestra.</span><span class="sxs-lookup"><span data-stu-id="147c1-180">If you plan to use Ajax in multiple pages in your application then it makes sense to include the required JavaScript files in your application s view master page.</span></span> <span data-ttu-id="147c1-181">De este modo, los archivos JavaScript se incluirá en todas las páginas en la aplicación automáticamente.</span><span class="sxs-lookup"><span data-stu-id="147c1-181">That way, the JavaScript files will be included in all of the pages in your application automatically.</span></span>

<span data-ttu-id="147c1-182">Agregue el siguiente código de JavaScript que se incluye dentro de la &lt;head&gt; etiqueta de la página principal de vista:</span><span class="sxs-lookup"><span data-stu-id="147c1-182">Add the following JavaScript includes inside the &lt;head&gt; tag of your view master page:</span></span>

[!code-html[Main](iteration-7-add-ajax-functionality-cs/samples/sample1.html)]

## <a name="refactoring-the-index-view-to-use-ajax"></a><span data-ttu-id="147c1-183">Refactorización de la vista de índice para usar Ajax</span><span class="sxs-lookup"><span data-stu-id="147c1-183">Refactoring the Index View to use Ajax</span></span>

<span data-ttu-id="147c1-184">Permiten s iniciar mediante la modificación de la vista de índice para que solo se hace clic en un grupo de contactos actualiza la región de la vista que muestra los contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-184">Let s start by modifying our Index view so that clicking a contact group only updates the region of the view that displays contacts.</span></span> <span data-ttu-id="147c1-185">El cuadro rojo en la figura 1 contiene la región que se va a actualizar.</span><span class="sxs-lookup"><span data-stu-id="147c1-185">The red box in Figure 1 contains the region that we want to update.</span></span>


<span data-ttu-id="147c1-186">[![Actualizar solo los contactos](iteration-7-add-ajax-functionality-cs/_static/image1.jpg)](iteration-7-add-ajax-functionality-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="147c1-186">[![Updating only contacts](iteration-7-add-ajax-functionality-cs/_static/image1.jpg)](iteration-7-add-ajax-functionality-cs/_static/image1.png)</span></span>

<span data-ttu-id="147c1-187">**Figura 01**: actualizar solo contactos ([haga clic aquí para ver la imagen a tamaño completo](iteration-7-add-ajax-functionality-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="147c1-187">**Figure 01**: Updating only contacts([Click to view full-size image](iteration-7-add-ajax-functionality-cs/_static/image2.png))</span></span>


<span data-ttu-id="147c1-188">El primer paso es separar la parte de la vista que se va a actualizar de forma asincrónica en un parcial independiente (control de vista de usuario).</span><span class="sxs-lookup"><span data-stu-id="147c1-188">The first step is to separate the part of the view that we want to update asynchronously into a separate partial (view user control).</span></span> <span data-ttu-id="147c1-189">Se ha movido la sección de la vista de índice que muestra la tabla de contactos en parte en la lista 1.</span><span class="sxs-lookup"><span data-stu-id="147c1-189">The section of the Index view that displays the table of contacts has been moved into the partial in Listing 1.</span></span>

<span data-ttu-id="147c1-190">**Lista 1 - Views\Contact\ContactList.ascx**</span><span class="sxs-lookup"><span data-stu-id="147c1-190">**Listing 1 - Views\Contact\ContactList.ascx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample2.aspx)]

<span data-ttu-id="147c1-191">Observe que la parcial en la lista 1 tiene un modelo diferente de la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="147c1-191">Notice that the partial in Listing 1 has a different model than the Index view.</span></span> <span data-ttu-id="147c1-192">El *Inherits* de atributo en el &lt;% @ Page %&gt; directiva especifica que la parcial hereda de la ViewUserControl&lt;grupo&gt; clase.</span><span class="sxs-lookup"><span data-stu-id="147c1-192">The *Inherits* attribute in the &lt;%@ Page %&gt; directive specifies that the partial inherits from the ViewUserControl&lt;Group&gt; class.</span></span>

<span data-ttu-id="147c1-193">La vista de índice actualizada se incluye en el listado 2.</span><span class="sxs-lookup"><span data-stu-id="147c1-193">The updated Index view is contained in Listing 2.</span></span>

<span data-ttu-id="147c1-194">**La lista 2 - Views\Contact\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="147c1-194">**Listing 2 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample3.aspx)]

<span data-ttu-id="147c1-195">Hay dos aspectos que debe tener en cuenta acerca de la vista actualizada en el listado 2.</span><span class="sxs-lookup"><span data-stu-id="147c1-195">There are two things that you should notice about the updated view in Listing 2.</span></span> <span data-ttu-id="147c1-196">En primer lugar, tenga en cuenta que todo el contenido movido parte se reemplaza con una llamada a Html.RenderPartial().</span><span class="sxs-lookup"><span data-stu-id="147c1-196">First, notice that all of the content moved into the partial is replaced with a call to Html.RenderPartial().</span></span> <span data-ttu-id="147c1-197">Se llama al método de Html.RenderPartial() cuando se solicita la vista de índice por primera vez con el fin de mostrar el conjunto inicial de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-197">The Html.RenderPartial() method is called when the Index view is first requested in order to display the initial set of contacts.</span></span>

<span data-ttu-id="147c1-198">En segundo lugar, tenga en cuenta que se ha reemplazado el Html.ActionLink() utilizado para mostrar los grupos de contactos con un Ajax.ActionLink().</span><span class="sxs-lookup"><span data-stu-id="147c1-198">Second, notice that the Html.ActionLink() used to display contact groups has been replaced with an Ajax.ActionLink().</span></span> <span data-ttu-id="147c1-199">Se llama a la Ajax.ActionLink() con los parámetros siguientes:</span><span class="sxs-lookup"><span data-stu-id="147c1-199">The Ajax.ActionLink() is called with the following parameters:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample4.aspx)]

<span data-ttu-id="147c1-200">El primer parámetro representa el texto que se mostrará para el vínculo, el segundo parámetro representa los valores de ruta y el tercer parámetro representa las opciones de Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-200">The first parameter represents the text to display for the link, the second parameter represents the route values, and the third parameter represents the Ajax options.</span></span> <span data-ttu-id="147c1-201">En este caso, usamos la opción de UpdateTargetId Ajax para que apunte a HTML &lt;div&gt; etiqueta que se va a actualizar una vez finalizada la solicitud de Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-201">In this case, we use the UpdateTargetId Ajax option to point to the HTML &lt;div&gt; tag that we want to update after the Ajax request completes.</span></span> <span data-ttu-id="147c1-202">Desea actualizar el &lt;div&gt; etiqueta con la nueva lista de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-202">We want to update the &lt;div&gt; tag with the new list of contacts.</span></span>

<span data-ttu-id="147c1-203">El método de Index() actualizado del controlador de contacto está contenido en el listado 3.</span><span class="sxs-lookup"><span data-stu-id="147c1-203">The updated Index() method of the Contact controller is contained in Listing 3.</span></span>

<span data-ttu-id="147c1-204">**El listado 3 - Controllers\ContactController.cs (método de Index)**</span><span class="sxs-lookup"><span data-stu-id="147c1-204">**Listing 3 - Controllers\ContactController.cs (Index method)**</span></span>

[!code-csharp[Main](iteration-7-add-ajax-functionality-cs/samples/sample5.cs)]

<span data-ttu-id="147c1-205">La acción actualizada de Index() condicionalmente devuelve uno de dos cosas.</span><span class="sxs-lookup"><span data-stu-id="147c1-205">The updated Index() action conditionally returns one of two things.</span></span> <span data-ttu-id="147c1-206">Si se invoca la acción de Index() mediante una solicitud Ajax, a continuación, el controlador devuelve un parcial.</span><span class="sxs-lookup"><span data-stu-id="147c1-206">If the Index() action is invoked by an Ajax request then the controller returns a partial.</span></span> <span data-ttu-id="147c1-207">En caso contrario, la acción de Index() devuelve una vista completa.</span><span class="sxs-lookup"><span data-stu-id="147c1-207">Otherwise, the Index() action returns an entire view.</span></span>

<span data-ttu-id="147c1-208">Tenga en cuenta que la acción de Index() no es necesario devolver todos los datos cuando se invoca mediante una solicitud Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-208">Notice that the Index() action does not need to return as much data when invoked by an Ajax request.</span></span> <span data-ttu-id="147c1-209">En el contexto de una solicitud normal, la acción del índice devuelve una lista de todos los grupos de contactos y el grupo de contactos seleccionado.</span><span class="sxs-lookup"><span data-stu-id="147c1-209">In the context of a normal request, the Index action returns a list of all of the contact groups and the selected contact group.</span></span> <span data-ttu-id="147c1-210">En el contexto de una solicitud Ajax, la acción de Index() devuelve solo el grupo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="147c1-210">In the context of an Ajax request, the Index() action returns only the selected group.</span></span> <span data-ttu-id="147c1-211">AJAX significa menos trabajo en el servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="147c1-211">Ajax means less work on your database server.</span></span>

<span data-ttu-id="147c1-212">La vista de índice modificada funciona en el caso de los exploradores de nivel superior y de nivel inferior.</span><span class="sxs-lookup"><span data-stu-id="147c1-212">Our modified Index view works in the case of both uplevel and downlevel browsers.</span></span> <span data-ttu-id="147c1-213">Si hace clic en un grupo de contactos y el explorador admite JavaScript, se actualiza únicamente la región de la vista que contiene la lista de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-213">If you click a contact group, and your browser supports JavaScript, then only the region of the view that contains the list of contacts is updated.</span></span> <span data-ttu-id="147c1-214">Si, por otro lado, el explorador no admite JavaScript, se actualiza toda la vista.</span><span class="sxs-lookup"><span data-stu-id="147c1-214">If, on the other hand, your browser does not support JavaScript, then the entire view is updated.</span></span>


<span data-ttu-id="147c1-215">La vista de índice actualizada tiene un problema.</span><span class="sxs-lookup"><span data-stu-id="147c1-215">Our updated Index view has one problem.</span></span> <span data-ttu-id="147c1-216">Al hacer clic en un grupo de contactos, no se resalta el grupo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="147c1-216">When you click a contact group, the selected group is not highlighted.</span></span> <span data-ttu-id="147c1-217">Dado que la lista de grupos se muestra fuera de la región que se actualiza durante una solicitud Ajax, no obtener resaltado el grupo adecuado.</span><span class="sxs-lookup"><span data-stu-id="147c1-217">Because the list of groups is displayed outside of the region that is updated during an Ajax request, the right group does not get highlighted.</span></span> <span data-ttu-id="147c1-218">Este problema se corregirá en la siguiente sección.</span><span class="sxs-lookup"><span data-stu-id="147c1-218">We'll fix this issue in the next section.</span></span>


## <a name="adding-jquery-animation-effects"></a><span data-ttu-id="147c1-219">Agregar efectos de animación de jQuery</span><span class="sxs-lookup"><span data-stu-id="147c1-219">Adding jQuery Animation Effects</span></span>

<span data-ttu-id="147c1-220">Normalmente, al hacer clic en un vínculo en una página web, puede usar la barra de progreso del explorador para detectar si el explorador está obteniendo activamente el contenido actualizado.</span><span class="sxs-lookup"><span data-stu-id="147c1-220">Normally, when you click a link in a web page, you can use the browser progress bar to detect whether or not the browser is actively fetching the updated content.</span></span> <span data-ttu-id="147c1-221">Al realizar una solicitud Ajax, por otro lado, la barra de progreso de explorador no muestra ningún progreso.</span><span class="sxs-lookup"><span data-stu-id="147c1-221">When performing an Ajax request, on the other hand, the browser progress bar does not show any progress.</span></span> <span data-ttu-id="147c1-222">Esto puede hacer que los usuarios nervioso.</span><span class="sxs-lookup"><span data-stu-id="147c1-222">This can make users nervous.</span></span> <span data-ttu-id="147c1-223">¿Cómo sé si el explorador ha inmovilizado?</span><span class="sxs-lookup"><span data-stu-id="147c1-223">How do you know whether the browser has frozen?</span></span>

<span data-ttu-id="147c1-224">Hay varias maneras que puede indicar a un usuario que se está realizando trabajo mientras se realiza una solicitud Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-224">There are several ways that you can indicate to a user that work is being performed while performing an Ajax request.</span></span> <span data-ttu-id="147c1-225">Un enfoque consiste en mostrar una animación sencilla.</span><span class="sxs-lookup"><span data-stu-id="147c1-225">One approach is to display a simple animation.</span></span> <span data-ttu-id="147c1-226">Por ejemplo, puede hacer desaparecer una región cuando una solicitud Ajax comienza y atenuación de la región cuando se completa la solicitud.</span><span class="sxs-lookup"><span data-stu-id="147c1-226">For example, you can fade out a region when an Ajax request begins and fade in the region when the request completes.</span></span>

<span data-ttu-id="147c1-227">Vamos a usar la biblioteca de jQuery que se incluye con el marco de MVC de ASP.NET de Microsoft, para crear los efectos de animación.</span><span class="sxs-lookup"><span data-stu-id="147c1-227">We'll use the jQuery library which is included with the Microsoft ASP.NET MVC framework, to create the animation effects.</span></span> <span data-ttu-id="147c1-228">La vista de índice actualizada se incluye en el listado 4.</span><span class="sxs-lookup"><span data-stu-id="147c1-228">The updated Index view is contained in Listing 4.</span></span>

<span data-ttu-id="147c1-229">**Listado 4 - Views\Contact\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="147c1-229">**Listing 4 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample6.aspx)]

<span data-ttu-id="147c1-230">Observe que la vista de índice actualizada contiene tres nuevas funciones de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="147c1-230">Notice that the updated Index view contains three new JavaScript functions.</span></span> <span data-ttu-id="147c1-231">Las dos primeras funciones usan jQuery para atenuar y atenuación en la lista de contactos al hacer clic en un nuevo grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-231">The first two functions use jQuery to fade out and fade in the list of contacts when you click a new contact group.</span></span> <span data-ttu-id="147c1-232">La tercera función muestra un mensaje de error cuando se produzca una solicitud de Ajax en un error (por ejemplo, tiempo de espera de red).</span><span class="sxs-lookup"><span data-stu-id="147c1-232">The third function displays an error message when an Ajax request results in an error (for example, network timeout).</span></span>

<span data-ttu-id="147c1-233">La primera función también se encarga de resaltado el grupo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="147c1-233">The first function also takes care of highlighting the selected group.</span></span> <span data-ttu-id="147c1-234">Una clase = atributo seleccionado se agrega al elemento primario (el elemento LI) del elemento que se hizo clic.</span><span class="sxs-lookup"><span data-stu-id="147c1-234">A class= selected attribute is added to the parent element (the LI element) of the element clicked.</span></span> <span data-ttu-id="147c1-235">Una vez más, jQuery facilita seleccionar el elemento correcto y agregar la clase CSS.</span><span class="sxs-lookup"><span data-stu-id="147c1-235">Again, jQuery makes it easy to select the right element and add the CSS class.</span></span>

<span data-ttu-id="147c1-236">Estas secuencias de comandos están asociados a los vínculos de grupo con la Ayuda del parámetro Ajax.ActionLink() AjaxOptions.</span><span class="sxs-lookup"><span data-stu-id="147c1-236">These scripts are tied to the group links with the help of the Ajax.ActionLink() AjaxOptions parameter.</span></span> <span data-ttu-id="147c1-237">La llamada al método de actualizada Ajax.ActionLink() tiene el siguiente aspecto:</span><span class="sxs-lookup"><span data-stu-id="147c1-237">The updated Ajax.ActionLink() method call looks like this:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample7.aspx)]

## <a name="adding-browser-history-support"></a><span data-ttu-id="147c1-238">Agregar compatibilidad con exploradores de historial</span><span class="sxs-lookup"><span data-stu-id="147c1-238">Adding Browser History Support</span></span>

<span data-ttu-id="147c1-239">Normalmente, al hacer clic en un vínculo para actualizar una página, se actualiza el historial del explorador.</span><span class="sxs-lookup"><span data-stu-id="147c1-239">Normally, when you click a link to update a page, your browser history is updated.</span></span> <span data-ttu-id="147c1-240">De este modo, puede hacer clic en el botón Atrás del explorador para retroceder en el tiempo a su estado anterior de la página.</span><span class="sxs-lookup"><span data-stu-id="147c1-240">That way, you can click the browser Back button to move back in time to the previous state of the page.</span></span> <span data-ttu-id="147c1-241">Por ejemplo, si hace clic en el grupo de contactos de sus amigos y, a continuación, haga clic en el grupo de contactos de negocios, hacer clic en el botón Atrás del explorador para navegar al estado de la página cuando se selecciona el grupo de contactos de sus amigos.</span><span class="sxs-lookup"><span data-stu-id="147c1-241">For example, if you click the Friends contact group and then click the Business contact group, you can click the browser Back button to navigate back to the state of the page when the Friends contact group was selected.</span></span>

<span data-ttu-id="147c1-242">Por desgracia, realizar una solicitud Ajax no actualizar historial del explorador automáticamente.</span><span class="sxs-lookup"><span data-stu-id="147c1-242">Unfortunately, performing an Ajax request does not update browser history automatically.</span></span> <span data-ttu-id="147c1-243">Si hace clic en un grupo de contactos y se recupera la lista de contactos de búsqueda de coincidencias con una solicitud Ajax, no se actualiza el historial del explorador.</span><span class="sxs-lookup"><span data-stu-id="147c1-243">If you click a contact group, and the list of matching contacts is retrieved with an Ajax request, then the browser history is not updated.</span></span> <span data-ttu-id="147c1-244">No se puede usar el botón Atrás del explorador para volver a un grupo de contactos después de seleccionar un nuevo grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-244">You cannot use the browser Back button to navigate back to a contact group after selecting a new contact group.</span></span>

<span data-ttu-id="147c1-245">Si desea que los usuarios puedan usar el Explorador de nuevo botón después de realizar las solicitudes Ajax que necesita realizar un poco más trabajo.</span><span class="sxs-lookup"><span data-stu-id="147c1-245">If you want users to be able to use the browser Back button after performing Ajax requests then you need to perform a little more work.</span></span> <span data-ttu-id="147c1-246">Necesario aprovechar la funcionalidad de administración del historial de explorador integrada en el marco de AJAX de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="147c1-246">You need to take advantage of the browser history management functionality built in the ASP.NET AJAX Framework.</span></span>

<span data-ttu-id="147c1-247">Historial de exploración de AJAX de ASP.NET, debe hacer tres cosas:</span><span class="sxs-lookup"><span data-stu-id="147c1-247">ASP.NET AJAX browser history, you need to do three things:</span></span>

1. <span data-ttu-id="147c1-248">Habilitar el historial de exploración estableciendo la propiedad enableBrowserHistory en true.</span><span class="sxs-lookup"><span data-stu-id="147c1-248">Enable Browser History by setting the enableBrowserHistory property to true.</span></span>
2. <span data-ttu-id="147c1-249">Guarde los puntos del historial cuando cambia el estado de una vista llamando al método addHistoryPoint().</span><span class="sxs-lookup"><span data-stu-id="147c1-249">Save history points when the state of a view changes by calling the addHistoryPoint() method.</span></span>
3. <span data-ttu-id="147c1-250">Reconstruir el estado de la vista cuando se produce el evento navigate.</span><span class="sxs-lookup"><span data-stu-id="147c1-250">Reconstruct the state of the view when the navigate event is raised.</span></span>

<span data-ttu-id="147c1-251">La vista de índice actualizada se incluye en el listado 5.</span><span class="sxs-lookup"><span data-stu-id="147c1-251">The updated Index view is contained in Listing 5.</span></span>

<span data-ttu-id="147c1-252">**Listado 5 - Views\Contact\Index.aspx**</span><span class="sxs-lookup"><span data-stu-id="147c1-252">**Listing 5 - Views\Contact\Index.aspx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample8.aspx)]

<span data-ttu-id="147c1-253">En el listado 5, historial de exploración está habilitado en la función pageInit().</span><span class="sxs-lookup"><span data-stu-id="147c1-253">In Listing 5, Browser History is enabled in the pageInit() function.</span></span> <span data-ttu-id="147c1-254">La función pageInit() también se utiliza para configurar el controlador de eventos para el evento navigate.</span><span class="sxs-lookup"><span data-stu-id="147c1-254">The pageInit() function is also used to set up the event handler for the navigate event.</span></span> <span data-ttu-id="147c1-255">Se produce el evento navigate cada vez que hace que el estado de la página para cambiar el explorador al día o el botón Atrás.</span><span class="sxs-lookup"><span data-stu-id="147c1-255">The navigate event is raised whenever the browser Forward or Back button causes the state of the page to change.</span></span>

<span data-ttu-id="147c1-256">Se llama al método de beginContactList() al hacer clic en un grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-256">The beginContactList() method is called when you click a contact group.</span></span> <span data-ttu-id="147c1-257">Este método crea un nuevo punto del historial llamando al método addHistoryPoint().</span><span class="sxs-lookup"><span data-stu-id="147c1-257">This method creates a new history point by calling the addHistoryPoint() method.</span></span> <span data-ttu-id="147c1-258">El identificador de hacer clic en el grupo de contactos se agrega al historial.</span><span class="sxs-lookup"><span data-stu-id="147c1-258">The id of the contact group clicked is added to history.</span></span>

<span data-ttu-id="147c1-259">El identificador de grupo se recupera de un atributo expando en el vínculo del grupo de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-259">The group id is retrieved from an expando attribute on the contact group link.</span></span> <span data-ttu-id="147c1-260">El vínculo se representa con la siguiente llamada a Ajax.ActionLink().</span><span class="sxs-lookup"><span data-stu-id="147c1-260">The link is rendered with the following call to Ajax.ActionLink().</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample9.aspx)]

<span data-ttu-id="147c1-261">El último parámetro pasado a la Ajax.ActionLink() agrega un atributo expando denominado Id. de grupo para el vínculo (minúscula para la compatibilidad XHTML).</span><span class="sxs-lookup"><span data-stu-id="147c1-261">The last parameter passed to the Ajax.ActionLink() adds an expando attribute named groupid to the link (lowercase for XHTML compatibility).</span></span>

<span data-ttu-id="147c1-262">Cuando un usuario presiona el botón hacia delante o Atrás del explorador, se produce el evento navigate y se llama al método navigate().</span><span class="sxs-lookup"><span data-stu-id="147c1-262">When a user hits the browser Back or Forward button, the navigate event is raised and the navigate() method is called.</span></span> <span data-ttu-id="147c1-263">Este método actualiza los contactos que se muestran en la página para que coincida con el estado de la página que se corresponde con el punto del historial de explorador pasado al método navigate.</span><span class="sxs-lookup"><span data-stu-id="147c1-263">This method updates the contacts displayed in the page to match the state of the page that corresponds to the browser history point passed to the navigate method.</span></span>

## <a name="performing-ajax-deletes"></a><span data-ttu-id="147c1-264">Realización de Ajax elimina</span><span class="sxs-lookup"><span data-stu-id="147c1-264">Performing Ajax Deletes</span></span>

<span data-ttu-id="147c1-265">Actualmente, con el fin de eliminar un contacto, debe hacer clic en el vínculo Eliminar y, a continuación, haga clic en el botón Eliminar muestra en la página de confirmación de eliminación (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="147c1-265">Currently, in order to delete a contact, you need to click on the Delete link and then click the Delete button displayed in the delete confirmation page (see Figure 2).</span></span> <span data-ttu-id="147c1-266">Esto parece ser una gran cantidad de solicitudes de página en algo tan simple como eliminar un registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="147c1-266">This seems like a lot of page requests to do something simple like deleting a database record.</span></span>


<span data-ttu-id="147c1-267">[![La página de confirmación de eliminación](iteration-7-add-ajax-functionality-cs/_static/image2.jpg)](iteration-7-add-ajax-functionality-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="147c1-267">[![The delete confirmation page](iteration-7-add-ajax-functionality-cs/_static/image2.jpg)](iteration-7-add-ajax-functionality-cs/_static/image3.png)</span></span>

<span data-ttu-id="147c1-268">**Figura 02**: la página de confirmación de eliminación ([haga clic aquí para ver la imagen a tamaño completo](iteration-7-add-ajax-functionality-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="147c1-268">**Figure 02**: The delete confirmation page([Click to view full-size image](iteration-7-add-ajax-functionality-cs/_static/image4.png))</span></span>


<span data-ttu-id="147c1-269">Es tentador para omitir la página de confirmación de eliminación y eliminar un contacto directamente desde la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="147c1-269">It is tempting to skip the delete confirmation page and delete a contact directly from the Index view.</span></span> <span data-ttu-id="147c1-270">Debe evitar la tentación porque este enfoque abre la aplicación a vulnerabilidades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="147c1-270">You should avoid this temptation because taking this approach opens your application to security holes.</span></span> <span data-ttu-id="147c1-271">En general, don t desee realizar una operación GET de HTTP al invocar una acción que modifica el estado de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="147c1-271">In general, you don t want to perform an HTTP GET operation when invoking an action that modifies the state of your web application.</span></span> <span data-ttu-id="147c1-272">Al realizar una eliminación, desea realizar una solicitud HTTP POST o, mejor aún, una operación DELETE de HTTP.</span><span class="sxs-lookup"><span data-stu-id="147c1-272">When performing a delete, you want to perform an HTTP POST, or better yet, an HTTP DELETE operation.</span></span>

<span data-ttu-id="147c1-273">El vínculo Eliminar está contenido en el ContactList parcial.</span><span class="sxs-lookup"><span data-stu-id="147c1-273">The Delete link is contained in the ContactList partial.</span></span> <span data-ttu-id="147c1-274">Una versión actualizada de la ContactList parcial se encuentra en el listado 6.</span><span class="sxs-lookup"><span data-stu-id="147c1-274">An updated version of the ContactList partial is contained in Listing 6.</span></span>

<span data-ttu-id="147c1-275">**Listado 6 - Views\Contact\ContactList.ascx**</span><span class="sxs-lookup"><span data-stu-id="147c1-275">**Listing 6 - Views\Contact\ContactList.ascx**</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample10.aspx)]

<span data-ttu-id="147c1-276">El vínculo Eliminar se representa con la siguiente llamada al método Ajax.ImageActionLink():</span><span class="sxs-lookup"><span data-stu-id="147c1-276">The Delete link is rendered with the following call to the Ajax.ImageActionLink() method:</span></span>

[!code-aspx[Main](iteration-7-add-ajax-functionality-cs/samples/sample11.aspx)]

> [!NOTE] 
> 
> <span data-ttu-id="147c1-277">El Ajax.ImageActionLink() no es una parte estándar del marco de MVC de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="147c1-277">The Ajax.ImageActionLink() is not a standard part of the ASP.NET MVC framework.</span></span> <span data-ttu-id="147c1-278">El Ajax.ImageActionLink() es un métodos de aplicación auxiliar personalizada incluidos en el proyecto póngase en contacto con el administrador.</span><span class="sxs-lookup"><span data-stu-id="147c1-278">The Ajax.ImageActionLink() is a custom helper methods included in the Contact Manager project.</span></span>


<span data-ttu-id="147c1-279">El parámetro AjaxOptions tiene dos propiedades.</span><span class="sxs-lookup"><span data-stu-id="147c1-279">The AjaxOptions parameter has two properties.</span></span> <span data-ttu-id="147c1-280">En primer lugar, la propiedad confirmar se utiliza para mostrar un cuadro de diálogo de confirmación emergente JavaScript.</span><span class="sxs-lookup"><span data-stu-id="147c1-280">First, the Confirm property is used to display a popup JavaScript confirmation dialog.</span></span> <span data-ttu-id="147c1-281">En segundo lugar, la propiedad HttpMethod se usa para realizar una operación DELETE de HTTP.</span><span class="sxs-lookup"><span data-stu-id="147c1-281">Second, the HttpMethod property is used to perform an HTTP DELETE operation.</span></span>

<span data-ttu-id="147c1-282">Listado 7 contiene una nueva acción de AjaxDelete() que se ha agregado al controlador de contacto.</span><span class="sxs-lookup"><span data-stu-id="147c1-282">Listing 7 contains a new AjaxDelete() action that has been added to the Contact controller.</span></span>

<span data-ttu-id="147c1-283">**Listado 7 - Controllers\ContactController.cs (AjaxDelete)**</span><span class="sxs-lookup"><span data-stu-id="147c1-283">**Listing 7 - Controllers\ContactController.cs (AjaxDelete)**</span></span>

[!code-csharp[Main](iteration-7-add-ajax-functionality-cs/samples/sample12.cs)]

<span data-ttu-id="147c1-284">La acción AjaxDelete() se decora con un atributo AcceptVerbs.</span><span class="sxs-lookup"><span data-stu-id="147c1-284">The AjaxDelete() action is decorated with an AcceptVerbs attribute.</span></span> <span data-ttu-id="147c1-285">Este atributo se evita que la acción que invoca excepto cualquier operación de HTTP que no sea una operación DELETE de HTTP.</span><span class="sxs-lookup"><span data-stu-id="147c1-285">This attribute prevents the action from being invoked except by any HTTP operation other than an HTTP DELETE operation.</span></span> <span data-ttu-id="147c1-286">En concreto, no se puede invocar esta acción con una solicitud HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="147c1-286">In particular, you cannot invoke this action with an HTTP GET.</span></span>

<span data-ttu-id="147c1-287">Después de eliminar el registro de base de datos, debe ver una lista actualizada de contactos que no contiene el registro eliminado.</span><span class="sxs-lookup"><span data-stu-id="147c1-287">After you delete database record, you need to display the updated list of contacts that does not contain the deleted record.</span></span> <span data-ttu-id="147c1-288">El método AjaxDelete() devuelve el ContactList parcial y la lista actualizada de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-288">The AjaxDelete() method returns the ContactList partial and the updated list of contacts.</span></span>

## <a name="summary"></a><span data-ttu-id="147c1-289">Resumen</span><span class="sxs-lookup"><span data-stu-id="147c1-289">Summary</span></span>

<span data-ttu-id="147c1-290">En esta iteración, hemos agregado la funcionalidad de Ajax a nuestra aplicación póngase en contacto con el administrador.</span><span class="sxs-lookup"><span data-stu-id="147c1-290">In this iteration, we added Ajax functionality to our Contact Manager application.</span></span> <span data-ttu-id="147c1-291">Se usa Ajax para mejorar la capacidad de respuesta y el rendimiento de nuestra aplicación.</span><span class="sxs-lookup"><span data-stu-id="147c1-291">We used Ajax to improve the responsiveness and performance of our application.</span></span>

<span data-ttu-id="147c1-292">En primer lugar, hemos vuelto a diseñar la vista de índice para que al hacer clic en un grupo de contactos no se actualiza toda la vista.</span><span class="sxs-lookup"><span data-stu-id="147c1-292">First, we refactored the Index view so that clicking a contact group does not update the entire view.</span></span> <span data-ttu-id="147c1-293">En su lugar, si se hace clic en un grupo de contactos, sólo se actualiza la lista de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-293">Instead, clicking a contact group only updates the list of contacts.</span></span>

<span data-ttu-id="147c1-294">A continuación, se usan efectos de animación de jQuery fundido de salida y atenuación en la lista de contactos.</span><span class="sxs-lookup"><span data-stu-id="147c1-294">Next, we used jQuery animation effects to fade out and fade in the list of contacts.</span></span> <span data-ttu-id="147c1-295">Agregar animación a una aplicación Ajax puede utilizarse para proporcionar a los usuarios de la aplicación con el equivalente de una barra de progreso del explorador.</span><span class="sxs-lookup"><span data-stu-id="147c1-295">Adding animation to an Ajax application can be used to provide users of the application with the equivalent of a browser progress bar.</span></span>

<span data-ttu-id="147c1-296">También hemos agregado compatibilidad con exploradores de historial a nuestra aplicación de Ajax.</span><span class="sxs-lookup"><span data-stu-id="147c1-296">We also added browser history support to our Ajax application.</span></span> <span data-ttu-id="147c1-297">Se habilita a los usuarios hacer clic en Atrás del explorador y reenviar botones para cambiar el estado de la vista de índice.</span><span class="sxs-lookup"><span data-stu-id="147c1-297">We enabled users to click the browser Back and Forward buttons to change the state of the Index view.</span></span>

<span data-ttu-id="147c1-298">Por último, hemos creado un vínculo de eliminación que admite operaciones HTTP DELETE.</span><span class="sxs-lookup"><span data-stu-id="147c1-298">Finally, we created a delete link that supports HTTP DELETE operations.</span></span> <span data-ttu-id="147c1-299">Si realiza eliminaciones de Ajax, se permiten a los usuarios eliminar registros de base de datos sin solicitar al usuario solicitar una página de confirmación de eliminación adicionales.</span><span class="sxs-lookup"><span data-stu-id="147c1-299">By performing Ajax deletes, we enable users to delete database records without requiring the user to request an additional delete confirmation page.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="147c1-300">[Anterior](iteration-6-use-test-driven-development-cs.md)
> [Siguiente](iteration-1-create-the-application-vb.md)</span><span class="sxs-lookup"><span data-stu-id="147c1-300">[Previous](iteration-6-use-test-driven-development-cs.md)
[Next](iteration-1-create-the-application-vb.md)</span></span>
