---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-5
title: 'Parte 5: Editar formularios y plantillas | Documentos de Microsoft'
author: jongalloway
description: Esta serie de tutoriales detalla todos los pasos realizados para compilar la aplicación de ejemplo de la tienda de música de MVC de ASP.NET. Parte 5 cubre editar formularios y plantillas.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/21/2011
ms.topic: article
ms.assetid: 6b09413a-6d6a-425a-87c9-629f91b91b28
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-5
msc.type: authoredcontent
ms.openlocfilehash: d584e614b5a4124044cd9decd2272192ca164643
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
---
<a name="part-5-edit-forms-and-templating"></a><span data-ttu-id="21ab7-104">Parte 5: Editar formularios y plantillas</span><span class="sxs-lookup"><span data-stu-id="21ab7-104">Part 5: Edit Forms and Templating</span></span>
====================
<span data-ttu-id="21ab7-105">por [Jon Galloway](https://github.com/jongalloway)</span><span class="sxs-lookup"><span data-stu-id="21ab7-105">by [Jon Galloway](https://github.com/jongalloway)</span></span>

> <span data-ttu-id="21ab7-106">La tienda de música de MVC es una aplicación de tutorial que presenta y explica paso a paso cómo usar ASP.NET MVC y Visual Studio para el desarrollo web.</span><span class="sxs-lookup"><span data-stu-id="21ab7-106">The MVC Music Store is a tutorial application that introduces and explains step-by-step how to use ASP.NET MVC and Visual Studio for web development.</span></span>  
>   
> <span data-ttu-id="21ab7-107">La tienda de música de MVC es una implementación de almacén de ejemplo ligera que vende álbumes de música en línea e implementa administración básica del sitio, en el inicio de sesión de usuario y la funcionalidad del carro de la compra.</span><span class="sxs-lookup"><span data-stu-id="21ab7-107">The MVC Music Store is a lightweight sample store implementation which sells music albums online, and implements basic site administration, user sign-in, and shopping cart functionality.</span></span>
> 
> <span data-ttu-id="21ab7-108">Esta serie de tutoriales detalla todos los pasos realizados para compilar la aplicación de ejemplo de la tienda de música de MVC de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="21ab7-108">This tutorial series details all of the steps taken to build the ASP.NET MVC Music Store sample application.</span></span> <span data-ttu-id="21ab7-109">Parte 5 cubre editar formularios y plantillas.</span><span class="sxs-lookup"><span data-stu-id="21ab7-109">Part 5 covers Edit Forms and Templating.</span></span>


<span data-ttu-id="21ab7-110">En el capítulo anterior, se nos ha cargar datos de nuestra base de datos y mostrarlos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-110">In the past chapter, we were loading data from our database and displaying it.</span></span> <span data-ttu-id="21ab7-111">En este capítulo, se le permiten modificar los datos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-111">In this chapter, we'll also enable editing the data.</span></span>

## <a name="creating-the-storemanagercontroller"></a><span data-ttu-id="21ab7-112">Crear el StoreManagerController</span><span class="sxs-lookup"><span data-stu-id="21ab7-112">Creating the StoreManagerController</span></span>

<span data-ttu-id="21ab7-113">Comenzaremos creando un nuevo controlador denominado **StoreManagerController**.</span><span class="sxs-lookup"><span data-stu-id="21ab7-113">We'll begin by creating a new controller called **StoreManagerController**.</span></span> <span data-ttu-id="21ab7-114">Para este controlador, se puede sacar partido de las las características de Scaffolding disponibles en ASP.NET MVC 3 Tools Update.</span><span class="sxs-lookup"><span data-stu-id="21ab7-114">For this controller, we will be taking advantage of the Scaffolding features available in the ASP.NET MVC 3 Tools Update.</span></span> <span data-ttu-id="21ab7-115">Establecer las opciones para el cuadro de diálogo Agregar controlador tal y como se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="21ab7-115">Set the options for the Add Controller dialog as shown below.</span></span>

![](mvc-music-store-part-5/_static/image1.png)

<span data-ttu-id="21ab7-116">Al hacer clic en el botón Agregar, verá que el mecanismo de scaffolding de ASP.NET MVC 3 realiza una gran cantidad de trabajo automáticamente:</span><span class="sxs-lookup"><span data-stu-id="21ab7-116">When you click the Add button, you'll see that the ASP.NET MVC 3 scaffolding mechanism does a good amount of work for you:</span></span>

- <span data-ttu-id="21ab7-117">Crea el nuevo StoreManagerController con una variable local de Entity Framework</span><span class="sxs-lookup"><span data-stu-id="21ab7-117">It creates the new StoreManagerController with a local Entity Framework variable</span></span>
- <span data-ttu-id="21ab7-118">Agrega una carpeta StoreManager a la carpeta del proyecto vistas</span><span class="sxs-lookup"><span data-stu-id="21ab7-118">It adds a StoreManager folder to the project's Views folder</span></span>
- <span data-ttu-id="21ab7-119">Agrega la vista Create.cshtml, Delete.cshtml, Details.cshtml, Edit.cshtml y Index.cshtml, establecimiento inflexible de tipos a la clase de álbum</span><span class="sxs-lookup"><span data-stu-id="21ab7-119">It adds Create.cshtml, Delete.cshtml, Details.cshtml, Edit.cshtml, and Index.cshtml view, strongly typed to the Album class</span></span>

![](mvc-music-store-part-5/_static/image2.png)

<span data-ttu-id="21ab7-120">La nueva clase de controlador de StoreManager incluye CRUD (crear, leer, actualizar y eliminar) acciones del controlador que saben cómo trabajar con el álbum, clase de modelo y usar nuestro contexto de Entity Framework para el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-120">The new StoreManager controller class includes CRUD (create, read, update, delete) controller actions which know how to work with the Album model class and use our Entity Framework context for database access.</span></span>

## <a name="modifying-a-scaffolded-view"></a><span data-ttu-id="21ab7-121">Modificación de una vista con scaffolding</span><span class="sxs-lookup"><span data-stu-id="21ab7-121">Modifying a Scaffolded View</span></span>

<span data-ttu-id="21ab7-122">Es importante recordar que, mientras que generó este código para que podamos, es código de MVC de ASP.NET estándar, tal como se ha estado escribiendo a lo largo de este tutorial.</span><span class="sxs-lookup"><span data-stu-id="21ab7-122">It's important to remember that, while this code was generated for us, it's standard ASP.NET MVC code, just like we've been writing throughout this tutorial.</span></span> <span data-ttu-id="21ab7-123">Se ha diseñado para ahorrar el tiempo que tardaría en hacerlo en escribir código repetitivo del controlador y la creación manual de las vistas fuertemente tipadas, pero esto no es del tipo de código generado es podrán que haya visto prologa con advertencias nefastas en comentarios acerca de cómo no debe cambiar el código.</span><span class="sxs-lookup"><span data-stu-id="21ab7-123">It's intended to save you the time you'd spend on writing boilerplate controller code and creating the strongly typed views manually, but this isn't the kind of generated code you may have seen prefaced with dire warnings in comments about how you mustn't change the code.</span></span> <span data-ttu-id="21ab7-124">Éste es el código y se espera que cambiarlo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-124">This is your code, and you're expected to change it.</span></span>

<span data-ttu-id="21ab7-125">Por lo tanto, puede empezar con una operación de edición a la vista de índice StoreManager rápida (/ Views/StoreManager/Index.cshtml).</span><span class="sxs-lookup"><span data-stu-id="21ab7-125">So, let's start with a quick edit to the StoreManager Index view (/Views/StoreManager/Index.cshtml).</span></span> <span data-ttu-id="21ab7-126">Esta vista muestra una tabla que enumera los álbumes en nuestra tienda edite / detalles / eliminar vínculos e incluye las propiedades públicas del álbum.</span><span class="sxs-lookup"><span data-stu-id="21ab7-126">This view will display a table which lists the Albums in our store with Edit / Details / Delete links, and includes the Album's public properties.</span></span> <span data-ttu-id="21ab7-127">Se quitará el campo AlbumArtUrl, ya que no es muy útil en esta presentación.</span><span class="sxs-lookup"><span data-stu-id="21ab7-127">We'll remove the AlbumArtUrl field, as it's not very useful in this display.</span></span> <span data-ttu-id="21ab7-128">En &lt;tabla&gt; sección del código de la vista, quite el &lt;th&gt; y &lt;td&gt; elementos que rodean las referencias de AlbumArtUrl, como se indica en las líneas resaltadas a continuación:</span><span class="sxs-lookup"><span data-stu-id="21ab7-128">In &lt;table&gt; section of the view code, remove the &lt;th&gt; and &lt;td&gt; elements surrounding AlbumArtUrl references, as indicated by the highlighted lines below:</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample1.cshtml)]

<span data-ttu-id="21ab7-129">El código de la vista modificada aparecerá como sigue:</span><span class="sxs-lookup"><span data-stu-id="21ab7-129">The modified view code will appear as follows:</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample2.cshtml)]

## <a name="a-first-look-at-the-store-manager"></a><span data-ttu-id="21ab7-130">Un primer vistazo a Store Manager</span><span class="sxs-lookup"><span data-stu-id="21ab7-130">A first look at the Store Manager</span></span>

<span data-ttu-id="21ab7-131">Ahora ejecute la aplicación y busque/StoreManager /.</span><span class="sxs-lookup"><span data-stu-id="21ab7-131">Now run the application and browse to /StoreManager/.</span></span> <span data-ttu-id="21ab7-132">Esto muestra el índice de administrador de almacén que modificamos, que muestra una lista de los álbumes en el almacén con vínculos para obtener más información, editar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-132">This displays the Store Manager Index we just modified, showing a list of the albums in the store with links to Edit, Details, and Delete.</span></span>

![](mvc-music-store-part-5/_static/image3.png)

<span data-ttu-id="21ab7-133">Al hacer clic en el vínculo de edición, se muestra un formulario con campos de edición para el álbum, incluida listas desplegables de género y el intérprete.</span><span class="sxs-lookup"><span data-stu-id="21ab7-133">Clicking the Edit link displays an edit form with fields for the Album, including dropdowns for Genre and Artist.</span></span>

![](mvc-music-store-part-5/_static/image4.png)

<span data-ttu-id="21ab7-134">Haga clic en el vínculo "Volver a la lista" en la parte inferior, a continuación, haga clic en el vínculo detalles de un álbum.</span><span class="sxs-lookup"><span data-stu-id="21ab7-134">Click the "Back to List" link at the bottom, then click on the Details link for an Album.</span></span> <span data-ttu-id="21ab7-135">Esto muestra la información de detalle de un álbum individual.</span><span class="sxs-lookup"><span data-stu-id="21ab7-135">This displays the detail information for an individual Album.</span></span>

![](mvc-music-store-part-5/_static/image5.png)

<span data-ttu-id="21ab7-136">De nuevo, haga clic en la parte posterior para el vínculo de la lista, a continuación, haga clic en un vínculo de eliminación.</span><span class="sxs-lookup"><span data-stu-id="21ab7-136">Again, click the Back to List link, then click on a Delete link.</span></span> <span data-ttu-id="21ab7-137">Esto muestra un cuadro de diálogo de confirmación, que muestra los detalles del álbum y le pregunta si se está seguro de que desea eliminarlo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-137">This displays a confirmation dialog, showing the album details and asking if we're sure we want to delete it.</span></span>

![](mvc-music-store-part-5/_static/image6.png)

<span data-ttu-id="21ab7-138">Haga clic en el botón Eliminar en la parte inferior eliminará el álbum y volver a la página de índice, que se muestra en el álbum eliminado.</span><span class="sxs-lookup"><span data-stu-id="21ab7-138">Clicking the Delete button at the bottom will delete the album and return you to the Index page, which shows the album deleted.</span></span>

<span data-ttu-id="21ab7-139">No terminamos con el administrador del almacén, pero tenemos que funciona el controlador y el código de la vista para las operaciones CRUD iniciar desde.</span><span class="sxs-lookup"><span data-stu-id="21ab7-139">We're not done with the Store Manager, but we have working controller and view code for the CRUD operations to start from.</span></span>

## <a name="looking-at-the-store-manager-controller-code"></a><span data-ttu-id="21ab7-140">Examinando el código de controlador de administrador de almacén</span><span class="sxs-lookup"><span data-stu-id="21ab7-140">Looking at the Store Manager Controller code</span></span>

<span data-ttu-id="21ab7-141">El controlador de administrador de almacén contiene una gran cantidad de código.</span><span class="sxs-lookup"><span data-stu-id="21ab7-141">The Store Manager Controller contains a good amount of code.</span></span> <span data-ttu-id="21ab7-142">Analicemos esto de arriba a abajo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-142">Let's go through this from top to bottom.</span></span> <span data-ttu-id="21ab7-143">El controlador incluye algunos espacios de nombres estándar para un controlador MVC, así como una referencia a nuestro espacio de nombres de modelos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-143">The controller includes some standard namespaces for an MVC controller, as well as a reference to our Models namespace.</span></span> <span data-ttu-id="21ab7-144">El controlador tiene una instancia privada de MusicStoreEntities, utilizado por cada una de las acciones de controlador para el acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-144">The controller has a private instance of MusicStoreEntities, used by each of the controller actions for data access.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample3.cs)]

### <a name="store-manager-index-and-details-actions"></a><span data-ttu-id="21ab7-145">Almacenar acciones de administrador de índice y detalles</span><span class="sxs-lookup"><span data-stu-id="21ab7-145">Store Manager Index and Details actions</span></span>

<span data-ttu-id="21ab7-146">La vista de índice recupera una lista de álbumes, incluida la información que se hace referencia de género y el intérprete del cada álbum, tal y como hemos visto anteriormente cuando se trabaja en el método de examinar el almacén.</span><span class="sxs-lookup"><span data-stu-id="21ab7-146">The index view retrieves a list of Albums, including each album's referenced Genre and Artist information, as we previously saw when working on the Store Browse method.</span></span> <span data-ttu-id="21ab7-147">La vista de índice es posterior a las referencias a los objetos vinculados para que pueda mostrar cada álbum nombre género y el nombre del intérprete, por lo que el controlador está siendo eficaz y consultar esta información en la solicitud original.</span><span class="sxs-lookup"><span data-stu-id="21ab7-147">The Index view is following the references to the linked objects so that it can display each album's Genre name and Artist name, so the controller is being efficient and querying for this information in the original request.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample4.cs)]

<span data-ttu-id="21ab7-148">Acción de controlador de detalles del controlador StoreManager funciona exactamente igual que la acción de detalles del controlador de almacén indicamos previamente - consulta el álbum con el identificador mediante el método Find(), a continuación, lo devuelve a la vista.</span><span class="sxs-lookup"><span data-stu-id="21ab7-148">The StoreManager Controller's Details controller action works exactly the same as the Store Controller Details action we wrote previously - it queries for the Album by ID using the Find() method, then returns it to the view.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample5.cs)]

### <a name="the-create-action-methods"></a><span data-ttu-id="21ab7-149">El crear métodos de acción</span><span class="sxs-lookup"><span data-stu-id="21ab7-149">The Create Action Methods</span></span>

<span data-ttu-id="21ab7-150">Los métodos de acción de crear son un poco diferentes de los que hemos visto hasta ahora, ya que controlan una entrada de formulario.</span><span class="sxs-lookup"><span data-stu-id="21ab7-150">The Create action methods are a little different from ones we've seen so far, because they handle form input.</span></span> <span data-ttu-id="21ab7-151">Cuando un usuario visita por primera vez /StoreManager/crear / se mostrará un formulario vacío.</span><span class="sxs-lookup"><span data-stu-id="21ab7-151">When a user first visits /StoreManager/Create/ they will be shown an empty form.</span></span> <span data-ttu-id="21ab7-152">Esta página HTML contendrá un &lt;formulario&gt; elementos en el que pueden especificar los detalles del álbum de entrada del elemento que contiene la lista desplegable y cuadro de texto.</span><span class="sxs-lookup"><span data-stu-id="21ab7-152">This HTML page will contain a &lt;form&gt; element that contains dropdown and textbox input elements where they can enter the album's details.</span></span>

<span data-ttu-id="21ab7-153">Después de que el usuario rellena los valores de formulario de álbum, presione el botón "Guardar" para enviar que estos cambios de nuevo a nuestra aplicación para guardar en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-153">After the user fills in the Album form values, they can press the "Save" button to submit these changes back to our application to save within the database.</span></span> <span data-ttu-id="21ab7-154">Cuando el usuario presiona el botón "Guardar" el &lt;formulario&gt; realizará una solicitud HTTP POST a la dirección /StoreManager/crear/URL y enviar el &lt;formulario&gt; valores como parte de la publicación HTTP.</span><span class="sxs-lookup"><span data-stu-id="21ab7-154">When the user presses the "save" button the &lt;form&gt; will perform an HTTP-POST back to the /StoreManager/Create/ URL and submit the &lt;form&gt; values as part of the HTTP-POST.</span></span>

<span data-ttu-id="21ab7-155">ASP.NET MVC permite dividir fácilmente la lógica de los dos escenarios de invocación de dirección URL, por lo que nos permite implementar dos métodos de acción "Crear" independientes dentro de nuestra clase StoreManagerController: uno para controlar el HTTP-GET inicial, examine el /StoreManager/Create / URL y la otra para controlar el HTTP-POST de los cambios enviados.</span><span class="sxs-lookup"><span data-stu-id="21ab7-155">ASP.NET MVC allows us to easily split up the logic of these two URL invocation scenarios by enabling us to implement two separate "Create" action methods within our StoreManagerController class – one to handle the initial HTTP-GET browse to the /StoreManager/Create/ URL, and the other to handle the HTTP-POST of the submitted changes.</span></span>

### <a name="passing-information-to-a-view-using-viewbag"></a><span data-ttu-id="21ab7-156">Pasar información a una vista con ViewBag</span><span class="sxs-lookup"><span data-stu-id="21ab7-156">Passing information to a View using ViewBag</span></span>

<span data-ttu-id="21ab7-157">Se ha usado el elemento ViewBag anteriormente en este tutorial, pero aún no lo ha hablado mucho sobre él.</span><span class="sxs-lookup"><span data-stu-id="21ab7-157">We've used the ViewBag earlier in this tutorial, but haven't talked much about it.</span></span> <span data-ttu-id="21ab7-158">El elemento ViewBag nos permite pasar información a la vista sin usar un objeto de modelo fuertemente tipado.</span><span class="sxs-lookup"><span data-stu-id="21ab7-158">The ViewBag allows us to pass information to the view without using a strongly typed model object.</span></span> <span data-ttu-id="21ab7-159">En este caso, la acción del controlador HTTP-GET editar necesita pasar una lista de géneros y artistas al formulario para rellenar las listas desplegables y la manera más sencilla de hacerlo es devolverlos como elementos de elemento ViewBag.</span><span class="sxs-lookup"><span data-stu-id="21ab7-159">In this case, our Edit HTTP-GET controller action needs to pass both a list of Genres and Artists to the form to populate the dropdowns, and the simplest way to do that is to return them as ViewBag items.</span></span>

<span data-ttu-id="21ab7-160">El elemento ViewBag es un objeto dinámico, lo que significa que puede escribir ViewBag.Foo o ViewBag.YourNameHere sin tener que escribir código para definir las propiedades.</span><span class="sxs-lookup"><span data-stu-id="21ab7-160">The ViewBag is a dynamic object, meaning that you can type ViewBag.Foo or ViewBag.YourNameHere without writing code to define those properties.</span></span> <span data-ttu-id="21ab7-161">En este caso, el código del controlador utiliza ViewBag.GenreId y ViewBag.ArtistId para que los valores de lista desplegable que se envía con el formulario serán GenreId y ArtistId, que son las propiedades de álbum que va a establecer.</span><span class="sxs-lookup"><span data-stu-id="21ab7-161">In this case, the controller code uses ViewBag.GenreId and ViewBag.ArtistId so that the dropdown values submitted with the form will be GenreId and ArtistId, which are the Album properties they will be setting.</span></span>

<span data-ttu-id="21ab7-162">Estos valores de lista desplegable se devuelven al formulario utilizando el objeto SelectList, que se basa solo para ese fin.</span><span class="sxs-lookup"><span data-stu-id="21ab7-162">These dropdown values are returned to the form using the SelectList object, which is built just for that purpose.</span></span> <span data-ttu-id="21ab7-163">Esto se realiza mediante código similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="21ab7-163">This is done using code like this:</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample6.cs)]

<span data-ttu-id="21ab7-164">Como puede ver desde el código del método de acción, tres parámetros que se sirven para crear este objeto:</span><span class="sxs-lookup"><span data-stu-id="21ab7-164">As you can see from the action method code, three parameters are being used to create this object:</span></span>

- <span data-ttu-id="21ab7-165">La lista de elementos que se va a mostrar la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="21ab7-165">The list of items the dropdown will be displaying.</span></span> <span data-ttu-id="21ab7-166">Tenga en cuenta que esto no es una cadena, estamos pasando una lista de géneros.</span><span class="sxs-lookup"><span data-stu-id="21ab7-166">Note that this isn't just a string - we're passing a list of Genres.</span></span>
- <span data-ttu-id="21ab7-167">El siguiente parámetro que se pasan a la SelectList es el valor seleccionado.</span><span class="sxs-lookup"><span data-stu-id="21ab7-167">The next parameter being passed to the SelectList is the Selected Value.</span></span> <span data-ttu-id="21ab7-168">Este modo el SelectList sabe cómo previamente seleccione un elemento en la lista.</span><span class="sxs-lookup"><span data-stu-id="21ab7-168">This how the SelectList knows how to pre-select an item in the list.</span></span> <span data-ttu-id="21ab7-169">Esto será más fácil de entender, cuando se examina en el formulario de edición, que es muy similar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-169">This will be easier to understand when we look at the Edit form, which is pretty similar.</span></span>
- <span data-ttu-id="21ab7-170">El último parámetro es la propiedad que se mostrará.</span><span class="sxs-lookup"><span data-stu-id="21ab7-170">The final parameter is the property to be displayed.</span></span> <span data-ttu-id="21ab7-171">En este caso, esto es que indica que la propiedad Genre.Name es lo que se mostrará al usuario.</span><span class="sxs-lookup"><span data-stu-id="21ab7-171">In this case, this is indicating that the Genre.Name property is what will be shown to the user.</span></span>

<span data-ttu-id="21ab7-172">Teniendo esto en cuenta, a continuación, la acción Create HTTP-GET es bastante sencilla: dos SelectLists se agregan al elemento ViewBag y ningún objeto de modelo se pasa al formulario (ya que no se ha creado todavía).</span><span class="sxs-lookup"><span data-stu-id="21ab7-172">With that in mind, then, the HTTP-GET Create action is pretty simple - two SelectLists are added to the ViewBag, and no model object is passed to the form (since it hasn't been created yet).</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample7.cs)]

### <a name="html-helpers-to-display-the-drop-downs-in-the-create-view"></a><span data-ttu-id="21ab7-173">Aplicaciones auxiliares HTML para mostrar las exploraciones le Drop en Create View</span><span class="sxs-lookup"><span data-stu-id="21ab7-173">HTML Helpers to display the Drop Downs in the Create View</span></span>

<span data-ttu-id="21ab7-174">Puesto que hemos hablado acerca de cómo la lista desplegable de valores se pasan a la vista, echemos un vistazo rápido a la vista para ver cómo se muestran los valores.</span><span class="sxs-lookup"><span data-stu-id="21ab7-174">Since we've talked about how the drop down values are passed to the view, let's take a quick look at the view to see how those values are displayed.</span></span> <span data-ttu-id="21ab7-175">En el código de vista (/ Views/StoreManager/Create.cshtml), verá que se realiza la llamada siguiente para mostrar la lista de género hacia abajo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-175">In the view code (/Views/StoreManager/Create.cshtml), you'll see the following call is made to display the Genre drop down.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample8.cshtml)]

<span data-ttu-id="21ab7-176">Esto se conoce como una aplicación auxiliar de HTML: un método de utilidad que lleva a cabo una tarea común de la vista.</span><span class="sxs-lookup"><span data-stu-id="21ab7-176">This is known as an HTML Helper - a utility method which performs a common view task.</span></span> <span data-ttu-id="21ab7-177">Aplicaciones auxiliares HTML son muy útiles en la conservación de nuestro código vista concisas y legibles.</span><span class="sxs-lookup"><span data-stu-id="21ab7-177">HTML Helpers are very useful in keeping our view code concise and readable.</span></span> <span data-ttu-id="21ab7-178">ASP.NET MVC proporciona la aplicación auxiliar Html.DropDownList pero, como verá más adelante es posible crear nuestras propia aplicaciones auxiliares para el código de la vista que se podrá volver a usar en nuestra aplicación.</span><span class="sxs-lookup"><span data-stu-id="21ab7-178">The Html.DropDownList helper is provided by ASP.NET MVC, but as we'll see later it's possible to create our own helpers for view code we'll reuse in our application.</span></span>

<span data-ttu-id="21ab7-179">La llamada Html.DropDownList solo debe indicarse dos cosas: dónde conviene get de la lista para mostrar y qué valor (si existe) debe estar seleccionado previamente.</span><span class="sxs-lookup"><span data-stu-id="21ab7-179">The Html.DropDownList call just needs to be told two things - where to get the list to display, and what value (if any) should be pre-selected.</span></span> <span data-ttu-id="21ab7-180">El primer parámetro, GenreId, indica la DropDownList para buscar un valor denominado GenreId en el modelo o el elemento ViewBag.</span><span class="sxs-lookup"><span data-stu-id="21ab7-180">The first parameter, GenreId, tells the DropDownList to look for a value named GenreId in either the model or ViewBag.</span></span> <span data-ttu-id="21ab7-181">El segundo parámetro se utiliza para indicar el valor para mostrar como inicialmente se seleccionan en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="21ab7-181">The second parameter is used to indicate the value to show as initially selected in the drop down list.</span></span> <span data-ttu-id="21ab7-182">Puesto que este formulario es una forma de crear, no hay ningún valor para ser preseleccionadas y String.Empty se ha pasado.</span><span class="sxs-lookup"><span data-stu-id="21ab7-182">Since this form is a Create form, there's no value to be preselected and String.Empty is passed.</span></span>

### <a name="handling-the-posted-form-values"></a><span data-ttu-id="21ab7-183">Controlar los valores de formulario expuestos</span><span class="sxs-lookup"><span data-stu-id="21ab7-183">Handling the Posted Form values</span></span>

<span data-ttu-id="21ab7-184">Como se explicó antes, hay dos métodos de acción asociados con cada forma.</span><span class="sxs-lookup"><span data-stu-id="21ab7-184">As we discussed before, there are two action methods associated with each form.</span></span> <span data-ttu-id="21ab7-185">El primero controla la solicitud HTTP GET y muestra el formulario.</span><span class="sxs-lookup"><span data-stu-id="21ab7-185">The first handles the HTTP-GET request and displays the form.</span></span> <span data-ttu-id="21ab7-186">El segundo administra la solicitud HTTP-POST, que contiene los valores de formulario enviado.</span><span class="sxs-lookup"><span data-stu-id="21ab7-186">The second handles the HTTP-POST request, which contains the submitted form values.</span></span> <span data-ttu-id="21ab7-187">Tenga en cuenta que la acción de controlador tiene un atributo [HttpPost], que indica a ASP.NET MVC que solo debería responder a las solicitudes HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="21ab7-187">Notice that controller action has an [HttpPost] attribute, which tells ASP.NET MVC that it should only respond to HTTP-POST requests.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample9.cs)]

<span data-ttu-id="21ab7-188">Esta acción tiene cuatro responsabilidades:</span><span class="sxs-lookup"><span data-stu-id="21ab7-188">This action has four responsibilities:</span></span>

- 1. <span data-ttu-id="21ab7-189">Leer los valores de formulario</span><span class="sxs-lookup"><span data-stu-id="21ab7-189">Read the form values</span></span>
- 2. <span data-ttu-id="21ab7-190">Compruebe si los valores del formulario pasan cualquier regla de validación</span><span class="sxs-lookup"><span data-stu-id="21ab7-190">Check if the form values pass any validation rules</span></span>
- 3. <span data-ttu-id="21ab7-191">Si el envío del formulario es válido, guardar los datos y mostrar la lista actualizada</span><span class="sxs-lookup"><span data-stu-id="21ab7-191">If the form submission is valid, save the data and display the updated list</span></span>
- 4. <span data-ttu-id="21ab7-192">Si el envío del formulario no es válido, volver a mostrar el formulario con errores de validación</span><span class="sxs-lookup"><span data-stu-id="21ab7-192">If the form submission is not valid, redisplay the form with validation errors</span></span>

#### <a name="reading-form-values-with-model-binding"></a><span data-ttu-id="21ab7-193">Leer valores de formulario con el enlace de modelos</span><span class="sxs-lookup"><span data-stu-id="21ab7-193">Reading Form Values with Model Binding</span></span>

<span data-ttu-id="21ab7-194">La acción del controlador está procesando el envío de un formulario que incluya los valores para GenreId y ArtistId (en la lista desplegable) y valores de cuadro de texto de título, el precio y AlbumArtUrl.</span><span class="sxs-lookup"><span data-stu-id="21ab7-194">The controller action is processing a form submission that includes values for GenreId and ArtistId (from the drop down list) and textbox values for Title, Price, and AlbumArtUrl.</span></span> <span data-ttu-id="21ab7-195">Aunque es posible tener acceso directo a los valores del formulario, un mejor enfoque es usar las capacidades de enlace de modelos integradas en ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="21ab7-195">While it's possible to directly access form values, a better approach is to use the Model Binding capabilities built into ASP.NET MVC.</span></span> <span data-ttu-id="21ab7-196">Cuando una acción de controlador toma un tipo de modelo como un parámetro, ASP.NET MVC intentará rellenar un objeto de ese tipo con entradas de formulario (así como los valores de ruta y la cadena de consulta).</span><span class="sxs-lookup"><span data-stu-id="21ab7-196">When a controller action takes a model type as a parameter, ASP.NET MVC will attempt to populate an object of that type using form inputs (as well as route and querystring values).</span></span> <span data-ttu-id="21ab7-197">Esto consigue mediante buscando valores cuyos nombres coincidan con las propiedades del objeto de modelo, por ejemplo, al establecer el nuevo álbum valor del objeto GenreId, busca una entrada con el nombre GenreId.</span><span class="sxs-lookup"><span data-stu-id="21ab7-197">It does this by looking for values whose names match properties of the model object, e.g. when setting the new Album object's GenreId value, it looks for an input with the name GenreId.</span></span> <span data-ttu-id="21ab7-198">Al crear vistas utilizando los métodos estándares en ASP.NET MVC, los formularios siempre se representará mediante nombres de propiedad como nombres de campo de entrada, por lo que esto los nombres de campo sólo coincidirá con.</span><span class="sxs-lookup"><span data-stu-id="21ab7-198">When you create views using the standard methods in ASP.NET MVC, the forms will always be rendered using property names as input field names, so this the field names will just match up.</span></span>

#### <a name="validating-the-model"></a><span data-ttu-id="21ab7-199">Validar el modelo</span><span class="sxs-lookup"><span data-stu-id="21ab7-199">Validating the Model</span></span>

<span data-ttu-id="21ab7-200">El modelo se valida con una llamada simple a ModelState.IsValid.</span><span class="sxs-lookup"><span data-stu-id="21ab7-200">The model is validated with a simple call to ModelState.IsValid.</span></span> <span data-ttu-id="21ab7-201">No hemos agregamos cualquier regla de validación a nuestra clase álbum aún - haremos todo lo que en un bit, así que ahora esta comprobación no tiene mucho que hacer.</span><span class="sxs-lookup"><span data-stu-id="21ab7-201">We haven't added any validation rules to our Album class yet - we'll do that in a bit - so right now this check doesn't have much to do.</span></span> <span data-ttu-id="21ab7-202">Lo importante es que esta comprobación ModelStat.IsValid adaptará a las reglas de validación que colocamos en nuestro modelo, por lo que los futuros cambios en las reglas de validación no requieren actualizaciones para el código de acción del controlador.</span><span class="sxs-lookup"><span data-stu-id="21ab7-202">What's important is that this ModelStat.IsValid check will adapt to the validation rules we put on our model, so future changes to validation rules won't require any updates to the controller action code.</span></span>

#### <a name="saving-the-submitted-values"></a><span data-ttu-id="21ab7-203">Guardar los valores enviados</span><span class="sxs-lookup"><span data-stu-id="21ab7-203">Saving the submitted values</span></span>

<span data-ttu-id="21ab7-204">Si el envío del formulario pasa la validación, es el momento de guardar los valores en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="21ab7-204">If the form submission passes validation, it's time to save the values to the database.</span></span> <span data-ttu-id="21ab7-205">Con Entity Framework, que solo requiere agregar el modelo a la colección de álbumes y una llamada a SaveChanges.</span><span class="sxs-lookup"><span data-stu-id="21ab7-205">With Entity Framework, that just requires adding the model to the Albums collection and calling SaveChanges.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample10.cs)]

<span data-ttu-id="21ab7-206">Entity Framework genera los comandos SQL adecuados para conservar el valor.</span><span class="sxs-lookup"><span data-stu-id="21ab7-206">Entity Framework generates the appropriate SQL commands to persist the value.</span></span> <span data-ttu-id="21ab7-207">Después de guardar los datos, se redireccionar a la lista de álbumes, vemos la actualización.</span><span class="sxs-lookup"><span data-stu-id="21ab7-207">After saving the data, we redirect back to the list of Albums so we can see our update.</span></span> <span data-ttu-id="21ab7-208">Para ello, devolver RedirectToAction con el nombre de la acción de controlador que desea mostrar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-208">This is done by returning RedirectToAction with the name of the controller action we want displayed.</span></span> <span data-ttu-id="21ab7-209">En este caso, es el método de índice.</span><span class="sxs-lookup"><span data-stu-id="21ab7-209">In this case, that's the Index method.</span></span>

#### <a name="displaying-invalid-form-submissions-with-validation-errors"></a><span data-ttu-id="21ab7-210">Mostrar los envíos de formulario no válido con errores de validación</span><span class="sxs-lookup"><span data-stu-id="21ab7-210">Displaying invalid form submissions with Validation Errors</span></span>

<span data-ttu-id="21ab7-211">En el caso de entrada de formulario no válido, se agregan los valores de lista desplegable para el elemento ViewBag (como en el caso de HTTP GET) y los valores del modelo dependiente se pasan a la vista para mostrar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-211">In the case of invalid form input, the dropdown values are added to the ViewBag (as in the HTTP-GET case) and the bound model values are passed back to the view for display.</span></span> <span data-ttu-id="21ab7-212">Errores de validación se muestran automáticamente mediante el @Html.ValidationMessageFor aplicación auxiliar HTML.</span><span class="sxs-lookup"><span data-stu-id="21ab7-212">Validation errors are automatically displayed using the @Html.ValidationMessageFor HTML Helper.</span></span>

#### <a name="testing-the-create-form"></a><span data-ttu-id="21ab7-213">Probar el formulario de creación</span><span class="sxs-lookup"><span data-stu-id="21ab7-213">Testing the Create Form</span></span>

<span data-ttu-id="21ab7-214">Para probar esto, ejecute la aplicación y vaya a /StoreManager/crear / - Esto mostrará el formulario en blanco que se ha devuelto por el método StoreController crear HTTP-GET.</span><span class="sxs-lookup"><span data-stu-id="21ab7-214">To test this out, run the application and browse to /StoreManager/Create/ - this will show you the blank form which was returned by the StoreController Create HTTP-GET method.</span></span>

<span data-ttu-id="21ab7-215">Rellene algunos valores y haga clic en el botón Crear para enviar el formulario.</span><span class="sxs-lookup"><span data-stu-id="21ab7-215">Fill in some values and click the Create button to submit the form.</span></span>

![](mvc-music-store-part-5/_static/image7.png)

![](mvc-music-store-part-5/_static/image8.png)

### <a name="handling-edits"></a><span data-ttu-id="21ab7-216">Control de cambios</span><span class="sxs-lookup"><span data-stu-id="21ab7-216">Handling Edits</span></span>

<span data-ttu-id="21ab7-217">El par de acciones de edición (HTTP-GET y HTTP-POST) es muy similar a los métodos de acción de crear que acabamos de ver.</span><span class="sxs-lookup"><span data-stu-id="21ab7-217">The Edit action pair (HTTP-GET and HTTP-POST) are very similar to the Create action methods we just looked at.</span></span> <span data-ttu-id="21ab7-218">Puesto que el escenario de edición implica trabajar con un álbum existente, el método carga el álbum basándose en el parámetro "id", de edición que HTTP-GET pasa a través de la ruta.</span><span class="sxs-lookup"><span data-stu-id="21ab7-218">Since the edit scenario involves working with an existing album, the Edit HTTP-GET method loads the Album based on the "id" parameter, passed in via the route.</span></span> <span data-ttu-id="21ab7-219">Este código para recuperar un álbum por AlbumId es el mismo como, hemos analizado anteriormente en la acción de controlador de detalles.</span><span class="sxs-lookup"><span data-stu-id="21ab7-219">This code for retrieving an album by AlbumId is the same as we've previously looked at in the Details controller action.</span></span> <span data-ttu-id="21ab7-220">Al igual que con la función Create / método GET de HTTP, la lista desplegable de valores se devuelven a través de ViewBag.</span><span class="sxs-lookup"><span data-stu-id="21ab7-220">As with the Create / HTTP-GET method, the drop down values are returned via the ViewBag.</span></span> <span data-ttu-id="21ab7-221">Esto nos permite devolver un álbum como nuestro objeto de modelo a la vista (que está fuertemente tipada en la clase de álbum) al pasar datos adicionales (por ejemplo, una lista de géneros) mediante el elemento ViewBag.</span><span class="sxs-lookup"><span data-stu-id="21ab7-221">This allows us to return an Album as our model object to the view (which is strongly typed to the Album class) while passing additional data (e.g. a list of Genres) via the ViewBag.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample11.cs)]

<span data-ttu-id="21ab7-222">La acción de editar HTTP-POST es muy similar a la acción Create HTTP-POST.</span><span class="sxs-lookup"><span data-stu-id="21ab7-222">The Edit HTTP-POST action is very similar to the Create HTTP-POST action.</span></span> <span data-ttu-id="21ab7-223">La única diferencia es en lugar de agregar un nuevo álbum a la base de datos. Colección de álbumes, estamos encontrando la instancia actual del álbum mediante la base de datos. Entry(Album) y establecer su estado como modificado.</span><span class="sxs-lookup"><span data-stu-id="21ab7-223">The only difference is that instead of adding a new album to the db.Albums collection, we're finding the current instance of the Album using db.Entry(album) and setting its state to Modified.</span></span> <span data-ttu-id="21ab7-224">Esto indica a Entity Framework que se está modificando un álbum existente en lugar de crear uno nuevo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-224">This tells Entity Framework that we are modifying an existing album as opposed to creating a new one.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample12.cs)]

<span data-ttu-id="21ab7-225">Podemos probar este comando al ejecutar la aplicación y examinar/StoreManger/y, a continuación, haga clic en el vínculo de edición para un álbum.</span><span class="sxs-lookup"><span data-stu-id="21ab7-225">We can test this out by running the application and browsing to /StoreManger/, then clicking the Edit link for an album.</span></span>

![](mvc-music-store-part-5/_static/image9.png)

<span data-ttu-id="21ab7-226">Esto muestra el formulario de edición que se muestra en el método GET de HTTP editar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-226">This displays the Edit form shown by the Edit HTTP-GET method.</span></span> <span data-ttu-id="21ab7-227">Rellene algunos valores y haga clic en el botón Guardar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-227">Fill in some values and click the Save button.</span></span>

![](mvc-music-store-part-5/_static/image10.png)

<span data-ttu-id="21ab7-228">Esto envía el formulario, guarda los valores y nos devuelve a la lista de álbumes, que muestra que se actualizaron los valores.</span><span class="sxs-lookup"><span data-stu-id="21ab7-228">This posts the form, saves the values, and returns us to the Album list, showing that the values were updated.</span></span>

![](mvc-music-store-part-5/_static/image11.png)

### <a name="handling-deletion"></a><span data-ttu-id="21ab7-229">Control de eliminación</span><span class="sxs-lookup"><span data-stu-id="21ab7-229">Handling Deletion</span></span>

<span data-ttu-id="21ab7-230">Eliminación sigue el mismo patrón que editar y crear, mediante la acción de un controlador para mostrar el formulario de confirmación y otra acción de controlador para controlar el envío del formulario.</span><span class="sxs-lookup"><span data-stu-id="21ab7-230">Deletion follows the same pattern as Edit and Create, using one controller action to display the confirmation form, and another controller action to handle the form submission.</span></span>

<span data-ttu-id="21ab7-231">La acción de controlador HTTP-GET Delete es exactamente igual que la acción de controlador de detalles del Administrador de almacén anterior.</span><span class="sxs-lookup"><span data-stu-id="21ab7-231">The HTTP-GET Delete controller action is exactly the same as our previous Store Manager Details controller action.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample13.cs)]

<span data-ttu-id="21ab7-232">Se muestra un formulario que está fuertemente tipado para un tipo de álbum, mediante la plantilla de contenido de la vista de eliminación.</span><span class="sxs-lookup"><span data-stu-id="21ab7-232">We display a form that's strongly typed to an Album type, using the Delete view content template.</span></span>

![](mvc-music-store-part-5/_static/image12.png)

<span data-ttu-id="21ab7-233">La plantilla de eliminación muestra todos los campos para el modelo, pero podemos simplificar un poco ese abajo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-233">The Delete template shows all the fields for the model, but we can simplify that down quite a bit.</span></span> <span data-ttu-id="21ab7-234">Cambie el código de vista de /Views/StoreManager/Delete.cshtml al siguiente.</span><span class="sxs-lookup"><span data-stu-id="21ab7-234">Change the view code in /Views/StoreManager/Delete.cshtml to the following.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample14.cshtml)]

<span data-ttu-id="21ab7-235">Esto muestra una confirmación de eliminación simplificada.</span><span class="sxs-lookup"><span data-stu-id="21ab7-235">This displays a simplified Delete confirmation.</span></span>

![](mvc-music-store-part-5/_static/image13.png)

<span data-ttu-id="21ab7-236">Haga clic en el botón Eliminar hace que el formulario se envía al servidor, que ejecuta la acción DeleteConfirmed.</span><span class="sxs-lookup"><span data-stu-id="21ab7-236">Clicking the Delete button causes the form to be posted back to the server, which executes the DeleteConfirmed action.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample15.cs)]

<span data-ttu-id="21ab7-237">La acción de controlador HTTP-POST eliminar realiza las siguientes acciones:</span><span class="sxs-lookup"><span data-stu-id="21ab7-237">Our HTTP-POST Delete Controller Action takes the following actions:</span></span>

- 1. <span data-ttu-id="21ab7-238">Carga el álbum por Id.</span><span class="sxs-lookup"><span data-stu-id="21ab7-238">Loads the Album by ID</span></span>
- 2. <span data-ttu-id="21ab7-239">Elimina el álbum y guardar los cambios</span><span class="sxs-lookup"><span data-stu-id="21ab7-239">Deletes it the album and save changes</span></span>
- 3. <span data-ttu-id="21ab7-240">Redirige al índice, que muestra que se quitó el álbum de la lista</span><span class="sxs-lookup"><span data-stu-id="21ab7-240">Redirects to the Index, showing that the Album was removed from the list</span></span>

<span data-ttu-id="21ab7-241">Para ello, ejecute la aplicación y vaya a /StoreManager.</span><span class="sxs-lookup"><span data-stu-id="21ab7-241">To test this, run the application and browse to /StoreManager.</span></span> <span data-ttu-id="21ab7-242">Seleccione un álbum de la lista y haga clic en el vínculo Eliminar.</span><span class="sxs-lookup"><span data-stu-id="21ab7-242">Select an album from the list and click the Delete link.</span></span>

![](mvc-music-store-part-5/_static/image14.png)

<span data-ttu-id="21ab7-243">Esto muestra la pantalla de confirmación de eliminación.</span><span class="sxs-lookup"><span data-stu-id="21ab7-243">This displays our Delete confirmation screen.</span></span>

![](mvc-music-store-part-5/_static/image15.png)

<span data-ttu-id="21ab7-244">Haga clic en el botón Eliminar quita el álbum y nos devuelve a la página de índice del Administrador de almacenamiento, que muestra que se ha eliminado el álbum.</span><span class="sxs-lookup"><span data-stu-id="21ab7-244">Clicking the Delete button removes the album and returns us to the Store Manager Index page, which shows that the album has been deleted.</span></span>

![](mvc-music-store-part-5/_static/image16.png)

### <a name="using-a-custom-html-helper-to-truncate-text"></a><span data-ttu-id="21ab7-245">Uso de una aplicación auxiliar HTML personalizado para truncar el texto</span><span class="sxs-lookup"><span data-stu-id="21ab7-245">Using a custom HTML Helper to truncate text</span></span>

<span data-ttu-id="21ab7-246">Tenemos un problema potencial con nuestra página de índice del Administrador de almacén.</span><span class="sxs-lookup"><span data-stu-id="21ab7-246">We've got one potential issue with our Store Manager Index page.</span></span> <span data-ttu-id="21ab7-247">Nuestro propiedades del título del álbum y el nombre del intérprete tanto pueden ser lo suficientemente largo que se producen fuera de nuestro formato de tabla.</span><span class="sxs-lookup"><span data-stu-id="21ab7-247">Our Album Title and Artist Name properties can both be long enough that they could throw off our table formatting.</span></span> <span data-ttu-id="21ab7-248">Vamos a crear una aplicación auxiliar de HTML personalizado para permitir que nos truncar fácilmente estas y otras propiedades en nuestros puntos de vista.</span><span class="sxs-lookup"><span data-stu-id="21ab7-248">We'll create a custom HTML Helper to allow us to easily truncate these and other properties in our Views.</span></span>

![](mvc-music-store-part-5/_static/image17.png)

<span data-ttu-id="21ab7-249">De Razor @helper sintaxis hizo bastante fácil de crear sus propias funciones auxiliares para su uso en las vistas.</span><span class="sxs-lookup"><span data-stu-id="21ab7-249">Razor's @helper syntax has made it pretty easy to create your own helper functions for use in your views.</span></span> <span data-ttu-id="21ab7-250">Abra la vista /Views/StoreManager/Index.cshtml y agregue el código siguiente directamente después de la @model línea.</span><span class="sxs-lookup"><span data-stu-id="21ab7-250">Open the /Views/StoreManager/Index.cshtml view and add the following code directly after the @model line.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample16.cshtml)]

<span data-ttu-id="21ab7-251">Este método auxiliar toma una cadena y una longitud máxima para permitir.</span><span class="sxs-lookup"><span data-stu-id="21ab7-251">This helper method takes a string and a maximum length to allow.</span></span> <span data-ttu-id="21ab7-252">Si el texto proporcionado es menor que la longitud especificada, la aplicación auxiliar genera como-es.</span><span class="sxs-lookup"><span data-stu-id="21ab7-252">If the text supplied is shorter than the length specified, the helper outputs it as-is.</span></span> <span data-ttu-id="21ab7-253">Si es más larga, se trunca el texto y representa "..." para el resto.</span><span class="sxs-lookup"><span data-stu-id="21ab7-253">If it is longer, then it truncates the text and renders "…" for the remainder.</span></span>

<span data-ttu-id="21ab7-254">Ahora podemos usar nuestro truncar auxiliar para asegurarse de que el título del álbum y el nombre del intérprete propiedades son menos de 25 caracteres.</span><span class="sxs-lookup"><span data-stu-id="21ab7-254">Now we can use our Truncate helper to ensure that both the Album Title and Artist Name properties are less than 25 characters.</span></span> <span data-ttu-id="21ab7-255">El código de la vista completa con nuestro nuevo auxiliar de truncar aparece debajo.</span><span class="sxs-lookup"><span data-stu-id="21ab7-255">The complete view code using our new Truncate helper appears below.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample17.cshtml)]

<span data-ttu-id="21ab7-256">Ahora cuando se examina la dirección URL /StoreManager/, los álbumes y títulos se mantengan por debajo de la longitud máxima.</span><span class="sxs-lookup"><span data-stu-id="21ab7-256">Now when we browse the /StoreManager/ URL, the albums and titles are kept below our maximum lengths.</span></span>

![](mvc-music-store-part-5/_static/image18.png)

<span data-ttu-id="21ab7-257">Nota: Esto muestra el caso más sencillo de crear y usar una aplicación auxiliar en una vista.</span><span class="sxs-lookup"><span data-stu-id="21ab7-257">Note: This shows the simple case of creating and using a helper in one view.</span></span> <span data-ttu-id="21ab7-258">Para más información acerca de cómo crear aplicaciones auxiliares que puede utilizar en todo el sitio, consulte la entrada de mi de blog: [http://bit.ly/mvc3-helper-options](http://bit.ly/mvc3-helper-options)</span><span class="sxs-lookup"><span data-stu-id="21ab7-258">To learn more about creating helpers that you can use throughout your site, see my blog post: [http://bit.ly/mvc3-helper-options](http://bit.ly/mvc3-helper-options)</span></span>


> [!div class="step-by-step"]
> <span data-ttu-id="21ab7-259">[Anterior](mvc-music-store-part-4.md)
> [Siguiente](mvc-music-store-part-6.md)</span><span class="sxs-lookup"><span data-stu-id="21ab7-259">[Previous](mvc-music-store-part-4.md)
[Next](mvc-music-store-part-6.md)</span></span>
