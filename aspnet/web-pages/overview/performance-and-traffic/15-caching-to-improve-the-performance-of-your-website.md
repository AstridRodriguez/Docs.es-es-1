---
uid: web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
title: Almacenamiento en caché de datos en un ASP.NET Web Pages (Razor) sitio para mejorar el rendimiento | Documentos de Microsoft
author: tfitzmac
description: 'Puede acelerar su sitio Web al tener almacenar: es decir, caché, los resultados de los datos que normalmente podrían tardar un tiempo considerable para recuperar o procesar un...'
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/14/2014
ms.topic: article
ms.assetid: 961e525b-7700-469e-8a68-d7010b6fb68c
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
msc.type: authoredcontent
ms.openlocfilehash: 742409219bd3b05f8ddf2c0d5034919fc9bf1d26
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2018
ms.locfileid: "28039201"
---
<a name="caching-data-in-an-aspnet-web-pages-razor-site-for-better-performance"></a><span data-ttu-id="baad8-103">Almacenar en caché datos en un sitio de ASP.NET Web Pages (Razor) para mejorar el rendimiento</span><span class="sxs-lookup"><span data-stu-id="baad8-103">Caching Data in an ASP.NET Web Pages (Razor) Site for Better Performance</span></span>
====================
<span data-ttu-id="baad8-104">por [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="baad8-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="baad8-105">En este artículo se explica cómo usar una aplicación auxiliar para almacenar en caché información para mejorar el rendimiento en un sitio Web de ASP.NET Web Pages (Razor).</span><span class="sxs-lookup"><span data-stu-id="baad8-105">This article explains how to use a helper to cache information for faster performance in an ASP.NET Web Pages (Razor) website.</span></span> <span data-ttu-id="baad8-106">Puede acelerar su sitio Web al incluirla almacén &#8212; es decir, caché &#8212; los resultados de los datos que normalmente podría tardar un tiempo considerable para recuperar o procesar y que no cambian con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="baad8-106">You can speed up your website by having it store &#8212; that is, cache &#8212; the results of data that ordinarily would take considerable time to retrieve or process and that does not change often.</span></span>
> 
> <span data-ttu-id="baad8-107">**Lo que aprenderá:**</span><span class="sxs-lookup"><span data-stu-id="baad8-107">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="baad8-108">Describe cómo usar el almacenamiento en caché para mejorar la capacidad de respuesta de su sitio Web.</span><span class="sxs-lookup"><span data-stu-id="baad8-108">How to use caching to improve the responsiveness of your website.</span></span>
> 
> <span data-ttu-id="baad8-109">Estas son las características ASP.NET presentadas en el artículo:</span><span class="sxs-lookup"><span data-stu-id="baad8-109">These are the ASP.NET features introduced in the article:</span></span>
> 
> - <span data-ttu-id="baad8-110">El `WebCache` auxiliar.</span><span class="sxs-lookup"><span data-stu-id="baad8-110">The `WebCache` helper.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="baad8-111">Versiones de software que se usa en el tutorial</span><span class="sxs-lookup"><span data-stu-id="baad8-111">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="baad8-112">ASP.NET Web Pages (Razor) 3</span><span class="sxs-lookup"><span data-stu-id="baad8-112">ASP.NET Web Pages (Razor) 3</span></span>
>   
> 
> <span data-ttu-id="baad8-113">Este tutorial también funciona con ASP.NET Web Pages 2.</span><span class="sxs-lookup"><span data-stu-id="baad8-113">This tutorial also works with ASP.NET Web Pages 2.</span></span>


<span data-ttu-id="baad8-114">Cada vez que un usuario solicita una página del sitio, el servidor web tiene que realizar algún trabajo para satisfacer la solicitud.</span><span class="sxs-lookup"><span data-stu-id="baad8-114">Every time someone requests a page from your site, the web server has to do some work in order to fulfill the request.</span></span> <span data-ttu-id="baad8-115">En algunos de sus páginas, el servidor podría tener que realizar tareas que toman (comparativamente) mucho tiempo, por ejemplo, la recuperación de datos de una base de datos.</span><span class="sxs-lookup"><span data-stu-id="baad8-115">For some of your pages, the server might have to perform tasks that take a (comparatively) long time, such as retrieving data from a database.</span></span> <span data-ttu-id="baad8-116">Aunque estas tareas no toman larga en términos absolutos, si su sitio experimenta una gran cantidad de tráfico, puede sumar una serie completa de las solicitudes individuales que hacer que el servidor web realizar las tareas complicadas o lenta a una gran cantidad de trabajo.</span><span class="sxs-lookup"><span data-stu-id="baad8-116">Even if these tasks don't take long in absolute terms, if your site experiences a lot of traffic, a whole series of individual requests that cause the web server to perform the complicated or slow task can add up to a lot of work.</span></span> <span data-ttu-id="baad8-117">En última instancia, esto puede afectar al rendimiento del sitio.</span><span class="sxs-lookup"><span data-stu-id="baad8-117">This can ultimately affect the performance of the site.</span></span>

<span data-ttu-id="baad8-118">Es una manera de mejorar el rendimiento de su sitio Web en casos como este en caché los datos.</span><span class="sxs-lookup"><span data-stu-id="baad8-118">One way to improve the performance of your website in circumstances like this is to cache data.</span></span> <span data-ttu-id="baad8-119">Si su sitio obtiene repetir las solicitudes de la misma información y no necesita modificarse por cada persona a la información y no es tiempo confidenciales, en lugar de volver a capturar o actualizar los cálculos, puede capturar los datos una vez y, a continuación, almacenar los resultados.</span><span class="sxs-lookup"><span data-stu-id="baad8-119">If your site gets repeated requests for the same information, and the information does not need to be modified for each person, and it's not time sensitive, instead of re-fetching or recalculating it, you can fetch the data once and then store the results.</span></span> <span data-ttu-id="baad8-120">La próxima vez que llega una solicitud para que obtener información, simplemente obtenerlo de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-120">The next time a request comes in for that information, you just get it out of the cache.</span></span>

<span data-ttu-id="baad8-121">En general, se almacenan en caché información que no cambia con frecuencia.</span><span class="sxs-lookup"><span data-stu-id="baad8-121">In general, you cache information that doesn't change frequently.</span></span> <span data-ttu-id="baad8-122">Al colocar la información en la memoria caché, se almacena en memoria en el servidor web.</span><span class="sxs-lookup"><span data-stu-id="baad8-122">When you put information in the cache, it's stored in memory on the web server.</span></span> <span data-ttu-id="baad8-123">Puede especificar cuánto tiempo se deben almacenarse en caché, de segundos a días.</span><span class="sxs-lookup"><span data-stu-id="baad8-123">You can specify how long it should be cached, from seconds to days.</span></span> <span data-ttu-id="baad8-124">Cuando expira el período de almacenamiento en caché, se quita automáticamente la información de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-124">When the caching period expires, the information is automatically removed from the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="baad8-125">Las entradas de la memoria caché podrían quitarse por motivos distintos de que han caducado.</span><span class="sxs-lookup"><span data-stu-id="baad8-125">Entries in the cache might be removed for reasons other than that they've expired.</span></span> <span data-ttu-id="baad8-126">Por ejemplo, el servidor web podría temporalmente disponga de suficiente memoria y una forma pueda reclamar memoria consiste en producir las entradas de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-126">For example, the web server might temporarily run low on memory, and one way it can reclaim memory is by throwing entries out of the cache.</span></span> <span data-ttu-id="baad8-127">Como verá, incluso si ha colocado información en la memoria caché, tiene que comprobar para asegurarse de que aún está allí cuando lo necesite.</span><span class="sxs-lookup"><span data-stu-id="baad8-127">As you'll see, even if you've put information into the cache, you have to check to be sure it's still there when you need it.</span></span>


<span data-ttu-id="baad8-128">Imagine que su sitio Web tiene una página que muestra la temperatura actual y el boletín meteorológico.</span><span class="sxs-lookup"><span data-stu-id="baad8-128">Imagine your website has a page that displays the current temperature and weather forecast.</span></span> <span data-ttu-id="baad8-129">Para obtener este tipo de información, puede enviar una solicitud a un servicio externo.</span><span class="sxs-lookup"><span data-stu-id="baad8-129">To get this type of information, you might send a request to an external service.</span></span> <span data-ttu-id="baad8-130">Puesto que esta información no varían mucho (dentro de un período de tiempo de dos horas, por ejemplo) y, como llamadas externas llevar tiempo y el ancho de banda, es un buen candidato para el almacenamiento en caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-130">Since this information doesn't change much (within a two-hour time period, for example) and since external calls require time and bandwidth, it's a good candidate for caching.</span></span>

## <a name="adding-caching-to-a-page"></a><span data-ttu-id="baad8-131">Agregar almacenamiento en caché a una página</span><span class="sxs-lookup"><span data-stu-id="baad8-131">Adding Caching to a Page</span></span>

<span data-ttu-id="baad8-132">ASP.NET incluye una `WebCache` auxiliar que resulta muy sencillo agregar almacenamiento en caché a su sitio y agregar datos a la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-132">ASP.NET includes a `WebCache` helper that makes it easy to add caching to your site and add data to the cache.</span></span> <span data-ttu-id="baad8-133">En este procedimiento, creará una página que almacena en caché la hora actual.</span><span class="sxs-lookup"><span data-stu-id="baad8-133">In this procedure, you'll create a page that caches the current time.</span></span> <span data-ttu-id="baad8-134">Esto no es un ejemplo del mundo real, ya que la hora actual es algo que cambian con frecuencia, y que además no resulta difícil de calcular.</span><span class="sxs-lookup"><span data-stu-id="baad8-134">This isn't a real-world example, since the current time is something that does change often, and that moreover isn't complex to calculate.</span></span> <span data-ttu-id="baad8-135">Sin embargo, resulta una buena forma de ilustrar el almacenamiento en caché en acción.</span><span class="sxs-lookup"><span data-stu-id="baad8-135">However, it's a good way to illustrate caching in action.</span></span>

1. <span data-ttu-id="baad8-136">Agregar una nueva página denominada *WebCache.cshtml* al sitio Web.</span><span class="sxs-lookup"><span data-stu-id="baad8-136">Add a new page named *WebCache.cshtml* to the website.</span></span>
2. <span data-ttu-id="baad8-137">Agregue el código y el marcado siguiente a la página:</span><span class="sxs-lookup"><span data-stu-id="baad8-137">Add the following code and markup to the page:</span></span>

    [!code-cshtml[Main](15-caching-to-improve-the-performance-of-your-website/samples/sample1.cshtml)]

    <span data-ttu-id="baad8-138">Cuando se almacena en caché datos, ubicación en la memoria caché con un nombre de esto es único para todo el sitio Web.</span><span class="sxs-lookup"><span data-stu-id="baad8-138">When you cache data, you put it into the cache using a name this is unique across the website.</span></span> <span data-ttu-id="baad8-139">En este caso, deberá utilizar una entrada de caché con nombre `CachedTime`.</span><span class="sxs-lookup"><span data-stu-id="baad8-139">In this case, you'll use a cache entry named `CachedTime`.</span></span> <span data-ttu-id="baad8-140">Se trata de la `cacheItemKey` se muestra en el ejemplo de código.</span><span class="sxs-lookup"><span data-stu-id="baad8-140">This is the `cacheItemKey` shown in the code example.</span></span>

    <span data-ttu-id="baad8-141">El código lee primero el `CachedTime` entrada de caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-141">The code first reads the `CachedTime` cache entry.</span></span> <span data-ttu-id="baad8-142">Si se devuelve un valor (es decir, si la entrada de caché no es null), el código simplemente establece el valor de la variable de tiempo en los datos de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-142">If a value is returned (that is, if the cache entry isn't null), the code just sets the value of the time variable to the cache data.</span></span>

    <span data-ttu-id="baad8-143">Sin embargo, si no existe la entrada de caché (es decir, es null), el código establece el valor de tiempo, lo agrega a la memoria caché y establece un valor de expiración en un minuto.</span><span class="sxs-lookup"><span data-stu-id="baad8-143">However, if the cache entry doesn't exist (that is, it's null), the code sets the time value, adds it to the cache, and sets an expiration value to one minute.</span></span> <span data-ttu-id="baad8-144">Después de un minuto, se descarta la entrada de caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-144">After one minute, the cache entry is discarded.</span></span> <span data-ttu-id="baad8-145">(El valor de expiración predeterminado para un elemento de la memoria caché es de 20 minutos). El comando `WebCache.Set(cacheItemKey, time, 1, false)` muestra cómo agregar el valor de tiempo actual a la memoria caché y establecer su expiración en 1 minuto.</span><span class="sxs-lookup"><span data-stu-id="baad8-145">(The default expiration value for an item in the cache is 20 minutes.) The command `WebCache.Set(cacheItemKey, time, 1, false)` shows how to add the current time value to the cache and set its expiration to 1 minute.</span></span> <span data-ttu-id="baad8-146">Establecer el *slidingExpiration* parámetro `false` significa que la hora de expiración no se renueva cada vez que se solicita.</span><span class="sxs-lookup"><span data-stu-id="baad8-146">Setting the *slidingExpiration* parameter to `false` means the expiration time is not renewed each time it is requested.</span></span> <span data-ttu-id="baad8-147">Expiración exactamente 1 minuto después de que se agregó originalmente a la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-147">It will expire exactly 1 minute after it was originally added to the cache.</span></span> <span data-ttu-id="baad8-148">Si establece este valor en `true` la hora de expiración de 1 minuto se restablece cada vez que se solicita el valor de la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-148">If you set this value to `true` the 1 minute expiration time is reset each time the value is requested from the cache.</span></span>

    <span data-ttu-id="baad8-149">Este código muestra el patrón que se debe utilizar siempre cuando almacena datos en caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-149">This code illustrates the pattern you should always use when you cache data.</span></span> <span data-ttu-id="baad8-150">Antes de que obtener algo de la memoria caché, primero compruebe siempre si la `WebCache.Get` método devolvió un valor nulo.</span><span class="sxs-lookup"><span data-stu-id="baad8-150">Before you get something out of the cache, always check first whether the `WebCache.Get` method has returned null.</span></span> <span data-ttu-id="baad8-151">Recuerde que la entrada de caché han expirado o puede que haya quitado por algún otro motivo, por lo que nunca se garantiza que cualquier entrada determinada en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-151">Remember that the cache entry might have expired or might have been removed for some other reason, so any given entry is never guaranteed to be in the cache.</span></span>
3. <span data-ttu-id="baad8-152">Ejecutar *WebCache.cshtml* en un explorador.</span><span class="sxs-lookup"><span data-stu-id="baad8-152">Run *WebCache.cshtml* in a browser.</span></span> <span data-ttu-id="baad8-153">(Asegúrese de que la página está seleccionada en el **archivos** área de trabajo antes de ejecutarlo.) La primera vez que solicite la página, los datos de hora no están en la memoria caché y el código tiene que agregar el valor de hora a la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-153">(Make sure the page is selected in the **Files** workspace before you run it.) The first time you request the page, the time data isn't in the cache, and the code has to add the time value to the cache.</span></span>

    ![1 de la memoria caché](15-caching-to-improve-the-performance-of-your-website/_static/image1.jpg)
4. <span data-ttu-id="baad8-155">Actualizar *WebCache.cshtml* en el explorador.</span><span class="sxs-lookup"><span data-stu-id="baad8-155">Refresh *WebCache.cshtml* in the browser.</span></span> <span data-ttu-id="baad8-156">Esta vez, los datos de tiempo están en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-156">This time, the time data is in the cache.</span></span> <span data-ttu-id="baad8-157">Tenga en cuenta que la hora no ha cambiado desde la última vez que se ha visto la página.</span><span class="sxs-lookup"><span data-stu-id="baad8-157">Notice that the time hasn't changed since the last time you viewed the page.</span></span>

    ![caché-2](15-caching-to-improve-the-performance-of-your-website/_static/image2.jpg)
5. <span data-ttu-id="baad8-159">Espere un minuto para vaciar la memoria caché y, a continuación, actualice la página.</span><span class="sxs-lookup"><span data-stu-id="baad8-159">Wait one minute for the cache to be emptied, and then refresh the page.</span></span> <span data-ttu-id="baad8-160">La página nuevo indica que los datos de tiempo no se encontraron en la memoria caché y la hora actualizada se agrega a la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="baad8-160">The page again indicates that the time data wasn't found in the cache, and the updated time is added to the cache.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="baad8-161">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="baad8-161">Additional Resources</span></span>


- [<span data-ttu-id="baad8-162">Mostrar datos en un gráfico</span><span class="sxs-lookup"><span data-stu-id="baad8-162">Displaying Data in a Chart</span></span>](https://go.microsoft.com/fwlink/?LinkId=202895)
- <span data-ttu-id="baad8-163">[Referencia de la API de WebCache](https://msdn.microsoft.com/library/system.web.helpers.webcache(v=vs.99).aspx) (MSDN)</span><span class="sxs-lookup"><span data-stu-id="baad8-163">[WebCache API reference](https://msdn.microsoft.com/library/system.web.helpers.webcache(v=vs.99).aspx) (MSDN)</span></span>
