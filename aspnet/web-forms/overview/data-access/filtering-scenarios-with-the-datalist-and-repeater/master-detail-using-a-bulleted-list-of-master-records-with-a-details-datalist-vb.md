---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb
title: "Principal-detalle utilizando una lista con viñetas de registros maestros con un control DataList de detalles (VB) | Documentos de Microsoft"
author: rick-anderson
description: "En este tutorial se podrá comprimir el informe de dos páginas principal-detalle del tutorial anterior en una sola página, que muestra una lista con viñetas de nombres de categoría en t..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/17/2006
ms.topic: article
ms.assetid: ee20742f-6fb7-49a0-a009-058fe363aacb
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 613ad1fb101a168c79310c9dc7bf731be264f889
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2018
---
<a name="masterdetail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb"></a><span data-ttu-id="4a5ef-103">Principal-detalle utilizando una lista con viñetas de registros maestros con un control DataList de detalles (VB)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-103">Master/Detail Using a Bulleted List of Master Records with a Details DataList (VB)</span></span>
====================
<span data-ttu-id="4a5ef-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4a5ef-105">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_VB.exe) o [descarga de PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/datatutorial35vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_35_VB.exe) or [Download PDF](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/datatutorial35vb1.pdf)</span></span>

> <span data-ttu-id="4a5ef-106">En este tutorial se podrá comprimir el informe de dos páginas principal-detalle del tutorial anterior en una sola página, que muestra una lista con viñetas de nombres de categoría en el lado izquierdo de la pantalla y productos de la categoría seleccionada a la derecha de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-106">In this tutorial we'll compress the two-page master/detail report of the previous tutorial into a single page, showing a bulleted list of category names on the left side of the screen and the selected category's products on the right of the screen.</span></span>


## <a name="introduction"></a><span data-ttu-id="4a5ef-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="4a5ef-107">Introduction</span></span>

<span data-ttu-id="4a5ef-108">En el [tutorial anterior](master-detail-filtering-acess-two-pages-datalist-vb.md) explicamos cómo separar un informe maestro y detalles a través de dos páginas.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-108">In the [preceding tutorial](master-detail-filtering-acess-two-pages-datalist-vb.md) we looked at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="4a5ef-109">En la página maestra se usa un control de repetidor para representar una lista con viñetas de categorías.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-109">In the master page we used a Repeater control to render a bulleted list of categories.</span></span> <span data-ttu-id="4a5ef-110">Cada nombre de categoría era un hipervínculo que, al hacer clic, se toman al usuario a la página de detalles, donde un control DataList de dos columnas mostró los productos que pertenecen a la categoría seleccionada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-110">Each category name was a hyperlink that, when clicked, would take the user to the details page, where a two-column DataList showed those products belonging to the selected category.</span></span>

<span data-ttu-id="4a5ef-111">En este tutorial se podrá comprimir el tutorial de dos páginas en una sola página, que muestra una lista con viñetas de nombres de categoría en el lado izquierdo de la pantalla con cada nombre de categoría que se representa como un control LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-111">In this tutorial we'll compress the two-page tutorial into a single page, showing a bulleted list of category names on the left side of the screen with each category name rendered as a LinkButton.</span></span> <span data-ttu-id="4a5ef-112">Al hacer clic en uno de los nombres de categoría LinkButton induce a una devolución de datos y los productos de s de la categoría seleccionada se enlaza a un control DataList de dos columnas a la derecha de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-112">Clicking one of the category name LinkButtons induces a postback and binds the selected category s products to a two-column DataList on the right of the screen.</span></span> <span data-ttu-id="4a5ef-113">Además de mostrar cada nombre de categoría s, repetidor de la izquierda muestra el número total de productos no existe para una categoría determinada (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-113">In addition to displaying each category s name, the Repeater on the left shows how many total products there are for a given category (see Figure 1).</span></span>


<span data-ttu-id="4a5ef-114">[![La categoría es nombre y el número Total de productos se muestran a la izquierda](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-114">[![The Category s Name and Total Number of Products are Displayed on the Left](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image2.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image1.png)</span></span>

<span data-ttu-id="4a5ef-115">**Figura 1**: s nombre de la categoría y el número Total de productos se muestran a la izquierda ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-115">**Figure 1**: The Category s Name and Total Number of Products are Displayed on the Left ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image3.png))</span></span>


## <a name="step-1-displaying-a-repeater-in-the-left-portion-of-the-screen"></a><span data-ttu-id="4a5ef-116">Paso 1: Mostrar un repetidor en la parte izquierda de la pantalla</span><span class="sxs-lookup"><span data-stu-id="4a5ef-116">Step 1: Displaying a Repeater in the Left Portion of the Screen</span></span>

<span data-ttu-id="4a5ef-117">Para este tutorial es necesario que la lista con viñetas de categorías aparezca a la izquierda de los productos de s de la categoría seleccionada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-117">For this tutorial we need to have the bulleted list of categories appear to the left of the selected category s products.</span></span> <span data-ttu-id="4a5ef-118">Se puede colocar contenido en una página web mediante el estándar HTML elementos etiquetas de párrafo, espacios de no separación, `<table>` s y así sucesivamente o a través de técnicas de (CSS) de la hoja de estilos en cascada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-118">Content within a web page can be positioned using standard HTML elements paragraph tags, non-breaking spaces, `<table>` s, and so on or through cascading stylesheet (CSS) techniques.</span></span> <span data-ttu-id="4a5ef-119">Hasta ahora todos nuestros tutoriales han usado técnicas CSS para colocar.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-119">All of our tutorials thus far have used CSS techniques for positioning.</span></span> <span data-ttu-id="4a5ef-120">Cuando se compila la interfaz de usuario de navegación en la página maestra en la [páginas maestras y navegación del sitio](../introduction/master-pages-and-site-navigation-vb.md) tutorial utilizáramos *posiciones absolutas*, que indica el desplazamiento de píxel precisa para la navegación lista y el contenido principal.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-120">When we built the navigation user interface in our master page in the [Master Pages and Site Navigation](../introduction/master-pages-and-site-navigation-vb.md) tutorial we used *absolute positioning*, indicating the precise pixel offset for the navigation list and the main content.</span></span> <span data-ttu-id="4a5ef-121">También se puede usar CSS para colocar un elemento a la derecha o izquierda de otro a través de *flotante*.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-121">Alternatively, CSS can be used to position one element to the right or left of another through *floating*.</span></span> <span data-ttu-id="4a5ef-122">Podemos tenemos la lista con viñetas de categorías aparecen a la izquierda de los productos de s de la categoría seleccionada por flotante repetidor a la izquierda del control DataList</span><span class="sxs-lookup"><span data-stu-id="4a5ef-122">We can have the bulleted list of categories appear to the left of the selected category s products by floating the Repeater to the left of the DataList</span></span>

<span data-ttu-id="4a5ef-123">Abra la `CategoriesAndProducts.aspx` página desde el `DataListRepeaterFiltering` carpeta y agregar a la página un repetidor y un control DataList.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-123">Open the `CategoriesAndProducts.aspx` page from the `DataListRepeaterFiltering` folder and add to the page a Repeater and a DataList.</span></span> <span data-ttu-id="4a5ef-124">Establecer el repetidor s `ID` a `Categories` y DataList s a `CategoryProducts`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-124">Set the Repeater s `ID` to `Categories` and the DataList s to `CategoryProducts`.</span></span> <span data-ttu-id="4a5ef-125">Vaya a la vista del origen y colocar los controles de repetidor y DataList dentro de sus propios `<div>` elementos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-125">Go to the Source view and put the Repeater and DataList controls within their own `<div>` elements.</span></span> <span data-ttu-id="4a5ef-126">Es decir, incluya el repetidor dentro de un `<div>` elemento primero y, a continuación, el control DataList en su propio `<div>` elemento directamente después del repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-126">That is, enclose the Repeater within a `<div>` element first and then the DataList in its own `<div>` element directly after the Repeater.</span></span> <span data-ttu-id="4a5ef-127">El código de marcado en este momento debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-127">Your markup at this point should look similar to the following:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample1.aspx)]

<span data-ttu-id="4a5ef-128">Para hacer flotar repetidor a la izquierda del control DataList, debemos usar la `float` atributo de estilo CSS, como:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-128">To float the Repeater to the left of the DataList, we need to use the `float` CSS style attribute, like so:</span></span>


[!code-html[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample2.html)]

<span data-ttu-id="4a5ef-129">El `float: left;` flote hasta llegar al primer `<div>` elemento a la izquierda de la segunda.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-129">The `float: left;` floats the first `<div>` element to the left of the second one.</span></span> <span data-ttu-id="4a5ef-130">El `width` y `padding-right` configuración indica la primera `<div>` s `width` y se agrega el relleno entre el `<div>` contenido del elemento s y el margen derecho.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-130">The `width` and `padding-right` settings indicate the first `<div>` s `width` and how much padding is added between the `<div>` element s content and its right margin.</span></span> <span data-ttu-id="4a5ef-131">Para obtener más información sobre flotante elementos en CSS desproteger la [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-131">For more information on floating elements in CSS check out the [Floatutorial](http://css.maxdesign.com.au/floatutorial/).</span></span>

<span data-ttu-id="4a5ef-132">En lugar de especificar la configuración de estilo directamente a través de la primera `<p>` elemento s `style` atributo, permiten s en su lugar, cree una nueva clase CSS en `Styles.css` denominado `FloatLeft`:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-132">Rather than specify the style setting directly through the first `<p>` element s `style` attribute, let s instead create a new CSS class in `Styles.css` named `FloatLeft`:</span></span>


[!code-css[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample3.css)]

<span data-ttu-id="4a5ef-133">A continuación, podemos reemplazar la `<div>` con `<div class="FloatLeft">`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-133">Then we can replace the `<div>` with `<div class="FloatLeft">`.</span></span>

<span data-ttu-id="4a5ef-134">Después de agregar la clase CSS y configurar el marcado en el `CategoriesAndProducts.aspx` página, vaya al diseñador.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-134">After adding the CSS class and configuring the markup in the `CategoriesAndProducts.aspx` page, go to the Designer.</span></span> <span data-ttu-id="4a5ef-135">Debería ver el repetidor flotante a la izquierda del control DataList (aunque derecha ahora ambos solo aparecen como gris cuadros desde que se ve todavía para configurar sus orígenes de datos o plantillas).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-135">You should see the Repeater floating to the left of the DataList (although right now both just appear as gray boxes since we ve yet to configure their data sources or templates).</span></span>


<span data-ttu-id="4a5ef-136">[![Repetidor flota hacia la izquierda del control DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-136">[![The Repeater is Floated to the Left of the DataList](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image5.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image4.png)</span></span>

<span data-ttu-id="4a5ef-137">**Figura 2**: el repetidor flota hacia la izquierda del control DataList ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-137">**Figure 2**: The Repeater is Floated to the Left of the DataList ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image6.png))</span></span>


## <a name="step-2-determining-the-number-of-products-for-each-category"></a><span data-ttu-id="4a5ef-138">Paso 2: Determinar el número de productos para cada categoría</span><span class="sxs-lookup"><span data-stu-id="4a5ef-138">Step 2: Determining the Number of Products for Each Category</span></span>

<span data-ttu-id="4a5ef-139">Con la s repetidor y DataList que rodea el marcado completo, re listo para enlazar los datos de categoría a repetidor controla de manera centralizada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-139">With the Repeater and DataList s surrounding markup complete, we re ready to bind the category data to the Repeater control.</span></span> <span data-ttu-id="4a5ef-140">Sin embargo, como se muestra en la lista con viñetas de categorías en la figura 1, además de cada nombre de categoría s también es necesario mostrar el número de productos asociados con la categoría.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-140">However, as the bulleted list of categories in Figure 1 shows, in addition to each category s name we also need to display the number of products associated with the category.</span></span> <span data-ttu-id="4a5ef-141">Para obtener acceso a esta información se puede:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-141">To access this information we can either:</span></span>

- <span data-ttu-id="4a5ef-142">**Determinar esta información de la clase de código subyacente ASP.NET page s.**</span><span class="sxs-lookup"><span data-stu-id="4a5ef-142">**Determine this information from the ASP.NET page s code-behind class.**</span></span> <span data-ttu-id="4a5ef-143">Dada una determinada  *`categoryID`*  podemos determinar el número de productos asociados mediante una llamada a la `ProductsBLL` clase s. `GetProductsByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-143">Given a particular *`categoryID`* we can determine the number of associated products by calling the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="4a5ef-144">Este método devuelve un `ProductsDataTable` cuyos `Count` propiedad indica cuántos `ProductsRow` s existe, que es el número de productos para el elemento especificado  *`categoryID`* .</span><span class="sxs-lookup"><span data-stu-id="4a5ef-144">This method returns a `ProductsDataTable` object whose `Count` property indicates how many `ProductsRow` s exists, which is the number of products for the specified *`categoryID`*.</span></span> <span data-ttu-id="4a5ef-145">Podemos crear una `ItemDataBound` controlador de eventos para el repetidor que, para cada categoría enlazado a repetidor, llama a la `ProductsBLL` clase s. `GetProductsByCategoryID(categoryID)` método e incluye el recuento en la salida.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-145">We can create an `ItemDataBound` event handler for the Repeater that, for each category bound to the Repeater, calls the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method and includes its count in the output.</span></span>
- <span data-ttu-id="4a5ef-146">**Actualización de la `CategoriesDataTable` en el conjunto de datos con tipo para incluir un `NumberOfProducts` columna.**</span><span class="sxs-lookup"><span data-stu-id="4a5ef-146">**Update the `CategoriesDataTable` in the Typed DataSet to include a `NumberOfProducts` column.**</span></span> <span data-ttu-id="4a5ef-147">A continuación, podemos actualizar el `GetCategories()` método en el `CategoriesDataTable` para incluir esta información o, o bien, deje `GetCategories()` como-es y crear un nuevo `CategoriesDataTable` método llamado `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-147">We can then update the `GetCategories()` method in the `CategoriesDataTable` to include this information or, alternatively, leave `GetCategories()` as-is and create a new `CategoriesDataTable` method called `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="4a5ef-148">Permiten s explorar ambas técnicas.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-148">Let s explore both of these techniques.</span></span> <span data-ttu-id="4a5ef-149">El primer enfoque es más fácil de implementar porque no queremos t es necesario actualizar la capa de acceso a datos; Sin embargo, requiere más de las comunicaciones con la base de datos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-149">The first approach is simpler to implement since we don t need to update the Data Access Layer; however, it requires more communications with the database.</span></span> <span data-ttu-id="4a5ef-150">La llamada a la `ProductsBLL` clase s `GetProductsByCategoryID(categoryID)` método en el `ItemDataBound` controlador de eventos agrega una llamada de la base de datos adicional para cada categoría de muestra del repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-150">The call to the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method in the `ItemDataBound` event handler adds an extra database call for each category displayed in the Repeater.</span></span> <span data-ttu-id="4a5ef-151">Con esta técnica hay *N* + 1 base de datos de llamadas, donde *N* es el número de categorías que se muestran en el repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-151">With this technique there are *N* + 1 database calls, where *N* is the number of categories displayed in the Repeater.</span></span> <span data-ttu-id="4a5ef-152">Con el segundo método, se devuelve el recuento de productos con información acerca de cada categoría de la `CategoriesBLL` clase s `GetCategories()` (o `GetCategoriesAndNumberOfProducts()`) método, lo que resulta en un solo de ida y vuelta a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-152">With the second approach, the product count is returned with information about each category from the `CategoriesBLL` class s `GetCategories()` (or `GetCategoriesAndNumberOfProducts()`) method, thereby resulting in just one trip to the database.</span></span>

## <a name="determining-the-number-of-products-in-the-itemdatabound-event-handler"></a><span data-ttu-id="4a5ef-153">Determinar el número de productos en el controlador de evento ItemDataBound</span><span class="sxs-lookup"><span data-stu-id="4a5ef-153">Determining the Number of Products in the ItemDataBound Event Handler</span></span>

<span data-ttu-id="4a5ef-154">Determinar el número de productos para cada categoría de repetidor s `ItemDataBound` controlador de eventos no requiere ninguna modificación en la capa de acceso a datos existente.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-154">Determining the number of products for each category in the Repeater s `ItemDataBound` event handler does not require any modifications to our existing Data Access Layer.</span></span> <span data-ttu-id="4a5ef-155">Se pueden realizar todas las modificaciones directamente en la `CategoriesAndProducts.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-155">All modifications can be made directly within the `CategoriesAndProducts.aspx` page.</span></span> <span data-ttu-id="4a5ef-156">Empiece agregando un nuevo ObjectDataSource denominado `CategoriesDataSource` a través de la etiqueta inteligente de repetidor s.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-156">Start by adding a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="4a5ef-157">A continuación, configure la `CategoriesDataSource` ObjectDataSource por lo que TI recupera sus datos de la `CategoriesBLL` clase s. `GetCategories()` método.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-157">Next, configure the `CategoriesDataSource` ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories()` method.</span></span>


<span data-ttu-id="4a5ef-158">[![Configurar el ObjectDataSource para utilizar la clase CategoriesBLL s GetCategories() (método)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-158">[![Configure the ObjectDataSource to Use the CategoriesBLL class s GetCategories() Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image8.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image7.png)</span></span>

<span data-ttu-id="4a5ef-159">**Figura 3**: configurar el ObjectDataSource que se utilizan los `CategoriesBLL` clase s `GetCategories()` método ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-159">**Figure 3**: Configure the ObjectDataSource to Use the `CategoriesBLL` class s `GetCategories()` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image9.png))</span></span>


<span data-ttu-id="4a5ef-160">Cada elemento de la `Categories` repetidor debe ser seleccionable y, al hacer clic, provocar la `CategoryProducts` DataList para mostrar los productos de la categoría seleccionada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-160">Each item in the `Categories` Repeater needs to be clickable and, when clicked, cause the `CategoryProducts` DataList to display those products for the selected category.</span></span> <span data-ttu-id="4a5ef-161">Esto puede realizarse mediante la realización de cada categoría de un hipervínculo, vincular a esta misma página (`CategoriesAndProducts.aspx`), pero pasando el `CategoryID` a través de la cadena de consulta, mucho como vimos en el tutorial anterior.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-161">This can be accomplished by making each category a hyperlink, linking back to this same page (`CategoriesAndProducts.aspx`), but passing the `CategoryID` through the querystring, much like we saw in the previous tutorial.</span></span> <span data-ttu-id="4a5ef-162">La ventaja de este enfoque es que una página que muestra los productos de una categoría determinada s puede estar marcada e indizada por un motor de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-162">The advantage of this approach is that a page displaying a particular category s products can be bookmarked and indexed by a search engine.</span></span>

<span data-ttu-id="4a5ef-163">Como alternativa, podemos hacer que cada categoría de un control LinkButton, que es el enfoque que usaremos para este tutorial.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-163">Alternatively, we can make each category a LinkButton, which is the approach we'll use for this tutorial.</span></span> <span data-ttu-id="4a5ef-164">Se representa en el explorador del usuario s como un hipervínculo LinkButton pero, al hacer clic, induce a una devolución de datos; en la devolución de datos, las operaciones de asignación DataList ObjectDataSource tiene que actualizarse para mostrar los productos que pertenecen a la categoría seleccionada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-164">The LinkButton renders in the user s browser as a hyperlink but, when clicked, induces a postback; on postback, the DataList s ObjectDataSource needs to be refreshed to display those products belonging to the selected category.</span></span> <span data-ttu-id="4a5ef-165">Para este tutorial, utilizando un hipervínculo resulta más apropiado que el uso de un control LinkButton; Sin embargo, puede haber otros escenarios donde es más conveniente utilizar un control LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-165">For this tutorial, using a hyperlink makes more sense than using a LinkButton; however, there may be other scenarios where using a LinkButton is more advantageous.</span></span> <span data-ttu-id="4a5ef-166">Mientras que el enfoque de hipervínculo es ideal para este ejemplo, permiten s en su lugar, explican cómo utilizar el control LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-166">While the hyperlink approach would be ideal for this example, let s instead explore using the LinkButton.</span></span> <span data-ttu-id="4a5ef-167">Como veremos, utilizar un control LinkButton presenta algunos desafíos que en caso contrario, no se producirá con un hipervínculo.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-167">As we'll see, using a LinkButton introduces some challenges that would not otherwise arise with a hyperlink.</span></span> <span data-ttu-id="4a5ef-168">Por lo tanto, el uso un LinkButton en este tutorial se resalte estos desafíos y ayudar a proporcionar soluciones para estos escenarios donde podemos deseamos usar un control LinkButton en lugar de un hipervínculo.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-168">Therefore, using a LinkButton in this tutorial will highlight these challenges and help provide solutions for those scenarios where we may want to use a LinkButton instead of a hyperlink.</span></span>

> [!NOTE]
> <span data-ttu-id="4a5ef-169">Se recomienda repetir este tutorial con un control de hipervínculo o `<a>` elemento en lugar de LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-169">You are encouraged to repeat this tutorial using a HyperLink control or `<a>` element in lieu of the LinkButton.</span></span>


<span data-ttu-id="4a5ef-170">El marcado siguiente muestra la sintaxis declarativa para repetidor y ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-170">The following markup shows the declarative syntax for the Repeater and the ObjectDataSource.</span></span> <span data-ttu-id="4a5ef-171">Tenga en cuenta que las plantillas de s repetidor representan una lista con viñetas con cada elemento como un control LinkButton:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-171">Note that the Repeater s templates render a bulleted list with each item as a LinkButton:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="4a5ef-172">Para este tutorial repetidor debe tener su estado de vista habilitado (tenga en cuenta la omisión de la `EnableViewState="False"` de la sintaxis declarativa de repetidor s).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-172">For this tutorial the Repeater must have its view state enabled (note the omission of the `EnableViewState="False"` from the Repeater s declarative syntax).</span></span> <span data-ttu-id="4a5ef-173">En el paso 3 se creará un controlador de eventos para el repetidor s `ItemCommand` eventos en el que se va a actualizar DataList s s ObjectDataSource `SelectParameters` colección.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-173">In step 3 we'll be creating an event handler for the Repeater s `ItemCommand` event in which we'll be updating the DataList s ObjectDataSource s `SelectParameters` collection.</span></span> <span data-ttu-id="4a5ef-174">Repetidor s `ItemCommand`, sin embargo, ganó incendio t si el estado de vista está deshabilitado.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-174">The Repeater s `ItemCommand`, however, won t fire if view state is disabled.</span></span> <span data-ttu-id="4a5ef-175">Vea [más difíciles de A una pregunta de ASP.NET](http://scottonwriting.net/sowblog/posts/1263.aspx) y [su solución](http://scottonwriting.net/sowBlog/posts/1268.aspx) para obtener más información sobre por qué el estado de vista debe estar habilitado para un repetidor s `ItemCommand` activación del evento.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-175">See [A Stumper of an ASP.NET Question](http://scottonwriting.net/sowblog/posts/1263.aspx) and [its solution](http://scottonwriting.net/sowBlog/posts/1268.aspx) for more information on why view state must be enabled for a Repeater s `ItemCommand` event to fire.</span></span>


<span data-ttu-id="4a5ef-176">LinkButton con el `ID` valor de propiedad de `ViewCategory` no tiene su `Text` conjunto de propiedades.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-176">The LinkButton with the `ID` property value of `ViewCategory` does not have its `Text` property set.</span></span> <span data-ttu-id="4a5ef-177">Si hubiéramos Queríamos saber el nombre de categoría para mostrar, se habría establezca la propiedad Text mediante declaración, mediante la sintaxis de enlace de datos, como:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-177">If we had just wanted to display the category name, we would have set the Text property declaratively, through databinding syntax, like so:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample5.aspx)]

<span data-ttu-id="4a5ef-178">Sin embargo, queremos que aparezca el nombre de categoría s *y* el número de productos que pertenecen a esa categoría.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-178">However, we want to show both the category s name *and* the number of products belonging to that category.</span></span> <span data-ttu-id="4a5ef-179">Esta información se puede recuperar desde el repetidor s `ItemDataBound` controlador de eventos mediante la realización de una llamada a la `ProductBLL` clase s `GetCategoriesByProductID(categoryID)` método y determinar cuántos registros se devuelven en el cuadro `ProductsDataTable`, como el código siguiente se muestran:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-179">This information can be retrieved from the Repeater s `ItemDataBound` event handler by making a call to the `ProductBLL` class s `GetCategoriesByProductID(categoryID)` method and determining how many records are returned in the resulting `ProductsDataTable`, as the following code illustrates:</span></span>


[!code-vb[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="4a5ef-180">Empezamos asegurándose de que se está trabajando con un elemento de datos (uno cuyo `ItemType` es `Item` o `AlternatingItem`) y, a continuación, hacer referencia a la `CategoriesRow` instancia que solo se ha enlazado a la actual `RepeaterItem`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-180">We start out by ensuring that we re working with a data item (one whose `ItemType` is `Item` or `AlternatingItem`) and then reference the `CategoriesRow` instance that has just been bound to the current `RepeaterItem`.</span></span> <span data-ttu-id="4a5ef-181">A continuación, se determina el número de productos para esta categoría mediante la creación de una instancia de la `ProductsBLL` de la clase, una llamada a su `GetCategoriesByProductID(categoryID)` método y determinar el número de registros devueltos usando la `Count` propiedad.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-181">Next, we determine the number of products for this category by creating an instance of the `ProductsBLL` class, calling its `GetCategoriesByProductID(categoryID)` method, and determining the number of records returned using the `Count` property.</span></span> <span data-ttu-id="4a5ef-182">Por último, el `ViewCategory` LinkButton en ItemTemplate es references y su `Text` propiedad está establecida en *CategoryName* (*NumberOfProductsInCategory*), donde  *NumberOfProductsInCategory* se da formato como un número con cero posiciones decimales.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-182">Finally, the `ViewCategory` LinkButton in the ItemTemplate is references and its `Text` property is set to *CategoryName* (*NumberOfProductsInCategory*), where *NumberOfProductsInCategory* is formatted as a number with zero decimal places.</span></span>

> [!NOTE]
> <span data-ttu-id="4a5ef-183">Como alternativa, podríamos haber agregamos una *formato función* a la clase de código subyacente ASP.NET página s que acepta una categoría s `CategoryName` y `CategoryID` valores y devuelve el `CategoryName` concatenado con el número de productos de la categoría (según lo determinado por una llamada a la `GetCategoriesByProductID(categoryID)` método).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-183">Alternatively, we could have added a *formatting function* to the ASP.NET page s code-behind class that accepts a category s `CategoryName` and `CategoryID` values and returns the `CategoryName` concatenated with the number of products in the category (as determined by calling the `GetCategoriesByProductID(categoryID)` method).</span></span> <span data-ttu-id="4a5ef-184">Los resultados de una función de este formato se pudieron asignar mediante declaración a las operaciones de asignación LinkButton Text (propiedad) reemplaza la necesidad de la `ItemDataBound` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-184">The results of such a formatting function could be declaratively assigned to the LinkButton s Text property replacing the need for the `ItemDataBound` event handler.</span></span> <span data-ttu-id="4a5ef-185">Hacer referencia a la [utilizando TemplateFields en el GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) o [dar formato al DataList y repetidor basado en datos](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutoriales para obtener más información sobre el uso de funciones de formato.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-185">Refer to the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) or [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutorials for more information on using formatting functions.</span></span>


<span data-ttu-id="4a5ef-186">Después de agregar este controlador de eventos, tómese un momento para probar la página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-186">After adding this event handler, take a moment to test the page through a browser.</span></span> <span data-ttu-id="4a5ef-187">Tenga en cuenta cómo se muestra cada categoría en una lista con viñetas, mostrar el nombre de categoría s y el número de productos asociados con la categoría (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-187">Note how each category is listed in a bulleted list, displaying the category s name and the number of products associated with the category (see Figure 4).</span></span>


<span data-ttu-id="4a5ef-188">[![Se muestran cada s nombre de categoría y el número de productos](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-188">[![Each Category s Name and Number of Products are Displayed](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image11.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image10.png)</span></span>

<span data-ttu-id="4a5ef-189">**Figura 4**: se muestran cada categoría s nombre y número de productos ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-189">**Figure 4**: Each Category s Name and Number of Products are Displayed ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image12.png))</span></span>


## <a name="updating-thecategoriesdatatableandcategoriestableadapterto-include-the-number-of-products-for-each-category"></a><span data-ttu-id="4a5ef-190">Actualizando el`CategoriesDataTable`y`CategoriesTableAdapter`para que incluya el número de productos para cada categoría</span><span class="sxs-lookup"><span data-stu-id="4a5ef-190">Updating the`CategoriesDataTable`and`CategoriesTableAdapter`to Include the Number of Products for Each Category</span></span>

<span data-ttu-id="4a5ef-191">En lugar de determinar el número de productos de cada categoría tal y como s se enlazan a repetidor, podemos simplificar el proceso mediante el ajuste de la `CategoriesDataTable` y `CategoriesTableAdapter` en la capa de acceso a datos para incluir esta información de forma nativa.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-191">Rather than determining the number of products for each category as it s bound to the Repeater, we can streamline this process by adjusting the `CategoriesDataTable` and `CategoriesTableAdapter` in the Data Access Layer to include this information natively.</span></span> <span data-ttu-id="4a5ef-192">Para lograr esto, debemos agregar una nueva columna a `CategoriesDataTable` para contener el número de productos asociados.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-192">To achieve this, we must add a new column to `CategoriesDataTable` to hold the number of associated products.</span></span> <span data-ttu-id="4a5ef-193">Para agregar una nueva columna a una tabla de datos, abra el conjunto de datos con tipo (`App_Code\DAL\Northwind.xsd`), haga doble clic en la tabla de datos para modificar y elija Agregar / columna.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-193">To add a new column to a DataTable, open the Typed DataSet (`App_Code\DAL\Northwind.xsd`), right-click on the DataTable to modify, and choose Add / Column.</span></span> <span data-ttu-id="4a5ef-194">Agregar una nueva columna a la `CategoriesDataTable` (Véase la figura 5).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-194">Add a new column to the `CategoriesDataTable` (see Figure 5).</span></span>


<span data-ttu-id="4a5ef-195">[![Agregar una nueva columna a la CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-195">[![Add a New Column to the CategoriesDataSource](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image14.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image13.png)</span></span>

<span data-ttu-id="4a5ef-196">**Figura 5**: agregar una nueva columna a la `CategoriesDataSource` ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-196">**Figure 5**: Add a New Column to the `CategoriesDataSource` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image15.png))</span></span>


<span data-ttu-id="4a5ef-197">Esto agregará una nueva columna denominada `Column1`, que puede cambiar escribiendo simplemente en un nombre diferente.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-197">This will add a new column named `Column1`, which you can change by simply typing in a different name.</span></span> <span data-ttu-id="4a5ef-198">Cambiar el nombre de esta nueva columna a `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-198">Rename this new column to `NumberOfProducts`.</span></span> <span data-ttu-id="4a5ef-199">A continuación, necesitamos configurar estas propiedades de columna s.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-199">Next, we need to configure this column s properties.</span></span> <span data-ttu-id="4a5ef-200">Haga clic en la nueva columna y vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-200">Click on the new column and go to the Properties window.</span></span> <span data-ttu-id="4a5ef-201">Cambiar la columna s `DataType` propiedad de `System.String` a `System.Int32` y establezca el `ReadOnly` propiedad `True`, tal y como se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-201">Change the column s `DataType` property from `System.String` to `System.Int32` and set the `ReadOnly` property to `True`, as shown in Figure 6.</span></span>


![Establecer las propiedades de solo lectura de la nueva columna y el tipo de datos](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image16.png)

<span data-ttu-id="4a5ef-203">**Figura 6**: establecer el `DataType` y `ReadOnly` propiedades de la nueva columna</span><span class="sxs-lookup"><span data-stu-id="4a5ef-203">**Figure 6**: Set the `DataType` and `ReadOnly` Properties of the New Column</span></span>


<span data-ttu-id="4a5ef-204">Mientras el `CategoriesDataTable` tiene ahora un `NumberOfProducts` columna, su valor no se establece por cualquiera de las consultas de s TableAdapter correspondientes.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-204">While the `CategoriesDataTable` now has a `NumberOfProducts` column, its value is not set by any of the corresponding TableAdapter s queries.</span></span> <span data-ttu-id="4a5ef-205">Podemos actualizar el `GetCategories()` método para devolver esta información si deseamos que dicha información devuelve cada vez que se recupera información de categoría.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-205">We can update the `GetCategories()` method to return this information if we want such information returned every time category information is retrieved.</span></span> <span data-ttu-id="4a5ef-206">Si, sin embargo, únicamente se necesita obtener el número de productos asociados para las categorías en algunos casos (por ejemplo, como en este tutorial), podemos dejar `GetCategories()` como-es y cree un nuevo método que devuelve esta información.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-206">If, however, we only need to grab the number of associated products for the categories in rare instances (such as just for this tutorial), then we can leave `GetCategories()` as-is and create a new method that returns this information.</span></span> <span data-ttu-id="4a5ef-207">S permiten usar este último enfoque, crear un nuevo método denominado `GetCategoriesAndNumberOfProducts()`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-207">Let s use this latter approach, creating a new method named `GetCategoriesAndNumberOfProducts()`.</span></span>

<span data-ttu-id="4a5ef-208">Para agregar este nuevo `GetCategoriesAndNumberOfProducts()` método, el botón secundario en el `CategoriesTableAdapter` y elija la nueva consulta.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-208">To add this new `GetCategoriesAndNumberOfProducts()` method, right-click on the `CategoriesTableAdapter` and choose New Query.</span></span> <span data-ttu-id="4a5ef-209">Se abrirá el TableAdapter consultar a Asistente de configuración, que se ve usa varias veces en los tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-209">This brings up the TableAdapter Query Configuration Wizard, which we ve used numerous times in previous tutorials.</span></span> <span data-ttu-id="4a5ef-210">Para este método, inicie al asistente que indica que la consulta utiliza una instrucción SQL ad hoc que devuelve filas.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-210">For this method, start the wizard by indicating that the query uses an ad-hoc SQL statement that returns rows.</span></span>


<span data-ttu-id="4a5ef-211">[![Cree el método con una instrucción de SQL Ad Hoc](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-211">[![Create the Method Using an Ad-Hoc SQL Statement](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image18.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image17.png)</span></span>

<span data-ttu-id="4a5ef-212">**Figura 7**: crear el método mediante una instrucción de SQL Ad Hoc ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-212">**Figure 7**: Create the Method Using an Ad-Hoc SQL Statement ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image19.png))</span></span>


<span data-ttu-id="4a5ef-213">[![La instrucción SQL devuelve filas](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-213">[![The SQL Statement Returns Rows](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image21.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image20.png)</span></span>

<span data-ttu-id="4a5ef-214">**Figura 8**: The SQL instrucción devuelve filas ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-214">**Figure 8**: The SQL Statement Returns Rows ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image22.png))</span></span>


<span data-ttu-id="4a5ef-215">La siguiente pantalla del asistente pide us para la consulta que se utilizará.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-215">The next wizard screen prompts us for the query to use.</span></span> <span data-ttu-id="4a5ef-216">Para devolver cada categoría s `CategoryID`, `CategoryName`, y `Description` campos, junto con el número de productos asociados con la categoría, utilizan la siguiente `SELECT` instrucción:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-216">To return each category s `CategoryID`, `CategoryName`, and `Description` fields, along with the number of products associated with the category, use the following `SELECT` statement:</span></span>


[!code-sql[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample7.sql)]


<span data-ttu-id="4a5ef-217">[![Especifique la consulta que se utilizan](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-217">[![Specify the Query to Use](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image24.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image23.png)</span></span>

<span data-ttu-id="4a5ef-218">**Figura 9**: especifique la consulta que se utilizan ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-218">**Figure 9**: Specify the Query to Use ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image25.png))</span></span>


<span data-ttu-id="4a5ef-219">Tenga en cuenta que la subconsulta que calcula el número de productos asociados con la categoría es un alias como `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-219">Note that the subquery that computes the number of products associated with the category is aliased as `NumberOfProducts`.</span></span> <span data-ttu-id="4a5ef-220">Esta coincidencia nomenclatura hace que el valor devuelto por esta subconsulta para asociar a la `CategoriesDataTable` s `NumberOfProducts` columna.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-220">This naming match causes the value returned by this subquery to be associated with the `CategoriesDataTable` s `NumberOfProducts` column.</span></span>

<span data-ttu-id="4a5ef-221">Después de escribir esta consulta, el último paso es elegir el nombre para el nuevo método.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-221">After entering this query, the last step is to choose the name for the new method.</span></span> <span data-ttu-id="4a5ef-222">Use `FillWithNumberOfProducts` y `GetCategoriesAndNumberOfProducts` para el relleno una DataTable y devolver un DataTable patrones, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-222">Use `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span>


<span data-ttu-id="4a5ef-223">[![Nombre de la nueva FillWithNumberOfProducts de métodos de TableAdapter s y GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-223">[![Name the New TableAdapter s Methods FillWithNumberOfProducts and GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image27.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image26.png)</span></span>

<span data-ttu-id="4a5ef-224">**Figura 10**: el nombre de los métodos de TableAdapter nueva s `FillWithNumberOfProducts` y `GetCategoriesAndNumberOfProducts` ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-224">**Figure 10**: Name the New TableAdapter s Methods `FillWithNumberOfProducts` and `GetCategoriesAndNumberOfProducts` ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image28.png))</span></span>


<span data-ttu-id="4a5ef-225">En este punto, la capa de acceso a datos se ha ampliado para incluir el número de productos por categoría.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-225">At this point the Data Access Layer has been extended to include the number of products per category.</span></span> <span data-ttu-id="4a5ef-226">Puesto que nuestro de nivel de presentación enruta todas las llamadas a la capa DAL a través de una capa de lógica empresarial independiente que necesitamos agregar correspondiente `GetCategoriesAndNumberOfProducts` método a la `CategoriesBLL` clase:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-226">Since all our presentation layer routes all calls to the DAL through a separate Business Logic Layer we need to add a corresponding `GetCategoriesAndNumberOfProducts` method to the `CategoriesBLL` class:</span></span>


[!code-vb[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample8.vb)]

<span data-ttu-id="4a5ef-227">Con la capa DAL y BLL completa, se re está listo para enlazar estos datos a la `Categories` repetidor en `CategoriesAndProducts.aspx`!</span><span class="sxs-lookup"><span data-stu-id="4a5ef-227">With the DAL and BLL complete, we re ready to bind this data to the `Categories` Repeater in `CategoriesAndProducts.aspx`!</span></span> <span data-ttu-id="4a5ef-228">Si se ha creado ya un ObjectDataSource para repetidor desde el determinar el número de productos en la `ItemDataBound` sección del controlador de eventos, elimine este ObjectDataSource y quitar repetidor s `DataSourceID` propiedad también configuración; sin líos el Repetidor s `ItemDataBound` evento desde el controlador de eventos mediante la eliminación de la `Handles Categories.OnItemDataBound` sintaxis de la clase de código subyacente ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-228">If you ve already created an ObjectDataSource for the Repeater from the Determining the Number of Products in the `ItemDataBound` Event Handler section, delete this ObjectDataSource and remove the Repeater s `DataSourceID` property setting; also unwire the Repeater s `ItemDataBound` event from the event handler by removing the `Handles Categories.OnItemDataBound` syntax in the ASP.NET code-behind class.</span></span>

<span data-ttu-id="4a5ef-229">Con repetidor su estado original, agregar un nuevo origen ObjectDataSource denominado `CategoriesDataSource` a través de la etiqueta inteligente de repetidor s.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-229">With the Repeater back in its original state, add a new ObjectDataSource named `CategoriesDataSource` via the Repeater s smart tag.</span></span> <span data-ttu-id="4a5ef-230">Configurar el ObjectDataSource para usar el `CategoriesBLL` (clase), pero en lugar de tener usar el `GetCategories()` método, se lo use `GetCategoriesAndNumberOfProducts()` en su lugar (consulte la figura 11).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-230">Configure the ObjectDataSource to use the `CategoriesBLL` class, but instead of having it use the `GetCategories()` method, have it use `GetCategoriesAndNumberOfProducts()` instead (see Figure 11).</span></span>


<span data-ttu-id="4a5ef-231">[![Configurar el ObjectDataSource para utilizar el método GetCategoriesAndNumberOfProducts](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-231">[![Configure the ObjectDataSource to Use the GetCategoriesAndNumberOfProducts Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image30.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image29.png)</span></span>

<span data-ttu-id="4a5ef-232">**Figura 11**: configurar el ObjectDataSource que se utilizan los `GetCategoriesAndNumberOfProducts` método ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-232">**Figure 11**: Configure the ObjectDataSource to Use the `GetCategoriesAndNumberOfProducts` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image31.png))</span></span>


<span data-ttu-id="4a5ef-233">A continuación, actualice el `ItemTemplate` para que las operaciones de asignación LinkButton `Text` propiedad se asigna mediante declaración con la sintaxis de enlace de datos e incluye tanto el `CategoryName` y `NumberOfProducts` campos de datos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-233">Next, update the `ItemTemplate` so that the LinkButton s `Text` property is declaratively assigned using databinding syntax and includes both the `CategoryName` and `NumberOfProducts` data fields.</span></span> <span data-ttu-id="4a5ef-234">El marcado declarativo completo para repetidor y `CategoriesDataSource` ObjectDataSource seguimiento:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-234">The complete declarative markup for the Repeater and the `CategoriesDataSource` ObjectDataSource follow:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample9.aspx)]

<span data-ttu-id="4a5ef-235">El resultado representado mediante la actualización de la capa DAL para incluir un `NumberOfProducts` columna es lo mismo que usar el `ItemDataBound` enfoque de controlador de eventos (hacen referencia a la figura 4 para ver la pantalla de captura del repetidor que muestra los nombres de categoría y el número de productos).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-235">The output rendered by updating the DAL to include a `NumberOfProducts` column is the same as using the `ItemDataBound` event handler approach (refer back to Figure 4 to see a screen shot of the Repeater showing the category names and number of products).</span></span>

## <a name="step-3-displaying-the-selected-category-s-products"></a><span data-ttu-id="4a5ef-236">Paso 3: Mostrar los productos de s de la categoría seleccionada</span><span class="sxs-lookup"><span data-stu-id="4a5ef-236">Step 3: Displaying the Selected Category s Products</span></span>

<span data-ttu-id="4a5ef-237">En este momento tenemos el `Categories` repetidor mostrar la lista de categorías junto con el número de productos en cada categoría.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-237">At this point we have the `Categories` Repeater displaying the list of categories along with the number of products in each category.</span></span> <span data-ttu-id="4a5ef-238">Repetidor usa un LinkButton para cada categoría que, al hacer clic, hace una devolución de datos, en la que señalan se necesitan para mostrar los productos de la categoría seleccionada en el `CategoryProducts` DataList.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-238">The Repeater uses a LinkButton for each category that, when clicked, causes a postback, at which point we need to display those products for the selected category in the `CategoryProducts` DataList.</span></span>

<span data-ttu-id="4a5ef-239">Presenta la dificultad nos encontramos es cómo hacer que el control DataList mostrar solo los productos para la categoría seleccionada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-239">One challenge facing us is how to have the DataList display just those products for the selected category.</span></span> <span data-ttu-id="4a5ef-240">En el [principal/detalle con un GridView maestro seleccionable DetailsView detalles](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) tutorial hemos visto cómo crear un control GridView cuyas filas se han podido seleccionar, con la fila seleccionada s detalles que se muestran en un DetailsView en la misma página.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-240">In the [Master/Detail Using a Selectable Master GridView with a Details DetailsView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) tutorial we saw how to build a GridView whose rows could be selected, with the selected row s details being displayed in a DetailsView on the same page.</span></span> <span data-ttu-id="4a5ef-241">Las operaciones de asignación GridView ObjectDataSource devuelve información acerca de todos los productos con el `ProductsBLL` s `GetProducts()` método mientras la s de DetailsView ObjectDataSource recupera información sobre el uso de producto seleccionado el `GetProductsByProductID(productID)` método.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-241">The GridView s ObjectDataSource returned information about all products using the `ProductsBLL` s `GetProducts()` method while the DetailsView s ObjectDataSource retrieved information about the selected product using the `GetProductsByProductID(productID)` method.</span></span> <span data-ttu-id="4a5ef-242">El  *`productID`*  el valor del parámetro se proporciona mediante declaración mediante la asociación con el valor de las operaciones de asignación GridView `SelectedValue` propiedad.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-242">The *`productID`* parameter value was provided declaratively by associating it with the value of the GridView s `SelectedValue` property.</span></span> <span data-ttu-id="4a5ef-243">Por desgracia, repetidor no tiene un `SelectedValue` propiedad y no puede actuar como un origen del parámetro.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-243">Unfortunately, the Repeater does not have a `SelectedValue` property and cannot serve as a parameter source.</span></span>

> [!NOTE]
> <span data-ttu-id="4a5ef-244">Este es uno de los desafíos que aparecen cuando se usa el control LinkButton en un repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-244">This is one of those challenges that appear when using the LinkButton in a Repeater.</span></span> <span data-ttu-id="4a5ef-245">Habíamos utiliza un hipervínculo para pasar el `CategoryID` a través de la cadena de consulta en su lugar, podríamos usar ese campo de cadena de consulta como origen para el valor del parámetro.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-245">Had we used a hyperlink to pass in the `CategoryID` through the querystring instead, we could use that QueryString field as the source for the parameter s value.</span></span>


<span data-ttu-id="4a5ef-246">Antes de que nos preocupamos por la falta de un `SelectedValue` de repetidor, sin embargo, let de la propiedad s enlazar el control DataList a un origen ObjectDataSource en primer lugar y especificar su `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-246">Before we worry about the lack of a `SelectedValue` property for the Repeater, though, let s first bind the DataList to an ObjectDataSource and specify its `ItemTemplate`.</span></span>

<span data-ttu-id="4a5ef-247">Desde la etiqueta inteligente de DataList s, optar por agregar una nueva ObjectDataSource denominado `CategoryProductsDataSource` y configúrelo para utilizar el `ProductsBLL` clase s. `GetProductsByCategoryID(categoryID)` método.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-247">From the DataList s smart tag, opt to add a new ObjectDataSource named `CategoryProductsDataSource` and configure it to use the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="4a5ef-248">Puesto que el control DataList en este tutorial ofrece una interfaz de solo lectura, no dude en establecer las listas desplegables en la instrucción INSERT, UPDATE y eliminar las fichas (ninguno).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-248">Since the DataList in this tutorial offers a read-only interface, feel free to set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="4a5ef-249">[![Configurar el ObjectDataSource para usar la clase ProductsBLL s GetProductsByCategoryID(categoryID) (método)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-249">[![Configure the ObjectDataSource to Use ProductsBLL Class s GetProductsByCategoryID(categoryID) Method](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image33.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image32.png)</span></span>

<span data-ttu-id="4a5ef-250">**Figura 12**: configurar el ObjectDataSource que se utilizan `ProductsBLL` clase s `GetProductsByCategoryID(categoryID)` método ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-250">**Figure 12**: Configure the ObjectDataSource to Use `ProductsBLL` Class s `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image34.png))</span></span>


<span data-ttu-id="4a5ef-251">Puesto que la `GetProductsByCategoryID(categoryID)` método espera un parámetro de entrada (*`categoryID`*), el Asistente para configurar orígenes de datos nos permite especificar el origen de s de parámetro.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-251">Since the `GetProductsByCategoryID(categoryID)` method expects an input parameter (*`categoryID`*), the Configure Data Source wizard allows us to specify the parameter s source.</span></span> <span data-ttu-id="4a5ef-252">Tenían las categorías se han incluido en un control GridView o un control DataList, d establecemos la lista desplegable de origen de parámetro para el Control y la ControlID a la `ID` de los datos de control Web.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-252">Had the categories been listed in a GridView or a DataList, we d set the Parameter source drop-down list to Control and the ControlID to the `ID` of the data Web control.</span></span> <span data-ttu-id="4a5ef-253">Sin embargo, como la falta de repetidor un `SelectedValue` no se puede usar como un origen de los parámetros de propiedad.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-253">However, since the Repeater lacks a `SelectedValue` property it cannot be used as a parameter source.</span></span> <span data-ttu-id="4a5ef-254">Si se selecciona, encontrará que la lista desplegable de ControlID sólo contiene un control `ID``CategoryProducts`, el `ID` del control DataList.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-254">If you check, you'll find that the ControlID drop-down list only contains one control `ID``CategoryProducts`, the `ID` of the DataList.</span></span>

<span data-ttu-id="4a5ef-255">Por ahora, establezca la lista desplegable de origen de parámetro en ninguno.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-255">For now, set the Parameter source drop-down list to None.</span></span> <span data-ttu-id="4a5ef-256">Se terminará mediante programación asignar este valor de parámetro cuando una categoría que se hace clic en LinkButton del repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-256">We'll end up programmatically assigning this parameter value when a category LinkButton is clicked in the Repeater.</span></span>


<span data-ttu-id="4a5ef-257">[![Hacer no especificar un origen de parámetro para el parámetro categoryID](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-257">[![Do Not Specify a Parameter Source for the categoryID Parameter](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image36.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image35.png)</span></span>

<span data-ttu-id="4a5ef-258">**Figura 13**: no se especifique un origen de parámetro para la  *`categoryID`*  parámetro ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-258">**Figure 13**: Do Not Specify a Parameter Source for the *`categoryID`* Parameter ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image37.png))</span></span>


<span data-ttu-id="4a5ef-259">Después de completar el Asistente para configurar orígenes de datos, Visual Studio genera automáticamente el control DataList s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-259">After completing the Configure Data Source wizard, Visual Studio auto-generates the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="4a5ef-260">Reemplace este valor predeterminado `ItemTemplate` con la plantilla se utilizado en el tutorial anterior; además, establezca la DataList s `RepeatColumns` propiedad en 2.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-260">Replace this default `ItemTemplate` with the template we used in the preceding tutorial; also, set the DataList s `RepeatColumns` property to 2.</span></span> <span data-ttu-id="4a5ef-261">Después de realizar estos cambios en el marcado declarativo para su DataList y su ObjectDataSource asociado debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-261">After making these changes the declarative markup for your DataList and its associated ObjectDataSource should look like the following:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample10.aspx)]

<span data-ttu-id="4a5ef-262">Actualmente, el `CategoryProductsDataSource` ObjectDataSource s  *`categoryID`*  parámetro nunca se establece, por lo que no hay productos se muestran al ver la página.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-262">Currently, the `CategoryProductsDataSource` ObjectDataSource s *`categoryID`* parameter is never set, so no products are displayed when viewing the page.</span></span> <span data-ttu-id="4a5ef-263">Lo que debemos hacer es establecer este valor de parámetro en función de la `CategoryID` de la categoría donde ha hecho clic del control de repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-263">What we need to do is have this parameter value set based on the `CategoryID` of the clicked category in the Repeater.</span></span> <span data-ttu-id="4a5ef-264">Esto presenta dos desafíos: en primer lugar, cómo se determina cuando un LinkButton del repetidor s `ItemTemplate` se ha presionado; y el segundo, ¿cómo podemos determinar el `CategoryID` de la categoría correspondiente se ha hecho clic cuyo LinkButton?</span><span class="sxs-lookup"><span data-stu-id="4a5ef-264">This introduces two challenges: first, how do we determine when a LinkButton in the Repeater s `ItemTemplate` has been clicked; and second, how can we determine the `CategoryID` of the corresponding category whose LinkButton was clicked?</span></span>

<span data-ttu-id="4a5ef-265">LinkButton similar a los controles de botón y ImageButton tiene un `Click` eventos y un [ `Command` eventos](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-265">The LinkButton like the Button and ImageButton controls has a `Click` event and a [`Command` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.command.aspx).</span></span> <span data-ttu-id="4a5ef-266">El `Click` evento está diseñado para simplemente tenga en cuenta que se ha hecho clic el LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-266">The `Click` event is designed to simply note that the LinkButton has been clicked.</span></span> <span data-ttu-id="4a5ef-267">En ocasiones, sin embargo, además de tener en cuenta que se ha hecho clic el LinkButton también es necesario pasar cierta información adicional para el controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-267">At times, however, in addition to noting that the LinkButton has been clicked we also need to pass some extra information to the event handler.</span></span> <span data-ttu-id="4a5ef-268">Si este es el caso, las operaciones de asignación LinkButton [ `CommandName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) y [ `CommandArgument` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) propiedades se pueden asignar esta información adicional.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-268">If this is the case, the LinkButton s [`CommandName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandname.aspx) and [`CommandArgument`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.linkbutton.commandargument.aspx) properties can be assigned this extra information.</span></span> <span data-ttu-id="4a5ef-269">A continuación, cuando se hace clic en el control LinkButton, su `Command` desencadena el evento (en lugar de su `Click` evento) y el controlador de eventos se pasa los valores de la `CommandName` y `CommandArgument` propiedades.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-269">Then, when the LinkButton is clicked, its `Command` event fires (instead of its `Click` event) and the event handler is passed the values of the `CommandName` and `CommandArgument` properties.</span></span>

<span data-ttu-id="4a5ef-270">Cuando un `Command` evento se provoca desde dentro de una plantilla de repetidor, las operaciones de asignación repetidor [ `ItemCommand` eventos](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) se activa y se pasa el `CommandName` y `CommandArgument` valores de lo clic LinkButton (o botón o ImageButton).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-270">When a `Command` event is raised from within a template in the Repeater, the Repeater s [`ItemCommand` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.repeater.itemcommand.aspx) fires and is passed the `CommandName` and `CommandArgument` values of the clicked LinkButton (or Button or ImageButton).</span></span> <span data-ttu-id="4a5ef-271">Por lo tanto, para determinar cuándo se ha hecho clic una categoría LinkButton del repetidor, necesitamos hacer lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-271">Therefore, to determine when a category LinkButton in the Repeater has been clicked, we need to do the following:</span></span>

1. <span data-ttu-id="4a5ef-272">Establecer el `CommandName` propiedad de LinkButton del repetidor s `ItemTemplate` a algún valor (se ha utilizado ListProducts).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-272">Set the `CommandName` property of the LinkButton in the Repeater s `ItemTemplate` to some value (I ve used ListProducts ).</span></span> <span data-ttu-id="4a5ef-273">Estableciendo este `CommandName` valor, las operaciones de asignación LinkButton `Command` evento se desencadena cuando se hace clic en el control LinkButton.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-273">By setting this `CommandName` value, the LinkButton s `Command` event fires when the LinkButton is clicked.</span></span>
2. <span data-ttu-id="4a5ef-274">Establecer la s LinkButton `CommandArgument` en el valor del elemento actual s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-274">Set the LinkButton s `CommandArgument` property to the value of the current item s `CategoryID`.</span></span>
3. <span data-ttu-id="4a5ef-275">Crear un controlador de eventos para el repetidor s `ItemCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-275">Create an event handler for the Repeater s `ItemCommand` event.</span></span> <span data-ttu-id="4a5ef-276">Conjunto de eventos de controlador, el `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parámetro en el valor del pasado `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-276">In the event handler, set the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span>

<span data-ttu-id="4a5ef-277">El siguiente `ItemTemplate` marcado para categorías repetidor implementa los pasos 1 y 2.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-277">The following `ItemTemplate` markup for the Categories Repeater implements steps 1 and 2.</span></span> <span data-ttu-id="4a5ef-278">Tenga en cuenta cómo el `CommandArgument` valor se asigna el elemento de datos s `CategoryID` mediante sintaxis de enlace de datos:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-278">Note how the `CommandArgument` value is assigned the data item s `CategoryID` using databinding syntax:</span></span>


[!code-aspx[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample11.aspx)]

<span data-ttu-id="4a5ef-279">Cada vez que crea un `ItemCommand` controlador de eventos, es recomendable comprobar siempre primero entrante `CommandName` valor porque *cualquier* `Command` evento desencadenado por *cualquier* Button, LinkButton, o ImageButton dentro del repetidor provocará la `ItemCommand` activación del evento.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-279">Whenever creating an `ItemCommand` event handler it is prudent to always first check the incoming `CommandName` value because *any* `Command` event raised by *any* Button, LinkButton, or ImageButton within the Repeater will cause the `ItemCommand` event to fire.</span></span> <span data-ttu-id="4a5ef-280">Aunque actualmente solo tenemos un tal LinkButton ahora, en el futuro se (u otro programador en el equipo) ¿agregar controles de botón adicionales de Web a repetidor que, al hacer clic, genera los mismos `ItemCommand` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-280">While we currently only have one such LinkButton now, in the future we (or another developer on our team) might add additional button Web controls to the Repeater that, when clicked, raises the same `ItemCommand` event handler.</span></span> <span data-ttu-id="4a5ef-281">Por lo tanto, se s mejor Asegúrese siempre de que ha activado el `CommandName` propiedad y continuar solo con la lógica de programación si coincide con el valor esperado.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-281">Therefore, it s best to always make sure you check the `CommandName` property and only proceed with your programmatic logic if it matches up to the value expected.</span></span>

<span data-ttu-id="4a5ef-282">Después de asegurarse de que en el pasado `CommandName` valor es igual a ListProducts, el controlador de eventos, a continuación, asigna la `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parámetro en el valor del pasado `CommandArgument`.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-282">After ensuring that the passed-in `CommandName` value equals ListProducts, the event handler then assigns the `CategoryProductsDataSource` ObjectDataSource s `CategoryID` parameter to the value of the passed-in `CommandArgument`.</span></span> <span data-ttu-id="4a5ef-283">Esta modificación a las operaciones de asignación ObjectDataSource `SelectParameters` automáticamente hace que el control DataList a sí mismo enlazar al origen de datos, que muestra los productos de la categoría recién seleccionada.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-283">This modification to the ObjectDataSource s `SelectParameters` automatically causes the DataList to rebind itself to the data source, showing the products for the newly selected category.</span></span>


[!code-vb[Main](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/samples/sample12.vb)]

<span data-ttu-id="4a5ef-284">Con estas adiciones, nuestro tutorial es completa.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-284">With these additions, our tutorial is complete!</span></span> <span data-ttu-id="4a5ef-285">Tómese un momento para probarla en un explorador.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-285">Take a moment to test it out in a browser.</span></span> <span data-ttu-id="4a5ef-286">Figura 14 muestra la pantalla al primero visitar la página.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-286">Figure 14 shows the screen when first visiting the page.</span></span> <span data-ttu-id="4a5ef-287">Dado que aún no ha seleccionarse una categoría, no se muestran productos.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-287">Since a category has yet to be selected, no products are displayed.</span></span> <span data-ttu-id="4a5ef-288">Al hacer clic en una categoría, como crear, muestra los productos en la categoría de producto en una vista de dos columnas (consulte la figura 15).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-288">Clicking on a category, such as Produce, displays those products in the Product category in a two-column view (see Figure 15).</span></span>


<span data-ttu-id="4a5ef-289">[![No hay productos son muestra al primer visitar la página](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-289">[![No Products are Displayed When First Visiting the Page](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image39.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image38.png)</span></span>

<span data-ttu-id="4a5ef-290">**Figura 14**: los productos No son muestra al primer visitar la página ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-290">**Figure 14**: No Products are Displayed When First Visiting the Page ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image40.png))</span></span>


<span data-ttu-id="4a5ef-291">[![Al hacer clic en las listas de categorías de productos los productos correspondientes a la derecha](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-291">[![Clicking the Produce Category Lists the Matching Products to the Right](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image42.png)](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image41.png)</span></span>

<span data-ttu-id="4a5ef-292">**Figura 15**: al hacer clic en la categoría de productos se enumeran los productos de búsqueda de coincidencias a la derecha ([haga clic aquí para ver la imagen a tamaño completo](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="4a5ef-292">**Figure 15**: Clicking the Produce Category Lists the Matching Products to the Right ([Click to view full-size image](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb/_static/image43.png))</span></span>


## <a name="summary"></a><span data-ttu-id="4a5ef-293">Resumen</span><span class="sxs-lookup"><span data-stu-id="4a5ef-293">Summary</span></span>

<span data-ttu-id="4a5ef-294">Como hemos visto en este tutorial y la anterior, principal-detalle informes pueden estar repartidos por dos páginas o consolidaron en uno.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-294">As we saw in this tutorial and the preceding one, master/detail reports can be spread out across two pages, or consolidated on one.</span></span> <span data-ttu-id="4a5ef-295">Mostrar un informe de maestro y detalles en una sola página, sin embargo, presenta algunos desafíos sobre cómo mejor para escribir registros de detalles en la página y el patrón de diseño.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-295">Displaying a master/details report on a single page, however, introduces some challenges on how best to layout the master and details records on the page.</span></span> <span data-ttu-id="4a5ef-296">En el *principal/detalle con un GridView maestro seleccionable DetailsView detalles* tutorial tuvimos que los registros de detalles aparecen encima de los registros maestros; en este tutorial se usan técnicas CSS para tener la float registros maestros a la a la izquierda de los detalles.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-296">In the *Master/Detail Using a Selectable Master GridView with a Details DetailsView* tutorial we had the details records appear above the master records; in this tutorial we used CSS techniques to have the master records float to the left of the details.</span></span>

<span data-ttu-id="4a5ef-297">Además de mostrar informes maestra/detalles, también tuvimos la oportunidad de explorar cómo recuperar el número de productos asociados con cada categoría, así como el modo realizar la lógica de servidor cuando cuando un LinkButton (botón o ImageButton) cuando se hace clic en desde un Repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-297">Along with displaying master/details reports, we also had the opportunity to explore how to retrieve the number of products associated with each category as well as how to perform server-side logic when a LinkButton (or Button or ImageButton) is clicked from within a Repeater.</span></span>

<span data-ttu-id="4a5ef-298">Este tutorial completa nuestro examen de los informes de maestro y detalles con la DataList y repetidor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-298">This tutorial completes our examination of master/detail reports with the DataList and Repeater.</span></span> <span data-ttu-id="4a5ef-299">El siguiente conjunto de tutoriales ilustrará cómo agregar, editar y eliminar funciones para el control DataList.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-299">Our next set of tutorials will illustrate how to add editing and deleting capabilities to the DataList control.</span></span>

<span data-ttu-id="4a5ef-300">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-300">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="4a5ef-301">Información adicional</span><span class="sxs-lookup"><span data-stu-id="4a5ef-301">Further Reading</span></span>

<span data-ttu-id="4a5ef-302">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="4a5ef-302">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="4a5ef-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) un tutorial sobre flotante elementos CSS con CSS</span><span class="sxs-lookup"><span data-stu-id="4a5ef-303">[Floatutorial](http://css.maxdesign.com.au/floatutorial/) a tutorial on floating CSS elements with CSS</span></span>
- <span data-ttu-id="4a5ef-304">[Posicionamiento de CSS](http://www.brainjar.com/css/positioning/) obtener más información sobre la colocación de los elementos con CSS</span><span class="sxs-lookup"><span data-stu-id="4a5ef-304">[CSS Positioning](http://www.brainjar.com/css/positioning/) more information on positioning elements with CSS</span></span>
- <span data-ttu-id="4a5ef-305">[Para presentar Out contenido con HTML](http://www.w3schools.com/html/html_layout.asp) con `<table>` s y otros elementos HTML para determinar la posición</span><span class="sxs-lookup"><span data-stu-id="4a5ef-305">[Laying Out Content with HTML](http://www.w3schools.com/html/html_layout.asp) using `<table>` s and other HTML elements for positioning</span></span>

## <a name="about-the-author"></a><span data-ttu-id="4a5ef-306">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="4a5ef-306">About the Author</span></span>

<span data-ttu-id="4a5ef-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-307">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4a5ef-308">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-308">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4a5ef-309">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-309">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="4a5ef-310">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="4a5ef-310">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="4a5ef-311">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="4a5ef-311">Special Thanks To</span></span>

<span data-ttu-id="4a5ef-312">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-312">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4a5ef-313">Revisor inicial para este tutorial era Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="4a5ef-313">Lead reviewer for this tutorial was Zack Jones.</span></span> <span data-ttu-id="4a5ef-314">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="4a5ef-314">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4a5ef-315">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="4a5ef-315">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="4a5ef-316">Anterior</span><span class="sxs-lookup"><span data-stu-id="4a5ef-316">Previous</span></span>](master-detail-filtering-acess-two-pages-datalist-vb.md)
