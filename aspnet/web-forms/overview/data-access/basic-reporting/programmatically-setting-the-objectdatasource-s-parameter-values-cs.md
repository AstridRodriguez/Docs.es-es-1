---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: Establecer mediante programación los valores de parámetro de ObjectDataSource (C#) | Documentos de Microsoft
author: rick-anderson
description: En este tutorial se examinará agregar un método a nuestro DAL y BLL que acepta un parámetro de entrada y devuelve los datos. En el ejemplo se establecerá este parámetro...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 1bd1fd63e5aae74459675d45dd399e449d7897b8
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
ms.locfileid: "30875687"
---
<a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="bd4c2-104">Establecer mediante programación los valores de parámetro de ObjectDataSource (C#)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>
====================
<span data-ttu-id="bd4c2-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="bd4c2-106">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) o [descarga de PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-106">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="bd4c2-107">En este tutorial se examinará agregar un método a nuestro DAL y BLL que acepta un parámetro de entrada y devuelve los datos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="bd4c2-108">En el ejemplo se establecerá este parámetro mediante programación.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-108">The example will set this parameter programmatically.</span></span>


## <a name="introduction"></a><span data-ttu-id="bd4c2-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="bd4c2-109">Introduction</span></span>

<span data-ttu-id="bd4c2-110">Como vimos en el [tutorial anterior](declarative-parameters-cs.md), una serie de opciones está disponible para pasar mediante declaración los valores de parámetros a métodos de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="bd4c2-111">Si el valor del parámetro está codificado de forma rígida, proviene de un control Web en la página, o en cualquier otro origen que es legible por un origen de datos `Parameter` objeto, por ejemplo, que se puede enlazar valor al parámetro de entrada sin tener que escribir una línea de código.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="bd4c2-112">Puede haber ocasiones, sin embargo, cuando el valor del parámetro procede de algún origen ya no tienen en cuenta uno del origen de datos integrados `Parameter` objetos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="bd4c2-113">Si nuestro sitio admite cuentas de usuario que queramos establezca el parámetro tomando como base el actualmente ha iniciado sesión Id. de usuario del visitante</span><span class="sxs-lookup"><span data-stu-id="bd4c2-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="bd4c2-114">O bien, podemos necesitar personalizar el valor del parámetro antes de enviarlo a lo largo de al método del objeto subyacente de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="bd4c2-115">Cada vez que el ObjectDataSource `Select` se invoca el método genera el ObjectDataSource en primer lugar su [evento Selecting](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="bd4c2-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="bd4c2-116">A continuación, se invoca el método del objeto subyacente de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="bd4c2-117">Una vez que se haya completado la ObjectDataSource [eventos seleccionados](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) se activa (figura 1 muestra esta secuencia de eventos).</span><span class="sxs-lookup"><span data-stu-id="bd4c2-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="bd4c2-118">Pueden establecer los valores de parámetro pasados al método del objeto subyacente de ObjectDataSource o personalizados en un controlador de eventos para el `Selecting` eventos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>


<span data-ttu-id="bd4c2-119">[![Se invoca el ObjectDataSource seleccionados y método de selección de incendio de eventos antes y después de su subyacente del objeto](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="bd4c2-120">**Figura 1**: The ObjectDataSource `Selected` y `Selecting` eventos activan antes y del después de su objeto subyacente método se invoca ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>


<span data-ttu-id="bd4c2-121">En este tutorial se examinará agregar un método a nuestro DAL y BLL que acepta un parámetro de entrada `Month`, del tipo `int` y devuelve un `EmployeesDataTable` objeto rellenado con los empleados que tienen su aniversario de contratación de la manera especificada `Month`.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="bd4c2-122">Nuestro ejemplo establecerá este parámetro mediante programación en función del mes actual, que muestra una lista de "Employee aniversarios este mes".</span><span class="sxs-lookup"><span data-stu-id="bd4c2-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="bd4c2-123">Comencemos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="bd4c2-124">Paso 1: Agregar un método a`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="bd4c2-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="bd4c2-125">En nuestro ejemplo primero tenemos que agregar a fin de recuperar los empleados cuyo `HireDate` se produjo en un mes especificado.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="bd4c2-126">Para proporcionar esta funcionalidad de acuerdo con nuestra arquitectura se debe crear un método en `EmployeesTableAdapter` que se asigna a la instrucción SQL apropiada.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="bd4c2-127">Para ello, inicie abriendo el conjunto de datos con tipo de Northwind.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="bd4c2-128">Haga doble clic en la `EmployeesTableAdapter` etiqueta y elija Agregar consulta.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>


<span data-ttu-id="bd4c2-129">[![Agregar una nueva consulta a la EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="bd4c2-130">**Figura 2**: agregar una nueva consulta para la `EmployeesTableAdapter` ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>


<span data-ttu-id="bd4c2-131">Elija esta opción para agregar una instrucción SQL que devuelve filas.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="bd4c2-132">Cuando llegue a especificar una `SELECT` el valor predeterminado de la pantalla de instrucción `SELECT` instrucción para el `EmployeesTableAdapter` ya se va a cargar.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="bd4c2-133">Basta con agregar en el `WHERE` cláusula: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="bd4c2-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) es una función de T-SQL que devuelve una parte de fecha en particular de un `datetime` tipo; en este caso usamos `DATEPART` para devolver el mes de la `HireDate` columna.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>


<span data-ttu-id="bd4c2-135">[![Solo las filas donde el HireDate columna de retorno es menor o igual que el @HiredBeforeDate parámetro](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="bd4c2-136">**Figura 3**: devolver sólo aquellas filas donde la `HireDate` columna es menor o igual que el `@HiredBeforeDate` parámetro ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>


<span data-ttu-id="bd4c2-137">Por último, cambie el `FillBy` y `GetDataBy` a los nombres de método `FillByHiredDateMonth` y `GetEmployeesByHiredDateMonth`, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>


<span data-ttu-id="bd4c2-138">[![Elija los nombres de método más adecuados que FillBy y GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="bd4c2-139">**Figura 4**: elija más adecuado método nombres que `FillBy` y `GetDataBy` ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>


<span data-ttu-id="bd4c2-140">Haga clic en Finalizar para completar al asistente y volver a la superficie de diseño del conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="bd4c2-141">El `EmployeesTableAdapter` ahora se debe incluir un nuevo conjunto de métodos para tener acceso a empleados contratados en un mes especificado.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>


<span data-ttu-id="bd4c2-142">[![Los nuevos métodos aparecen en la superficie de diseño del conjunto de datos](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="bd4c2-143">**Figura 5**: los nuevos métodos aparecen en la superficie de diseño del conjunto de datos ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>


## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="bd4c2-144">Paso 2: Agregar el`GetEmployeesByHiredDateMonth(month)`método a la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="bd4c2-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="bd4c2-145">Puesto que nuestra aplicación arquitectura usa un independiente de las capas para la lógica de negocios y los datos tener acceso a lógica, es necesario agregar un método a nuestro BLL que llama a la capa DAL para recuperar a los empleados contratado antes de una fecha especificada.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="bd4c2-146">Abra la `EmployeesBLL.cs` de archivos y agregue el método siguiente:</span><span class="sxs-lookup"><span data-stu-id="bd4c2-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>


[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="bd4c2-147">Al igual que con nuestros otros métodos de esta clase, `GetEmployeesByHiredDateMonth(month)` simplemente llama hacia abajo en la capa DAL y devuelve los resultados.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="bd4c2-148">Paso 3: Mostrar a los empleados cuyo aniversario contratación es este mes</span><span class="sxs-lookup"><span data-stu-id="bd4c2-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="bd4c2-149">El último paso en este ejemplo es mostrar a los empleados cuyo aniversario contratación es este mes.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="bd4c2-150">Empiece agregando un control GridView a la `ProgrammaticParams.aspx` página en el `BasicReporting` carpeta y agregue un nuevo ObjectDataSource como origen de datos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="bd4c2-151">Configurar el ObjectDataSource para usar el `EmployeesBLL` clase con la `SelectMethod` establecido en `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>


<span data-ttu-id="bd4c2-152">[![Utilice la clase EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="bd4c2-153">**Figura 6**: Use la `EmployeesBLL` clase ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>


<span data-ttu-id="bd4c2-154">[![Seleccione desde el GetEmployeesByHiredDateMonth(month) (método)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="bd4c2-155">**Figura 7**: Select From el `GetEmployeesByHiredDateMonth(month)` método ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>


<span data-ttu-id="bd4c2-156">La última pantalla le pide que proporcione el `month` origen del valor del parámetro.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="bd4c2-157">Puesto que este valor se configuran mediante programación, deje el origen del parámetro establece en el valor predeterminado None opción y haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>


<span data-ttu-id="bd4c2-158">[![Deje el origen de parámetro establecido en None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="bd4c2-159">**Figura 8**: deje el origen de parámetro establecido en None ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>


<span data-ttu-id="bd4c2-160">Esto creará un `Parameter` objeto en el ObjectDataSource `SelectParameters` colección que no tiene un valor especificado.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>


[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="bd4c2-161">Para establecer este valor mediante programación, es necesario crear un controlador de eventos para el ObjectDataSource `Selecting` eventos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="bd4c2-162">Para ello, vaya a la vista de diseño y haga doble clic en el origen ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="bd4c2-163">Como alternativa, seleccione el ObjectDataSource, vaya a la ventana Propiedades y haga clic en el icono de rayo.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="bd4c2-164">A continuación, en haga doble clic en el cuadro de texto junto a la `Selecting` eventos o escriba el nombre del controlador de eventos que desea usar.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>


![Haga clic en el icono de rayo en la ventana Propiedades para mostrar eventos de un Control Web](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="bd4c2-166">**Figura 9**: haga clic en el icono de rayo en la ventana Propiedades para mostrar eventos de un Control Web</span><span class="sxs-lookup"><span data-stu-id="bd4c2-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>


<span data-ttu-id="bd4c2-167">Ambos enfoques de agregar un nuevo controlador de eventos para el ObjectDataSource `Selecting` eventos a la clase de código subyacente de la página.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="bd4c2-168">En este controlador de eventos podemos leer y escribir en los valores de parámetro mediante `e.InputParameters[parameterName]`, donde *`parameterName`* es el valor de la `Name` de atributo en el `<asp:Parameter>` etiqueta (el `InputParameters` colección también puede ser indizada ordinal, como en `e.InputParameters[index]`).</span><span class="sxs-lookup"><span data-stu-id="bd4c2-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="bd4c2-169">Para establecer el `month` parámetro en el mes actual, agregue lo siguiente a la `Selecting` controlador de eventos:</span><span class="sxs-lookup"><span data-stu-id="bd4c2-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>


[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="bd4c2-170">Cuando visite esta página a través de un explorador podemos ver que el solo empleado se contrató a este mes (marzo) Laura Callahan, que está en la compañía desde 1994.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>


<span data-ttu-id="bd4c2-171">[![Los empleados cuyos aniversarios se muestran en este mes](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="bd4c2-172">**Figura 10**: los empleados cuyo aniversarios este mes se muestran ([haga clic aquí para ver la imagen a tamaño completo](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="bd4c2-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>


## <a name="summary"></a><span data-ttu-id="bd4c2-173">Resumen</span><span class="sxs-lookup"><span data-stu-id="bd4c2-173">Summary</span></span>

<span data-ttu-id="bd4c2-174">Mientras que los valores de parámetros de ObjectDataSource normalmente se establece mediante declaración, sin necesidad de una línea de código, es fácil establecer los valores de parámetro mediante programación.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="bd4c2-175">Todo lo que necesitamos hacer es crear un controlador de eventos para el ObjectDataSource `Selecting` evento, que se desencadena antes de método del objeto subyacente se invoca y establecer manualmente los valores para uno o más parámetros a través de la `InputParameters` colección.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="bd4c2-176">Este tutorial finaliza la sección informes básicos.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="bd4c2-177">El [siguiente tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) inicia, la sección de filtrado y escenarios de maestra / de detalle, en el que se examinará técnicas para permitir que el visitante para filtrar los datos y los detalles de un informe principal en un informe de detalles.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="bd4c2-178">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="bd4c2-179">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="bd4c2-179">About the Author</span></span>

<span data-ttu-id="bd4c2-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="bd4c2-181">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="bd4c2-182">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="bd4c2-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="bd4c2-183">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="bd4c2-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="bd4c2-184">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="bd4c2-184">Special Thanks To</span></span>

<span data-ttu-id="bd4c2-185">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-185">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="bd4c2-186">Revisor inicial para este tutorial era Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="bd4c2-186">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="bd4c2-187">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="bd4c2-187">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="bd4c2-188">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-188">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="bd4c2-189">[Anterior](declarative-parameters-cs.md)
> [Siguiente](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="bd4c2-189">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>
