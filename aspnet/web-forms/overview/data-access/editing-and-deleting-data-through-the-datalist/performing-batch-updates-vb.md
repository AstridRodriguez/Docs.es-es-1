---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
title: Realizar actualizaciones por lotes (VB) | Documentos de Microsoft
author: rick-anderson
description: Información sobre cómo crear un totalmente editable DataList donde todos sus elementos están en modo de edición y cuyos valores se pueden guardar haciendo clic en un botón "Actualizar todo" en los...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 8dac22a7-91de-4e3b-888f-a4c438b03851
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
msc.type: authoredcontent
ms.openlocfilehash: 4d28a431c2b09de8c46079e888aa191017de4e30
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
---
<a name="performing-batch-updates-vb"></a><span data-ttu-id="75a3c-103">Realizar actualizaciones por lotes (VB)</span><span class="sxs-lookup"><span data-stu-id="75a3c-103">Performing Batch Updates (VB)</span></span>
====================
<span data-ttu-id="75a3c-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="75a3c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="75a3c-105">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) o [descarga de PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="75a3c-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) or [Download PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span></span>

> <span data-ttu-id="75a3c-106">Información sobre cómo crear un totalmente editable DataList donde todos sus elementos están en modo de edición y cuyos valores se pueden guardar haciendo clic en un botón "Actualizar todo" en la página.</span><span class="sxs-lookup"><span data-stu-id="75a3c-106">Learn how to create a fully-editable DataList where all of its items are in edit mode and whose values can be saved by clicking an "Update All" button on the page.</span></span>


## <a name="introduction"></a><span data-ttu-id="75a3c-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="75a3c-107">Introduction</span></span>

<span data-ttu-id="75a3c-108">En el [tutorial anterior](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) se examina cómo crear un nivel de elemento DataList.</span><span class="sxs-lookup"><span data-stu-id="75a3c-108">In the [preceding tutorial](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) we examined how to create an item-level DataList.</span></span> <span data-ttu-id="75a3c-109">Como GridView editable estándar, cada elemento en el control DataList incluye una operación de edición botón que, al hacer clic en, haría que el elemento editable.</span><span class="sxs-lookup"><span data-stu-id="75a3c-109">Like the standard editable GridView, each item in the DataList included an Edit button that, when clicked, would make the item editable.</span></span> <span data-ttu-id="75a3c-110">Aunque este nivel de elemento edición funciona bien con datos que solo se actualizan ocasionalmente, ciertos escenarios de casos de uso requieren que el usuario editar el número de registros.</span><span class="sxs-lookup"><span data-stu-id="75a3c-110">While this item-level editing works well for data that is only updated occasionally, certain use case scenarios require the user to edit many records.</span></span> <span data-ttu-id="75a3c-111">Si un usuario necesita editar docenas de registros y se ve obligado a haga clic en Editar, realice los cambios y haga clic en Actualizar para cada una de ellas, la cantidad de hacer clic en puede dificultar su productividad.</span><span class="sxs-lookup"><span data-stu-id="75a3c-111">If a user needs to edit dozens of records and is forced to click Edit, make their changes, and click Update for each one, the amount of clicking can hamper her productivity.</span></span> <span data-ttu-id="75a3c-112">En estos casos, es una mejor opción proporcionar un control DataList completamente editable, donde *todos los* de sus elementos se encuentran en modo de edición y cuyos valores se pueden editar haciendo clic en un botón Actualizar todo en la página (consulte la figura 1).</span><span class="sxs-lookup"><span data-stu-id="75a3c-112">In such situations, a better option is to provide a fully-editable DataList, one where *all* of its items are in edit mode and whose values can be edited by clicking an Update All button on the page (see Figure 1).</span></span>


<span data-ttu-id="75a3c-113">[![Se puede modificar cada elemento en un control DataList Editable totalmente](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="75a3c-113">[![Each Item in a Fully Editable DataList can be Modified](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span></span>

<span data-ttu-id="75a3c-114">**Figura 1**: se puede modificar cada elemento en un control DataList Editable totalmente ([haga clic aquí para ver la imagen a tamaño completo](performing-batch-updates-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="75a3c-114">**Figure 1**: Each Item in a Fully Editable DataList can be Modified ([Click to view full-size image](performing-batch-updates-vb/_static/image3.png))</span></span>


<span data-ttu-id="75a3c-115">En este tutorial, examinaremos cómo permitir a los usuarios actualizar información de direcciones de proveedores mediante un control DataList puede modificar por completo.</span><span class="sxs-lookup"><span data-stu-id="75a3c-115">In this tutorial we'll examine how to enable users to update suppliers address information using a fully editable DataList.</span></span>

## <a name="step-1-create-the-editable-user-interface-in-the-datalist-s-itemtemplate"></a><span data-ttu-id="75a3c-116">Paso 1: Crear la interfaz de usuario puede editar en DataList s ItemTemplate</span><span class="sxs-lookup"><span data-stu-id="75a3c-116">Step 1: Create the Editable User Interface in the DataList s ItemTemplate</span></span>

<span data-ttu-id="75a3c-117">En el tutorial anterior, donde se crea a un DataList editable estándar, el nivel de elemento, utilizamos dos plantillas:</span><span class="sxs-lookup"><span data-stu-id="75a3c-117">In the preceding tutorial, where we creating a standard, item-level editable DataList, we used two templates:</span></span>

- <span data-ttu-id="75a3c-118">`ItemTemplate` contiene la interfaz de usuario de solo lectura (los controles Web de etiqueta para mostrar cada nombre de producto s y precio).</span><span class="sxs-lookup"><span data-stu-id="75a3c-118">`ItemTemplate` contained the read-only user interface (the Label Web controls for displaying each product s name and price).</span></span>
- <span data-ttu-id="75a3c-119">`EditItemTemplate` contiene la interfaz de usuario de modo de edición (los dos controles de cuadro de texto Web).</span><span class="sxs-lookup"><span data-stu-id="75a3c-119">`EditItemTemplate` contained the edit mode user interface (the two TextBox Web controls).</span></span>

<span data-ttu-id="75a3c-120">El control DataList s `EditItemIndex` propiedad determina qué `DataListItem` (si existe) se representa mediante el `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-120">The DataList s `EditItemIndex` property dictates what `DataListItem` (if any) is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="75a3c-121">En concreto, el `DataListItem` cuyo `ItemIndex` valor coincide con el control DataList s `EditItemIndex` propiedad se represente usando el `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-121">In particular, the `DataListItem` whose `ItemIndex` value matches the DataList s `EditItemIndex` property is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="75a3c-122">Este modelo funciona bien cuando se puede editar un único elemento en un momento, pero la diferencia se encuentra al crear a un control DataList totalmente editables.</span><span class="sxs-lookup"><span data-stu-id="75a3c-122">This model works well when only one item can be edited at a time, but falls apart when creating a fully-editable DataList.</span></span>

<span data-ttu-id="75a3c-123">Para un control DataList puede modificar por completo, queremos *todos los* de la `DataListItem` s para representar mediante la interfaz editable.</span><span class="sxs-lookup"><span data-stu-id="75a3c-123">For a fully editable DataList, we want *all* of the `DataListItem` s to render using the editable interface.</span></span> <span data-ttu-id="75a3c-124">La manera más sencilla de lograrlo es definir la interfaz editable en el `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-124">The simplest way to accomplish this is to define the editable interface in the `ItemTemplate`.</span></span> <span data-ttu-id="75a3c-125">Para modificar la información de dirección de proveedores, la interfaz editable contiene el nombre del proveedor como texto y, a continuación, cuadros de texto para la dirección, ciudad y los valores de país.</span><span class="sxs-lookup"><span data-stu-id="75a3c-125">For modifying the suppliers address information, the editable interface contains the supplier name as text and then TextBoxes for the address, city, and country values.</span></span>

<span data-ttu-id="75a3c-126">Comience abriendo la `BatchUpdate.aspx` página, agregue un control DataList y establecer su `ID` propiedad `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-126">Start by opening the `BatchUpdate.aspx` page, add a DataList control, and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="75a3c-127">Desde la etiqueta inteligente de DataList s, optar por agregar un nuevo control ObjectDataSource denominado `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-127">From the DataList s smart tag, opt to add a new ObjectDataSource control named `SuppliersDataSource`.</span></span>


<span data-ttu-id="75a3c-128">[![Crear un nuevo origen ObjectDataSource denominado SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="75a3c-128">[![Create a New ObjectDataSource Named SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span></span>

<span data-ttu-id="75a3c-129">**Figura 2**: crear un nuevo ObjectDataSource denominado `SuppliersDataSource` ([haga clic aquí para ver la imagen a tamaño completo](performing-batch-updates-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="75a3c-129">**Figure 2**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](performing-batch-updates-vb/_static/image6.png))</span></span>


<span data-ttu-id="75a3c-130">Configurar el ObjectDataSource para recuperar datos mediante el `SuppliersBLL` clase s. `GetSuppliers()` (método) (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="75a3c-130">Configure the ObjectDataSource to retrieve data using the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 3).</span></span> <span data-ttu-id="75a3c-131">Al igual que con el tutorial anterior, en lugar de actualizar la información de proveedor a través de ObjectDataSource, trabajamos directamente con la capa de lógica de negocios.</span><span class="sxs-lookup"><span data-stu-id="75a3c-131">As with the preceding tutorial, rather than updating the supplier information through the ObjectDataSource, we'll work directly with the Business Logic Layer.</span></span> <span data-ttu-id="75a3c-132">Por tanto, establecer la lista desplegable en (ninguno) en la pestaña de actualización (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="75a3c-132">Therefore, set the drop-down list to (None) in the UPDATE tab (see Figure 4).</span></span>


<span data-ttu-id="75a3c-133">[![Recuperar información de proveedor mediante el método GetSuppliers()](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="75a3c-133">[![Retrieve Supplier Information Using the GetSuppliers() Method](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span></span>

<span data-ttu-id="75a3c-134">**Figura 3**: recuperar información de proveedor mediante el `GetSuppliers()` método ([haga clic aquí para ver la imagen a tamaño completo](performing-batch-updates-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="75a3c-134">**Figure 3**: Retrieve Supplier Information Using the `GetSuppliers()` Method ([Click to view full-size image](performing-batch-updates-vb/_static/image9.png))</span></span>


<span data-ttu-id="75a3c-135">[![Establecer la lista desplegable en (ninguno) en la pestaña de actualización](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="75a3c-135">[![Set the Drop-Down List to (None) in the UPDATE Tab](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span></span>

<span data-ttu-id="75a3c-136">**Figura 4**: establecer la lista desplegable en (ninguno) en la pestaña de actualización ([haga clic aquí para ver la imagen a tamaño completo](performing-batch-updates-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="75a3c-136">**Figure 4**: Set the Drop-Down List to (None) in the UPDATE Tab ([Click to view full-size image](performing-batch-updates-vb/_static/image12.png))</span></span>


<span data-ttu-id="75a3c-137">Después de completar el asistente, Visual Studio genera automáticamente el control DataList s `ItemTemplate` para mostrar cada campo de datos devuelto por el origen de datos en un control Web Label.</span><span class="sxs-lookup"><span data-stu-id="75a3c-137">After completing the wizard, Visual Studio automatically generates the DataList s `ItemTemplate` to display each data field returned by the data source in a Label Web control.</span></span> <span data-ttu-id="75a3c-138">Es necesario modificar esta plantilla para que proporcione la interfaz de edición en su lugar.</span><span class="sxs-lookup"><span data-stu-id="75a3c-138">We need to modify this template so that it provides the editing interface instead.</span></span> <span data-ttu-id="75a3c-139">El `ItemTemplate` se pueden personalizar mediante el diseñador utilizando la opción de editar plantillas de la etiqueta inteligente de DataList s o directamente a través de la sintaxis declarativa.</span><span class="sxs-lookup"><span data-stu-id="75a3c-139">The `ItemTemplate` can be customized through the Designer using the Edit Templates option from the DataList s smart tag or directly through the declarative syntax.</span></span>

<span data-ttu-id="75a3c-140">Tómese un momento para crear una interfaz de edición que muestra el nombre del proveedor s como texto, pero incluye cuadros de texto para el proveedor s dirección, ciudad y los valores de país.</span><span class="sxs-lookup"><span data-stu-id="75a3c-140">Take a moment to create an editing interface that displays the supplier s name as text, but includes TextBoxes for the supplier s address, city, and country values.</span></span> <span data-ttu-id="75a3c-141">Después de realizar estos cambios, la sintaxis declarativa de s de página debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="75a3c-141">After making these changes, your page s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](performing-batch-updates-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="75a3c-142">Como con el tutorial anterior, el control DataList en este tutorial debe tener su estado de vista habilitado.</span><span class="sxs-lookup"><span data-stu-id="75a3c-142">As with the preceding tutorial, the DataList in this tutorial must have its view state enabled.</span></span>


<span data-ttu-id="75a3c-143">En el `ItemTemplate` I m con dos nuevas clases CSS, `SupplierPropertyLabel` y `SupplierPropertyValue`, que se han agregado a la `Styles.css` clase y configurado para usar la misma configuración de estilo que el `ProductPropertyLabel` y `ProductPropertyValue` clases CSS.</span><span class="sxs-lookup"><span data-stu-id="75a3c-143">In the `ItemTemplate` I m using two new CSS classes, `SupplierPropertyLabel` and `SupplierPropertyValue`, which have been added to the `Styles.css` class and configured to use the same style settings as the `ProductPropertyLabel` and `ProductPropertyValue` CSS classes.</span></span>


[!code-css[Main](performing-batch-updates-vb/samples/sample2.css)]

<span data-ttu-id="75a3c-144">Después de realizar estos cambios, visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="75a3c-144">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="75a3c-145">Como se muestra en la figura 5, cada elemento DataList muestra el nombre del proveedor como texto y cuadros de texto utiliza para mostrar la dirección, ciudad y país.</span><span class="sxs-lookup"><span data-stu-id="75a3c-145">As Figure 5 shows, each DataList item displays the supplier name as text and uses TextBoxes to display the address, city, and country.</span></span>


<span data-ttu-id="75a3c-146">[![Cada proveedor en el control DataList está en modo Editable](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="75a3c-146">[![Each Supplier in the DataList is Editable](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span></span>

<span data-ttu-id="75a3c-147">**Figura 5**: cada proveedor en el control DataList es Editable ([haga clic aquí para ver la imagen a tamaño completo](performing-batch-updates-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="75a3c-147">**Figure 5**: Each Supplier in the DataList is Editable ([Click to view full-size image](performing-batch-updates-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-an-update-all-button"></a><span data-ttu-id="75a3c-148">Paso 2: Agregar una actualización botón todo</span><span class="sxs-lookup"><span data-stu-id="75a3c-148">Step 2: Adding an Update All Button</span></span>

<span data-ttu-id="75a3c-149">Aunque cada proveedor en la figura 5 tiene su dirección, ciudad y campos de país que se muestran en un cuadro de texto, actualmente no hay ningún botón de actualización disponible.</span><span class="sxs-lookup"><span data-stu-id="75a3c-149">While each supplier in Figure 5 has its address, city, and country fields displayed in a TextBox, there currently is no Update button available.</span></span> <span data-ttu-id="75a3c-150">En lugar de tener un botón de actualización por cada elemento, con completamente editable DataList suele haber un solo botón Actualizar todo en la página que, al hacer clic, actualiza *todos los* de los registros en el control DataList.</span><span class="sxs-lookup"><span data-stu-id="75a3c-150">Rather than having an Update button per item, with fully editable DataLists there is typically a single Update All button on the page that, when clicked, updates *all* of the records in the DataList.</span></span> <span data-ttu-id="75a3c-151">Para este tutorial, permiten s agregar dos botones Actualizar todo: uno en la parte superior de la página y otro en la parte inferior (aunque al hacer clic en cualquiera de los botones, tendrá el mismo efecto).</span><span class="sxs-lookup"><span data-stu-id="75a3c-151">For this tutorial, let s add two Update All buttons - one at the top of the page and one at the bottom (although clicking either button will have the same effect).</span></span>

<span data-ttu-id="75a3c-152">Comience por agregar un control de botón Web anteriormente la DataList y establezca su `ID` propiedad `UpdateAll1`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-152">Start by adding a Button Web control above the DataList and set its `ID` property to `UpdateAll1`.</span></span> <span data-ttu-id="75a3c-153">A continuación, agregar el segundo control de botón Web bajo el control DataList, establecer su `ID` a `UpdateAll2`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-153">Next, add the second Button Web control beneath the DataList, setting its `ID` to `UpdateAll2`.</span></span> <span data-ttu-id="75a3c-154">Establecer el `Text` propiedades de los dos botones para actualizar todo.</span><span class="sxs-lookup"><span data-stu-id="75a3c-154">Set the `Text` properties for the two Buttons to Update All.</span></span> <span data-ttu-id="75a3c-155">Por último, crear controladores de eventos de ambos botones `Click` eventos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-155">Lastly, create event handlers for both Buttons `Click` events.</span></span> <span data-ttu-id="75a3c-156">En lugar de duplicar la lógica de actualización en cada uno de los controladores de eventos, permiten s refactorizar esa lógica a un tercer método, `UpdateAllSupplierAddresses`, con los controladores de eventos, basta con invocar este método terceros.</span><span class="sxs-lookup"><span data-stu-id="75a3c-156">Rather than duplicating the update logic in each of the event handlers, let s refactor that logic to a third method, `UpdateAllSupplierAddresses`, having the event handlers simply invoking this third method.</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample3.vb)]

<span data-ttu-id="75a3c-157">Figura 6 muestra la página después de han agregado los botones Actualizar todo.</span><span class="sxs-lookup"><span data-stu-id="75a3c-157">Figure 6 shows the page after the Update All buttons have been added.</span></span>


<span data-ttu-id="75a3c-158">[![Se han agregado dos botones de todas las actualizaciones a la página](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="75a3c-158">[![Two Update All Buttons have been Added to the Page](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span></span>

<span data-ttu-id="75a3c-159">**Figura 6**: se han agregado dos botones de todas las actualizaciones a la página ([haga clic aquí para ver la imagen a tamaño completo](performing-batch-updates-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="75a3c-159">**Figure 6**: Two Update All Buttons have been Added to the Page ([Click to view full-size image](performing-batch-updates-vb/_static/image18.png))</span></span>


## <a name="step-3-updating-all-of-the-suppliers-address-information"></a><span data-ttu-id="75a3c-160">Paso 3: Actualizar toda la información de direcciones de proveedores</span><span class="sxs-lookup"><span data-stu-id="75a3c-160">Step 3: Updating All of the Suppliers Address Information</span></span>

<span data-ttu-id="75a3c-161">Con todos los elementos de s DataList mostrar la interfaz de edición y la adición de los botones Actualizar todo, todo lo que sigue siendo está escribiendo el código para realizar la actualización por lotes.</span><span class="sxs-lookup"><span data-stu-id="75a3c-161">With all of the DataList s items displaying the editing interface and with the addition of the Update All buttons, all that remains is writing the code to perform the batch update.</span></span> <span data-ttu-id="75a3c-162">En concreto, es necesario recorrer los elementos de DataList s y la llamada la `SuppliersBLL` clase s. `UpdateSupplierAddress` método para cada uno de ellos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-162">Specifically, we need to loop through the DataList s items and call the `SuppliersBLL` class s `UpdateSupplierAddress` method for each one.</span></span>

<span data-ttu-id="75a3c-163">La colección de `DataListItem` instancias que utilizan el control DataList son accesibles a través de DataList s [ `Items` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span><span class="sxs-lookup"><span data-stu-id="75a3c-163">The collection of `DataListItem` instances that makeup the DataList can be accessed via the DataList s [`Items` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span></span> <span data-ttu-id="75a3c-164">Con una referencia a un `DataListItem`, podemos obtenemos correspondiente `SupplierID` desde el `DataKeys` referencia controla la Web de cuadro de texto dentro de colección y mediante programación el `ItemTemplate` como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="75a3c-164">With a reference to a `DataListItem`, we can grab the corresponding `SupplierID` from the `DataKeys` collection and programmatically reference the TextBox Web controls within the `ItemTemplate` as the following code illustrates:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample4.vb)]

<span data-ttu-id="75a3c-165">Cuando el usuario hace clic en uno de los botones Actualizar todo, el `UpdateAllSupplierAddresses` método recorre en iteración cada `DataListItem` en el `Suppliers` DataList y llamadas a la `SuppliersBLL` clase s. `UpdateSupplierAddress` método, pasando los valores correspondientes.</span><span class="sxs-lookup"><span data-stu-id="75a3c-165">When the user clicks one of the Update All buttons, the `UpdateAllSupplierAddresses` method iterates through each `DataListItem` in the `Suppliers` DataList and calls the `SuppliersBLL` class s `UpdateSupplierAddress` method, passing in the corresponding values.</span></span> <span data-ttu-id="75a3c-166">Un valor no especificado para la dirección, ciudad o país pasa es un valor de `Nothing` a `UpdateSupplierAddress` (en lugar de una cadena en blanco), que da como resultado una base de datos `NULL` para los campos de registro s subyacente.</span><span class="sxs-lookup"><span data-stu-id="75a3c-166">A non-entered value for address, city, or country passes is a value of `Nothing` to `UpdateSupplierAddress` (rather than a blank string), which results in a database `NULL` for the underlying record s fields.</span></span>

> [!NOTE]
> <span data-ttu-id="75a3c-167">Como una mejora, puede que desee agregar un estado de control Web Label a la página que ofrece algunos mensajes de confirmación una vez realizada la actualización por lotes.</span><span class="sxs-lookup"><span data-stu-id="75a3c-167">As an enhancement, you may want to add a status Label Web control to the page that provides some confirmation message after the batch update is performed.</span></span>


## <a name="updating-only-those-addresses-that-have-been-modified"></a><span data-ttu-id="75a3c-168">Actualizar solo las direcciones que se han modificado</span><span class="sxs-lookup"><span data-stu-id="75a3c-168">Updating Only Those Addresses That Have Been Modified</span></span>

<span data-ttu-id="75a3c-169">El algoritmo de actualización de lote utilizado para este tutorial se llama el `UpdateSupplierAddress` método para *cada* proveedor en el control DataList, independientemente de si ha cambiado su información de dirección.</span><span class="sxs-lookup"><span data-stu-id="75a3c-169">The batch update algorithm used for this tutorial calls the `UpdateSupplierAddress` method for *every* supplier in the DataList, regardless of whether their address information has been changed.</span></span> <span data-ttu-id="75a3c-170">Mientras estos blind actualiza t normalmente un problema de rendimiento, puede generar registros superfluos si se van a auditar cambios en la tabla de base de datos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-170">While such blind updates aren t usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="75a3c-171">Por ejemplo, si utiliza desencadenadores para registrar todos los `UPDATE` s para el `Suppliers` tabla a una tabla de auditoría cada vez que un usuario hace clic en el botón Actualizar todo se creará un nuevo registro de auditoría para cada proveedor en el sistema, independientemente de si el usuario efectúa cualquiera cambios.</span><span class="sxs-lookup"><span data-stu-id="75a3c-171">For example, if you use triggers to record all `UPDATE` s to the `Suppliers` table to an auditing table, every time a user clicks the Update All button a new audit record will be created for each supplier in the system, regardless of whether the user made any changes.</span></span>

<span data-ttu-id="75a3c-172">Las clases DataTable de ADO.NET y DataAdapter están diseñadas para admitir las actualizaciones por lotes que da como resultado solo modificados, eliminados y nuevos registros en cualquier comunicación de base de datos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-172">The ADO.NET DataTable and DataAdapter classes are designed to support batch updates where only modified, deleted, and new records results in any database communication.</span></span> <span data-ttu-id="75a3c-173">Cada fila de la tabla de datos tiene un [ `RowState` propiedad](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) que indica si la fila se ha agregado a la tabla de datos, eliminado contenido, modificar, o se mantiene sin cambios.</span><span class="sxs-lookup"><span data-stu-id="75a3c-173">Each row in the DataTable has a [`RowState` property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) that indicates whether the row has been added to the DataTable, deleted from it, modified, or remains unchanged.</span></span> <span data-ttu-id="75a3c-174">Cuando inicialmente se rellena una tabla de datos, todas las filas se marcan sin cambios.</span><span class="sxs-lookup"><span data-stu-id="75a3c-174">When a DataTable is initially populated, all rows are marked unchanged.</span></span> <span data-ttu-id="75a3c-175">Cambiar el valor de cualquiera de las columnas de fila s marca la fila modificada.</span><span class="sxs-lookup"><span data-stu-id="75a3c-175">Changing the value of any of the row s columns marks the row as modified.</span></span>

<span data-ttu-id="75a3c-176">En el `SuppliersBLL` clase actualizamos la información de dirección de proveedor especificado s por primera lectura en el registro de proveedor único en una `SuppliersDataTable` y, a continuación, establezca el `Address`, `City`, y `Country` valores de columna mediante el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="75a3c-176">In the `SuppliersBLL` class we update the specified supplier s address information by first reading in the single supplier record into a `SuppliersDataTable` and then set the `Address`, `City`, and `Country` column values using the following code:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample5.vb)]

<span data-ttu-id="75a3c-177">Este código naively asigna las pasa la dirección, ciudad y los valores de país para el `SuppliersRow` en el `SuppliersDataTable` independientemente de si han cambiado los valores.</span><span class="sxs-lookup"><span data-stu-id="75a3c-177">This code naively assigns the passed-in address, city, and country values to the `SuppliersRow` in the `SuppliersDataTable` regardless of whether or not the values have changed.</span></span> <span data-ttu-id="75a3c-178">Estas modificaciones provocarán la `SuppliersRow` s `RowState` propiedad se marca como modificada.</span><span class="sxs-lookup"><span data-stu-id="75a3c-178">These modifications cause the `SuppliersRow` s `RowState` property to be marked as modified.</span></span> <span data-ttu-id="75a3c-179">Cuando la s de capa de acceso a datos `Update` se llama al método, lo que ve el `SupplierRow` se ha modificado y, por tanto, se envía una `UPDATE` comando a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-179">When the Data Access Layer s `Update` method is called, it sees that the `SupplierRow` has been modified and therefore sends an `UPDATE` command to the database.</span></span>

<span data-ttu-id="75a3c-180">Sin embargo, imagine que agregamos código a este método para asignar solo la dirección pasada, city y valores de país si difieren de las `SuppliersRow` s valores existentes.</span><span class="sxs-lookup"><span data-stu-id="75a3c-180">Imagine, however, that we added code to this method to only assign the passed-in address, city, and country values if they differ from the `SuppliersRow` s existing values.</span></span> <span data-ttu-id="75a3c-181">En el caso donde la dirección, ciudad y país son los mismos que los datos existentes, no se realizará ningún cambio y la `SupplierRow` s `RowState` izquierda marcada como permanece invariable.</span><span class="sxs-lookup"><span data-stu-id="75a3c-181">In the case where the address, city, and country are the same as the existing data, no changes will be made and the `SupplierRow` s `RowState` will be left marked as unchanged.</span></span> <span data-ttu-id="75a3c-182">El resultado neto es que cuando la capa DAL s `Update` se llama al método, no se realizará ninguna llamada de la base de datos porque el `SuppliersRow` no se ha modificado.</span><span class="sxs-lookup"><span data-stu-id="75a3c-182">The net result is that when the DAL s `Update` method is called, no database call will be made because the `SuppliersRow` has not been modified.</span></span>

<span data-ttu-id="75a3c-183">Para establecer este cambio, reemplace las instrucciones que se asignan a ciegas los pasa la dirección, ciudad y valores de país con el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="75a3c-183">To enact this change, replace the statements that blindly assign the passed-in address, city, and country values with the following code:</span></span>


[!code-vb[Main](performing-batch-updates-vb/samples/sample6.vb)]

<span data-ttu-id="75a3c-184">Con este código añadido, s de la capa DAL `Update` método envía un `UPDATE` instrucción a solo aquellos registros que se han cambiado cuyos valores relacionados con la dirección en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-184">With this added code, the DAL s `Update` method sends an `UPDATE` statement to the database for only those records whose address-related values have changed.</span></span>

<span data-ttu-id="75a3c-185">Como alternativa, podríamos hacer un seguimiento de si hay alguna diferencia entre los campos de dirección en el pasado y la base de datos y, si no hay ninguno, basta con omitir la llamada a la capa DAL s `Update` método.</span><span class="sxs-lookup"><span data-stu-id="75a3c-185">Alternatively, we could keep track of whether there are any differences between the passed-in address fields and the database data and, if there are none, simply bypass the call to the DAL s `Update` method.</span></span> <span data-ttu-id="75a3c-186">Este enfoque funciona bien si el método, que se van a usar la base de datos directo ya que el método directo DB ejecutando t pasa un `SuppliersRow` instancia cuya `RowState` se puede comprobar para determinar si realmente se necesita una llamada de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="75a3c-186">This approach works well if you re using the DB direct method, since the DB direct method isn t passed a `SuppliersRow` instance whose `RowState` can be checked to determine whether a database call is actually needed.</span></span>

> [!NOTE]
> <span data-ttu-id="75a3c-187">Cada vez que la `UpdateSupplierAddress` se invoca el método, se realiza una llamada a la base de datos para recuperar información sobre el registro actualizado.</span><span class="sxs-lookup"><span data-stu-id="75a3c-187">Each time the `UpdateSupplierAddress` method is invoked, a call is made to the database to retrieve information about the updated record.</span></span> <span data-ttu-id="75a3c-188">A continuación, si hay algún cambio en los datos, se realiza otra llamada a la base de datos para actualizar la fila de la tabla.</span><span class="sxs-lookup"><span data-stu-id="75a3c-188">Then, if there are any changes in data, another call to the database is made to update the table row.</span></span> <span data-ttu-id="75a3c-189">Este flujo de trabajo podría optimizarse mediante la creación de un `UpdateSupplierAddress` sobrecarga del método que acepta un `EmployeesDataTable` instancia cuya *todos los* de los cambios desde la `BatchUpdate.aspx` página.</span><span class="sxs-lookup"><span data-stu-id="75a3c-189">This workflow could be optimized by creating an `UpdateSupplierAddress` method overload that accepts an `EmployeesDataTable` instance that has *all* of the changes from the `BatchUpdate.aspx` page.</span></span> <span data-ttu-id="75a3c-190">A continuación, podría realizar una llamada a la base de datos para obtener todos los registros de la `Suppliers` tabla.</span><span class="sxs-lookup"><span data-stu-id="75a3c-190">Then, it could make one call to the database to get all of the records from the `Suppliers` table.</span></span> <span data-ttu-id="75a3c-191">A continuación, se han pudieron enumerar los dos conjuntos de resultados y solo aquellos registros que se han producido cambios pudieron actualizarse.</span><span class="sxs-lookup"><span data-stu-id="75a3c-191">The two resultsets could then be enumerated and only those records where changes have occurred could be updated.</span></span>


## <a name="summary"></a><span data-ttu-id="75a3c-192">Resumen</span><span class="sxs-lookup"><span data-stu-id="75a3c-192">Summary</span></span>

<span data-ttu-id="75a3c-193">En este tutorial, hemos visto cómo crear a un control DataList puede modificar por completo, que permite a un usuario modificar rápidamente la información de dirección de varios proveedores.</span><span class="sxs-lookup"><span data-stu-id="75a3c-193">In this tutorial we saw how to create a fully editable DataList, allowing a user to quickly modify the address information for multiple suppliers.</span></span> <span data-ttu-id="75a3c-194">Hemos iniciado mediante la definición de la interfaz de modificación de un control de cuadro de texto Web para el proveedor s dirección, ciudad y los valores de país en el control DataList s `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="75a3c-194">We started by defining the editing interface a TextBox Web control for the supplier s address, city, and country values in the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="75a3c-195">A continuación, agregamos botones Actualizar todo encima y debajo el control DataList.</span><span class="sxs-lookup"><span data-stu-id="75a3c-195">Next, we added Update All buttons above and below the DataList.</span></span> <span data-ttu-id="75a3c-196">Después de que un usuario ha realizado los cambios y hacer clic en uno de los botones Actualizar todo, el `DataListItem` se enumeran s y una llamada a la `SuppliersBLL` clase s `UpdateSupplierAddress` se realiza el método.</span><span class="sxs-lookup"><span data-stu-id="75a3c-196">After a user has made his changes and clicked one of the Update All buttons, the `DataListItem` s are enumerated and a call to the `SuppliersBLL` class s `UpdateSupplierAddress` method is made.</span></span>

<span data-ttu-id="75a3c-197">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="75a3c-197">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="75a3c-198">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="75a3c-198">About the Author</span></span>

<span data-ttu-id="75a3c-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="75a3c-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="75a3c-200">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="75a3c-200">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="75a3c-201">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="75a3c-201">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="75a3c-202">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="75a3c-202">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="75a3c-203">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="75a3c-203">Special Thanks To</span></span>

<span data-ttu-id="75a3c-204">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="75a3c-204">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="75a3c-205">Los revisores iniciales para este tutorial eran Zack Jones y Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="75a3c-205">Lead reviewers for this tutorial were Zack Jones and Ken Pespisa.</span></span> <span data-ttu-id="75a3c-206">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="75a3c-206">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="75a3c-207">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="75a3c-207">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="75a3c-208">[Anterior](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
> [Siguiente](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="75a3c-208">[Previous](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
[Next](handling-bll-and-dal-level-exceptions-vb.md)</span></span>
