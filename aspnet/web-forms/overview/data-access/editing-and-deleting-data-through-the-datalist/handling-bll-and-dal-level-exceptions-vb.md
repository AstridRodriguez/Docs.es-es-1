---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
title: Control de excepciones de nivel de DAL y BLL (VB) | Documentos de Microsoft
author: rick-anderson
description: "En este tutorial, veremos cómo controlar las excepciones generadas durante el flujo de trabajo de actualización de un DataList editable de manera discreta."
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: ca665073-b379-4239-9404-f597663ca65e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: 245e381eca2aca61be5f860d1ec9994b482a9863
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="handling-bll--and-dal-level-exceptions-vb"></a><span data-ttu-id="59328-103">Control de excepciones de nivel de DAL y BLL (VB)</span><span class="sxs-lookup"><span data-stu-id="59328-103">Handling BLL- and DAL-Level Exceptions (VB)</span></span>
====================
<span data-ttu-id="59328-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="59328-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="59328-105">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) o [descarga de PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="59328-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span></span>

> <span data-ttu-id="59328-106">En este tutorial, veremos cómo controlar las excepciones generadas durante el flujo de trabajo de actualización de un DataList editable de manera discreta.</span><span class="sxs-lookup"><span data-stu-id="59328-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>


## <a name="introduction"></a><span data-ttu-id="59328-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="59328-107">Introduction</span></span>

<span data-ttu-id="59328-108">En el [información general de edición y eliminación de datos en el control DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, creamos un DataList que ofrecen simple de edición y eliminación de las capacidades.</span><span class="sxs-lookup"><span data-stu-id="59328-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="59328-109">Aunque es totalmente funcional, es muy fácil de usar, como cualquier error que se produjo durante la edición o eliminar proceso generó una excepción no controlada.</span><span class="sxs-lookup"><span data-stu-id="59328-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="59328-110">Por ejemplo, si se omite el nombre del producto s o, al editar un producto, escriba un valor del precio de muy asequible!, produce una excepción.</span><span class="sxs-lookup"><span data-stu-id="59328-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="59328-111">Puesto que no se detecta esta excepción en el código, propaga hasta el tiempo de ejecución ASP.NET, que, a continuación, muestra los detalles de excepción s en la página web.</span><span class="sxs-lookup"><span data-stu-id="59328-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="59328-112">Como vimos en el [BLL - control y las excepciones de nivel de la capa DAL de una página ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, si se produce una excepción desde las profundidades de la lógica de negocios o los niveles de acceso a datos, los detalles de la excepción se devuelven a ObjectDataSource y a continuación, en GridView.</span><span class="sxs-lookup"><span data-stu-id="59328-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="59328-113">Hemos visto cómo controlar estas excepciones correctamente mediante la creación de `Updated` o `RowUpdated` controladores de eventos para el ObjectDataSource o GridView, comprobar si una excepción y, a continuación, que indica que se ha controlado la excepción.</span><span class="sxs-lookup"><span data-stu-id="59328-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="59328-114">Nuestros DataList tutoriales, sin embargo, t a través de ObjectDataSource para actualizar y eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="59328-114">Our DataList tutorials, however, aren t using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="59328-115">En su lugar, estamos trabajando directamente en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="59328-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="59328-116">Con el fin de detectar las excepciones que se origina en el BLL o la capa DAL, es necesario implementar el código en el código subyacente de la página ASP.NET de control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="59328-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="59328-117">En este tutorial, veremos cómo controlar las excepciones producidas durante una s DataList editable actualizar el flujo de trabajo de manera más discreta.</span><span class="sxs-lookup"><span data-stu-id="59328-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="59328-118">En el *una visión general de edición y eliminación de datos en el control DataList* tutorial analizamos técnicas diferentes para modificar y eliminar datos de DataList, algunas técnicas conlleva el uso de un origen ObjectDataSource para actualizar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="59328-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="59328-119">Si utiliza estas técnicas, puede controlar las excepciones de la capa BLL o la capa DAL a través de las operaciones de asignación ObjectDataSource `Updated` o `Deleted` controladores de eventos.</span><span class="sxs-lookup"><span data-stu-id="59328-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>


## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="59328-120">Paso 1: Crear a un DataList Editable</span><span class="sxs-lookup"><span data-stu-id="59328-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="59328-121">Antes de que nos preocupamos sobre el control de excepciones que se producen durante el flujo de trabajo de actualización, permiten s crear primero un DataList editable.</span><span class="sxs-lookup"><span data-stu-id="59328-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="59328-122">Abrir la `ErrorHandling.aspx` página en el `EditDeleteDataList` carpeta, agregar un control DataList hasta el diseñador, establezca su `ID` propiedad a `Products`, y agregue un nuevo ObjectDataSource denominado `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="59328-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="59328-123">Configurar el ObjectDataSource para usar el `ProductsBLL` clase s. `GetProducts()` registra el método para la selección; establece las listas de lista desplegable en la instrucción INSERT, UPDATE y eliminar las fichas (ninguno).</span><span class="sxs-lookup"><span data-stu-id="59328-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="59328-124">[![Devolver la información de producto mediante el método GetProducts()](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="59328-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span></span>

<span data-ttu-id="59328-125">**Figura 1**: devolver la información de producto mediante el `GetProducts()` método ([haga clic aquí para ver la imagen a tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="59328-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span></span>


<span data-ttu-id="59328-126">Después de completar el Asistente de ObjectDataSource, Visual Studio creará automáticamente un `ItemTemplate` para el control DataList.</span><span class="sxs-lookup"><span data-stu-id="59328-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="59328-127">Reemplácelo con un `ItemTemplate` que muestra cada nombre de producto s y precio e incluye un botón Editar.</span><span class="sxs-lookup"><span data-stu-id="59328-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="59328-128">A continuación, cree una `EditItemTemplate` con un control de cuadro de texto Web para el nombre y el precio y botones Actualizar y Cancelar.</span><span class="sxs-lookup"><span data-stu-id="59328-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="59328-129">Por último, establezca la DataList s `RepeatColumns` propiedad en 2.</span><span class="sxs-lookup"><span data-stu-id="59328-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="59328-130">Después de estos cambios, el marcado declarativo de s de página debe ser similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="59328-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="59328-131">Asegúrese de que la edición, Cancelar, y los botones de actualización tienen sus `CommandName` establecer propiedades para editar, Cancelar y actualizar, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="59328-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="59328-132">Para este tutorial, el control DataList debe estar habilitado el estado de vista de s.</span><span class="sxs-lookup"><span data-stu-id="59328-132">For this tutorial the DataList s view state must be enabled.</span></span>


<span data-ttu-id="59328-133">Tómese un momento para ver el progreso a través de un explorador (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="59328-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>


<span data-ttu-id="59328-134">[![Cada producto incluye un botón Editar](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="59328-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span></span>

<span data-ttu-id="59328-135">**Figura 2**: cada producto incluye un botón Editar ([haga clic aquí para ver la imagen a tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="59328-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span></span>


<span data-ttu-id="59328-136">Actualmente, el botón Editar sólo provoca una devolución de datos, t aún hacen que el producto editable.</span><span class="sxs-lookup"><span data-stu-id="59328-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="59328-137">Para habilitar la edición, necesitamos crear controladores de eventos para el control DataList s `EditCommand`, `CancelCommand`, y `UpdateCommand` eventos.</span><span class="sxs-lookup"><span data-stu-id="59328-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="59328-138">El `EditCommand` y `CancelCommand` eventos simplemente actualización DataList s `EditItemIndex` propiedad y vuelva a enlazar los datos al control DataList:</span><span class="sxs-lookup"><span data-stu-id="59328-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="59328-139">El `UpdateCommand` controlador de eventos es un poco más complicada.</span><span class="sxs-lookup"><span data-stu-id="59328-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="59328-140">Tiene que leerse en el producto editado s `ProductID` desde el `DataKeys` colección junto con el nombre de producto s y el precio de los cuadros de texto en el `EditItemTemplate`y, a continuación, llame a la `ProductsBLL` clase s. `UpdateProduct` método antes de devolver el control DataList a su estado anterior de edición.</span><span class="sxs-lookup"><span data-stu-id="59328-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="59328-141">Por ahora, s permiten usar simplemente el mismo código exacto de la `UpdateCommand` controlador de eventos en el *información general de edición y eliminación de datos en el control DataList* tutorial.</span><span class="sxs-lookup"><span data-stu-id="59328-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="59328-142">Vamos a agregar el código para controlar correctamente las excepciones en el paso 2.</span><span class="sxs-lookup"><span data-stu-id="59328-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="59328-143">En el caso de entrada no válida que puede ser en forma de un precio por unidad con formato incorrecto, un valor del precio unitario no válido como - 5,00 USD o la omisión del nombre del producto de s que se producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="59328-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="59328-144">Puesto que la `UpdateCommand` controlador de eventos no incluye ninguna en este momento, el código de control de excepciones, la excepción se llegan hasta el tiempo de ejecución ASP.NET, donde se mostrará al usuario final (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="59328-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>


![Cuando se produce una excepción no controlada, el usuario final ve una página de Error](handling-bll-and-dal-level-exceptions-vb/_static/image7.png)

<span data-ttu-id="59328-146">**Figura 3**: cuando se produce una excepción no controlada, el usuario final ve una página de Error</span><span class="sxs-lookup"><span data-stu-id="59328-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>


## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="59328-147">Paso 2: Administrar correctamente las excepciones en el controlador de eventos de UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="59328-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="59328-148">Durante el flujo de trabajo de actualización, las excepciones pueden producirse en el `UpdateCommand` controlador de eventos, la capa BLL o la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="59328-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="59328-149">Por ejemplo, si un usuario escribe un precio de demasiados costosas, la `Decimal.Parse` instrucción en el `UpdateCommand` controlador de eventos, se producirá un `FormatException` excepción.</span><span class="sxs-lookup"><span data-stu-id="59328-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="59328-150">Si el usuario la omita el nombre del producto s o si el precio tiene un valor negativo, la capa DAL producirá una excepción.</span><span class="sxs-lookup"><span data-stu-id="59328-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="59328-151">Cuando se produce una excepción, deseamos mostrar un mensaje informativo en la propia página.</span><span class="sxs-lookup"><span data-stu-id="59328-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="59328-152">Agregar un sitio Web de la etiqueta de control a la página cuya `ID` está establecido en `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="59328-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="59328-153">Configurar el texto del rótulo s para mostrar en una red, muy grande, fuente negrita y cursiva asignando su `CssClass` propiedad a la `Warning` clase CSS, que se define en el `Styles.css` archivo.</span><span class="sxs-lookup"><span data-stu-id="59328-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="59328-154">Cuando se produce un error, solamente queremos la etiqueta que se mostrará una vez.</span><span class="sxs-lookup"><span data-stu-id="59328-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="59328-155">Es decir, en postbacks posteriores, el mensaje de advertencia de etiqueta s debería desaparecer.</span><span class="sxs-lookup"><span data-stu-id="59328-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="59328-156">Esto puede realizarse borrando la etiqueta s `Text` propiedad o configuración de su `Visible` propiedad `False` en el `Page_Load` controlador de eventos (como hicimos en el [BLL - control y las excepciones de nivel de la capa DAL en un ASP Página .NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) o al deshabilitar la compatibilidad de estado de vista de etiqueta s.</span><span class="sxs-lookup"><span data-stu-id="59328-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="59328-157">Permitir que s use esta última opción.</span><span class="sxs-lookup"><span data-stu-id="59328-157">Let s use the latter option.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample4.aspx)]

<span data-ttu-id="59328-158">Cuando se produce una excepción, asignaremos los detalles de la excepción para la `ExceptionDetails` control s etiqueta `Text` propiedad.</span><span class="sxs-lookup"><span data-stu-id="59328-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="59328-159">Puesto que su estado de vista está deshabilitado, en postbacks posteriores el `Text` propiedad s mediante programación cambios se perderán, vuelve a establecerse en el texto predeterminado (una cadena vacía), ocultando de esta manera el mensaje de advertencia.</span><span class="sxs-lookup"><span data-stu-id="59328-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="59328-160">Para determinar cuándo se ha producido un error con el fin de mostrar un mensaje útil en la página, tenemos que agregar una `Try ... Catch` bloquear para el `UpdateCommand` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="59328-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="59328-161">El `Try` parte contiene código que puede provocar una excepción, mientras que la `Catch` bloque contiene código que se ejecuta en el caso de una excepción.</span><span class="sxs-lookup"><span data-stu-id="59328-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="59328-162">Extraer del repositorio el [Fundamentos del control de excepciones](https://msdn.microsoft.com/en-us/library/2w8f0bss.aspx) sección en la documentación de .NET Framework para obtener más información sobre la `Try ... Catch` bloque.</span><span class="sxs-lookup"><span data-stu-id="59328-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/en-us/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="59328-163">Cuando se produce una excepción de cualquier tipo de código dentro de la `Try` bloque, la `Catch` código del bloque s iniciará la ejecución.</span><span class="sxs-lookup"><span data-stu-id="59328-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="59328-164">El tipo de excepción que se produce `DbException`, `NoNullAllowedException`, `ArgumentException`y así sucesivamente dependerá de qué, exactamente, provocado el error en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="59328-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="59328-165">Si hay un problema de s en el nivel de base de datos, un `DbException` se iniciará.</span><span class="sxs-lookup"><span data-stu-id="59328-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="59328-166">Si se especifica un valor no válido para la `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, o `ReorderLevel` campos, un `ArgumentException` se producirá, tal y como se agrega código para validar estos valores de campo en el `ProductsDataTable` clase (vea la [ Creación de una capa de lógica de negocios](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span><span class="sxs-lookup"><span data-stu-id="59328-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span></span>

<span data-ttu-id="59328-167">Podemos proporcionar una explicación más relevantes para el usuario final al basar el texto del mensaje en el tipo de excepción detectada.</span><span class="sxs-lookup"><span data-stu-id="59328-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="59328-168">El código siguiente que se usó de forma casi idéntica en el [BLL - control y las excepciones de nivel de la capa DAL de una página ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial proporciona este nivel de detalle:</span><span class="sxs-lookup"><span data-stu-id="59328-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial provides this level of detail:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample6.vb)]

<span data-ttu-id="59328-169">Para completar este tutorial, basta con llamar a la `DisplayExceptionDetails` método desde el `Catch` bloque pasando detectado `Exception` instancia (`ex`).</span><span class="sxs-lookup"><span data-stu-id="59328-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="59328-170">Con el `Try ... Catch` bloquear en su lugar, los usuarios recibirán un mensaje de error más informativo, como las figuras 4 y 5 mostrar.</span><span class="sxs-lookup"><span data-stu-id="59328-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="59328-171">Tenga en cuenta que en el caso de una excepción DataList permanece en modo de edición.</span><span class="sxs-lookup"><span data-stu-id="59328-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="59328-172">Esto es porque una vez que se produce la excepción, el flujo de control se redirigirá inmediatamente a la `Catch` bloque, omitiendo el código que devuelve el control DataList a su estado anterior de edición.</span><span class="sxs-lookup"><span data-stu-id="59328-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>


<span data-ttu-id="59328-173">[![Se muestra un mensaje de Error si un usuario la omita un campo necesario](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="59328-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span></span>

<span data-ttu-id="59328-174">**Figura 4**: aparece un mensaje de Error si un usuario la omita un campo necesario ([haga clic aquí para ver la imagen a tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="59328-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span></span>


<span data-ttu-id="59328-175">[![Es de un mensaje de Error aparece cuando especifica un precio negativo](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="59328-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span></span>

<span data-ttu-id="59328-176">**Figura 5**: un mensaje de Error es aparece cuando especifica un precio negativo ([haga clic aquí para ver la imagen a tamaño completo](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="59328-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span></span>


## <a name="summary"></a><span data-ttu-id="59328-177">Resumen</span><span class="sxs-lookup"><span data-stu-id="59328-177">Summary</span></span>

<span data-ttu-id="59328-178">El control GridView y ObjectDataSource proporcionan controladores de eventos posterior al nivel que incluyen información sobre las excepciones que se produjeron durante el flujo de trabajo de actualización y eliminación, así como propiedades que se pueden establecer para indicar si la excepción se ha administra.</span><span class="sxs-lookup"><span data-stu-id="59328-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="59328-179">Estas características, sin embargo, no están disponibles al trabajar con el control DataList y con la capa BLL directamente.</span><span class="sxs-lookup"><span data-stu-id="59328-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="59328-180">En su lugar, somos responsables de implementar el control de excepciones.</span><span class="sxs-lookup"><span data-stu-id="59328-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="59328-181">En este tutorial se ha explicado cómo agregar el control de excepciones para una s DataList editable actualiza el flujo de trabajo mediante la adición de un `Try ... Catch` bloquear para el `UpdateCommand` controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="59328-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="59328-182">Si se produce una excepción durante el flujo de trabajo de actualización, el `Catch` ejecuta código del bloque s, mostrar información útil en la `ExceptionDetails` etiqueta.</span><span class="sxs-lookup"><span data-stu-id="59328-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="59328-183">En este punto, el control DataList realiza ningún esfuerzo para evitar excepciones suceda en primer lugar.</span><span class="sxs-lookup"><span data-stu-id="59328-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="59328-184">Aunque se sabe que un precio negativo se producirá una excepción, conocemos t ha agregado funcionalidad para evitar de forma proactiva un usuario entraran en estas entradas no válidas.</span><span class="sxs-lookup"><span data-stu-id="59328-184">Even though we know that a negative price will result in an exception, we haven t yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="59328-185">En el siguiente tutorial veremos cómo ayudar a reducir las excepciones producidas por proporcionados por el usuario no válido mediante la adición de controles de validación en el `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="59328-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="59328-186">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="59328-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="59328-187">Información adicional</span><span class="sxs-lookup"><span data-stu-id="59328-187">Further Reading</span></span>

<span data-ttu-id="59328-188">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="59328-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="59328-189">Instrucciones de diseño para excepciones</span><span class="sxs-lookup"><span data-stu-id="59328-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/en-us/library/ms298399.aspx)
- <span data-ttu-id="59328-190">[Módulos de registro de error y controladores (ELMAH)](http://workspaces.gotdotnet.com/elmah) (una biblioteca de código abierto para el registro de errores)</span><span class="sxs-lookup"><span data-stu-id="59328-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="59328-191">[Enterprise Library para .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (incluye el bloque de aplicaciones de administración de excepciones)</span><span class="sxs-lookup"><span data-stu-id="59328-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="59328-192">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="59328-192">About the Author</span></span>

<span data-ttu-id="59328-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="59328-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="59328-194">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="59328-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="59328-195">Su último libro es [ *SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="59328-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="59328-196">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="59328-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="59328-197">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="59328-197">Special Thanks To</span></span>

<span data-ttu-id="59328-198">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="59328-198">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="59328-199">Revisor inicial para este tutorial era Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="59328-199">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="59328-200">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="59328-200">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="59328-201">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="59328-201">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="59328-202">[Anterior](performing-batch-updates-vb.md)
[Siguiente](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="59328-202">[Previous](performing-batch-updates-vb.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span></span>
