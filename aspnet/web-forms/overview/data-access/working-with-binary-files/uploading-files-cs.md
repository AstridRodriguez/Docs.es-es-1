---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-cs
title: Carga de archivos (C#) | Documentos de Microsoft
author: rick-anderson
description: Obtenga información acerca de cómo permitir a los usuarios cargar archivos binarios (como documentos de Word o PDF) al sitio Web donde puede almacenarse en el sistema de archivos del servidor...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/27/2007
ms.topic: article
ms.assetid: b381b1da-feb3-4776-bc1b-75db53eb90ab
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-cs
msc.type: authoredcontent
ms.openlocfilehash: 3c758e94311817d01b17d27083733f805caf600f
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/10/2018
ms.locfileid: "30889204"
---
<a name="uploading-files-c"></a><span data-ttu-id="f8f70-103">Carga de archivos (C#)</span><span class="sxs-lookup"><span data-stu-id="f8f70-103">Uploading Files (C#)</span></span>
====================
<span data-ttu-id="f8f70-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f8f70-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f8f70-105">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_CS.exe) o [descarga de PDF](uploading-files-cs/_static/datatutorial54cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f8f70-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_CS.exe) or [Download PDF](uploading-files-cs/_static/datatutorial54cs1.pdf)</span></span>

> <span data-ttu-id="f8f70-106">Obtenga información acerca de cómo permitir a los usuarios cargar archivos binarios (como documentos de Word o PDF) al sitio Web donde puede almacenarse en el sistema de archivos del servidor o la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>


## <a name="introduction"></a><span data-ttu-id="f8f70-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="f8f70-107">Introduction</span></span>

<span data-ttu-id="f8f70-108">Todos los tutoriales se ha examinado hasta ahora ha trabajado exclusivamente con datos de texto.</span><span class="sxs-lookup"><span data-stu-id="f8f70-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="f8f70-109">Sin embargo, muchas aplicaciones tienen modelos de datos que captura los datos binarios y texto.</span><span class="sxs-lookup"><span data-stu-id="f8f70-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="f8f70-110">Un sitio de tratamiento de fechas en línea podría permitir a los usuarios cargar una imagen para asociarlo con su perfil.</span><span class="sxs-lookup"><span data-stu-id="f8f70-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="f8f70-111">Un sitio Web de contratación podría permitir a los usuarios cargar su reanudación como un documento de Microsoft Word o PDF.</span><span class="sxs-lookup"><span data-stu-id="f8f70-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="f8f70-112">Trabajar con datos binarios, agrega un nuevo conjunto de retos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="f8f70-113">Debemos decidir cómo se almacenan los datos binarios en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="f8f70-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="f8f70-114">La interfaz que se utiliza para insertar nuevos registros debe actualizarse para permitir al usuario cargar un archivo desde su equipo y se deben realizar pasos adicionales para mostrar o proporcionan un medio para descargar un registro s datos binarios asociados.</span><span class="sxs-lookup"><span data-stu-id="f8f70-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="f8f70-115">En este tutorial y los tres siguientes exploraremos cómo hurdle estos desafíos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="f8f70-116">Al final de estos tutoriales tendrá creamos una aplicación totalmente funcional que asocia un folleto PDF e imagen con cada categoría.</span><span class="sxs-lookup"><span data-stu-id="f8f70-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="f8f70-117">En este tutorial en concreto se examinará técnicas diferentes para almacenar datos binarios y explorar cómo permitir a los usuarios cargar un archivo desde su equipo y ha guardado en el sistema de archivos de s de servidor web.</span><span class="sxs-lookup"><span data-stu-id="f8f70-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="f8f70-118">Datos binarios que forma parte de un modelo de datos de aplicación s se conocen a veces como un [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), un acrónimo de objeto binario grande.</span><span class="sxs-lookup"><span data-stu-id="f8f70-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="f8f70-119">En estos tutoriales he decidido utilizar los datos binarios de terminología, aunque el término BLOB es sinónimo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>


## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="f8f70-120">Paso 1: Crear el trabajo con páginas Web de datos binarios</span><span class="sxs-lookup"><span data-stu-id="f8f70-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="f8f70-121">Antes de comenzar a explorar los desafíos relacionados con la adición de compatibilidad con datos binarios, permiten s primero Tómese un momento para crear las páginas ASP.NET en el proyecto de sitio Web que se necesitará para este tutorial y los tres siguientes.</span><span class="sxs-lookup"><span data-stu-id="f8f70-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="f8f70-122">Empiece por agregar una nueva carpeta denominada `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="f8f70-123">A continuación, agregue las siguientes páginas ASP.NET a la carpeta y asegúrese de que asociar cada página con el `Site.master` página maestra:</span><span class="sxs-lookup"><span data-stu-id="f8f70-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`


![Agregar las páginas ASP.NET para los tutoriales relacionados con datos binarios](uploading-files-cs/_static/image1.gif)

<span data-ttu-id="f8f70-125">**Figura 1**: agregar las páginas ASP.NET para los tutoriales relacionados con datos binarios</span><span class="sxs-lookup"><span data-stu-id="f8f70-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>


<span data-ttu-id="f8f70-126">Al igual que en las otras carpetas, `Default.aspx` en el `BinaryData` carpeta enumerará los tutoriales en su sección.</span><span class="sxs-lookup"><span data-stu-id="f8f70-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="f8f70-127">Recuerde que el `SectionLevelTutorialListing.ascx` Control de usuario proporciona esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="f8f70-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="f8f70-128">Por lo tanto, agregue este Control de usuario para `Default.aspx` arrastrándolo desde el Explorador de soluciones en la página s la vista Diseño.</span><span class="sxs-lookup"><span data-stu-id="f8f70-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="f8f70-129">[![Agregar el Control de usuario SectionLevelTutorialListing.ascx a Default.aspx](uploading-files-cs/_static/image2.gif)](uploading-files-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-cs/_static/image2.gif)](uploading-files-cs/_static/image1.png)</span></span>

<span data-ttu-id="f8f70-130">**Figura 2**: agregar la `SectionLevelTutorialListing.ascx` Control de usuario a `Default.aspx` ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-cs/_static/image2.png))</span></span>


<span data-ttu-id="f8f70-131">Por último, agregue estas páginas como entradas para el `Web.sitemap` archivo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="f8f70-132">En concreto, agregue el siguiente marcado después de la mejora GridView `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="f8f70-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>


[!code-xml[Main](uploading-files-cs/samples/sample1.xml)]

<span data-ttu-id="f8f70-133">Después de actualizar `Web.sitemap`, tómese un momento para ver el sitio Web de tutoriales a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="f8f70-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="f8f70-134">Ahora, el menú de la izquierda incluye elementos para el trabajo con los tutoriales de datos binarios.</span><span class="sxs-lookup"><span data-stu-id="f8f70-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>


![El mapa del sitio ahora incluye las entradas para el trabajo con los tutoriales de datos binarios](uploading-files-cs/_static/image3.gif)

<span data-ttu-id="f8f70-136">**Figura 3**: el mapa del sitio ahora incluye las entradas para el trabajo con los tutoriales de datos binarios</span><span class="sxs-lookup"><span data-stu-id="f8f70-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>


## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="f8f70-137">Paso 2: Decida dónde desea almacenar los datos binarios</span><span class="sxs-lookup"><span data-stu-id="f8f70-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="f8f70-138">Datos binarios que está asociados con el modelo de datos de aplicación s pueden almacenarse en uno de estos dos lugares: en el sistema de archivos de web server s con una referencia en el archivo almacenado en la base de datos; o directamente dentro de la base de datos (consulte la figura 4).</span><span class="sxs-lookup"><span data-stu-id="f8f70-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="f8f70-139">Cada enfoque tiene su propio conjunto de ventajas y desventajas y merece una explicación más detallada.</span><span class="sxs-lookup"><span data-stu-id="f8f70-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>


<span data-ttu-id="f8f70-140">[![Datos binarios pueden almacenarse en el sistema de archivos o directamente en la base de datos](uploading-files-cs/_static/image4.gif)](uploading-files-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-cs/_static/image4.gif)](uploading-files-cs/_static/image3.png)</span></span>

<span data-ttu-id="f8f70-141">**Figura 4**: datos binarios pueden almacenarse en el sistema de archivos o directamente en la base de datos ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-cs/_static/image4.png))</span></span>


<span data-ttu-id="f8f70-142">Imagine que deseamos ampliar la base de datos Northwind para asociar una imagen a cada producto.</span><span class="sxs-lookup"><span data-stu-id="f8f70-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="f8f70-143">Una opción sería almacenar estos archivos de imagen en el sistema de archivos de s de servidor web y anote la ruta de acceso en la `Products` tabla.</span><span class="sxs-lookup"><span data-stu-id="f8f70-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="f8f70-144">Con este enfoque, d agregamos una `ImagePath` columna a la `Products` tabla de tipo `varchar(200)`, tal vez.</span><span class="sxs-lookup"><span data-stu-id="f8f70-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="f8f70-145">Cuando un usuario carga una imagen de Chai, esa imagen podría estar almacenada en el sistema de archivos de web server s en `~/Images/Tea.jpg`, donde `~` representa la ruta de acceso física s de aplicación.</span><span class="sxs-lookup"><span data-stu-id="f8f70-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="f8f70-146">Es decir, si el sitio web se basa en la ruta de acceso física `C:\Websites\Northwind\`, `~/Images/Tea.jpg` sería equivalente a `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="f8f70-147">Después de cargar el archivo de imagen, d actualizamos el registro Chai en el `Products` tabla para que su `ImagePath` hace referencia a la ruta de acceso de la nueva imagen de la columna.</span><span class="sxs-lookup"><span data-stu-id="f8f70-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="f8f70-148">Podríamos usar `~/Images/Tea.jpg` o simplemente `Tea.jpg` si decidimos que todas las imágenes de producto se colocaría en la aplicación s `Images` carpeta.</span><span class="sxs-lookup"><span data-stu-id="f8f70-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="f8f70-149">Las principales ventajas de almacenar los datos binarios en el sistema de archivos son:</span><span class="sxs-lookup"><span data-stu-id="f8f70-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="f8f70-150">**Facilidad de implementación** como veremos en breve, almacenar y recuperar datos binarios almacenados directamente dentro de la base de datos implica un poco más código que al trabajar con datos mediante el sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="f8f70-151">Además, para un usuario ver o descargar datos binarios se debe presentar con una dirección URL a los datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="f8f70-152">Si los datos residen en el sistema de archivos de s de servidor web, la dirección URL es sencilla.</span><span class="sxs-lookup"><span data-stu-id="f8f70-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="f8f70-153">Si los datos se almacenan en la base de datos, sin embargo, una página web. debe crearse que recuperará y devolver los datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="f8f70-154">**Ampliar el acceso a los datos binarios** los datos binarios que necesite ser accesible para otros servicios o aplicaciones, que no se puede extraer los datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="f8f70-155">Por ejemplo, las imágenes asociadas a cada producto posible que también deba ser disponibles para los usuarios a través de [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), en cuyo caso d queremos almacenar los datos binarios en el sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="f8f70-156">**Rendimiento** si los datos binarios se almacenan en el sistema de archivos, la congestión de petición y la red entre el servidor de base de datos y el servidor web será menor que si los datos binarios se almacenan directamente en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="f8f70-157">El principal inconveniente de almacenar datos binarios en el sistema de archivos es que éste separa los datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="f8f70-158">Si se elimina un registro de la `Products` tabla, el archivo asociado en el sistema de archivos de s de servidor web no se elimina automáticamente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="f8f70-159">Nos debemos escribir código adicional para eliminar el archivo o el sistema de archivos se llenarse con archivos sin usar, huérfanos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="f8f70-160">Además, cuando la copia de seguridad de la base de datos, debemos hacemos asegurarse de realizar copias de seguridad de los datos binarios asociados en el sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="f8f70-161">Mover la base de datos a otro sitio o servidor plantea similar desafíos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="f8f70-162">Como alternativa, se pueden almacenar datos binarios directamente en una base de datos de Microsoft SQL Server 2005 mediante la creación de una columna de tipo `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="f8f70-163">Al igual que con otros tipos de datos de longitud variable, puede especificar una longitud máxima de los datos binarios que se pueden guardar en esta columna.</span><span class="sxs-lookup"><span data-stu-id="f8f70-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="f8f70-164">Por ejemplo, para reservar al menos 5.000 bytes usar `varbinary(5000)`; `varbinary(MAX)` permite que el tamaño máximo de almacenamiento, aproximadamente 2 GB.</span><span class="sxs-lookup"><span data-stu-id="f8f70-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="f8f70-165">La principal ventaja de almacenar datos binarios directamente en la base de datos es el acoplamiento apretado entre los datos binarios y el registro de base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="f8f70-166">Esto simplifica en gran medida las tareas de administración de base de datos, como las copias de seguridad o mover la base de datos a un sitio o servidor diferente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="f8f70-167">Además, eliminar automáticamente un registro elimina los datos binarios correspondientes.</span><span class="sxs-lookup"><span data-stu-id="f8f70-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="f8f70-168">También son más sutiles ventajas de almacenar los datos binarios en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="f8f70-169">Vea [almacenar binario archivos directamente en la base de datos utilizando ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) para obtener una explicación más detallada.</span><span class="sxs-lookup"><span data-stu-id="f8f70-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="f8f70-170">En Microsoft SQL Server 2000 y versiones anteriores, el `varbinary` tipo de datos tenía un límite máximo de 8.000 bytes.</span><span class="sxs-lookup"><span data-stu-id="f8f70-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="f8f70-171">Para almacenar hasta 2 GB de datos binarios el [ `image` tipo de datos](https://msdn.microsoft.com/library/ms187993.aspx) debe usarse en su lugar.</span><span class="sxs-lookup"><span data-stu-id="f8f70-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="f8f70-172">Con la adición de `MAX` en SQL Server 2005, sin embargo, la `image` tipo de datos está en desuso.</span><span class="sxs-lookup"><span data-stu-id="f8f70-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="f8f70-173">Lo s siendo compatibles con versiones anteriores compatibilidad, pero Microsoft ha anunciado que el `image` tipo de datos se quitará en una versión futura de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="f8f70-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>


<span data-ttu-id="f8f70-174">Si está trabajando con un modelo de datos antiguo, puede ver el `image` tipo de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="f8f70-175">La base de datos de Northwind s `Categories` tabla tiene un `Picture` columna que puede usarse para almacenar los datos binarios de un archivo de imagen para la categoría.</span><span class="sxs-lookup"><span data-stu-id="f8f70-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="f8f70-176">Puesto que la base de datos Northwind tiene sus raíces en Microsoft Access y las versiones anteriores de SQL Server, esta columna es de tipo `image`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="f8f70-177">Para este tutorial y los tres siguientes, vamos a usar ambos enfoques.</span><span class="sxs-lookup"><span data-stu-id="f8f70-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="f8f70-178">El `Categories` tabla ya tiene un `Picture` columna para almacenar el contenido binario de una imagen de la categoría.</span><span class="sxs-lookup"><span data-stu-id="f8f70-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="f8f70-179">Vamos a agregar una columna adicional, `BrochurePath`, para almacenar una ruta de acceso a un documento PDF en el sistema de archivos de s de servidor web que puede usarse para proporcionar una visión general de calidad de impresión, elegante de la categoría.</span><span class="sxs-lookup"><span data-stu-id="f8f70-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="f8f70-180">Paso 3: Agregar la`BrochurePath`columna a la`Categories`tabla</span><span class="sxs-lookup"><span data-stu-id="f8f70-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="f8f70-181">La tabla Categories tiene actualmente solo cuatro columnas: `CategoryID`, `CategoryName`, `Description`, y `Picture`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="f8f70-182">Además de estos campos, es necesario agregar uno nuevo que señala el folleto categoría s (si existe).</span><span class="sxs-lookup"><span data-stu-id="f8f70-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="f8f70-183">Para agregar esta columna, vaya al explorador de servidores, profundizar en las tablas, haga doble clic en el `Categories` de la tabla y elija Abrir definición de tabla (Véase la figura 5).</span><span class="sxs-lookup"><span data-stu-id="f8f70-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="f8f70-184">Si no ve el Explorador de servidores, abrirá seleccionando la opción de explorador de servidores en el menú Ver, o Ctrl + Alt + S de llamadas.</span><span class="sxs-lookup"><span data-stu-id="f8f70-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="f8f70-185">Agregue un nuevo `varchar(200)` columna a la `Categories` tabla denominada `BrochurePath` y permite `NULL` s y haga clic en el icono Guardar (o Ctrl + S de llamadas).</span><span class="sxs-lookup"><span data-stu-id="f8f70-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>


<span data-ttu-id="f8f70-186">[![Agregar una columna BrochurePath a la tabla de categorías](uploading-files-cs/_static/image5.gif)](uploading-files-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-cs/_static/image5.gif)](uploading-files-cs/_static/image5.png)</span></span>

<span data-ttu-id="f8f70-187">**Figura 5**: agregar un `BrochurePath` columna a la `Categories` tabla ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-cs/_static/image6.png))</span></span>


## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="f8f70-188">Paso 4: Actualización de la arquitectura que se utilizan los`Picture`y`BrochurePath`columnas</span><span class="sxs-lookup"><span data-stu-id="f8f70-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="f8f70-189">El `CategoriesDataTable` en la capa de acceso a datos (DAL) actualmente tiene cuatro `DataColumn` s definidas: `CategoryID`, `CategoryName`, `Description`, y `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="f8f70-190">Cuando se diseñó originalmente esta DataTable en el [crear una capa de acceso a datos](../introduction/creating-a-data-access-layer-cs.md) tutorial, el `CategoriesDataTable` solo pudiera guiarse por las tres primeras columnas; el `NumberOfProducts` se ha agregado la columna en la [principal-detalle utilizando un viñetas Lista de registros maestros con un control DataList detalles](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="f8f70-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) tutorial.</span></span>

<span data-ttu-id="f8f70-191">Como se describe en *crear una capa de acceso a datos*, las tablas de datos en el conjunto de datos con tipo componen los objetos de negocio.</span><span class="sxs-lookup"><span data-stu-id="f8f70-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="f8f70-192">Los TableAdapters son responsables de la comunicación con la base de datos y rellenar los objetos de negocios con los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="f8f70-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="f8f70-193">El `CategoriesDataTable` se rellena con el `CategoriesTableAdapter`, que tiene tres métodos de recuperación de datos:</span><span class="sxs-lookup"><span data-stu-id="f8f70-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="f8f70-194">`GetCategories()` ejecuta la consulta principal de TableAdapter s y devuelve el `CategoryID`, `CategoryName`, y `Description` campos de todos los registros en la `Categories` tabla.</span><span class="sxs-lookup"><span data-stu-id="f8f70-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="f8f70-195">La consulta principal es lo que se usa por el generado automáticamente `Insert` y `Update` métodos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="f8f70-196">`GetCategoryByCategoryID(categoryID)` Devuelve el `CategoryID`, `CategoryName`, y `Description` campos de la categoría cuyos `CategoryID` es igual a *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="f8f70-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="f8f70-197">`GetCategoriesAndNumberOfProducts()` -Devuelve el `CategoryID`, `CategoryName`, y `Description` campos para todos los registros en la `Categories` tabla.</span><span class="sxs-lookup"><span data-stu-id="f8f70-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="f8f70-198">También usa una subconsulta para devolver el número de productos asociados con cada categoría.</span><span class="sxs-lookup"><span data-stu-id="f8f70-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="f8f70-199">Observe que ninguna de estas consultas devuelven el `Categories` tabla s `Picture` o `BrochurePath` columnas; ni hace el `CategoriesDataTable` proporcionar `DataColumn` para ver si estos campos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="f8f70-200">Para poder trabajar con la imagen y `BrochurePath` propiedades, es necesario agregarlos primero a la `CategoriesDataTable` y, a continuación, actualizar la `CategoriesTableAdapter` clase para devolver estas columnas.</span><span class="sxs-lookup"><span data-stu-id="f8f70-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="f8f70-201">Agregar el`Picture`y`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="f8f70-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="f8f70-202">Empiece por agregar estas dos columnas a la `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="f8f70-203">Haga doble clic en el `CategoriesDataTable` encabezado s, seleccione Agregar en el menú contextual y, a continuación, elija la opción de columna.</span><span class="sxs-lookup"><span data-stu-id="f8f70-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="f8f70-204">Esto creará un nuevo `DataColumn` en la tabla de datos denominada `Column1`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="f8f70-205">Cambiar el nombre de esta columna para `Picture`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="f8f70-206">En la ventana Propiedades, establezca la `DataColumn` s `DataType` propiedad `System.Byte[]` (Esto no es una opción en la lista desplegable; debe escribir en).</span><span class="sxs-lookup"><span data-stu-id="f8f70-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>


<span data-ttu-id="f8f70-207">[![Crear una imagen con el nombre de objeto DataColumn cuyo tipo de datos es System.Byte]](uploading-files-cs/_static/image6.gif)](uploading-files-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-cs/_static/image6.gif)](uploading-files-cs/_static/image7.png)</span></span>

<span data-ttu-id="f8f70-208">**Figura 6**: crear un `DataColumn` con nombre `Picture` cuyo `DataType` es `System.Byte[]` ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-cs/_static/image8.png))</span></span>


<span data-ttu-id="f8f70-209">Agregue otro `DataColumn` a la tabla de datos, asígnele el nombre `BrochurePath` con el valor predeterminado `DataType` valor (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="f8f70-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="f8f70-210">Devolver el`Picture`y`BrochurePath`valores de TableAdapter</span><span class="sxs-lookup"><span data-stu-id="f8f70-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="f8f70-211">Con estos dos `DataColumn` agregada a la `CategoriesDataTable`, se re listo para actualizar el `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="f8f70-212">Podríamos tener ambos de estos valores de columna devueltos en la consulta principal de TableAdapter, pero esto podría devolver los datos binarios cada vez el `GetCategories()` se invocó el método.</span><span class="sxs-lookup"><span data-stu-id="f8f70-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="f8f70-213">En su lugar, s permiten actualizar la consulta principal de TableAdapter para devolver `BrochurePath` y crea un método de recuperación de datos adicionales que devuelve una categoría determinada s `Picture` columna.</span><span class="sxs-lookup"><span data-stu-id="f8f70-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="f8f70-214">Para actualizar la consulta principal de TableAdapter, haga doble clic en el `CategoriesTableAdapter` encabezado s y elija la opción de configurar en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="f8f70-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="f8f70-215">Se abrirá el Asistente para configuración de adaptador de tabla, el que se ha visto en una serie de tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="f8f70-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="f8f70-216">Actualizar la consulta para devolver el `BrochurePath` y haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="f8f70-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>


<span data-ttu-id="f8f70-217">[![Actualizar la lista de columnas en la instrucción SELECT para devolver también BrochurePath](uploading-files-cs/_static/image7.gif)](uploading-files-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-cs/_static/image7.gif)](uploading-files-cs/_static/image9.png)</span></span>

<span data-ttu-id="f8f70-218">**Figura 7**: actualizar la lista de columnas en la `SELECT` instrucción para devolver también `BrochurePath` ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-cs/_static/image10.png))</span></span>


<span data-ttu-id="f8f70-219">Al usar instrucciones SQL ad hoc de TableAdapter, actualizar la lista de columnas en la consulta principal actualiza la lista de columnas para todos los `SELECT` consultar métodos de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f8f70-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="f8f70-220">Es decir, el `GetCategoryByCategoryID(categoryID)` método se ha actualizado para devolver la `BrochurePath` columna, que sería lo que se esperaba.</span><span class="sxs-lookup"><span data-stu-id="f8f70-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="f8f70-221">Sin embargo, también actualiza la lista de columnas en la `GetCategoriesAndNumberOfProducts()` método, quitar la subconsulta que devuelve el número de productos de cada categoría.</span><span class="sxs-lookup"><span data-stu-id="f8f70-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="f8f70-222">Por lo tanto, deberá actualizar este método s `SELECT` consulta.</span><span class="sxs-lookup"><span data-stu-id="f8f70-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="f8f70-223">Haga doble clic en el `GetCategoriesAndNumberOfProducts()` método, elija Configurar y revertir el `SELECT` consulta a su valor original:</span><span class="sxs-lookup"><span data-stu-id="f8f70-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>


[!code-sql[Main](uploading-files-cs/samples/sample2.sql)]

<span data-ttu-id="f8f70-224">A continuación, cree un nuevo método de TableAdapter que devuelve una categoría determinada s `Picture` valor de la columna.</span><span class="sxs-lookup"><span data-stu-id="f8f70-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="f8f70-225">Haga doble clic en el `CategoriesTableAdapter` encabezado s y elija la opción de Agregar consulta para iniciar el Asistente para configuración de consultas de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f8f70-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="f8f70-226">El primer paso de este asistente nos pregunta que si desea consultar los datos utilizando una instrucción de SQL ad hoc, un nuevo procedimiento almacenado, o uno ya existente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="f8f70-227">Seleccione Usar instrucciones SQL y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="f8f70-228">Dado que se va a devolver una fila, elija la selección que devuelve la opción de filas del segundo paso.</span><span class="sxs-lookup"><span data-stu-id="f8f70-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>


<span data-ttu-id="f8f70-229">[![Seleccione la opción de instrucciones de uso de SQL](uploading-files-cs/_static/image8.gif)](uploading-files-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-229">[![Select the Use SQL statements Option](uploading-files-cs/_static/image8.gif)](uploading-files-cs/_static/image11.png)</span></span>

<span data-ttu-id="f8f70-230">**Figura 8**: seleccione la opción de instrucciones de uso de SQL ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-cs/_static/image12.png))</span></span>


<span data-ttu-id="f8f70-231">[![Puesto que la consulta devolverá un registro de la tabla Categories, elija SELECT que devuelve filas](uploading-files-cs/_static/image9.gif)](uploading-files-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-cs/_static/image9.gif)](uploading-files-cs/_static/image13.png)</span></span>

<span data-ttu-id="f8f70-232">**Figura 9**: puesto que la consulta devolverá un registro de la tabla de categorías, elija Seleccionar que devuelve filas ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-cs/_static/image14.png))</span></span>


<span data-ttu-id="f8f70-233">En el tercer paso, escriba la siguiente consulta SQL y haga clic en siguiente:</span><span class="sxs-lookup"><span data-stu-id="f8f70-233">In the third step, enter the following SQL query and click Next:</span></span>


[!code-sql[Main](uploading-files-cs/samples/sample3.sql)]

<span data-ttu-id="f8f70-234">El último paso es elegir el nombre para el nuevo método.</span><span class="sxs-lookup"><span data-stu-id="f8f70-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="f8f70-235">Use `FillCategoryWithBinaryDataByCategoryID` y `GetCategoryWithBinaryDataByCategoryID` para el relleno una DataTable y devolver un DataTable patrones, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="f8f70-236">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-236">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="f8f70-237">[![Elija los nombres de los métodos de TableAdapter s](uploading-files-cs/_static/image10.gif)](uploading-files-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-cs/_static/image10.gif)](uploading-files-cs/_static/image15.png)</span></span>

<span data-ttu-id="f8f70-238">**Figura 10**: elija los nombres de los métodos de TableAdapter s ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-cs/_static/image16.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f8f70-239">Después de completar al Asistente para configuración de consultas de adaptador de tabla puede ver un cuadro de diálogo que le informa de que el nuevo texto de comando devuelve datos con un esquema diferente del esquema de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="f8f70-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="f8f70-240">En resumen, el Asistente está teniendo en cuenta que la consulta principal de TableAdapter s `GetCategories()` devuelve un esquema diferente a la que acabamos de crear.</span><span class="sxs-lookup"><span data-stu-id="f8f70-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="f8f70-241">Pero esto es lo que queremos, por lo que puede pasar por alto este mensaje.</span><span class="sxs-lookup"><span data-stu-id="f8f70-241">But this is what we want, so you can disregard this message.</span></span>


<span data-ttu-id="f8f70-242">Además, tenga en cuenta que si está utilizando instrucciones SQL ad hoc y usar el Asistente para cambiar la consulta principal de TableAdapter s en algún punto posterior en el tiempo, modificará la `GetCategoryWithBinaryDataByCategoryID` método s `SELECT` lista de columnas de la instrucción s para incluir solo las columnas de la consulta principal (es decir, se quitará la `Picture` columna de la consulta).</span><span class="sxs-lookup"><span data-stu-id="f8f70-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="f8f70-243">Tendrá que actualizar manualmente la lista de columnas para devolver el `Picture` columnas, similar a lo que hicimos con la `GetCategoriesAndNumberOfProducts()` método anteriormente en este paso.</span><span class="sxs-lookup"><span data-stu-id="f8f70-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="f8f70-244">Después de agregar los dos `DataColumn` s para la `CategoriesDataTable` y `GetCategoryWithBinaryDataByCategoryID` método para el `CategoriesTableAdapter`, estas clases en el Diseñador de DataSet con tipo deben ser similar a la captura de pantalla en la figura 11.</span><span class="sxs-lookup"><span data-stu-id="f8f70-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>


![El Diseñador de DataSet incluye las nuevas columnas y el método](uploading-files-cs/_static/image11.gif)

<span data-ttu-id="f8f70-246">**Figura 11**: el Diseñador de DataSet incluye las nuevas columnas y el método</span><span class="sxs-lookup"><span data-stu-id="f8f70-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>


## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="f8f70-247">Actualización de la capa de lógica empresarial (BLL)</span><span class="sxs-lookup"><span data-stu-id="f8f70-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="f8f70-248">Con la capa DAL actualizada, todo lo que queda es aumentar la capa de lógica empresarial (BLL) para que incluya un método para el nuevo `CategoriesTableAdapter` método.</span><span class="sxs-lookup"><span data-stu-id="f8f70-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="f8f70-249">Agregue el método siguiente a la `CategoriesBLL` clase:</span><span class="sxs-lookup"><span data-stu-id="f8f70-249">Add the following method to the `CategoriesBLL` class:</span></span>


[!code-csharp[Main](uploading-files-cs/samples/sample4.cs)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="f8f70-250">Paso 5: Cargar un archivo desde el cliente al servidor Web</span><span class="sxs-lookup"><span data-stu-id="f8f70-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="f8f70-251">Cuando se recopilen datos binarios, a menudo estos datos es suministrados por un usuario final.</span><span class="sxs-lookup"><span data-stu-id="f8f70-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="f8f70-252">Para capturar esta información, el usuario debe ser capaz de cargar un archivo desde su equipo al servidor web.</span><span class="sxs-lookup"><span data-stu-id="f8f70-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="f8f70-253">Los datos cargados, a continuación, deben integrarse con el modelo de datos, lo que puede conllevar guardando el archivo en el sistema de archivos de s de servidor web y agregar una ruta de acceso al archivo en la base de datos o escribir el contenido binario directamente en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="f8f70-254">En este paso se examinará cómo permitir que un usuario cargar archivos desde su equipo al servidor.</span><span class="sxs-lookup"><span data-stu-id="f8f70-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="f8f70-255">En el siguiente tutorial centraremos nuestro atención para integrar el archivo cargado con el modelo de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="f8f70-256">ASP.NET 2.0 s nueva [control FileUpload Web](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) proporciona un mecanismo para que los usuarios enviar un archivo desde su equipo al servidor web.</span><span class="sxs-lookup"><span data-stu-id="f8f70-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="f8f70-257">El control FileUpload se representa como un `<input>` elemento cuyo `type` atributo se establece en el archivo, que los exploradores muestran como un cuadro de texto con un botón Examinar.</span><span class="sxs-lookup"><span data-stu-id="f8f70-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="f8f70-258">Haga clic en el botón Examinar, se abrirá un cuadro de diálogo desde el que el usuario puede seleccionar un archivo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="f8f70-259">Cuando el formulario se envía de nuevo, el contenido del archivo seleccionado de s se envía junto con la devolución de datos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="f8f70-260">En el servidor, obtener información sobre el archivo cargado es accesible a través de las propiedades de s control FileUpload.</span><span class="sxs-lookup"><span data-stu-id="f8f70-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="f8f70-261">Para demostrar la carga de archivos, abra el `FileUpload.aspx` página en el `BinaryData` carpeta, arrastre un control FileUpload desde el cuadro de herramientas hasta el diseñador y establecer el control s `ID` propiedad `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="f8f70-262">A continuación, agregue un control de botón Web establecer su `ID` y `Text` propiedades para `UploadButton` y cargar el archivo seleccionado, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="f8f70-263">Por último, coloque un control Web Label debajo del botón Borrar su `Text` propiedad y establezca su `ID` propiedad `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>


<span data-ttu-id="f8f70-264">[![Agregar un Control FileUpload a la página de ASP.NET](uploading-files-cs/_static/image12.gif)](uploading-files-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-cs/_static/image12.gif)](uploading-files-cs/_static/image17.png)</span></span>

<span data-ttu-id="f8f70-265">**Figura 12**: agregar un Control FileUpload a la página de ASP.NET ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-cs/_static/image18.png))</span></span>


<span data-ttu-id="f8f70-266">Figura 13 muestra esta página cuando se ve mediante un explorador.</span><span class="sxs-lookup"><span data-stu-id="f8f70-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="f8f70-267">Tenga en cuenta que al hacer clic en el botón Examinar abre un cuadro de diálogo de selección de archivos, que permite al usuario seleccionar un archivo desde su equipo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="f8f70-268">Una vez que se ha seleccionado un archivo, haga clic en el botón Cargar archivo seleccionado provoca una devolución de datos que envía el contenido binario de s de archivo seleccionado en el servidor web.</span><span class="sxs-lookup"><span data-stu-id="f8f70-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>


<span data-ttu-id="f8f70-269">[![El usuario puede seleccionar un archivo para cargarlo desde su equipo al servidor](uploading-files-cs/_static/image13.gif)](uploading-files-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-cs/_static/image13.gif)](uploading-files-cs/_static/image19.png)</span></span>

<span data-ttu-id="f8f70-270">**Figura 13**: el usuario puede seleccionar un archivo para cargar desde su equipo al servidor ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-cs/_static/image20.png))</span></span>


<span data-ttu-id="f8f70-271">En la devolución de datos, puede guardarse el archivo cargado en el sistema de archivos o sus datos binarios pueden actuar directamente a través de una secuencia.</span><span class="sxs-lookup"><span data-stu-id="f8f70-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="f8f70-272">En este ejemplo, el s permiten crear un `~/Brochures` carpeta y guarde allí el archivo cargado.</span><span class="sxs-lookup"><span data-stu-id="f8f70-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="f8f70-273">Empiece por agregar el `Brochures` carpeta para el sitio como una subcarpeta del directorio raíz.</span><span class="sxs-lookup"><span data-stu-id="f8f70-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="f8f70-274">A continuación, cree un controlador de eventos para el `UploadButton` s `Click` eventos y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="f8f70-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>


[!code-csharp[Main](uploading-files-cs/samples/sample5.cs)]

<span data-ttu-id="f8f70-275">El control FileUpload proporciona una variedad de propiedades para trabajar con los datos cargados.</span><span class="sxs-lookup"><span data-stu-id="f8f70-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="f8f70-276">Por ejemplo, el [ `HasFile` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indica si se ha cargado un archivo por el usuario, mientras que la [ `FileBytes` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) proporciona acceso a los datos binarios cargados como una matriz de bytes.</span><span class="sxs-lookup"><span data-stu-id="f8f70-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="f8f70-277">El `Click` controlador de eventos inicia asegurándose de que se ha cargado un archivo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="f8f70-278">Si se ha cargado un archivo, la etiqueta muestra el nombre del archivo cargado, su tamaño en bytes y su tipo de contenido.</span><span class="sxs-lookup"><span data-stu-id="f8f70-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="f8f70-279">Para asegurarse de que el usuario carga un archivo que se puede comprobar la `HasFile` propiedad y mostrar una advertencia si se s `false`, o bien puede usar el [control RequiredFieldValidator](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) en su lugar.</span><span class="sxs-lookup"><span data-stu-id="f8f70-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `false`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>


<span data-ttu-id="f8f70-280">El FileUpload s `SaveAs(filePath)` guarda el archivo cargado en especificado *filePath*.</span><span class="sxs-lookup"><span data-stu-id="f8f70-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="f8f70-281">*filePath* debe ser un *ruta de acceso física* (`C:\Websites\Brochures\SomeFile.pdf`) en lugar de un *virtuales* *ruta de acceso* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="f8f70-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="f8f70-282">El [ `Server.MapPath(virtPath)` método](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) toma una ruta de acceso virtual y devuelve su ruta de acceso física correspondiente.</span><span class="sxs-lookup"><span data-stu-id="f8f70-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="f8f70-283">En este caso, la ruta de acceso virtual es `~/Brochures/fileName`, donde *fileName* es el nombre del archivo cargado.</span><span class="sxs-lookup"><span data-stu-id="f8f70-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="f8f70-284">Vea [usando Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) para obtener más información sobre las rutas de acceso físicas y virtuales y usar `Server.MapPath`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="f8f70-285">Después de completar la `Click` controlador de eventos, tómese un momento para probar la página en un explorador.</span><span class="sxs-lookup"><span data-stu-id="f8f70-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="f8f70-286">Haga clic en el botón Examinar y seleccionar un archivo en el disco duro y, a continuación, haga clic en el botón Cargar archivo seleccionado.</span><span class="sxs-lookup"><span data-stu-id="f8f70-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="f8f70-287">La devolución de datos enviará el contenido del archivo seleccionado en el servidor web, que, a continuación, se mostrará información sobre el archivo antes de guardarlo en el `~/Brochures` carpeta.</span><span class="sxs-lookup"><span data-stu-id="f8f70-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="f8f70-288">Después de cargar el archivo, vuelva a Visual Studio y haga clic en el botón Actualizar en el Explorador de soluciones.</span><span class="sxs-lookup"><span data-stu-id="f8f70-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="f8f70-289">Debería aparecer el archivo que acaba de cargar en la carpeta ~/Brochures.</span><span class="sxs-lookup"><span data-stu-id="f8f70-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>


<span data-ttu-id="f8f70-290">[![Se ha cargado el archivo EvolutionValley.jpg en el servidor Web](uploading-files-cs/_static/image14.gif)](uploading-files-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="f8f70-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-cs/_static/image14.gif)](uploading-files-cs/_static/image21.png)</span></span>

<span data-ttu-id="f8f70-291">**Figura 14**: el archivo `EvolutionValley.jpg` se ha cargado en el servidor Web ([haga clic aquí para ver la imagen a tamaño completo](uploading-files-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="f8f70-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-cs/_static/image22.png))</span></span>


![EvolutionValley.jpg se guarda en la carpeta ~/Brochures](uploading-files-cs/_static/image15.gif)

<span data-ttu-id="f8f70-293">**Figura 15**: `EvolutionValley.jpg` se ha guardado en el `~/Brochures` carpeta</span><span class="sxs-lookup"><span data-stu-id="f8f70-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>


## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="f8f70-294">Matices con guardar los archivos cargados en el sistema de archivos</span><span class="sxs-lookup"><span data-stu-id="f8f70-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="f8f70-295">Hay varios matices que deben solucionarse al guardar la carga de archivos en el sistema de archivos de s de servidor web.</span><span class="sxs-lookup"><span data-stu-id="f8f70-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="f8f70-296">En primer lugar, allí el problema de seguridad.</span><span class="sxs-lookup"><span data-stu-id="f8f70-296">First, there s the issue of security.</span></span> <span data-ttu-id="f8f70-297">Para guardar un archivo en el sistema de archivos, el contexto de seguridad en el que se ejecuta la página ASP.NET debe tener permisos de escritura.</span><span class="sxs-lookup"><span data-stu-id="f8f70-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="f8f70-298">El servidor Web de desarrollo de ASP.NET se ejecuta en el contexto de la cuenta de usuario actual.</span><span class="sxs-lookup"><span data-stu-id="f8f70-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="f8f70-299">Si usas s de Microsoft Internet Information Services (IIS) que el servidor web, el contexto de seguridad depende de la versión de IIS y su configuración.</span><span class="sxs-lookup"><span data-stu-id="f8f70-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="f8f70-300">Otro desafío de guardar archivos en el sistema de archivos se centra en los nombres de los archivos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="f8f70-301">En la actualidad, nuestra página de guarda todos los archivos cargados en el `~/Brochures` directorio con el mismo nombre que el archivo en el equipo cliente s.</span><span class="sxs-lookup"><span data-stu-id="f8f70-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="f8f70-302">Si un usuario carga un folleto con el nombre `Brochure.pdf`, el archivo se guardará como `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="f8f70-303">Pero ¿qué ocurre si el usuario B en algún momento posterior carga un archivo de folleto diferentes que posee el mismo nombre de archivo (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="f8f70-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="f8f70-304">Con el código ahora, tenemos un archivo s se sobrescribirá con la carga de usuario B s de usuario.</span><span class="sxs-lookup"><span data-stu-id="f8f70-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="f8f70-305">Hay una serie de técnicas para solucionar conflictos de nombre de archivo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="f8f70-306">Una opción consiste en prohibir cargando un archivo si ya existe uno con el mismo nombre.</span><span class="sxs-lookup"><span data-stu-id="f8f70-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="f8f70-307">Con este enfoque, cuando el usuario B intenta cargar un archivo denominado `Brochure.pdf`, el sistema no se guarde el archivo y en su lugar, se muestra un mensaje que informa el usuario B para cambiar el nombre del archivo e inténtelo de nuevo.</span><span class="sxs-lookup"><span data-stu-id="f8f70-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="f8f70-308">Otro enfoque consiste en Guardar el archivo con un nombre de archivo único, lo que sería un [identificador único global (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) o el valor de la correspondiente base de datos de columnas de clave principal de registro s (suponiendo que la carga está asociada a un fila determinada en el modelo de datos).</span><span class="sxs-lookup"><span data-stu-id="f8f70-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="f8f70-309">En el siguiente tutorial se explorará estas opciones con más detalle.</span><span class="sxs-lookup"><span data-stu-id="f8f70-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="f8f70-310">Desafíos relacionados con grandes cantidades de datos binarios</span><span class="sxs-lookup"><span data-stu-id="f8f70-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="f8f70-311">Estos tutoriales se supone que los datos binarios que se capturan están moderados de tamaño.</span><span class="sxs-lookup"><span data-stu-id="f8f70-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="f8f70-312">Trabajar con grandes cantidades de archivos de datos binarios que son varios megabytes o más presenta desafíos nuevos que están fuera del ámbito de estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="f8f70-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="f8f70-313">Por ejemplo, de forma predeterminada ASP.NET rechazará cargas de más de 4 MB, aunque esto se puede configurar a través de la [ `<httpRuntime>` elemento](https://msdn.microsoft.com/library/e1f13641.aspx) en `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="f8f70-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="f8f70-314">IIS impone sus propio limitaciones de tamaño de carga de archivo, demasiado.</span><span class="sxs-lookup"><span data-stu-id="f8f70-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="f8f70-315">Vea [tamaño del archivo de carga de IIS](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="f8f70-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="f8f70-316">Además, el tiempo necesario para cargar archivos de gran tamaño puede superar el valor predeterminado 110 segundos que ASP.NET va a esperar una solicitud.</span><span class="sxs-lookup"><span data-stu-id="f8f70-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="f8f70-317">También hay problemas de memoria y rendimiento que surgen al trabajar con archivos de gran tamaño.</span><span class="sxs-lookup"><span data-stu-id="f8f70-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="f8f70-318">El control FileUpload resulta poco práctico para grandes cargas de archivos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="f8f70-319">Como el contenido del archivo s se publican en el servidor, el usuario final debe esperar pacientemente sin la confirmación que avanza su carga.</span><span class="sxs-lookup"><span data-stu-id="f8f70-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="f8f70-320">Esto no es tanto un problema cuando se trabaja con archivos más pequeños que se pueden cargar en unos segundos, pero pueden ser un problema cuando se trabaja con archivos de mayor tamaño que pueden tardar minutos en cargar.</span><span class="sxs-lookup"><span data-stu-id="f8f70-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="f8f70-321">Hay una variedad de archivos de terceros controles de carga que se ajusten mejor para controlar cargas de gran tamaño y muchos de estos proveedores proporcionan indicadores de progreso y ActiveX cargar administradores que tengan una experiencia de usuario mucho más elegante.</span><span class="sxs-lookup"><span data-stu-id="f8f70-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="f8f70-322">Si la aplicación necesita administrar archivos de gran tamaño, debe investigar los desafíos cuidadosamente y encontrar las soluciones adecuadas para sus necesidades concretas.</span><span class="sxs-lookup"><span data-stu-id="f8f70-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="f8f70-323">Resumen</span><span class="sxs-lookup"><span data-stu-id="f8f70-323">Summary</span></span>

<span data-ttu-id="f8f70-324">Creación de una aplicación que necesita para capturar datos binarios, presenta a una cantidad de desafíos.</span><span class="sxs-lookup"><span data-stu-id="f8f70-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="f8f70-325">En este tutorial, analizamos las dos primeras: decidir dónde desea almacenar los datos binarios y permitir que un usuario cargar contenido binario a través de una página web.</span><span class="sxs-lookup"><span data-stu-id="f8f70-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="f8f70-326">En los tres tutoriales siguientes, veremos cómo asociar los datos que se envían a un registro en la base de datos, así como cómo mostrar los datos binarios junto con sus campos de datos de texto.</span><span class="sxs-lookup"><span data-stu-id="f8f70-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="f8f70-327">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="f8f70-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="f8f70-328">Información adicional</span><span class="sxs-lookup"><span data-stu-id="f8f70-328">Further Reading</span></span>

<span data-ttu-id="f8f70-329">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="f8f70-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f8f70-330">Uso de tipos de datos de valores grandes</span><span class="sxs-lookup"><span data-stu-id="f8f70-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="f8f70-331">Tutoriales del Control fileUpload</span><span class="sxs-lookup"><span data-stu-id="f8f70-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="f8f70-332">El Control de servidor ASP.NET 2.0 FileUpload</span><span class="sxs-lookup"><span data-stu-id="f8f70-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="f8f70-333">El lado oscuro de cargas de archivos</span><span class="sxs-lookup"><span data-stu-id="f8f70-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="f8f70-334">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="f8f70-334">About the Author</span></span>

<span data-ttu-id="f8f70-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="f8f70-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f8f70-336">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="f8f70-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f8f70-337">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f8f70-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f8f70-338">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f8f70-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f8f70-339">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="f8f70-339">Special Thanks To</span></span>

<span data-ttu-id="f8f70-340">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="f8f70-340">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f8f70-341">Los revisores iniciales para este tutorial fueron Teresa Murphy y Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="f8f70-341">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="f8f70-342">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="f8f70-342">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f8f70-343">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f8f70-343">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="f8f70-344">Siguiente</span><span class="sxs-lookup"><span data-stu-id="f8f70-344">Next</span></span>](displaying-binary-data-in-the-data-web-controls-cs.md)
