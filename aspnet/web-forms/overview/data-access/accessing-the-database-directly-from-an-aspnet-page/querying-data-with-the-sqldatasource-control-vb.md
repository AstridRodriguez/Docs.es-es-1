---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
title: Consultar datos con el Control SqlDataSource (VB) | Documentos de Microsoft
author: rick-anderson
description: "En los tutoriales anteriores hemos utilizado el control ObjectDataSource para separar totalmente el nivel de presentación de la capa de acceso a datos. A partir de este tutor..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: b12f752d-3502-40a4-b695-fc7b7d08cfd3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb
msc.type: authoredcontent
ms.openlocfilehash: a3832bd9847ec8e789b71d13b30a673c8779f4ac
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2018
---
<a name="querying-data-with-the-sqldatasource-control-vb"></a><span data-ttu-id="d1d92-104">Consultar datos con el Control SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="d1d92-104">Querying Data with the SqlDataSource Control (VB)</span></span>
====================
<span data-ttu-id="d1d92-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d1d92-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d1d92-106">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) o [descarga de PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="d1d92-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_47_VB.exe) or [Download PDF](querying-data-with-the-sqldatasource-control-vb/_static/datatutorial47vb1.pdf)</span></span>

> <span data-ttu-id="d1d92-107">En los tutoriales anteriores hemos utilizado el control ObjectDataSource para separar totalmente el nivel de presentación de la capa de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-107">In the preceding tutorials we used the ObjectDataSource control to fully separate the presentation layer from the Data Access layer.</span></span> <span data-ttu-id="d1d92-108">A partir de este tutorial, se obtenga información acerca de cómo puede utilizarse el control SqlDataSource para aplicaciones sencillas que no requieren una estricta separación de la presentación y el acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-108">Starting with this tutorial, we learn how the SqlDataSource control can be used for simple applications that do not require such a strict separation of presentation and data access.</span></span>


## <a name="introduction"></a><span data-ttu-id="d1d92-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="d1d92-109">Introduction</span></span>

<span data-ttu-id="d1d92-110">Todos los tutoriales se ha examinado hasta ahora ha usado una arquitectura en niveles que consta de presentación, lógica de negocios y niveles de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-110">All of the tutorials we ve examined so far have used a tiered architecture consisting of presentation, Business Logic, and Data Access layers.</span></span> <span data-ttu-id="d1d92-111">La capa de acceso a datos (DAL) se ha diseñado en el primer tutorial ([crear una capa de acceso a datos](../introduction/creating-a-data-access-layer-vb.md)) y la capa de lógica empresarial en el segundo ([creación de una capa de lógica de negocios](../introduction/creating-a-business-logic-layer-vb.md)).</span><span class="sxs-lookup"><span data-stu-id="d1d92-111">The Data Access Layer (DAL) was crafted in the first tutorial ([Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md)) and the Business Logic Layer in the second ([Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md)).</span></span> <span data-ttu-id="d1d92-112">A partir de la [mostrar datos con el ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, hemos visto cómo utilizar ASP.NET 2.0 s nuevo ObjectDataSource control establecer una conexión mediante declaración con la arquitectura de la capa de presentación.</span><span class="sxs-lookup"><span data-stu-id="d1d92-112">Starting with the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, we saw how to use ASP.NET 2.0 s new ObjectDataSource control to declaratively interface with the architecture from the presentation layer.</span></span>

<span data-ttu-id="d1d92-113">Mientras todos los tutoriales hasta ahora han utilizado la arquitectura para trabajar con datos, también es posible tener acceso a, insertar, actualizar y eliminar datos de la base de datos directamente desde una página ASP.NET, omitiendo la arquitectura.</span><span class="sxs-lookup"><span data-stu-id="d1d92-113">While all of the tutorials so far have used the architecture to work with data, it is also possible to access, insert, update, and delete database data directly from an ASP.NET page, bypassing the architecture.</span></span> <span data-ttu-id="d1d92-114">Si lo hace, coloca las consultas de base de datos específica y la lógica de negocios directamente en la página web.</span><span class="sxs-lookup"><span data-stu-id="d1d92-114">Doing so places the specific database queries and business logic directly in the web page.</span></span> <span data-ttu-id="d1d92-115">Para las aplicaciones lo suficientemente grandes o complejas, diseñar, implementar y usar una arquitectura en capas son sumamente importante para el éxito, actualización y mantenimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d1d92-115">For sufficiently large or complex applications, designing, implementing, and using a tiered architecture is vitally important for the success, updatability, and maintainability of the application.</span></span> <span data-ttu-id="d1d92-116">Desarrollar una arquitectura robusta, sin embargo, puede ser innecesario al crear aplicaciones sumamente simples y únicas.</span><span class="sxs-lookup"><span data-stu-id="d1d92-116">Developing a robust architecture, however, may be unnecessary when creating exceedingly simple, one-off applications.</span></span>

<span data-ttu-id="d1d92-117">ASP.NET 2.0 proporciona controles de origen de datos integrados cinco [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), y [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="d1d92-117">ASP.NET 2.0 provides five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx).</span></span> <span data-ttu-id="d1d92-118">SqlDataSource puede utilizarse para tener acceso y modificar datos directamente desde una base de datos relacional, incluido Microsoft SQL Server, Microsoft Access, Oracle, MySQL y otros usuarios.</span><span class="sxs-lookup"><span data-stu-id="d1d92-118">The SqlDataSource can be used to access and modify data directly from a relational database, including Microsoft SQL Server, Microsoft Access, Oracle, MySQL, and others.</span></span> <span data-ttu-id="d1d92-119">En este tutorial y los tres siguientes, examinaremos cómo trabajar con el control SqlDataSource, explorar cómo consultar y filtrar los datos de base de datos, así como cómo usar el SqlDataSource para insertar, actualizar y eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-119">In this tutorial and the next three, we'll examine how to work with the SqlDataSource control, exploring how to query and filter database data, as well as how to use the SqlDataSource to insert, update, and delete data.</span></span>


![ASP.NET 2.0 incluye cinco controles de origen de datos integrados](querying-data-with-the-sqldatasource-control-vb/_static/image1.gif)

<span data-ttu-id="d1d92-121">**Figura 1**: ASP.NET 2.0 incluye cinco controles de origen de datos integrados</span><span class="sxs-lookup"><span data-stu-id="d1d92-121">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>


## <a name="comparing-the-objectdatasource-and-sqldatasource"></a><span data-ttu-id="d1d92-122">Comparar el ObjectDataSource y SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-122">Comparing the ObjectDataSource and SqlDataSource</span></span>

<span data-ttu-id="d1d92-123">Conceptualmente, los controles de la ObjectDataSource y SqlDataSource son simplemente servidores proxy a los datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-123">Conceptually, both the ObjectDataSource and SqlDataSource controls are simply proxies to data.</span></span> <span data-ttu-id="d1d92-124">Como se describe en el [mostrar datos con el ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, ObjectDataSource tiene propiedades que indican el tipo de objeto que proporciona los datos y los métodos que se invocará para seleccionar, insertar, actualizar y eliminar datos desde el tipo de objeto subyacente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-124">As discussed in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial, the ObjectDataSource has properties that indicate the object type that provides the data and the methods to invoke to select, insert, update, and delete data from the underlying object type.</span></span> <span data-ttu-id="d1d92-125">Una vez configuradas las propiedades de s ObjectDataSource, un control Web como GridView, DetailsView o DataList pueden estar enlazado a datos al control, mediante las operaciones de asignación ObjectDataSource `Select()`, `Insert()`, `Delete()`, y `Update()` métodos para interactuar con la arquitectura subyacente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-125">Once the ObjectDataSource s properties have been configured, a data Web control such as a GridView, DetailsView, or DataList can be bound to the control, using the ObjectDataSource s `Select()`, `Insert()`, `Delete()`, and `Update()` methods to interact with the underlying architecture.</span></span>

<span data-ttu-id="d1d92-126">SqlDataSource proporciona la misma funcionalidad, pero funciona en una base de datos relacional en lugar de una biblioteca de objetos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-126">The SqlDataSource provides the same functionality, but operates against a relational database rather than an object library.</span></span> <span data-ttu-id="d1d92-127">Con SqlDataSource, se debe especificar la cadena de conexión de base de datos y las consultas SQL ad hoc o los procedimientos almacenados para ejecutar para insertar, actualizar, eliminar y recuperar los datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-127">With the SqlDataSource, we must specify the database connection string and the ad-hoc SQL queries or stored procedures to execute to insert, update, delete, and retrieve data.</span></span> <span data-ttu-id="d1d92-128">Las operaciones de asignación SqlDataSource `Select()`, `Insert()`, `Update()`, y `Delete()` métodos, cuando se invoca, conéctese a la base de datos especificada y emitir la consulta SQL adecuada.</span><span class="sxs-lookup"><span data-stu-id="d1d92-128">The SqlDataSource s `Select()`, `Insert()`, `Update()`, and `Delete()` methods, when invoked, connect to the specified database and issue the appropriate SQL query.</span></span> <span data-ttu-id="d1d92-129">Como se ilustra en el siguiente diagrama, estos métodos realizan el trabajo de investigadores de conectarse a una base de datos, emitir una consulta y devolver los resultados.</span><span class="sxs-lookup"><span data-stu-id="d1d92-129">As the following diagram illustrates, the these methods do the grunt work of connecting to a database, issuing a query, and returning the results.</span></span>


![SqlDataSource actúa como un Proxy para la base de datos](querying-data-with-the-sqldatasource-control-vb/_static/image2.gif)

<span data-ttu-id="d1d92-131">**Figura 2**: SqlDataSource actúa como un Proxy para la base de datos</span><span class="sxs-lookup"><span data-stu-id="d1d92-131">**Figure 2**: The SqlDataSource Serves as a Proxy to the Database</span></span>


> [!NOTE]
> <span data-ttu-id="d1d92-132">En este tutorial, nos centraremos en recuperar datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-132">In this tutorial we'll focus on retrieving data from the database.</span></span> <span data-ttu-id="d1d92-133">En el [Insertar, actualizar y eliminar datos con el SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, veremos cómo configurar el SqlDataSource para admitir Insertar, actualizar y eliminar.</span><span class="sxs-lookup"><span data-stu-id="d1d92-133">In the [Inserting, Updating, and Deleteing Data with the SqlDataSource Control](inserting-updating-and-deleting-data-with-the-sqldatasource-vb.md) tutorial, we'll see how to configure the SqlDataSource to support inserting, updating, and deleting.</span></span>


## <a name="the-sqldatasource-and-accessdatasource-controls"></a><span data-ttu-id="d1d92-134">Los controles de AccessDataSource y SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-134">The SqlDataSource and AccessDataSource Controls</span></span>

<span data-ttu-id="d1d92-135">Además del control SqlDataSource, ASP.NET 2.0 también incluye un control AccessDataSource.</span><span class="sxs-lookup"><span data-stu-id="d1d92-135">In addition to the SqlDataSource control, ASP.NET 2.0 also includes an AccessDataSource control.</span></span> <span data-ttu-id="d1d92-136">Estos dos tipos de controles provocar numerosos desarrolladores de nuevo a ASP.NET 2.0 para sospechar que el control AccessDataSource está diseñado para trabajar exclusivamente con Microsoft Access con el control SqlDataSource diseñado para trabajar exclusivamente con Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d1d92-136">These two different controls lead many developers new to ASP.NET 2.0 to suspect that the AccessDataSource control is designed to work exclusively with Microsoft Access with the SqlDataSource control designed to work exclusively with Microsoft SQL Server.</span></span> <span data-ttu-id="d1d92-137">Aunque el AccessDataSource está diseñado para trabajar específicamente con Microsoft Access, el control SqlDataSource funciona con *cualquier* base de datos relacional que se puede tener acceso a través. NET.</span><span class="sxs-lookup"><span data-stu-id="d1d92-137">While the AccessDataSource is designed to work specifically with Microsoft Access, the SqlDataSource control works with *any* relational database that can be accessed through .NET.</span></span> <span data-ttu-id="d1d92-138">Esto incluye cualquier compatible con OLE DB o ODBC almacenes de datos, como Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL y PostgreSQL, entre muchas otras.</span><span class="sxs-lookup"><span data-stu-id="d1d92-138">This includes any OleDb- or ODBC-compliant data stores, such as Microsoft SQL Server, Microsoft Access, Oracle, Informix, MySQL, and PostgreSQL, among many others.</span></span>

<span data-ttu-id="d1d92-139">La única diferencia entre los controles AccessDataSource y SqlDataSource es cómo se especifica la información de conexión de base de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-139">The sole difference between the AccessDataSource and SqlDataSource controls is how the database connection information is specified.</span></span> <span data-ttu-id="d1d92-140">El control AccessDataSource necesita que la ruta de acceso al archivo de base de datos de Access.</span><span class="sxs-lookup"><span data-stu-id="d1d92-140">The AccessDataSource control needs just the file path to the Access database file.</span></span> <span data-ttu-id="d1d92-141">SqlDataSource, por otro lado, requiere una cadena de conexión completa.</span><span class="sxs-lookup"><span data-stu-id="d1d92-141">The SqlDataSource, on the other hand, requires a complete connection string.</span></span>

## <a name="step-1-creating-the-sqldatasource-web-pages"></a><span data-ttu-id="d1d92-142">Paso 1: Crear las páginas Web SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-142">Step 1: Creating the SqlDataSource Web Pages</span></span>

<span data-ttu-id="d1d92-143">Antes de empezar a explorar cómo trabajar directamente con datos de base de datos mediante el control SqlDataSource, permiten s primero Tómese un momento para crear las páginas ASP.NET en el proyecto de sitio Web que se necesitará para este tutorial y los tres siguientes.</span><span class="sxs-lookup"><span data-stu-id="d1d92-143">Before we start exploring how to work directly with database data using the SqlDataSource control, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="d1d92-144">Empiece por agregar una nueva carpeta denominada `SqlDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-144">Start by adding a new folder named `SqlDataSource`.</span></span> <span data-ttu-id="d1d92-145">A continuación, agregue las siguientes páginas ASP.NET a la carpeta y asegúrese de que asociar cada página con el `Site.master` página maestra:</span><span class="sxs-lookup"><span data-stu-id="d1d92-145">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Querying.aspx`
- `ParameterizedQueries.aspx`
- `InsertUpdateDelete.aspx`
- `OptimisticConcurrency.aspx`


![Agregar las páginas ASP.NET para los tutoriales relacionados con SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image3.gif)

<span data-ttu-id="d1d92-147">**Figura 3**: agregar las páginas ASP.NET para los tutoriales relacionados con SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-147">**Figure 3**: Add the ASP.NET Pages for the SqlDataSource-Related Tutorials</span></span>


<span data-ttu-id="d1d92-148">Al igual que en las otras carpetas, `Default.aspx` en el `SqlDataSource` carpeta enumerará los tutoriales en su sección.</span><span class="sxs-lookup"><span data-stu-id="d1d92-148">Like in the other folders, `Default.aspx` in the `SqlDataSource` folder will list the tutorials in its section.</span></span> <span data-ttu-id="d1d92-149">Recuerde que el `SectionLevelTutorialListing.ascx` Control de usuario proporciona esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="d1d92-149">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="d1d92-150">Por lo tanto, agregue este Control de usuario para `Default.aspx` arrastrándolo desde el Explorador de soluciones en la página s la vista Diseño.</span><span class="sxs-lookup"><span data-stu-id="d1d92-150">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="d1d92-151">[![Agregar el Control de usuario SectionLevelTutorialListing.ascx a Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span><span class="sxs-lookup"><span data-stu-id="d1d92-151">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](querying-data-with-the-sqldatasource-control-vb/_static/image5.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image4.gif)</span></span>

<span data-ttu-id="d1d92-152">**Figura 4**: agregar la `SectionLevelTutorialListing.ascx` Control de usuario a `Default.aspx` ([haga clic aquí para ver la imagen a tamaño completo](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span><span class="sxs-lookup"><span data-stu-id="d1d92-152">**Figure 4**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image6.gif))</span></span>


<span data-ttu-id="d1d92-153">Por último, agregue estos cuatro páginas como entradas para el `Web.sitemap` archivo.</span><span class="sxs-lookup"><span data-stu-id="d1d92-153">Lastly, add these four pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="d1d92-154">En concreto, agregue el siguiente marcado después de agregar botones de personalizado al DataList y repetidor `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="d1d92-154">Specifically, add the following markup after the Adding Custom Buttons to the DataList and Repeater `<siteMapNode>`:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample1.sql)]

<span data-ttu-id="d1d92-155">Después de actualizar `Web.sitemap`, tómese un momento para ver el sitio Web de tutoriales a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="d1d92-155">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="d1d92-156">El menú de la izquierda ahora incluye elementos para modificar, insertar y eliminar los tutoriales.</span><span class="sxs-lookup"><span data-stu-id="d1d92-156">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![El mapa del sitio ahora incluye las entradas para los tutoriales de SqlDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image7.gif)

<span data-ttu-id="d1d92-158">**Figura 5**: la asignación de sitio ahora incluye las entradas para los tutoriales de SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-158">**Figure 5**: The Site Map Now Includes Entries for the SqlDataSource Tutorials</span></span>


## <a name="step-2-adding-and-configuring-the-sqldatasource-control"></a><span data-ttu-id="d1d92-159">Paso 2: Agregar y configurar el Control SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-159">Step 2: Adding and Configuring the SqlDataSource Control</span></span>

<span data-ttu-id="d1d92-160">Comience abriendo la `Querying.aspx` página en el `SqlDataSource` carpeta y cambie a la vista de diseño.</span><span class="sxs-lookup"><span data-stu-id="d1d92-160">Start by opening the `Querying.aspx` page in the `SqlDataSource` folder and switch to Design view.</span></span> <span data-ttu-id="d1d92-161">Arrastre un control SqlDataSource desde el cuadro de herramientas en el diseñador y el conjunto de sus `ID` a `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-161">Drag a SqlDataSource control from the Toolbox onto the Designer and set its `ID` to `ProductsDataSource`.</span></span> <span data-ttu-id="d1d92-162">Al igual que con el origen ObjectDataSource, SqlDataSource no genera ningún resultado representado y, por tanto, aparece como un cuadro gris en la superficie de diseño.</span><span class="sxs-lookup"><span data-stu-id="d1d92-162">As with the ObjectDataSource, the SqlDataSource does not produce any rendered output and therefore appears as a gray box on the design surface.</span></span> <span data-ttu-id="d1d92-163">Para configurar el SqlDataSource, haga clic en el vínculo Configurar origen de datos de la etiqueta inteligente de SqlDataSource s.</span><span class="sxs-lookup"><span data-stu-id="d1d92-163">To configure the SqlDataSource, click on the Configure Data Source link from the SqlDataSource s smart tag.</span></span>


![Haga clic en el vínculo a origen de datos de la etiqueta inteligente de SqlDataSource s de configurar](querying-data-with-the-sqldatasource-control-vb/_static/image8.gif)

<span data-ttu-id="d1d92-165">**Figura 6**: haga clic en el vínculo a origen de datos de la etiqueta inteligente de SqlDataSource s de configurar</span><span class="sxs-lookup"><span data-stu-id="d1d92-165">**Figure 6**: Click on the Configure Data Source Link from the SqlDataSource s Smart Tag</span></span>


<span data-ttu-id="d1d92-166">Se abrirá el Asistente para configurar origen de datos de SqlDataSource control s.</span><span class="sxs-lookup"><span data-stu-id="d1d92-166">This brings up the SqlDataSource control s Configure Data Source wizard.</span></span> <span data-ttu-id="d1d92-167">Aunque los pasos del asistente s difieren desde el control ObjectDataSource s, el objetivo final es el mismo para proporcionar los detalles acerca de cómo recuperar, insertar, actualizar y eliminar datos mediante el origen de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-167">While the wizard s steps differ from the ObjectDataSource control s, the end goal is the same to provide the details on how to retrieve, insert, update, and delete data through the data source.</span></span> <span data-ttu-id="d1d92-168">Para el SqlDataSource esto conlleva especifica la base de datos subyacente para utilizar y proporcionar las instrucciones SQL ad hoc o procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="d1d92-168">For the SqlDataSource this entails specifying the underlying database to use and providing the ad-hoc SQL statements or stored procedures.</span></span>

<span data-ttu-id="d1d92-169">El primer paso del asistente nos pide la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-169">The first wizard step prompts us for the database.</span></span> <span data-ttu-id="d1d92-170">La lista desplegable incluye esas bases de datos que se encuentra en la s de la aplicación web `App_Data` carpeta y aquellos que se han agregado al nodo Conexiones de datos en el Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="d1d92-170">The drop-down list includes those databases found in the web application s `App_Data` folder and those that have been added to the Data Connections node in the Server Explorer.</span></span> <span data-ttu-id="d1d92-171">Desde que se ha agregado ya una cadena de conexión para el `NORTHWIND.MDF` en la base de datos la `App_Data` carpeta a nuestro proyecto s `Web.config` archivo, la lista desplegable incluye una referencia a esa cadena de conexión `NORTHWINDConnectionString`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-171">Since we ve already added a connection string for the `NORTHWIND.MDF` database in the `App_Data` folder to our project s `Web.config` file, the drop-down list includes a reference to that connection string, `NORTHWINDConnectionString`.</span></span> <span data-ttu-id="d1d92-172">Seleccione este elemento de la lista desplegable y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-172">Choose this item from the drop-down list and click Next.</span></span>


![Elija la conexión NORTHWINDConnectionString en la lista desplegable](querying-data-with-the-sqldatasource-control-vb/_static/image9.gif)

<span data-ttu-id="d1d92-174">**Figura 7**: elija la `NORTHWINDConnectionString` en la lista desplegable</span><span class="sxs-lookup"><span data-stu-id="d1d92-174">**Figure 7**: Choose the `NORTHWINDConnectionString` from the Drop-Down List</span></span>


<span data-ttu-id="d1d92-175">Después de elegir la base de datos, el asistente solicita la consulta devolver los datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-175">After choosing the database, the wizard asks for the query to return data.</span></span> <span data-ttu-id="d1d92-176">Se pueden especificar las columnas de una tabla o vista para devolver o puede especificar una instrucción SQL personalizada o un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="d1d92-176">We can either specify the columns of a table or view to return or can enter a custom SQL statement or specify a stored procedure.</span></span> <span data-ttu-id="d1d92-177">Puede alternar entre esta opción a través de especificar una instrucción SQL personalizada o procedimiento almacenado y especificar columnas de una tabla o ver los botones de radio.</span><span class="sxs-lookup"><span data-stu-id="d1d92-177">You can toggle between this choice through the Specify a custom SQL statement or stored procedure and Specify columns from a table or view radio buttons.</span></span>

> [!NOTE]
> <span data-ttu-id="d1d92-178">Para este primer ejemplo, permitir que s use el especificar columnas de una opción de tabla o vista.</span><span class="sxs-lookup"><span data-stu-id="d1d92-178">For this first example, let s use the Specify columns from a table or view option.</span></span> <span data-ttu-id="d1d92-179">Comenzaremos volver al asistente más adelante en este tutorial y explorar la especificar una opción de procedimiento almacenado o una instrucción SQL personalizada.</span><span class="sxs-lookup"><span data-stu-id="d1d92-179">We'll return to the wizard later in this tutorial and explore the Specify a custom SQL statement or stored procedure option.</span></span>


<span data-ttu-id="d1d92-180">Figura 8 muestra la pantalla de la instrucción Select de la configuración cuando se seleccionan las columnas de especificar en un botón de opción de tabla o vista.</span><span class="sxs-lookup"><span data-stu-id="d1d92-180">Figure 8 shows the Configure the Select Statement screen when the Specify columns from a table or view radio button is selected.</span></span> <span data-ttu-id="d1d92-181">La lista desplegable contiene el conjunto de tablas y vistas de la base de datos Northwind, con la tabla seleccionada o columnas de vistas s muestra en la siguiente lista de casilla de verificación.</span><span class="sxs-lookup"><span data-stu-id="d1d92-181">The drop-down list contains the set of tables and views in the Northwind database, with the selected table or view s columns displayed in the checkbox list below.</span></span> <span data-ttu-id="d1d92-182">En este ejemplo, se devuelven permiten s el `ProductID`, `ProductName`, y `UnitPrice` columnas de la `Products` tabla.</span><span class="sxs-lookup"><span data-stu-id="d1d92-182">For this example, let s return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table.</span></span> <span data-ttu-id="d1d92-183">Como se muestra en la figura 8, después de realizar las selecciones del asistente muestra la instrucción SQL resultante `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-183">As Figure 8 shows, after making these selections the wizard shows the resulting SQL statement `SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`.</span></span>


![Obtener datos de la tabla de productos](querying-data-with-the-sqldatasource-control-vb/_static/image10.gif)

<span data-ttu-id="d1d92-185">**Figura 8**: devolver datos desde el `Products` tabla</span><span class="sxs-lookup"><span data-stu-id="d1d92-185">**Figure 8**: Return Data from the `Products` Table</span></span>


<span data-ttu-id="d1d92-186">Una vez haya configurado el Asistente para devolver el `ProductID`, `ProductName`, y `UnitPrice` columnas de la `Products` de tabla, haga clic en el botón siguiente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-186">Once you have configured the wizard to return the `ProductID`, `ProductName`, and `UnitPrice` columns from the `Products` table, click the Next button.</span></span> <span data-ttu-id="d1d92-187">Esta pantalla final proporciona una oportunidad para examinar los resultados de la consulta configurado en el paso anterior.</span><span class="sxs-lookup"><span data-stu-id="d1d92-187">This final screen provides an opportunity to examine the results of the query configured from the previous step.</span></span> <span data-ttu-id="d1d92-188">Haga clic en el botón de consulta de prueba se ejecuta el configurado `SELECT` instrucción y muestra los resultados en una cuadrícula.</span><span class="sxs-lookup"><span data-stu-id="d1d92-188">Clicking the Test Query button executes the configured `SELECT` statement and displays the results in a grid.</span></span>


![Haga clic en el botón de consulta de prueba para revisar la consulta de selección](querying-data-with-the-sqldatasource-control-vb/_static/image11.gif)

<span data-ttu-id="d1d92-190">**Figura 9**: haga clic en el botón de consulta de prueba para revisar su `SELECT` consulta</span><span class="sxs-lookup"><span data-stu-id="d1d92-190">**Figure 9**: Click the Test Query Button to Review Your `SELECT` Query</span></span>


<span data-ttu-id="d1d92-191">Para completar al asistente, haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="d1d92-191">To complete the wizard, click Finish.</span></span>

<span data-ttu-id="d1d92-192">Al igual que con el origen ObjectDataSource, el Asistente para la s SqlDataSource simplemente asigna valores a las propiedades del control s, es decir, el [ `ConnectionString` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) y [ `SelectCommand` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) propiedades.</span><span class="sxs-lookup"><span data-stu-id="d1d92-192">Like with the ObjectDataSource, the SqlDataSource s wizard merely assigns values to the control s properties, namely the [`ConnectionString`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.connectionstring.aspx) and [`SelectCommand`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.selectcommand.aspx) properties.</span></span> <span data-ttu-id="d1d92-193">Después de completar al asistente, el marcado declarativo s del control SqlDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="d1d92-193">After completing the wizard, your SqlDataSource control s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample2.aspx)]

<span data-ttu-id="d1d92-194">El `ConnectionString` propiedad proporciona información sobre cómo conectarse a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-194">The `ConnectionString` property provides information on how to connect to the database.</span></span> <span data-ttu-id="d1d92-195">Esta propiedad puede asignarse un valor de cadena de conexión completa, codificado de forma rígida o puede apuntar a una cadena de conexión en `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-195">This property can be assigned a complete, hard-coded connection string value or can point to a connection string in `Web.config`.</span></span> <span data-ttu-id="d1d92-196">Para hacer referencia a un valor de cadena de conexión en el archivo Web.config, use la sintaxis `<%$ expressionPrefix:expressionValue %>`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-196">To reference a connection string value in Web.config, use the syntax `<%$ expressionPrefix:expressionValue %>`.</span></span> <span data-ttu-id="d1d92-197">Por lo general, *expressionPrefix* es ConnectionStrings y *expressionValue* es el nombre de la cadena de conexión en el `Web.config` [ `<connectionStrings>` sección](https://msdn.microsoft.com/library/bf7sd233.aspx).</span><span class="sxs-lookup"><span data-stu-id="d1d92-197">Typically, *expressionPrefix* is ConnectionStrings and *expressionValue* is the name of the connect string in the `Web.config` [`<connectionStrings>` section](https://msdn.microsoft.com/library/bf7sd233.aspx).</span></span> <span data-ttu-id="d1d92-198">Sin embargo, la sintaxis se puede usar para hacer referencia a `<appSettings>` elementos o contenido de archivos de recursos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-198">However, the syntax can be used to reference `<appSettings>` elements or content from resource files.</span></span> <span data-ttu-id="d1d92-199">Vea [información general sobre expresiones de ASP.NET](https://msdn.microsoft.com/library/d5bd1tad.aspx) para obtener más información acerca de esta sintaxis.</span><span class="sxs-lookup"><span data-stu-id="d1d92-199">See [ASP.NET Expressions Overview](https://msdn.microsoft.com/library/d5bd1tad.aspx) for more on this syntax.</span></span>

<span data-ttu-id="d1d92-200">El `SelectCommand` propiedad especifica la instrucción de SQL ad hoc o procedimiento almacenado que se ejecutan para devolver los datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-200">The `SelectCommand` property specifies the ad-hoc SQL statement or stored procedure to execute to return the data.</span></span>

## <a name="step-3-adding-a-data-web-control-and-binding-it-to-the-sqldatasource"></a><span data-ttu-id="d1d92-201">Paso 3: Agregar un Control Web de datos y se enlaza a la SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-201">Step 3: Adding a Data Web Control and Binding it to the SqlDataSource</span></span>

<span data-ttu-id="d1d92-202">Una vez que se ha configurado la SqlDataSource, se puede enlazar a un control Web, como una GridView DetailsView de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-202">Once the SqlDataSource has been configured, it can be bound to a data Web control, such as a GridView or DetailsView.</span></span> <span data-ttu-id="d1d92-203">Para este tutorial, permiten s muestra los datos en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="d1d92-203">For this tutorial, let s display the data in a GridView.</span></span> <span data-ttu-id="d1d92-204">En el cuadro de herramientas, arrastre un control GridView a la página y enlazarla a la `ProductsDataSource` SqlDataSource eligiendo el origen de datos en la lista desplegable de la etiqueta inteligente de s de GridView.</span><span class="sxs-lookup"><span data-stu-id="d1d92-204">From the Toolbox, drag a GridView onto the page and bind it to the `ProductsDataSource` SqlDataSource by choosing the data source from the drop-down list in the GridView s smart tag.</span></span>


<span data-ttu-id="d1d92-205">[![Agregar un control GridView y enlazarlo con el SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span><span class="sxs-lookup"><span data-stu-id="d1d92-205">[![Add a GridView and Bind it to the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb/_static/image13.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image12.gif)</span></span>

<span data-ttu-id="d1d92-206">**Figura 10**: agregar un control GridView y enlazarlo con el SqlDataSource Control ([haga clic aquí para ver la imagen a tamaño completo](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span><span class="sxs-lookup"><span data-stu-id="d1d92-206">**Figure 10**: Add a GridView and Bind it to the SqlDataSource Control ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image14.gif))</span></span>


<span data-ttu-id="d1d92-207">Una vez que se ha seleccionado el control SqlDataSource en la lista desplegable de la etiqueta inteligente de GridView s, Visual Studio agregará automáticamente un BoundField o CampoCasillaVerificación a GridView para cada una de las columnas devueltas por el control de origen de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-207">Once you ve selected the SqlDataSource control from the drop-down list in the GridView s smart tag, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the columns returned by the data source control.</span></span> <span data-ttu-id="d1d92-208">Puesto que la SqlDataSource devuelve tres columnas de la base de datos `ProductID`, `ProductName`, y `UnitPrice` hay tres campos en GridView.</span><span class="sxs-lookup"><span data-stu-id="d1d92-208">Since the SqlDataSource returns three database columns `ProductID`, `ProductName`, and `UnitPrice` there are three fields in the GridView.</span></span>

<span data-ttu-id="d1d92-209">Tómese un momento para configurar las tres operaciones de asignación GridView BoundFields.</span><span class="sxs-lookup"><span data-stu-id="d1d92-209">Take a moment to configure the GridView s three BoundFields.</span></span> <span data-ttu-id="d1d92-210">Cambiar el `ProductName` campo s `HeaderText` propiedad al nombre de producto y el `UnitPrice` campo s a un precio.</span><span class="sxs-lookup"><span data-stu-id="d1d92-210">Change the `ProductName` field s `HeaderText` property to Product Name and the `UnitPrice` field s to Price.</span></span> <span data-ttu-id="d1d92-211">Dar formato a los `UnitPrice` campo como una moneda.</span><span class="sxs-lookup"><span data-stu-id="d1d92-211">Also format the `UnitPrice` field as a currency.</span></span> <span data-ttu-id="d1d92-212">Después de realizar estas modificaciones, el código de marcado de GridView s declarativa debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="d1d92-212">After making these modifications, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample3.aspx)]

<span data-ttu-id="d1d92-213">Visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="d1d92-213">Visit this page through a browser.</span></span> <span data-ttu-id="d1d92-214">Como se muestra en la figura 11, GridView enumera cada producto s `ProductID`, `ProductName`, y `UnitPrice` valores.</span><span class="sxs-lookup"><span data-stu-id="d1d92-214">As Figure 11 shows, the GridView lists each product s `ProductID`, `ProductName`, and `UnitPrice` values.</span></span>


<span data-ttu-id="d1d92-215">[![GridView muestra cada producto s ProductID, ProductName y UnitPrice valores](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span><span class="sxs-lookup"><span data-stu-id="d1d92-215">[![The GridView Displays Each Product s ProductID, ProductName, and UnitPrice Values](querying-data-with-the-sqldatasource-control-vb/_static/image16.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image15.gif)</span></span>

<span data-ttu-id="d1d92-216">**Figura 11**: The GridView muestra cada producto s `ProductID`, `ProductName`, y `UnitPrice` valores ([haga clic aquí para ver la imagen a tamaño completo](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span><span class="sxs-lookup"><span data-stu-id="d1d92-216">**Figure 11**: The GridView Displays Each Product s `ProductID`, `ProductName`, and `UnitPrice` Values ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image17.gif))</span></span>


<span data-ttu-id="d1d92-217">Cuando se visita la página GridView invoca su control de origen de datos s `Select()` método.</span><span class="sxs-lookup"><span data-stu-id="d1d92-217">When the page is visited the GridView invokes its data source control s `Select()` method.</span></span> <span data-ttu-id="d1d92-218">Cuando que estuviéramos usando el control ObjectDataSource, esto se denomina la `ProductsBLL` clase s. `GetProducts()` método.</span><span class="sxs-lookup"><span data-stu-id="d1d92-218">When we were using the ObjectDataSource control, this called the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="d1d92-219">Con SqlDataSource, sin embargo, el `Select()` método establece una conexión a la base de datos especificada y problemas el `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, en este ejemplo).</span><span class="sxs-lookup"><span data-stu-id="d1d92-219">With the SqlDataSource, however, the `Select()` method establishes a connection to the specified database and issues the `SelectCommand` (`SELECT [ProductID], [ProductName], [UnitPrice] FROM [Products]`, in this example).</span></span> <span data-ttu-id="d1d92-220">SqlDataSource devuelve los resultados que GridView, a continuación, enumera, creación de una fila en GridView para cada registro de base de datos devuelto.</span><span class="sxs-lookup"><span data-stu-id="d1d92-220">The SqlDataSource returns its results which the GridView then enumerates, creating a row in the GridView for each database record returned.</span></span>

## <a name="the-built-in-data-web-control-features-and-the-sqldatasource-control"></a><span data-ttu-id="d1d92-221">Las características de Control Web de datos integrados y el Control SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-221">The Built-In Data Web Control Features and the SqlDataSource Control</span></span>

<span data-ttu-id="d1d92-222">En general, las funciones inherentes a los datos de que controles Web de paginación, ordenación, editar, eliminar, insertar y así sucesivamente son específicos para el control Web de datos y no son dependientes en el control de origen de datos utilizado.</span><span class="sxs-lookup"><span data-stu-id="d1d92-222">In general, the features inherent to the data Web controls paging, sorting, editing, deleting, inserting, and so on are specific to the data Web control and are not dependent on the data source control used.</span></span> <span data-ttu-id="d1d92-223">Es decir, el control GridView puede utilizar su integrado paginación, ordenación, modificar y eliminar si está enlazado a un origen ObjectDataSource o un SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="d1d92-223">That is, the GridView can utilize its built-in paging, sorting, editing, and deleting whether it is bound to an ObjectDataSource or a SqlDataSource.</span></span> <span data-ttu-id="d1d92-224">Sin embargo, ciertas características de control Web de datos son confidenciales al control de origen de datos que se va a usar o a la configuración de control s de origen de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-224">However, certain data Web control features are sensitive to the data source control being used or to the data source control s configuration.</span></span>

<span data-ttu-id="d1d92-225">Por ejemplo, en la [eficazmente paginar a través de grandes cantidades de datos](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial se explica cómo hacerlo, de forma predeterminada, la lógica de paginación para los datos Web controla naively devuelve *todos los* registros de subyacente origen de datos y, a continuación, muestran sólo el subconjunto adecuado de registros según el índice de la página actual y el número de registros mostrados por página.</span><span class="sxs-lookup"><span data-stu-id="d1d92-225">For example, in the [Efficiently Paging Through Large Amounts of Data](../paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb.md) tutorial we discussed how, by default, the paging logic for the data Web controls naively returns *all* records from the underlying data source and then displays only the appropriate subset of records given the current page index and the number of records to display per page.</span></span> <span data-ttu-id="d1d92-226">Este modelo es muy ineficaz al paginar a través de conjuntos de resultados lo suficientemente grande.</span><span class="sxs-lookup"><span data-stu-id="d1d92-226">This model is highly inefficient when paging through sufficiently large result sets.</span></span> <span data-ttu-id="d1d92-227">Afortunadamente, ObjectDataSource puede configurarse para admitir la paginación personalizada, que devuelve solo el subconjunto preciso de registros que deben mostrarse.</span><span class="sxs-lookup"><span data-stu-id="d1d92-227">Fortunately, the ObjectDataSource can be configured to support custom paging, which returns only the precise subset of records to display.</span></span> <span data-ttu-id="d1d92-228">El control SqlDataSource, sin embargo, no tiene las propiedades para implementar la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="d1d92-228">The SqlDataSource control, however, lacks the properties for implementing custom paging.</span></span>

<span data-ttu-id="d1d92-229">Otro problema con la paginación y la ordenación se genera con SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="d1d92-229">Another subtlety with paging and sorting arises with the SqlDataSource.</span></span> <span data-ttu-id="d1d92-230">De forma predeterminada, los datos devueltos por una SqlDataSource se pueden paginar u ordena a través de GridView.</span><span class="sxs-lookup"><span data-stu-id="d1d92-230">By default, the data returned from a SqlDataSource can be paged or sorted through the GridView.</span></span> <span data-ttu-id="d1d92-231">Para demostrar esto, compruebe las opciones Habilitar paginación y habilitar la ordenación en la etiqueta inteligente de GridView s en `Querying.aspx` y compruebe que funciona según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="d1d92-231">To demonstrate this, check the Enable Paging and Enable Sorting options in the GridView s smart tag in `Querying.aspx` and verify that this works as expected.</span></span>

<span data-ttu-id="d1d92-232">Ordenar y paginar funcionan porque el SqlDataSource recupera los datos de la base de datos en un conjunto de datos imprecisa.</span><span class="sxs-lookup"><span data-stu-id="d1d92-232">Sorting and paging works because the SqlDataSource retrieves the database data into a loosely-typed DataSet.</span></span> <span data-ttu-id="d1d92-233">El número total de registros devueltos por la consulta un aspecto fundamental para implementar la paginación puede determinarse del conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-233">The total number of records returned by the query an essential aspect to implementing paging can be ascertained from the DataSet.</span></span> <span data-ttu-id="d1d92-234">Además, se pueden ordenar los resultados de s de conjunto de datos a través de un objeto DataView.</span><span class="sxs-lookup"><span data-stu-id="d1d92-234">Additionally, the DataSet s results can be sorted through a DataView.</span></span> <span data-ttu-id="d1d92-235">Estas capacidades se utilizan automáticamente el SqlDataSource cuando las solicitudes de GridView paginar o datos ordenan.</span><span class="sxs-lookup"><span data-stu-id="d1d92-235">These capabilities are automatically used by the SqlDataSource when the GridView requests paged or sorted data.</span></span>

<span data-ttu-id="d1d92-236">SqlDataSource puede configurarse para devolver un objeto DataReader en lugar de un conjunto de datos cambiando su [ `DataSourceMode` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) de `DataSet` (valor predeterminado) a `DataReader`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-236">The SqlDataSource can be configured to return a DataReader instead of a DataSet by changing its [`DataSourceMode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sqldatasource.datasourcemode.aspx) from `DataSet` (the default) to `DataReader`.</span></span> <span data-ttu-id="d1d92-237">Utilizando un objeto DataReader podría preferir situaciones al pasar los resultados de s SqlDataSource en el código existente que espera un DataReader.</span><span class="sxs-lookup"><span data-stu-id="d1d92-237">Using a DataReader might be preferred in situations when passing the SqlDataSource s results to existing code that expects a DataReader.</span></span> <span data-ttu-id="d1d92-238">Además, puesto que DataReaders son objetos mucho más fácil que los conjuntos de datos, ofrecen un mejor rendimiento.</span><span class="sxs-lookup"><span data-stu-id="d1d92-238">Furthermore, since DataReaders are considerably simpler objects than DataSets, they offer better performance.</span></span> <span data-ttu-id="d1d92-239">Si realiza este cambio, sin embargo, no puede ordenar el control Web de datos ni página porque el SqlDataSource no puede determinar el número de registros es devueltos por la consulta, ni tampoco el DataReader ofrecen las técnicas para ordenar los datos devueltos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-239">If you make this change, however, the data Web control can neither sort nor page since the SqlDataSource cannot ascertain how many records are returned by the query, nor does the DataReader offer any techniques for sorting the returned data.</span></span>

## <a name="step-4-using-a-custom-sql-statement-or-stored-procedure"></a><span data-ttu-id="d1d92-240">Paso 4: Mediante una instrucción SQL personalizada o un procedimiento almacenado</span><span class="sxs-lookup"><span data-stu-id="d1d92-240">Step 4: Using a Custom SQL Statement or Stored Procedure</span></span>

<span data-ttu-id="d1d92-241">Al configurar el control SqlDataSource, la consulta utilizada para devolver los datos puede especificarse en uno de estos dos enfoques como una instrucción SQL personalizada o un procedimiento almacenado, o como columnas de una tabla o vista existente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-241">When configuring the SqlDataSource control, the query used to return data can be specified in one of two approaches as a custom SQL statement or stored procedure, or as columns from an existing table or view.</span></span> <span data-ttu-id="d1d92-242">En el paso 2, examinamos selecciona las columnas de la `Products` tabla.</span><span class="sxs-lookup"><span data-stu-id="d1d92-242">In Step 2 we examined selecting columns from the `Products` table.</span></span> <span data-ttu-id="d1d92-243">Permiten s mirar mediante una instrucción SQL personalizada.</span><span class="sxs-lookup"><span data-stu-id="d1d92-243">Let s look at using a custom SQL statement.</span></span>

<span data-ttu-id="d1d92-244">Agregue otro control GridView a la `Querying.aspx` página y decide crear un nuevo origen de datos en la lista desplegable de la etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-244">Add another GridView control to the `Querying.aspx` page and choose to create a new data source from the drop-down list in the smart tag.</span></span> <span data-ttu-id="d1d92-245">A continuación, indicar que los datos se van a extraer de una base de datos se creará un nuevo control SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="d1d92-245">Next, indicate that the data will be pulled from a database this will create a new SqlDataSource control.</span></span> <span data-ttu-id="d1d92-246">Nombre del control `ProductsWithCategoryInfoDataSource`.</span><span class="sxs-lookup"><span data-stu-id="d1d92-246">Name the control `ProductsWithCategoryInfoDataSource`.</span></span>


![Crear un nuevo Control SqlDataSource denominado ProductsWithCategoryInfoDataSource](querying-data-with-the-sqldatasource-control-vb/_static/image18.gif)

<span data-ttu-id="d1d92-248">**Figura 12**: crear un nuevo Control SqlDataSource denominado`ProductsWithCategoryInfoDataSource`</span><span class="sxs-lookup"><span data-stu-id="d1d92-248">**Figure 12**: Create a New SqlDataSource Control Named `ProductsWithCategoryInfoDataSource`</span></span>


<span data-ttu-id="d1d92-249">La siguiente pantalla le pide que especifique la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-249">The next screen asks us to specify the database.</span></span> <span data-ttu-id="d1d92-250">Igual que hicimos en la figura 7, seleccione el `NORTHWINDConnectionString` en la lista desplegable lista y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-250">As we did back in Figure 7, select the `NORTHWINDConnectionString` from the drop-down list and click Next.</span></span> <span data-ttu-id="d1d92-251">En la pantalla de la instrucción Select de configurar, elija la especificar una instrucción SQL personalizada o un botón de opción de procedimiento almacenado y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="d1d92-251">In the Configure the Select Statement screen, choose the Specify a custom SQL statement or stored procedure radio button and click Next.</span></span> <span data-ttu-id="d1d92-252">Se abrirá la pantalla definir personalizado instrucciones o procedimientos almacenados, que ofrece pestañas con la etiqueta SELECT, UPDATE, INSERT y DELETE.</span><span class="sxs-lookup"><span data-stu-id="d1d92-252">This will bring up the Define Custom Statements or Stored Procedures screen, which offers tabs labeled SELECT, UPDATE, INSERT, and DELETE.</span></span> <span data-ttu-id="d1d92-253">En cada pestaña puede especificar una instrucción SQL personalizada en el cuadro de texto o elija un procedimiento almacenado en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="d1d92-253">In each tab you can enter a custom SQL statement into the textbox or choose a stored procedure from the drop-down list.</span></span> <span data-ttu-id="d1d92-254">En este tutorial, veremos si escribe una instrucción SQL personalizada; el tutorial siguiente incluye un ejemplo que utiliza un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="d1d92-254">In this tutorial we will look at entering a custom SQL statement; the next tutorial includes an example that uses a stored procedure.</span></span>


![Escriba una instrucción SQL personalizada o seleccionar un procedimiento almacenado](querying-data-with-the-sqldatasource-control-vb/_static/image19.gif)

<span data-ttu-id="d1d92-256">**Figura 13**: escriba una instrucción SQL personalizada o seleccionar un procedimiento almacenado</span><span class="sxs-lookup"><span data-stu-id="d1d92-256">**Figure 13**: Enter a Custom SQL Statement or Pick a Stored Procedure</span></span>


<span data-ttu-id="d1d92-257">La instrucción SQL personalizada puede introducirse manualmente en el cuadro de texto o se puede construir gráficamente haciendo clic en el botón Generador de consultas.</span><span class="sxs-lookup"><span data-stu-id="d1d92-257">The custom SQL statement can be entered by hand into the textbox or can be constructed graphically by clicking the Query Builder button.</span></span> <span data-ttu-id="d1d92-258">Desde el generador de consultas o en el cuadro de texto, utilice la siguiente consulta para devolver el `ProductID` y `ProductName` campos desde el `Products` tabla mediante una `JOIN` para recuperar el producto s `CategoryName` desde el `Categories` tabla:</span><span class="sxs-lookup"><span data-stu-id="d1d92-258">From either the Query Builder or the textbox, use the following query to return the `ProductID` and `ProductName` fields from the `Products` table using a `JOIN` to retrieve the product s `CategoryName` from the `Categories` table:</span></span>


[!code-sql[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample4.sql)]


![Puede gráficamente construir la consulta con el generador de consultas](querying-data-with-the-sqldatasource-control-vb/_static/image20.gif)

<span data-ttu-id="d1d92-260">**Figura 14**: puede crear gráficamente la consulta mediante el generador de consultas</span><span class="sxs-lookup"><span data-stu-id="d1d92-260">**Figure 14**: You can Graphically Construct the Query Using the Query Builder</span></span>


<span data-ttu-id="d1d92-261">Después de especificar la consulta, haga clic en siguiente para ir a la pantalla de consulta de prueba.</span><span class="sxs-lookup"><span data-stu-id="d1d92-261">After specifying the query, click Next to proceed to the Test Query screen.</span></span> <span data-ttu-id="d1d92-262">Haga clic en Finalizar para completar al Asistente SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="d1d92-262">Click Finish to complete the SqlDataSource wizard.</span></span>

<span data-ttu-id="d1d92-263">Después de completar el asistente, GridView tendrá tres BoundFields agregarle mostrar la `ProductID`, `ProductName`, y `CategoryName` columnas devueltos por la consulta y resultante en el marcado declarativo siguiente:</span><span class="sxs-lookup"><span data-stu-id="d1d92-263">After completing the wizard, the GridView will have three BoundFields added to it displaying the `ProductID`, `ProductName`, and `CategoryName` columns returned from the query and resulting in the following declarative markup:</span></span>


[!code-aspx[Main](querying-data-with-the-sqldatasource-control-vb/samples/sample5.aspx)]


<span data-ttu-id="d1d92-264">[![GridView muestra cada identificador de producto s, nombre de la categoría de nombre y, a continuación, asociados](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span><span class="sxs-lookup"><span data-stu-id="d1d92-264">[![The GridView Shows Each Product s ID, Name, and Associated Category Name](querying-data-with-the-sqldatasource-control-vb/_static/image22.gif)](querying-data-with-the-sqldatasource-control-vb/_static/image21.gif)</span></span>

<span data-ttu-id="d1d92-265">**Figura 15**: Id. de s The GridView muestra cada producto, nombre y nombre de la categoría asociada ([haga clic aquí para ver la imagen a tamaño completo](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span><span class="sxs-lookup"><span data-stu-id="d1d92-265">**Figure 15**: The GridView Shows Each Product s ID, Name, and Associated Category Name ([Click to view full-size image](querying-data-with-the-sqldatasource-control-vb/_static/image23.gif))</span></span>


## <a name="summary"></a><span data-ttu-id="d1d92-266">Resumen</span><span class="sxs-lookup"><span data-stu-id="d1d92-266">Summary</span></span>

<span data-ttu-id="d1d92-267">En este tutorial, hemos visto cómo consultar y mostrar los datos mediante el control SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="d1d92-267">In this tutorial we saw how to query and display data using the SqlDataSource control.</span></span> <span data-ttu-id="d1d92-268">Al igual que el ObjectDataSource SqlDataSource actúa como un proxy, lo que proporciona un enfoque declarativo para tener acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-268">Like the ObjectDataSource, the SqlDataSource serves as a proxy, providing a declarative approach to accessing data.</span></span> <span data-ttu-id="d1d92-269">Sus propiedades que especifican para conectarse a la base de datos y el código SQL `SELECT` para ejecutar una consulta; se pueden especificar a través de la ventana Propiedades o mediante el Asistente para configurar origen de datos.</span><span class="sxs-lookup"><span data-stu-id="d1d92-269">Its properties specify the database to connect to and the SQL `SELECT` query to execute; they can be specified through the Properties window or by using the Configure DataSource wizard.</span></span>

<span data-ttu-id="d1d92-270">El `SELECT` ejemplos de consultas se examinan en este tutorial devuelven todos los registros de la consulta especificada.</span><span class="sxs-lookup"><span data-stu-id="d1d92-270">The `SELECT` query examples we examined in this tutorial returned all of the records from the specified query.</span></span> <span data-ttu-id="d1d92-271">El control SqlDataSource, sin embargo, puede incluir un `WHERE` cláusula con parámetros cuyos valores se asignan mediante programación o se extraen automáticamente desde un origen especificado.</span><span class="sxs-lookup"><span data-stu-id="d1d92-271">The SqlDataSource control, however, can include a `WHERE` clause with parameters whose values are assigned programmatically or are automatically pulled from a specified source.</span></span> <span data-ttu-id="d1d92-272">Examinaremos cómo crear y utilizar consultas parametrizadas en el siguiente tutorial!</span><span class="sxs-lookup"><span data-stu-id="d1d92-272">We'll examine how to create and use parameterized queries in the next tutorial!</span></span>

<span data-ttu-id="d1d92-273">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="d1d92-273">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="d1d92-274">Información adicional</span><span class="sxs-lookup"><span data-stu-id="d1d92-274">Further Reading</span></span>

<span data-ttu-id="d1d92-275">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="d1d92-275">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d1d92-276">Acceso a los datos de la base de datos relacional</span><span class="sxs-lookup"><span data-stu-id="d1d92-276">Accessing Relational Database Data</span></span>](http://aspnet.4guysfromrolla.com/articles/022206-1.aspx)
- [<span data-ttu-id="d1d92-277">Información general del Control SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-277">SqlDataSource Control Overview</span></span>](https://msdn.microsoft.com/library/dz12d98w.aspx)
- [<span data-ttu-id="d1d92-278">Tutoriales de inicio rápido de ASP.NET: El Control SqlDataSource</span><span class="sxs-lookup"><span data-stu-id="d1d92-278">ASP.NET Quickstart Tutorials: The SqlDataSource Control</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/data/sqldatasource.aspx)
- [<span data-ttu-id="d1d92-279">El archivo Web.config `<connectionStrings>` elemento</span><span class="sxs-lookup"><span data-stu-id="d1d92-279">The Web.config `<connectionStrings>` Element</span></span>](https://msdn.microsoft.com/library/bf7sd233.aspx)
- [<span data-ttu-id="d1d92-280">Referencia de cadena de conexión de base de datos</span><span class="sxs-lookup"><span data-stu-id="d1d92-280">Database Connection String Reference</span></span>](http://www.connectionstrings.com/)

## <a name="about-the-author"></a><span data-ttu-id="d1d92-281">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="d1d92-281">About the Author</span></span>

<span data-ttu-id="d1d92-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="d1d92-282">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="d1d92-283">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="d1d92-283">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="d1d92-284">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="d1d92-284">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="d1d92-285">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="d1d92-285">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="d1d92-286">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="d1d92-286">Special Thanks To</span></span>

<span data-ttu-id="d1d92-287">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="d1d92-287">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="d1d92-288">Los revisores iniciales para este tutorial eran Susan Connery, Bernadette Leigh y David Suru.</span><span class="sxs-lookup"><span data-stu-id="d1d92-288">Lead reviewers for this tutorial were Susan Connery, Bernadette Leigh, and David Suru.</span></span> <span data-ttu-id="d1d92-289">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="d1d92-289">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="d1d92-290">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="d1d92-290">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="d1d92-291">[Anterior](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Siguiente](using-parameterized-queries-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d1d92-291">[Previous](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)
[Next](using-parameterized-queries-with-the-sqldatasource-vb.md)</span></span>
