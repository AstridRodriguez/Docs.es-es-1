---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: "Creación de una capa de acceso a datos (C#) | Documentos de Microsoft"
author: rick-anderson
description: "En este tutorial comenzaremos desde el principio y crear la capa de acceso de datos (DAL), que con los conjuntos de datos, para tener acceso a la información en una base de datos."
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/05/2010
ms.topic: article
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: c610f84cfb82f38f9c67b757aa341c7a1497369c
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="creating-a-data-access-layer-c"></a><span data-ttu-id="7eec3-103">Creación de una capa de acceso a datos (C#)</span><span class="sxs-lookup"><span data-stu-id="7eec3-103">Creating a Data Access Layer (C#)</span></span>
====================
<span data-ttu-id="7eec3-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7eec3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7eec3-105">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) o [descarga de PDF](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7eec3-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) or [Download PDF](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span></span>

> <span data-ttu-id="7eec3-106">En este tutorial comenzaremos desde el principio y crear la capa de acceso de datos (DAL), que con los conjuntos de datos, para tener acceso a la información en una base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="7eec3-107">Introducción</span><span class="sxs-lookup"><span data-stu-id="7eec3-107">Introduction</span></span>

<span data-ttu-id="7eec3-108">Como los desarrolladores web, nuestras vidas giran en torno a trabajar con datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="7eec3-109">Creamos las bases de datos para almacenar los datos, el código para recuperar y modificar la base de datos y páginas web para recopilar y resumirlos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="7eec3-110">Este es el primer tutorial de una serie larga que se explorará técnicas para implementar estos patrones comunes en ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="7eec3-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="7eec3-111">Comenzaremos con la creación de un [arquitectura de software](http://en.wikipedia.org/wiki/Software_architecture) compuesto de una capa de acceso de datos (DAL) con los conjuntos de datos de tipo, una capa de lógica empresarial (BLL) que aplica reglas de negocios y páginas de una capa de presentación que se compone de ASP.NET que compartir un diseño de página común.</span><span class="sxs-lookup"><span data-stu-id="7eec3-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="7eec3-112">Una vez que se ha diseñado este fundamento de back-end, se moverá en informes, que muestra cómo mostrar, resumir, recopilar y validar los datos desde una aplicación web.</span><span class="sxs-lookup"><span data-stu-id="7eec3-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="7eec3-113">Estos tutoriales están pensados para ser conciso y se proporcionan instrucciones paso a paso con una gran cantidad de capturas de pantalla para guiarle a través del proceso visualmente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="7eec3-114">Cada tutorial está disponible en versiones de Visual Basic y C# e incluye la descarga de código completo usado.</span><span class="sxs-lookup"><span data-stu-id="7eec3-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="7eec3-115">(Este primer tutorial es bastante larga, pero el resto se presentan en fragmentos por mucho más).</span><span class="sxs-lookup"><span data-stu-id="7eec3-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="7eec3-116">Para estos tutoriales usaremos una versión de Microsoft SQL Server 2005 Express Edition de la base de datos de Northwind que se coloca en el **aplicación\_datos** directory.</span><span class="sxs-lookup"><span data-stu-id="7eec3-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="7eec3-117">Además del archivo de base de datos, el **aplicación\_datos** carpeta también contiene los scripts SQL para crear la base de datos, en caso de que desea usar una versión diferente de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="7eec3-118">Estos scripts se también se pueden [descargan directamente desde Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), si lo prefiere.</span><span class="sxs-lookup"><span data-stu-id="7eec3-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="7eec3-119">Si usa una versión diferente de SQL Server de la base de datos Northwind, debe actualizar el **NORTHWNDConnectionString** configuración de la aplicación **Web.config** archivo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="7eec3-120">La aplicación web se creó con Visual Studio 2005 Professional Edition como un proyecto de sitio Web basado en el sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="7eec3-121">Sin embargo, todos los tutoriales funcione igual de bien con la versión gratuita de Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="7eec3-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="7eec3-122">En este tutorial comenzaremos desde el principio y crear la capa de acceso de datos (DAL), que seguido de creación de la capa de lógica empresarial (BLL) en el segundo tutorial y trabajar en el diseño de página y la navegación en el tercer argumento.</span><span class="sxs-lookup"><span data-stu-id="7eec3-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="7eec3-123">Los tutoriales después de la tercera uno se compilará en la base se disponen en los tres primeros.</span><span class="sxs-lookup"><span data-stu-id="7eec3-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="7eec3-124">Tenemos mucho para abarcarlas en este primer tutorial, por lo que desencadenará Visual Studio y Comencemos!</span><span class="sxs-lookup"><span data-stu-id="7eec3-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="7eec3-125">Paso 1: Crear un proyecto Web y conectarse a la base de datos</span><span class="sxs-lookup"><span data-stu-id="7eec3-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="7eec3-126">Antes de que podemos crear la capa de acceso a datos (DAL), primero es necesario crear un sitio web y configurar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="7eec3-127">Empiece por crear un nuevo sitio de web ASP.NET basada en sistema de archivos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="7eec3-128">Para ello, vaya al menú archivo y elija Nuevo sitio Web, mostrar el cuadro de diálogo nuevo sitio Web.</span><span class="sxs-lookup"><span data-stu-id="7eec3-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="7eec3-129">Elija la plantilla de sitio Web ASP.NET, o establecer la lista de la lista desplegable de ubicación al sistema de archivos, elija una carpeta para colocar el sitio web y establecer el idioma en C#.</span><span class="sxs-lookup"><span data-stu-id="7eec3-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="7eec3-130">[![Crear un nuevo archivo basado en sistema sitio Web](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="7eec3-131">**Figura 1**: crear un sitio Web de New File System-Based ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="7eec3-132">Esto creará un nuevo sitio web con un **Default.aspx** página ASP.NET y un **aplicación\_datos** carpeta.</span><span class="sxs-lookup"><span data-stu-id="7eec3-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="7eec3-133">Con el sitio web creado, el siguiente paso es agregar una referencia a la base de datos en el Explorador de servidores de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7eec3-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="7eec3-134">Mediante la adición de una base de datos en el Explorador de servidores puede agregar tablas, procedimientos almacenados, vistas y así sucesivamente todo desde dentro de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7eec3-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="7eec3-135">También puede ver los datos de la tabla o crear sus propias consultas a mano o gráficamente mediante el generador de consultas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="7eec3-136">Además, cuando se compilación los conjuntos de datos con tipo para la capa DAL necesitaremos a punto de Visual Studio a la base de datos desde el que se debe construir los conjuntos de datos con tipo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="7eec3-137">Mientras que podemos proporcionar esta información de conexión en ese momento, Visual Studio rellena automáticamente una lista desplegable de las bases de datos ya está registrado en el Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="7eec3-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="7eec3-138">Los pasos para agregar la base de datos Northwind en el Explorador de servidores dependen de si desea utilizar la base de datos de SQL Server 2005 Express Edition en el **aplicación\_datos** carpeta o si tiene un Microsoft SQL Server 2000 o 2005 configuración de servidor de bases de datos que desea usar en su lugar.</span><span class="sxs-lookup"><span data-stu-id="7eec3-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="7eec3-139">Usar una base de datos en theApp\_DataFolder</span><span class="sxs-lookup"><span data-stu-id="7eec3-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="7eec3-140">Si no tiene un servidor SQL Server 2000 o 2005 servidor de base de datos para conectarse a, o simplemente desea evitar tener que agregar la base de datos a un servidor de base de datos, puede usar la versión de SQL Server 2005 Express Edition de la base de datos de Northwind que se encuentra en la websit descargado e's **aplicación\_datos** carpeta (**NORTHWND. MDF**).</span><span class="sxs-lookup"><span data-stu-id="7eec3-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="7eec3-141">Una base de datos se coloca en el **aplicación\_datos** carpeta se agrega automáticamente en el Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="7eec3-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="7eec3-142">Debería ver un nodo denominado NORTHWND suponiendo que tenga instalados en su equipo SQL Server 2005 Express Edition. MDF en el Explorador de servidores, que se puede expandir y explorar sus tablas, vistas, procedimientos almacenados y así sucesivamente (consulte la figura 2).</span><span class="sxs-lookup"><span data-stu-id="7eec3-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="7eec3-143">El **aplicación\_datos** carpeta también puede contener Microsoft Access **.mdb** archivos, lo que, como sus homólogos de SQL Server, se agregan automáticamente en el Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="7eec3-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="7eec3-144">Si no desea utilizar cualquiera de las opciones de SQL Server, siempre puede [descargar una versión de Microsoft Access del archivo de base de datos de Northwind](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) y colocarlo en la **aplicación\_datos** directory.</span><span class="sxs-lookup"><span data-stu-id="7eec3-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="7eec3-145">Tenga en cuenta, sin embargo, que las bases de datos de Access tienen tantas características como SQL Server y no están diseñados para usarse en escenarios de sitio web.</span><span class="sxs-lookup"><span data-stu-id="7eec3-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="7eec3-146">Además, un par de los tutoriales de 35 + vaya a usar ciertas características de nivel de base de datos que no están compatible con el acceso.</span><span class="sxs-lookup"><span data-stu-id="7eec3-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="7eec3-147">Conectarse a la base de datos en un servidor de base de datos de Microsoft SQL Server 2000 o 2005</span><span class="sxs-lookup"><span data-stu-id="7eec3-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="7eec3-148">O bien, puede conectarse a una base de datos de Northwind instalada en un servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="7eec3-149">Si el servidor de base de datos ya no dispone de la base de datos de Northwind instalada, primero debe agregarse al servidor de base de datos mediante la ejecución de la secuencia de comandos de instalación que se incluye en la descarga de este tutorial o por [descargar la versión de SQL Server 2000 de Northwind scripts de instalación](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directamente desde el sitio web de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="7eec3-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="7eec3-150">Una vez que tenga instalada la base de datos, vaya al explorador de servidores en Visual Studio, haga doble clic en el nodo Conexiones de datos y elija Agregar conexión.</span><span class="sxs-lookup"><span data-stu-id="7eec3-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="7eec3-151">Si no ve el Explorador de servidores para que vaya a la vista / Explorador de servidores o llamadas Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="7eec3-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="7eec3-152">Se abrirá el cuadro de diálogo Agregar conexión, donde puede especificar el servidor al que conectarse, la información de autenticación y el nombre de base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="7eec3-153">Una vez que ha configurado la información de conexión de base de datos y hace clic en el botón Aceptar, se agregará como un nodo bajo el nodo Conexiones de datos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="7eec3-154">Puede expandir el nodo de base de datos para explorar sus tablas, vistas, procedimientos almacenados y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Agregar una conexión a la base de datos de su servidor de base de datos Northwind](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="7eec3-156">**Figura 2**: agregar una conexión a la base de datos de su servidor de base de datos Northwind</span><span class="sxs-lookup"><span data-stu-id="7eec3-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="7eec3-157">Paso 2: Crear la capa de acceso a datos</span><span class="sxs-lookup"><span data-stu-id="7eec3-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="7eec3-158">Cuando se trabaja con una opción de datos es incrustar la lógica específica de datos directamente en la capa de presentación (en una aplicación web, la marca de páginas ASP.NET de la capa de presentación).</span><span class="sxs-lookup"><span data-stu-id="7eec3-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="7eec3-159">Esto puede adoptar la forma de escribir código ADO.NET en la parte correspondiente al código de la página ASP.NET o usar el control SqlDataSource desde la parte de marcado.</span><span class="sxs-lookup"><span data-stu-id="7eec3-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="7eec3-160">En cualquier caso, este enfoque relaciona estrechamente la lógica de acceso a datos con el nivel de presentación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="7eec3-161">Sin embargo, es el enfoque recomendado separar la lógica de acceso a datos de la capa de presentación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="7eec3-162">Esta capa independiente se conoce como la capa de acceso a datos, la capa DAL para abreviar y normalmente se implementa como un proyecto de biblioteca de clases independiente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="7eec3-163">Las ventajas de esta arquitectura por niveles están bien documentadas (consulte la sección "Lecturas adicionales" al final de este tutorial para obtener información sobre las siguientes ventajas) y es el enfoque tomaremos de esta serie.</span><span class="sxs-lookup"><span data-stu-id="7eec3-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="7eec3-164">Todo el código que es específico del origen de datos subyacente como la creación de una conexión a la base de datos, emitir **seleccione**, **insertar**, **actualización**, y  **ELIMINAR** comandos y así sucesivamente deben encontrarse en la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="7eec3-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="7eec3-165">El nivel de presentación no debe contener todas las referencias a este código de acceso de datos, pero en su lugar, debe realizar llamadas en la capa DAL para las solicitudes de todos los datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="7eec3-166">Niveles de acceso a datos normalmente contienen métodos para tener acceso a la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="7eec3-167">Por ejemplo, tiene la base de datos Northwind, **productos** y **categorías** tablas que registran los productos para la venta y las categorías a la que pertenecen.</span><span class="sxs-lookup"><span data-stu-id="7eec3-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="7eec3-168">En nuestro DAL tenemos métodos como:</span><span class="sxs-lookup"><span data-stu-id="7eec3-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="7eec3-169">**GetCategories(),** que devolverá información sobre todas las categorías</span><span class="sxs-lookup"><span data-stu-id="7eec3-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="7eec3-170">**GetProducts()**, que devuelve información acerca de todos los productos</span><span class="sxs-lookup"><span data-stu-id="7eec3-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="7eec3-171">**GetProductsByCategoryID (*categoryID*)**, lo que devolverá todos los productos que pertenecen a una categoría específica</span><span class="sxs-lookup"><span data-stu-id="7eec3-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="7eec3-172">**GetProductByProductID (*productID*)**, que devolverá información sobre un producto determinado</span><span class="sxs-lookup"><span data-stu-id="7eec3-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="7eec3-173">Estos métodos, cuando se invoca, conéctese a la base de datos, emitir la consulta apropiada y devolver los resultados.</span><span class="sxs-lookup"><span data-stu-id="7eec3-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="7eec3-174">¿Cómo se devuelven estos resultados es importante.</span><span class="sxs-lookup"><span data-stu-id="7eec3-174">How we return these results is important.</span></span> <span data-ttu-id="7eec3-175">Estos métodos pudieron devolver simplemente un conjunto de datos o DataReader rellenado por la consulta de base de datos, pero lo ideal es que se deben devolver estos resultados usando *objetos fuertemente tipados*.</span><span class="sxs-lookup"><span data-stu-id="7eec3-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="7eec3-176">Un objeto fuertemente tipado es uno cuyo esquema se define estrictamente en tiempo de compilación, mientras que lo contrario, un objeto débilmente tipadas, es uno cuyo esquema no se conoce hasta el tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="7eec3-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="7eec3-177">Por ejemplo, el DataReader y el conjunto de datos (de forma predeterminada) son objetos de imprecisa puesto que su esquema se define mediante las columnas devueltas por la consulta de base de datos utilizada para rellenarlos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="7eec3-178">Para obtener acceso a una columna concreta de un objeto DataTable débilmente tipadas que debemos usar sintaxis similar a la:   ***DataTable*. Filas [*índice*] ["*columnName*"]**. La tabla de datos flexible escribiendo en este ejemplo se exhibe por el hecho de que es necesario obtener acceso al nombre de columna mediante una cadena o el índice ordinal. Un DataTable fuertemente tipado, por otro lado, tendrá cada una de sus columnas que se implementan como propiedades, lo que genera código similar:   ***DataTable*. Filas [*índice*].* columnName***.</span><span class="sxs-lookup"><span data-stu-id="7eec3-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: ***DataTable*.Rows[*index*]["*columnName*"]**. The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index. A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: ***DataTable*.Rows[*index*].*columnName***.</span></span>

<span data-ttu-id="7eec3-179">Para devolver objetos fuertemente tipados, los desarrolladores pueden crear sus propios objetos de negocios personalizada o usar conjuntos de datos con tipo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-179">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="7eec3-180">Un objeto de negocios se implementa con el desarrollador como representa una clase cuyas propiedades normalmente reflejan las columnas de la tabla de base de datos subyacente del objeto de negocios.</span><span class="sxs-lookup"><span data-stu-id="7eec3-180">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="7eec3-181">Un conjunto de datos con tipo es una clase generada automáticamente por Visual Studio basado en un esquema de base de datos y cuyos miembros son fuertemente tipada de acuerdo con este esquema.</span><span class="sxs-lookup"><span data-stu-id="7eec3-181">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="7eec3-182">El conjunto de datos con tipo propio consta de las clases que extienden las clases de conjunto de datos de ADO.NET y DataTable, DataRow.</span><span class="sxs-lookup"><span data-stu-id="7eec3-182">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="7eec3-183">Además de tablas de datos fuertemente tipados, conjuntos de datos con tipo ahora también incluyen TableAdapters, que son clases con métodos para rellenar tablas de datos del conjunto de datos y la propagación de modificaciones en las tablas de datos a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-183">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="7eec3-184">Para obtener más información sobre las ventajas y desventajas del uso de conjuntos de datos con tipo frente a objetos comerciales personalizados, consulte [diseñar componentes de nivel de datos y pasar datos a través de los niveles de](https://msdn.microsoft.com/en-us/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="7eec3-184">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/en-us/library/ms978496.aspx).</span></span>


<span data-ttu-id="7eec3-185">Vamos a usar conjuntos de datos fuertemente tipados para la arquitectura de estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="7eec3-185">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="7eec3-186">La figura 3 ilustra el flujo de trabajo entre los diferentes niveles de una aplicación que usa conjuntos de datos con tipo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-186">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="7eec3-187">[![Código de acceso de todos los datos es relegado a la capa DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-187">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="7eec3-188">**Figura 3**: código de acceso de todos los datos es relegado a la capa DAL ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-188">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="7eec3-189">Crear un conjunto de datos con tipo y el adaptador de tabla</span><span class="sxs-lookup"><span data-stu-id="7eec3-189">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="7eec3-190">Para empezar a crear la capa DAL, comenzamos agregando un DataSet con tipo al proyecto.</span><span class="sxs-lookup"><span data-stu-id="7eec3-190">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="7eec3-191">Para ello, haga doble clic en el nodo del proyecto en el Explorador de soluciones y elija Agregar un nuevo elemento.</span><span class="sxs-lookup"><span data-stu-id="7eec3-191">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="7eec3-192">Seleccione la opción de conjunto de datos en la lista de plantillas y asígnele el nombre **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-192">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="7eec3-193">[![Optar por agregar un nuevo conjunto de datos al proyecto](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-193">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="7eec3-194">**Figura 4**: optar por agregar un nuevo conjunto de datos a un proyecto ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-194">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="7eec3-195">Tras hacer clic en Agregar, cuando se le solicite para agregar el conjunto de datos a la **aplicación\_código** carpeta, elija Sí.</span><span class="sxs-lookup"><span data-stu-id="7eec3-195">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="7eec3-196">A continuación, se mostrará el diseñador para el conjunto de datos con tipo y se iniciará el Asistente para configuración de TableAdapter, lo que le permite agregar su primera TableAdapter al conjunto de datos con tipo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-196">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="7eec3-197">Un conjunto de datos con tipo actúa como una colección fuertemente tipada de datos; se compone de las instancias de DataTable fuertemente tipado, cada uno de los cuales a su vez se compone de instancias de DataRow fuertemente tipada.</span><span class="sxs-lookup"><span data-stu-id="7eec3-197">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="7eec3-198">Se creará una tabla de datos fuertemente tipados para cada una de las tablas de base de datos subyacentes que necesitamos para trabajar con en esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="7eec3-198">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="7eec3-199">Puede empezar con la creación de una tabla de datos para la **productos** tabla.</span><span class="sxs-lookup"><span data-stu-id="7eec3-199">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="7eec3-200">Tenga en cuenta que DataTables fuertemente tipada no incluyen toda la información sobre cómo tener acceso a datos de la tabla de base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-200">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="7eec3-201">Para recuperar los datos para rellenar la tabla de datos, usamos una clase TableAdapter, que funciona como la capa de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-201">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="7eec3-202">Para nuestro **productos** DataTable, lo TableAdapter contendrá los métodos **GetProducts()**,  **GetProductByCategoryID (*categoryID*)**, etc. que se podrá invocar desde la capa de presentación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-202">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="7eec3-203">Rol de la tabla de datos es para que actúe como el objetos fuertemente tipados que se usa para pasar datos entre las capas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-203">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="7eec3-204">El Asistente para configuración de TableAdapter comienza le pide que seleccione a qué base de datos para trabajar con.</span><span class="sxs-lookup"><span data-stu-id="7eec3-204">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="7eec3-205">La lista desplegable muestra las bases de datos en el Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="7eec3-205">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="7eec3-206">Si no se agregó la base de datos Northwind en el Explorador de servidores, puede hacer clic en el botón nueva conexión en este momento para hacerlo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-206">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="7eec3-207">[![Elija la base de datos Northwind en la lista desplegable](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-207">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="7eec3-208">**Figura 5**: elija la base de datos Northwind en la lista desplegable ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-208">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="7eec3-209">Después de seleccionar la base de datos y haga clic en siguiente, se le preguntará si desea guardar la cadena de conexión en el **Web.config** archivo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-209">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="7eec3-210">Si guarda la cadena de conexión que se evitará tener disco duro codificadas en las clases TableAdapter, que simplifica las cosas si cambia la información de cadena de conexión en el futuro.</span><span class="sxs-lookup"><span data-stu-id="7eec3-210">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="7eec3-211">Si decide para guardar la cadena de conexión en el archivo de configuración se coloca en el  **&lt;connectionStrings&gt;**  sección, que puede ser [opcionalmente cifrada](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) para mejorado seguridad o modificados más adelante a través de la nueva página de propiedades de ASP.NET 2.0 dentro de la herramienta de administración de GUI de IIS, que es más adecuada para los administradores.</span><span class="sxs-lookup"><span data-stu-id="7eec3-211">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="7eec3-212">[![Guardar la cadena de conexión en Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-212">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="7eec3-213">**Figura 6**: Guardar cadena de conexión en **Web.config** ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-213">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="7eec3-214">A continuación, necesitamos definir el esquema para la primera DataTable fuertemente tipadas y proporcionan el primer método para nuestro TableAdapter que se usará al rellenar el conjunto de datos fuertemente tipados.</span><span class="sxs-lookup"><span data-stu-id="7eec3-214">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="7eec3-215">Estos dos pasos se llevan a cabo simultáneamente mediante la creación de una consulta que devuelve las columnas de la tabla que queremos reflejadas en la tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-215">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="7eec3-216">Al final del asistente se asignará un nombre de método para esta consulta.</span><span class="sxs-lookup"><span data-stu-id="7eec3-216">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="7eec3-217">Una vez que se haya realizado antes, este método se puede invocar desde la capa de presentación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-217">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="7eec3-218">El método se ejecuta la consulta definida y rellenar un DataTable fuertemente tipada.</span><span class="sxs-lookup"><span data-stu-id="7eec3-218">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="7eec3-219">Para empezar a definir la consulta SQL se debemos indicar cómo se desea el TableAdapter que emitir la consulta.</span><span class="sxs-lookup"><span data-stu-id="7eec3-219">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="7eec3-220">Podemos utilizar una instrucción de SQL ad hoc, cree un nuevo procedimiento almacenado o utilizar un procedimiento almacenado existente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-220">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="7eec3-221">Para estos tutoriales, vamos a usar instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="7eec3-221">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="7eec3-222">Hacer referencia a [Brian Noyes](http://briannoyes.net/)del artículo, [crear una capa de acceso a datos con el Diseñador de DataSet de Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) para obtener un ejemplo del uso de procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="7eec3-222">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="7eec3-223">[![Consulta los datos mediante una instrucción de SQL Ad Hoc](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-223">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="7eec3-224">**Figura 7**: consultar los datos utilizando una instrucción de SQL Ad Hoc ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-224">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="7eec3-225">En este momento se podemos escribir en la consulta SQL manualmente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-225">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="7eec3-226">Al crear el primer método en TableAdapter normalmente desea que la consulta devuelva las columnas que deben expresarse en la tabla de datos correspondiente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-226">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="7eec3-227">Podemos lograr esto mediante la creación de una consulta que devuelve todas las columnas y todas las filas de la **productos** tabla:</span><span class="sxs-lookup"><span data-stu-id="7eec3-227">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="7eec3-228">[![Escriba la consulta SQL en el cuadro de texto](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-228">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="7eec3-229">**Figura 8**: escriba el SQL consulta en el cuadro de texto ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-229">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="7eec3-230">Como alternativa, utilice el generador de consultas y crear gráficamente la consulta, como se muestra en la figura 9.</span><span class="sxs-lookup"><span data-stu-id="7eec3-230">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="7eec3-231">[![Crear la consulta de forma gráfica, a través del Editor de consultas](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-231">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="7eec3-232">**Figura 9**: crear la consulta gráficamente, mediante el Editor de consultas ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-232">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="7eec3-233">Después de crear la consulta, pero antes de pasar a la siguiente pantalla, haga clic en el botón Opciones avanzadas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-233">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="7eec3-234">En los proyectos de sitio Web, "instrucciones generar Insert, Update y Delete" es la única opción seleccionada de forma predeterminada; avanzada Si ejecuta a este asistente desde una biblioteca de clases o un proyecto de Windows también se seleccionará la opción "Usar simultaneidad optimista".</span><span class="sxs-lookup"><span data-stu-id="7eec3-234">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="7eec3-235">Deje desactivada la opción "Usar simultaneidad optimista" por ahora.</span><span class="sxs-lookup"><span data-stu-id="7eec3-235">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="7eec3-236">Examinaremos simultaneidad optimista en tutoriales futuros.</span><span class="sxs-lookup"><span data-stu-id="7eec3-236">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="7eec3-237">[![Solo el generar Insert, Update y Delete instrucciones SELECT opción](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-237">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="7eec3-238">**Figura 10**: solo el generar Insert, Update y Delete instrucciones Select opción ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-238">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="7eec3-239">Después de comprobar las opciones avanzadas, haga clic en siguiente para ir a la última pantalla.</span><span class="sxs-lookup"><span data-stu-id="7eec3-239">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="7eec3-240">Aquí se nos pide que seleccione los métodos para agregar al objeto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-240">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="7eec3-241">Hay dos patrones para rellenar los datos:</span><span class="sxs-lookup"><span data-stu-id="7eec3-241">There are two patterns for populating data:</span></span>

- <span data-ttu-id="7eec3-242">**Rellenar un DataTable** con este enfoque se crea un método que toma una tabla de datos como parámetro y lo rellena basándose en los resultados de la consulta.</span><span class="sxs-lookup"><span data-stu-id="7eec3-242">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="7eec3-243">La clase DataAdapter de ADO.NET, por ejemplo, implemente este patrón con su **Fill()** método.</span><span class="sxs-lookup"><span data-stu-id="7eec3-243">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="7eec3-244">**Devolver un DataTable** con este enfoque el método crea y rellena la tabla de datos por usted y lo devuelve como valor devuelven de los métodos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-244">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="7eec3-245">Puede hacer que el objeto TableAdapter implemente uno o ambos de estos patrones.</span><span class="sxs-lookup"><span data-stu-id="7eec3-245">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="7eec3-246">También puede cambiar el nombre de los métodos que se muestran a continuación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-246">You can also rename the methods provided here.</span></span> <span data-ttu-id="7eec3-247">Vamos a deje ambas casillas de verificación está activados, aunque solo usaremos el último modelo a lo largo de estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="7eec3-247">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="7eec3-248">Además, vamos a cambiar el nombre en su lugar genérico **GetData** método **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-248">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="7eec3-249">Si se activa, crea la casilla de verificación final, "GenerateDBDirectMethods," **Insert()**, **Update()**, y **Delete()** métodos de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-249">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="7eec3-250">Si deja esta opción no está activada, todas las actualizaciones debe realizarse a través de exclusiva del TableAdapter **Update()** método, que toma en el conjunto de datos con tipo, una tabla de datos, una sola fila de datos o una matriz de objetos DataRow.</span><span class="sxs-lookup"><span data-stu-id="7eec3-250">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="7eec3-251">(Si ha desactivado el "generar Insert, Update y Delete instrucciones" opción de las propiedades avanzadas en la figura 9 esta casilla de verificación configuración no tendrá ningún efecto.) Vamos a dejar esta casilla activada.</span><span class="sxs-lookup"><span data-stu-id="7eec3-251">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="7eec3-252">[![Cambie el nombre de método GetData por GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-252">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="7eec3-253">**Figura 11**: cambiar el nombre del método de **GetData** a **GetProducts** ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-253">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="7eec3-254">Complete el asistente, haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="7eec3-254">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="7eec3-255">Después de que se cierre el asistente se estamos devuelto en el Diseñador de DataSet que se muestra en la tabla de datos que acabamos de crear.</span><span class="sxs-lookup"><span data-stu-id="7eec3-255">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="7eec3-256">Puede ver la lista de columnas en la **productos** DataTable (**ProductID**, **ProductName**, etc.), así como los métodos de la  **ProductsTableAdapter** (**Fill()** y **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="7eec3-256">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="7eec3-257">[![La tabla de datos de productos y ProductsTableAdapter se agregaron al conjunto de datos con tipo](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-257">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="7eec3-258">**Figura 12**: el **productos** DataTable y **ProductsTableAdapter** se ha agregado al conjunto de datos con tipo ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-258">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="7eec3-259">En este momento tenemos un conjunto de datos con tipo con una sola tabla de datos (**Northwind.Products**) y una clase fuertemente tipada de DataAdapter (**NorthwindTableAdapters.ProductsTableAdapter**) con un  **GetProducts()** método.</span><span class="sxs-lookup"><span data-stu-id="7eec3-259">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="7eec3-260">Estos objetos se pueden usar para tener acceso a una lista de todos los productos desde código como:</span><span class="sxs-lookup"><span data-stu-id="7eec3-260">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="7eec3-261">Este código no era necesario que escribir un bit de código de acceso específico de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-261">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="7eec3-262">No se tenía que crear instancias de las clases ADO.NET, no tiene que hacer referencia a las cadenas de conexión, las consultas SQL, o procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="7eec3-262">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="7eec3-263">En su lugar, lo TableAdapter proporciona el código de acceso a datos de bajo nivel para nosotros.</span><span class="sxs-lookup"><span data-stu-id="7eec3-263">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="7eec3-264">Cada objeto que se usa en este ejemplo también está fuertemente tipado, lo que permite a Visual Studio proporcionar IntelliSense y la comprobación de tipos en tiempo de compilación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-264">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="7eec3-265">Y mejor de DataTables devueltas por el objeto TableAdapter se puede enlazar a datos ASP.NET controles Web, como GridView, DetailsView, DropDownList, CheckBoxList y algunas de las.</span><span class="sxs-lookup"><span data-stu-id="7eec3-265">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="7eec3-266">En el ejemplo siguiente se muestra el enlace el DataTable devuelto por la **GetProducts()** método a un control GridView en solo un exploraciones tres líneas de código dentro de la **página\_carga** controlador de eventos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-266">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="7eec3-267">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="7eec3-267">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="7eec3-268">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="7eec3-268">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="7eec3-269">[![Se muestra la lista de productos en un control GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-269">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="7eec3-270">**Figura 13**: se muestra la lista de productos en un GridView ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-270">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="7eec3-271">Si bien en este ejemplo es necesario que escribimos tres líneas de código en nuestra página de ASP.NET **página\_carga** controlador de eventos, en el futuro tutoriales examinaremos cómo usar el ObjectDataSource mediante declaración recuperar los datos desde el DAL.</span><span class="sxs-lookup"><span data-stu-id="7eec3-271">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="7eec3-272">Con el ObjectDataSource no se tendrá que escribir ningún código y obtendrá compatibilidad de paginación y ordenación así!</span><span class="sxs-lookup"><span data-stu-id="7eec3-272">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="7eec3-273">Paso 3: Agregar parámetros de métodos para la capa de acceso a datos</span><span class="sxs-lookup"><span data-stu-id="7eec3-273">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="7eec3-274">En este momento nuestro **ProductsTableAdapter** clase tiene pero un método, **GetProducts()**, que devuelve todos los productos de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-274">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="7eec3-275">Mientras que la capacidad para trabajar con todos los productos es muy útiles, hay ocasiones cuando es conveniente para recuperar información sobre un producto específico o todos los productos que pertenecen a una categoría determinada.</span><span class="sxs-lookup"><span data-stu-id="7eec3-275">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="7eec3-276">Para agregar esta funcionalidad a la capa de acceso a datos podemos agregar métodos con parámetros al objeto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-276">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="7eec3-277">Vamos a agregar la  **GetProductsByCategoryID (*categoryID*)** método.</span><span class="sxs-lookup"><span data-stu-id="7eec3-277">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="7eec3-278">Para agregar un nuevo método a la capa DAL, vuelva al diseñador de DataSet, pulse el botón derecho en el **ProductsTableAdapter** sección y elija Agregar consulta.</span><span class="sxs-lookup"><span data-stu-id="7eec3-278">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![Haga doble clic en el objeto TableAdapter y elija Agregar consulta](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="7eec3-280">**Figura 14**: haga doble clic en el objeto TableAdapter y elija Agregar consulta</span><span class="sxs-lookup"><span data-stu-id="7eec3-280">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="7eec3-281">En primer lugar, se nos pide sobre si desea tener acceso a la base de datos mediante una instrucción de SQL "ad-hoc" o un procedimiento almacenado nuevo o existente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-281">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="7eec3-282">Vamos a optar por usar una instrucción de SQL ad hoc nuevo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-282">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="7eec3-283">A continuación, se nos pide qué tipo de consulta SQL le gustaría utilizar.</span><span class="sxs-lookup"><span data-stu-id="7eec3-283">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="7eec3-284">Puesto que deseamos devolver todos los productos que pertenecen a una determinada categoría, desea escribir un **seleccione** instrucción que devuelve filas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-284">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="7eec3-285">[![Elija crear una instrucción SELECT que devuelve filas](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-285">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="7eec3-286">**Figura 15**: optar por crear un **seleccione** que devuelve filas del informe de ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-286">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="7eec3-287">El paso siguiente es definir la consulta SQL utilizada para tener acceso a los datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-287">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="7eec3-288">Puesto que deseamos devolver solo los productos que pertenecen a una categoría determinada, usar el mismo **seleccione** instrucción desde **GetProducts()**, pero agregue el siguiente **donde** cláusula: **donde CategoryID = @CategoryID** .</span><span class="sxs-lookup"><span data-stu-id="7eec3-288">Since we want to return only those products that belong to a particular category, I use the same **SELECT** statement from **GetProducts()**, but add the following **WHERE** clause: **WHERE CategoryID = @CategoryID**.</span></span> <span data-ttu-id="7eec3-289">El  **@CategoryID**  parámetro indica el Asistente de TableAdapter para que el método estamos creando requerirá un parámetro de entrada del tipo correspondiente (es decir, un entero que acepta valores NULL).</span><span class="sxs-lookup"><span data-stu-id="7eec3-289">The **@CategoryID** parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="7eec3-290">[![Escribir una consulta para devolver sólo los productos para una categoría específica](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-290">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="7eec3-291">**Figura 16**: escriba una consulta para devolver sólo los productos de una categoría especificada ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-291">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="7eec3-292">En el paso final podemos elegir que patrones a usar, así como personalizar los nombres de los métodos generados de acceso a datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-292">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="7eec3-293">Para la trama de relleno, vamos a cambiar el nombre a **FillByCategoryID** y para la devolución de un objeto DataTable retorno patrón (el  **obtener*X*** métodos), vamos a usar  **GetProductsByCategoryID**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-293">For the Fill pattern, let's change the name to **FillByCategoryID** and for the return a DataTable return pattern (the **Get*X*** methods), let's use **GetProductsByCategoryID**.</span></span>


<span data-ttu-id="7eec3-294">[![Elija los nombres de los métodos de TableAdapter](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-294">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="7eec3-295">**Figura 17**: elija los nombres de los métodos de TableAdapter ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-295">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="7eec3-296">Después de completar al asistente, el Diseñador de DataSet incluye los nuevos métodos de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-296">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Los productos ahora pueden ser consultadas por categoría](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="7eec3-298">**Figura 18**: The el productos puede ahora ser consultadas por categoría</span><span class="sxs-lookup"><span data-stu-id="7eec3-298">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="7eec3-299">Tómese un momento para agregar una  **GetProductByProductID (*productID*)** método utilizando la misma técnica.</span><span class="sxs-lookup"><span data-stu-id="7eec3-299">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="7eec3-300">Estas consultas con parámetros se pueden probar directamente desde el Diseñador de DataSet.</span><span class="sxs-lookup"><span data-stu-id="7eec3-300">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="7eec3-301">Haga doble clic en el método de TableAdapter y elija la vista previa de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-301">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="7eec3-302">A continuación, escriba los valores para usar con los parámetros y haga clic en vista previa.</span><span class="sxs-lookup"><span data-stu-id="7eec3-302">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="7eec3-303">[![Se muestran la pertenencia de esos productos a la categoría de bebidas](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-303">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="7eec3-304">**Figura 19**: se muestran los productos que pertenecen a la categoría bebidas ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-304">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="7eec3-305">Con el  **GetProductsByCategoryID (*categoryID*)** método en la capa DAL, ahora podemos crear una página ASP.NET que muestra solo los productos para una categoría específica.</span><span class="sxs-lookup"><span data-stu-id="7eec3-305">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="7eec3-306">El ejemplo siguiente muestra todos los productos que están en la categoría Bebidas, que tienen un **CategoryID** de 1.</span><span class="sxs-lookup"><span data-stu-id="7eec3-306">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="7eec3-307">Beverages.ASP</span><span class="sxs-lookup"><span data-stu-id="7eec3-307">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="7eec3-308">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="7eec3-308">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="7eec3-309">[![Se muestran los productos de la categoría Bebidas](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-309">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="7eec3-310">**Figura 20**: se muestran los productos de la categoría bebidas ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-310">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="7eec3-311">Paso 4: Insertar, actualizar y eliminar datos</span><span class="sxs-lookup"><span data-stu-id="7eec3-311">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="7eec3-312">Hay dos patrones que se usa habitualmente para insertar, actualizar y eliminar datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-312">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="7eec3-313">El primer patrón, que a la que llamaré el patrón directa de la base de datos, implica la creación de métodos que, cuando se invoca, problema una **insertar**, **actualización**, o **eliminar** comando a la base de datos que funciona en un registro único de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-313">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="7eec3-314">Estos métodos se pasan normalmente en una serie de valores escalares (enteros, cadenas, valores booleanos, fechas y horas y así sucesivamente) que corresponden a los valores para insertar, actualizar o eliminar.</span><span class="sxs-lookup"><span data-stu-id="7eec3-314">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="7eec3-315">Por ejemplo, con este patrón para el **productos** tabla el método delete tardaría en un parámetro de número entero que indica la **ProductID** del registro que desea eliminar, mientras que el método de inserción se tardaría un la cadena para la **ProductName**, un decimal para la **UnitPrice**, un entero para la **UnitsOnStock**, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-315">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="7eec3-316">[![Cada Insert, Update y Delete de solicitud se envían a la base de datos inmediatamente](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-316">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="7eec3-317">**Figura 21**: cada inserción, actualización y eliminar solicitud se envía a la base de datos inmediatamente ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-317">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="7eec3-318">El otro modelo, que hará referencia como el lote de actualizaciones de patrón, consiste en actualizar un DataSet, DataTable o colección de filas de datos en una llamada al método completo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-318">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="7eec3-319">Con este patrón de un desarrollador elimina, inserta, modifica las filas de datos en una tabla de datos y, a continuación, pasa esos objetos DataRow o DataTable a un método de actualización.</span><span class="sxs-lookup"><span data-stu-id="7eec3-319">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="7eec3-320">Este método, a continuación, enumera las filas de datos pasado, determina si o no ha se ha modificado, agregados o eliminar (a través de la DataRow [propiedad RowState](https://msdn.microsoft.com/en-us/library/system.data.datarow.rowstate.aspx) valor) y emite la solicitud de base de datos adecuada para cada registro.</span><span class="sxs-lookup"><span data-stu-id="7eec3-320">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/en-us/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="7eec3-321">[![Todos los cambios se sincronizan con la base de datos cuando se invoca el método de actualización](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-321">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="7eec3-322">**Figura 22**: todos los cambios se sincronizan con la base de datos cuando se invoca el método de actualización ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-322">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="7eec3-323">TableAdapter utiliza el patrón de actualización por lotes de forma predeterminada, pero también admite el patrón directa de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-323">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="7eec3-324">Puesto que hemos seleccionado la opción "generar Insert, Update y Delete instrucciones" desde las propiedades avanzadas al crear nuestra TableAdapter, el **ProductsTableAdapter** contiene un **Update()** (método), que implementa el patrón de actualización por lotes.</span><span class="sxs-lookup"><span data-stu-id="7eec3-324">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="7eec3-325">En concreto, lo TableAdapter contiene un **Update()** método que se puede pasar el conjunto de datos con tipo, una tabla de datos fuertemente tipados o uno o más filas de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-325">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="7eec3-326">Si deja activa la casilla de "GenerateDBDirectMethods" al crear por primera vez el objeto TableAdapter el patrón directa de la base de datos también se implementará a través de **Insert()**, **Update()**, y **Delete()**  métodos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-326">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="7eec3-327">Ambos patrones de modificación de datos utiliza el TableAdapter **InsertCommand**, **UpdateCommand**, y **DeleteCommand** propiedades para emitir sus **insertar** , **Actualización**, y **eliminar** comandos para la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-327">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="7eec3-328">Puede inspeccionar y modificar el **InsertCommand**, **UpdateCommand**, y **DeleteCommand** propiedades haciendo clic en el objeto TableAdapter en el Diseñador de DataSet y, a continuación, pasar en la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="7eec3-328">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="7eec3-329">(Asegúrese de que ha seleccionado el TableAdapter y que la **ProductsTableAdapter** objeto está seleccionado en la lista desplegable en la ventana Propiedades.)</span><span class="sxs-lookup"><span data-stu-id="7eec3-329">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="7eec3-330">[![El objeto TableAdapter tiene InsertCommand, UpdateCommand y DeleteCommand propiedades](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-330">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="7eec3-331">**Figura 23**: tiene el TableAdapter **InsertCommand**, **UpdateCommand**, y **DeleteCommand** propiedades ([haga clic aquí para ver imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-331">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="7eec3-332">Para examinar o modificar cualquiera de estas propiedades de comando de base de datos, haga clic en el **CommandText** subpropiedad, que abrirá el generador de consultas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-332">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="7eec3-333">[![Configurar la INSERCIÓN, actualización y las instrucciones DELETE en el generador de consultas](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-333">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="7eec3-334">**Figura 24**: configurar la **insertar**, **actualización**, y **eliminar** las instrucciones en el generador de consultas ([haga clic aquí para ver la imagen a tamaño completo ](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-334">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="7eec3-335">En el ejemplo de código siguiente se muestra cómo usar el patrón de actualización por lotes para doblar el precio de todos los productos que no están suspendidos y que tienen 25 unidades en existencias o menos:</span><span class="sxs-lookup"><span data-stu-id="7eec3-335">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="7eec3-336">El código siguiente muestra cómo usar el patrón directa de base de datos para eliminar un producto determinado mediante programación, a continuación, actualizar uno y, a continuación, agregue una nueva:</span><span class="sxs-lookup"><span data-stu-id="7eec3-336">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="7eec3-337">Insert, Update y Delete métodos de creación personalizados</span><span class="sxs-lookup"><span data-stu-id="7eec3-337">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="7eec3-338">El **Insert()**, **Update()**, y **Delete()** métodos creados por el método directo de la base de datos pueden ser un poco complicadas, especialmente para las tablas con muchas columnas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-338">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="7eec3-339">Buscar en el ejemplo de código anterior, sin IntelliSense ayuda no está especialmente claro qué **productos** columna de tabla se asigna a cada parámetro de entrada para el **Update()** y **Insert()**  métodos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-339">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="7eec3-340">Puede darse cuando solo desea actualizar una única columna o dos, o desea un personalizada **Insert()** método que, probablemente, devuelve el valor del registro recién insertado **identidad** (incremento automático) campo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-340">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="7eec3-341">Para crear un método personalizado de este tipo, vuelva al diseñador de DataSet.</span><span class="sxs-lookup"><span data-stu-id="7eec3-341">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="7eec3-342">Haga doble clic en el objeto TableAdapter y elija Agregar consulta devolver para el Asistente de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-342">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="7eec3-343">En la segunda pantalla podemos indicar el tipo de consulta para crear.</span><span class="sxs-lookup"><span data-stu-id="7eec3-343">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="7eec3-344">Vamos a crear un método que agrega un nuevo producto y, a continuación, devuelve el valor de la entrada recién agregado **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-344">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="7eec3-345">Por lo tanto, optar por crear un **insertar** consulta.</span><span class="sxs-lookup"><span data-stu-id="7eec3-345">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="7eec3-346">[![Cree un método para agregar una nueva fila a la tabla Products](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-346">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="7eec3-347">**Figura 25**: crear un método para agregar una fila nueva a la **productos** tabla ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-347">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="7eec3-348">En la siguiente pantalla del **InsertCommand**del **CommandText** aparece.</span><span class="sxs-lookup"><span data-stu-id="7eec3-348">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="7eec3-349">Aumentar esta consulta agregando **seleccionar ámbito\_IDENTITY()** al final de la consulta, que devolverá el último valor de identidad insertado en un **identidad** columna en el mismo ámbito.</span><span class="sxs-lookup"><span data-stu-id="7eec3-349">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="7eec3-350">(Consulte la [documentación técnica](https://msdn.microsoft.com/en-us/library/ms190315.aspx) para obtener más información acerca de **ámbito\_IDENTITY()** y por qué probable que desee [utilizar ámbito\_IDENTITY() en lugar de @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Asegúrese de que finalice la **insertar** instrucción con un punto y coma antes de agregar el **seleccione** instrucción.</span><span class="sxs-lookup"><span data-stu-id="7eec3-350">(See the [technical documentation](https://msdn.microsoft.com/en-us/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="7eec3-351">[![Aumentar la consulta para devolver el valor de SCOPE_IDENTITY)](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-351">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="7eec3-352">**Ilustración 26**: aumentar la consulta para devolver el **ámbito\_IDENTITY()** valor ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-352">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="7eec3-353">Por último, llame al método nuevo **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-353">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="7eec3-354">[![Establece el nombre del nuevo método en InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-354">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="7eec3-355">**Figura 27**: establece el nombre del nuevo método en **InsertProduct** ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-355">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="7eec3-356">Cuando vuelva al diseñador de DataSet, verá que el **ProductsTableAdapter** contiene un nuevo método, **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-356">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="7eec3-357">Si este método nuevo no tiene un parámetro para cada columna de la **productos** tabla, lo más probable es que se haya olvidado de finalizar la **insertar** instrucción con un punto y coma.</span><span class="sxs-lookup"><span data-stu-id="7eec3-357">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="7eec3-358">Configurar la **InsertProduct** método y tiene un punto y coma delimita el **insertar** y **seleccione** instrucciones.</span><span class="sxs-lookup"><span data-stu-id="7eec3-358">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="7eec3-359">De forma predeterminada, inserte el problema no es de consulta métodos, lo que significa que devuelven el número de filas afectadas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-359">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="7eec3-360">Sin embargo, deseamos la **InsertProduct** método para devolver el valor devuelto por la consulta, no el número de filas afectadas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-360">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="7eec3-361">Para lograr esto, ajustar el **InsertProduct** del método **ExecuteMode** propiedad **escalar**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-361">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="7eec3-362">[![Cambie la propiedad ExecuteMode a escalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-362">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="7eec3-363">**Figura 28**: cambiar la **ExecuteMode** propiedad **escalar** ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-363">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="7eec3-364">El código siguiente muestra esta nueva **InsertProduct** método en acción:</span><span class="sxs-lookup"><span data-stu-id="7eec3-364">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="7eec3-365">Paso 5: Completar la capa de acceso a datos</span><span class="sxs-lookup"><span data-stu-id="7eec3-365">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="7eec3-366">Tenga en cuenta que la **ProductsTableAdapters** clase devuelve el **CategoryID** y **SupplierID** los valores de la **productos** tabla, pero no incluye el **CategoryName** columna desde la **categorías** tabla o la **CompanyName** columna desde la **proveedores**tabla, aunque probablemente se trata las columnas que desea mostrar al mostrar información del producto.</span><span class="sxs-lookup"><span data-stu-id="7eec3-366">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="7eec3-367">Se puede aumentar el método del TableAdapter inicial, **GetProducts()**, debe incluir tanto el **CategoryName** y **CompanyName** valores de columna, que actualizarán el DataTable fuertemente tipado para incluir estas nuevas columnas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-367">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="7eec3-368">Esto puede suponer un problema, sin embargo, como los métodos del TableAdapter para insertar, actualizar, y eliminar datos se basan en este método inicial.</span><span class="sxs-lookup"><span data-stu-id="7eec3-368">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="7eec3-369">Afortunadamente, los métodos generados automáticamente para insertar, actualizar y eliminar no están afectadas por subconsultas en la **seleccione** cláusula.</span><span class="sxs-lookup"><span data-stu-id="7eec3-369">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="7eec3-370">Por teniendo cuidado para agregar nuestro consultas a **categorías** y **proveedores** como subconsultas, en lugar de **UNIR** s, se evitará tener que rehacer estos métodos para modificar los datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-370">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="7eec3-371">Haga doble clic en el **GetProducts()** método en el **ProductsTableAdapter** y elija Configurar.</span><span class="sxs-lookup"><span data-stu-id="7eec3-371">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="7eec3-372">A continuación, ajustar el **seleccione** cláusula para que se asemeje al igual que:</span><span class="sxs-lookup"><span data-stu-id="7eec3-372">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="7eec3-373">[![Actualización de la instrucción SELECT para el método GetProducts()](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-373">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="7eec3-374">**Figura 29**: actualización de la **seleccione** instrucción para el **GetProducts()** (método) ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-374">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="7eec3-375">Después de actualizar el **GetProducts()** método que desea utilizar esta nueva consulta la tabla de datos incluirá dos nuevas columnas: **CategoryName** y **NombreProveedor**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-375">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![La tabla de datos de productos tiene dos nuevas columnas](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="7eec3-377">**Figura 30**: el **productos** DataTable tiene dos nuevas columnas</span><span class="sxs-lookup"><span data-stu-id="7eec3-377">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="7eec3-378">Tómese un momento para actualizar la **seleccione** cláusula en la  **GetProductsByCategoryID (*categoryID*)** método así.</span><span class="sxs-lookup"><span data-stu-id="7eec3-378">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="7eec3-379">Si actualiza el **GetProducts()** **seleccione** con **UNIR** sintaxis el Diseñador de DataSet no podrán generar automáticamente los métodos para insertar, actualizar y eliminar base de datos usando el patrón directa de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-379">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="7eec3-380">En su lugar, tendrá que crearlas manualmente mucho al igual que hicimos con la **InsertProduct** método anteriormente en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="7eec3-380">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="7eec3-381">Además, manualmente tendrá que proporcionar el **InsertCommand**, **UpdateCommand**, y **DeleteCommand** si desea usar el lote de patrón de la actualización de los valores de propiedad.</span><span class="sxs-lookup"><span data-stu-id="7eec3-381">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="7eec3-382">Agregar los TableAdapters restantes</span><span class="sxs-lookup"><span data-stu-id="7eec3-382">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="7eec3-383">Hasta ahora, hemos visto solo al trabajar con un TableAdapter único para una tabla de base de datos único.</span><span class="sxs-lookup"><span data-stu-id="7eec3-383">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="7eec3-384">Sin embargo, la base de datos de Northwind contiene varias tablas relacionadas que se necesitará para trabajar con en nuestra aplicación web.</span><span class="sxs-lookup"><span data-stu-id="7eec3-384">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="7eec3-385">Un conjunto de datos con tipo puede contener varios relacionados con tablas de datos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-385">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="7eec3-386">Por lo tanto, para completar nuestro DAL que necesitamos agregar tablas de datos para las demás tablas que se usarán en estos tutoriales.</span><span class="sxs-lookup"><span data-stu-id="7eec3-386">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="7eec3-387">Para agregar un nuevo TableAdapter a un conjunto de datos con tipo, abra el Diseñador de DataSet, pulse el botón derecho en el diseñador y seleccione Agregar / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-387">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="7eec3-388">Esto creará una nueva tabla de datos y TableAdapter y le guían a través del asistente, examinamos anteriormente en este tutorial.</span><span class="sxs-lookup"><span data-stu-id="7eec3-388">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="7eec3-389">Tardar unos minutos para crear los siguientes métodos con las consultas siguientes y los TableAdapters.</span><span class="sxs-lookup"><span data-stu-id="7eec3-389">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="7eec3-390">Tenga en cuenta que las consultas en el **ProductsTableAdapter** incluyen las subconsultas para obtener los nombres de categoría y el proveedor de cada producto.</span><span class="sxs-lookup"><span data-stu-id="7eec3-390">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="7eec3-391">Además, si nos han estado siguiendo, ya ha agregado el **ProductsTableAdapter** la clase **GetProducts()** y  **GetProductsByCategoryID (*categoryID*)** métodos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-391">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="7eec3-392">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="7eec3-392">**ProductsTableAdapter**</span></span>

    - <span data-ttu-id="7eec3-393">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-393">**GetProducts**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
    - <span data-ttu-id="7eec3-394">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-394">**GetProductsByCategoryID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
    - <span data-ttu-id="7eec3-395">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-395">**GetProductsBySupplierID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
    - <span data-ttu-id="7eec3-396">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-396">**GetProductByProductID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="7eec3-397">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="7eec3-397">**CategoriesTableAdapter**</span></span>

    - <span data-ttu-id="7eec3-398">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-398">**GetCategories**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
    - <span data-ttu-id="7eec3-399">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-399">**GetCategoryByCategoryID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="7eec3-400">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="7eec3-400">**SuppliersTableAdapter**</span></span>

    - <span data-ttu-id="7eec3-401">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-401">**GetSuppliers**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
    - <span data-ttu-id="7eec3-402">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-402">**GetSuppliersByCountry**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
    - <span data-ttu-id="7eec3-403">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-403">**GetSupplierBySupplierID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="7eec3-404">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="7eec3-404">**EmployeesTableAdapter**</span></span>

    - <span data-ttu-id="7eec3-405">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-405">**GetEmployees**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
    - <span data-ttu-id="7eec3-406">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-406">**GetEmployeesByManager**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
    - <span data-ttu-id="7eec3-407">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="7eec3-407">**GetEmployeeByEmployeeID**:</span></span> 

        [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="7eec3-408">[![El Diseñador de DataSet después de haber agregado los cuatro TableAdapters](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-408">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="7eec3-409">**Figura 31**: el conjunto de datos diseñador después de los cuatro TableAdapters se han agregado ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-409">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="7eec3-410">Agregar código personalizado a la capa DAL</span><span class="sxs-lookup"><span data-stu-id="7eec3-410">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="7eec3-411">Los TableAdapters y las DataTables que agrega al conjunto de datos con tipo se expresan como un archivo de definición de esquemas XML (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="7eec3-411">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="7eec3-412">Puede ver esta información de esquema con el botón secundario en el **Northwind.xsd** un archivo en el Explorador de soluciones y elija Ver código.</span><span class="sxs-lookup"><span data-stu-id="7eec3-412">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="7eec3-413">[![El archivo de definición (XSD) del esquema XML para el Northwinds escribió el conjunto de datos](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-413">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="7eec3-414">**Figura 32**: archivo de la definición de esquemas de XML (XSD) para el conjunto de datos con tipo de Northwinds ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-414">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="7eec3-415">Esta información de esquema se convierte en código C# o Visual Basic en tiempo de diseño cuando se compila o en tiempo de ejecución (si es necesario), punto en el que puede ir a través de él con el depurador.</span><span class="sxs-lookup"><span data-stu-id="7eec3-415">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="7eec3-416">Para ver el código generado automáticamente Bajar en la vista de clases y la obtención de detalles a las clases TableAdapter o conjunto de datos con tipo.</span><span class="sxs-lookup"><span data-stu-id="7eec3-416">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="7eec3-417">Si no ve la vista de clases en la pantalla, vaya al menú Ver y seleccione desde allí o Ctrl + Mayús + C de llamadas.</span><span class="sxs-lookup"><span data-stu-id="7eec3-417">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="7eec3-418">Desde la vista de clases puede ver las propiedades, métodos y eventos de las clases de conjunto de datos con tipo y un TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="7eec3-418">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="7eec3-419">Para ver el código para un método concreto, haga doble clic en el nombre del método en la vista de clases o doble clic en él y elija Ir a definición.</span><span class="sxs-lookup"><span data-stu-id="7eec3-419">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Inspeccionar el código generado automáticamente, seleccione Ir a definición de la vista de clases](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="7eec3-421">**Figura 33**: inspeccionar el código generado automáticamente, seleccione Ir a definición de la vista de clases</span><span class="sxs-lookup"><span data-stu-id="7eec3-421">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="7eec3-422">Mientras que el código generado automáticamente puede ser un gran ahorro de tiempo, el código suele ser muy genérico y debe personalizarse para satisfacer las necesidades específicas de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-422">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="7eec3-423">El riesgo de extender el código generado automáticamente, sin embargo, es que la herramienta que generó el código podría decidir es el momento "regenerar" y sobrescribir las personalizaciones.</span><span class="sxs-lookup"><span data-stu-id="7eec3-423">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="7eec3-424">Con el nuevo concepto de clase parcial de .NET 2.0, es fácil dividir una clase en varios archivos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-424">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="7eec3-425">Esto nos permite agregar nuestra propia métodos, propiedades y eventos para las clases generadas automáticamente sin tener que preocuparse sobre Visual Studio sobrescribiendo nuestro personalizaciones.</span><span class="sxs-lookup"><span data-stu-id="7eec3-425">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="7eec3-426">Para mostrar cómo se personaliza la capa DAL, vamos a agregar un **GetProducts()** método a la **SuppliersRow** clase.</span><span class="sxs-lookup"><span data-stu-id="7eec3-426">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="7eec3-427">El **SuppliersRow** clase representa un único registro en el **proveedores** tabla; cada proveedor de proveedor puede cero a muchos productos, por lo que **GetProducts()** los devolverá productos del proveedor especificado.</span><span class="sxs-lookup"><span data-stu-id="7eec3-427">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="7eec3-428">Para lograr esto crea un nuevo archivo de clase en el **aplicación\_código** carpeta denominada **SuppliersRow.cs** y agregue el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="7eec3-428">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="7eec3-429">Esta clase parcial indica al compilador que, cuando generar el **Northwind.SuppliersRow** clase para que incluya la **GetProducts()** que acabamos de definir el método.</span><span class="sxs-lookup"><span data-stu-id="7eec3-429">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="7eec3-430">Si compila el proyecto y, a continuación, volver a la vista de clases, verá **GetProducts()** ahora aparece como un método de **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="7eec3-430">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![El método GetProducts() es ahora parte de la clase de Northwind.SuppliersRow](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="7eec3-432">**Figura 34**: el **GetProducts()** método forma ahora parte de la **Northwind.SuppliersRow** (clase)</span><span class="sxs-lookup"><span data-stu-id="7eec3-432">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="7eec3-433">El **GetProducts()** método ahora se puede utilizar para enumerar el conjunto de productos para un proveedor determinado, como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="7eec3-433">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="7eec3-434">Estos datos también se pueden mostrar en cualquiera de ASP. Controles Web de datos de NET.</span><span class="sxs-lookup"><span data-stu-id="7eec3-434">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="7eec3-435">La página siguiente, utiliza un control GridView con dos campos:</span><span class="sxs-lookup"><span data-stu-id="7eec3-435">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="7eec3-436">BoundField que muestra el nombre de cada proveedor, y</span><span class="sxs-lookup"><span data-stu-id="7eec3-436">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="7eec3-437">TemplateField que contiene un control BulletedList que está enlazado a los resultados devueltos por la **GetProducts()** método para cada proveedor.</span><span class="sxs-lookup"><span data-stu-id="7eec3-437">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="7eec3-438">Examinaremos cómo mostrar dichos informes principal-detalle en tutoriales futuros.</span><span class="sxs-lookup"><span data-stu-id="7eec3-438">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="7eec3-439">Por ahora, en este ejemplo está diseñado para mostrar mediante el método personalizado que agregó a la **Northwind.SuppliersRow** clase.</span><span class="sxs-lookup"><span data-stu-id="7eec3-439">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="7eec3-440">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="7eec3-440">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="7eec3-441">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="7eec3-441">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="7eec3-442">[![Nombre de la compañía del proveedor se muestra en la columna izquierda, sus productos a la derecha](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="7eec3-442">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="7eec3-443">**Figura 35**: nombre del proveedor el de la empresa se muestra en la columna izquierda, sus productos a la derecha ([haga clic aquí para ver la imagen a tamaño completo](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="7eec3-443">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="7eec3-444">Resumen</span><span class="sxs-lookup"><span data-stu-id="7eec3-444">Summary</span></span>

<span data-ttu-id="7eec3-445">Al compilar una aplicación web de creación de la capa DAL debe ser uno de los primeros pasos, que se producen antes de empezar a crear la capa de presentación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-445">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="7eec3-446">Con Visual Studio, la creación de un DAL basado en conjuntos de datos con tipo es una tarea que se pueden realizar en 10-15 minutos sin tener que escribir una línea de código.</span><span class="sxs-lookup"><span data-stu-id="7eec3-446">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="7eec3-447">Los tutoriales avanzando generará en esta capa DAL.</span><span class="sxs-lookup"><span data-stu-id="7eec3-447">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="7eec3-448">En el [siguiente tutorial](creating-a-business-logic-layer-cs.md) comenzaremos definir una serie de reglas de negocios y vea cómo implementarlas en una capa de lógica empresarial independiente.</span><span class="sxs-lookup"><span data-stu-id="7eec3-448">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="7eec3-449">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="7eec3-449">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="7eec3-450">Información adicional</span><span class="sxs-lookup"><span data-stu-id="7eec3-450">Further Reading</span></span>

<span data-ttu-id="7eec3-451">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="7eec3-451">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="7eec3-452">Creación de un DAL mediante fuertemente tipados los TableAdapters y las DataTables en VS 2005 y ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="7eec3-452">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="7eec3-453">Diseño de componentes de nivel de datos y pasar datos a través de niveles</span><span class="sxs-lookup"><span data-stu-id="7eec3-453">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/en-us/library/ms978496.aspx)
- [<span data-ttu-id="7eec3-454">Crear una capa de acceso a datos con el Diseñador de DataSet de Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="7eec3-454">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="7eec3-455">Cifrar la información de configuración en ASP.NET 2.0 las aplicaciones</span><span class="sxs-lookup"><span data-stu-id="7eec3-455">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="7eec3-456">Introducción a TableAdapter</span><span class="sxs-lookup"><span data-stu-id="7eec3-456">TableAdapter Overview</span></span>](https://msdn.microsoft.com/en-us/library/bz9tthwx.aspx)
- [<span data-ttu-id="7eec3-457">Trabajar con un conjunto de datos con tipo</span><span class="sxs-lookup"><span data-stu-id="7eec3-457">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/en-us/library/esbykkzb.aspx)
- [<span data-ttu-id="7eec3-458">Uso de acceso a datos fuertemente tipados en Visual Studio 2005 y ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="7eec3-458">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="7eec3-459">Cómo extender métodos de TableAdapter</span><span class="sxs-lookup"><span data-stu-id="7eec3-459">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="7eec3-460">Recuperación de datos escalar de un procedimiento almacenado</span><span class="sxs-lookup"><span data-stu-id="7eec3-460">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="7eec3-461">Aprendizaje mediante vídeo sobre los temas incluidos en este Tutorial</span><span class="sxs-lookup"><span data-stu-id="7eec3-461">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="7eec3-462">Niveles de acceso a datos en aplicaciones ASP.NET</span><span class="sxs-lookup"><span data-stu-id="7eec3-462">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="7eec3-463">Cómo enlazar manualmente un conjunto de datos a un control Datagrid</span><span class="sxs-lookup"><span data-stu-id="7eec3-463">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="7eec3-464">Cómo trabajar con conjuntos de datos y los filtros de una aplicación ASP</span><span class="sxs-lookup"><span data-stu-id="7eec3-464">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="7eec3-465">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="7eec3-465">About the Author</span></span>

<span data-ttu-id="7eec3-466">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="7eec3-466">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7eec3-467">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="7eec3-467">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7eec3-468">Su último libro es [ *SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="7eec3-468">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7eec3-469">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="7eec3-469">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7eec3-470">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="7eec3-470">Special Thanks To</span></span>

<span data-ttu-id="7eec3-471">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="7eec3-471">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7eec3-472">Los revisores iniciales para este tutorial eran Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez y Carlos Santos.</span><span class="sxs-lookup"><span data-stu-id="7eec3-472">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="7eec3-473">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="7eec3-473">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7eec3-474">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7eec3-474">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
[<span data-ttu-id="7eec3-475">Siguiente</span><span class="sxs-lookup"><span data-stu-id="7eec3-475">Next</span></span>](creating-a-business-logic-layer-cs.md)
