---
uid: web-forms/overview/data-access/caching-data/caching-data-at-application-startup-vb
title: "Almacenamiento en caché de datos al iniciar la aplicación (VB) | Documentos de Microsoft"
author: rick-anderson
description: "En cualquier aplicación Web algunos datos se utilizará con frecuencia y algunos datos se utilizarán con poca frecuencia. Podemos mejorar el rendimiento de nuestro b de la aplicación de ASP.NET..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/30/2007
ms.topic: article
ms.assetid: 84afe4ac-cc53-4f2e-a867-27eaf692c2df
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-at-application-startup-vb
msc.type: authoredcontent
ms.openlocfilehash: 06370e31d27aeab50e56e0b0b860aca7c3ad683b
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="caching-data-at-application-startup-vb"></a><span data-ttu-id="b59a7-104">Datos en caché al iniciar la aplicación (VB)</span><span class="sxs-lookup"><span data-stu-id="b59a7-104">Caching Data at Application Startup (VB)</span></span>
====================
<span data-ttu-id="b59a7-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b59a7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

[<span data-ttu-id="b59a7-106">Descarga de PDF</span><span class="sxs-lookup"><span data-stu-id="b59a7-106">Download PDF</span></span>](caching-data-at-application-startup-vb/_static/datatutorial60vb1.pdf)

> <span data-ttu-id="b59a7-107">En cualquier aplicación Web algunos datos se utilizará con frecuencia y algunos datos se utilizarán con poca frecuencia.</span><span class="sxs-lookup"><span data-stu-id="b59a7-107">In any Web application some data will be frequently used and some data will be infrequently used.</span></span> <span data-ttu-id="b59a7-108">Podemos mejorar el rendimiento de nuestra aplicación de ASP.NET mediante la carga de antemano los datos usados con frecuencia, una técnica conocida como.</span><span class="sxs-lookup"><span data-stu-id="b59a7-108">We can improve the performance of our ASP.NET application by loading in advance the frequently-used data, a technique known as.</span></span> <span data-ttu-id="b59a7-109">Este tutorial muestra un enfoque proactivo carga, que se usa para cargar datos en la memoria caché al iniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-109">This tutorial demonstrates one approach to proactive loading, which is to load data into the cache at application startup.</span></span>


## <a name="introduction"></a><span data-ttu-id="b59a7-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="b59a7-110">Introduction</span></span>

<span data-ttu-id="b59a7-111">Los dos tutoriales anteriores examinando el almacenamiento en caché datos de la capa de almacenamiento en caché y la presentación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-111">The two previous tutorials looked at caching data in the Presentation and Caching Layers.</span></span> <span data-ttu-id="b59a7-112">En [almacenar datos en caché con el ObjectDataSource](caching-data-with-the-objectdatasource-vb.md), analizamos usando la s ObjectDataSource características a los datos de caché en el nivel de presentación de caching.</span><span class="sxs-lookup"><span data-stu-id="b59a7-112">In [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md), we looked at using the ObjectDataSource s caching features to cache data in the Presentation Layer.</span></span> <span data-ttu-id="b59a7-113">[Datos de la arquitectura del almacenamiento en caché](caching-data-in-the-architecture-vb.md) examina el almacenamiento en caché en una capa de almacenamiento en caché nueva e independiente.</span><span class="sxs-lookup"><span data-stu-id="b59a7-113">[Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) examined caching in a new, separate Caching Layer.</span></span> <span data-ttu-id="b59a7-114">Ambos de estos tutoriales usan *carga reactiva* cuando se trabaja con la caché de datos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-114">Both of these tutorials used *reactive loading* in working with the data cache.</span></span> <span data-ttu-id="b59a7-115">Al cargar reactiva, cada vez que se solicitan los datos, el sistema comprueba primero si lo s en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-115">With reactive loading, each time the data is requested, the system first checks if it s in the cache.</span></span> <span data-ttu-id="b59a7-116">Si no es así, se toma los datos de origen, por ejemplo, la base de datos y, a continuación, se almacena en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-116">If not, it grabs the data from the originating source, such as the database, and then stores it in the cache.</span></span> <span data-ttu-id="b59a7-117">La ventaja principal de carga reactiva es su facilidad de implementación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-117">The main advantage to reactive loading is its ease of implementation.</span></span> <span data-ttu-id="b59a7-118">Uno de sus desventajas es su rendimiento desigual todas las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="b59a7-118">One of its disadvantages is its uneven performance across requests.</span></span> <span data-ttu-id="b59a7-119">Imagine una página que usa la capa de almacenamiento en caché del tutorial anterior para mostrar información del producto.</span><span class="sxs-lookup"><span data-stu-id="b59a7-119">Imagine a page that uses the Caching Layer from the preceding tutorial to display product information.</span></span> <span data-ttu-id="b59a7-120">Cuando esta página se visitado por primera vez o visitada por primera vez después de que los datos almacenados en caché se ha desalojado debido a restricciones de memoria o el vencimiento especificado tras haber sido informado, los datos se deben recuperar de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-120">When this page is visited for the first time, or visited for the first time after the cached data has been evicted due to memory constraints or the specified expiry having been reached, the data must be retrieved from the database.</span></span> <span data-ttu-id="b59a7-121">Por lo tanto, estas solicitudes de los usuarios tardará más tiempo que las solicitudes de los usuarios que pueden proporcionarse en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-121">Therefore, these users requests will take longer than users requests that can be served by the cache.</span></span>

<span data-ttu-id="b59a7-122">*Carga automático* proporciona una estrategia de administración de memoria caché alternativo que suaviza el rendimiento de todas las solicitudes mediante la carga de los datos almacenados en memoria caché antes de que s necesario.</span><span class="sxs-lookup"><span data-stu-id="b59a7-122">*Proactive loading* provides an alternative cache management strategy that smoothes out the performance across requests by loading the cached data before it s needed.</span></span> <span data-ttu-id="b59a7-123">Normalmente, la carga automático utiliza algún proceso que periódicamente se comprueba o se notifica cuando se ha producido una actualización de los datos subyacentes.</span><span class="sxs-lookup"><span data-stu-id="b59a7-123">Typically, proactive loading uses some process that either periodically checks or is notified when there has been an update to the underlying data.</span></span> <span data-ttu-id="b59a7-124">Este proceso, a continuación, actualiza la caché para mantener actualizado.</span><span class="sxs-lookup"><span data-stu-id="b59a7-124">This process then updates the cache to keep it fresh.</span></span> <span data-ttu-id="b59a7-125">Carga automático resulta especialmente útil si los datos subyacentes proceden de una conexión lenta de la base de datos, un servicio Web o algún otro origen de datos muy lenta.</span><span class="sxs-lookup"><span data-stu-id="b59a7-125">Proactive loading is especially useful if the underlying data comes from a slow database connection, a Web service, or some other particularly sluggish data source.</span></span> <span data-ttu-id="b59a7-126">Pero este enfoque para cargar automático es más difícil de implementar, ya que requiere crear, administrar e implementar un proceso para comprobar los cambios y actualizar la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-126">But this approach to proactive loading is more difficult to implement, as it requires creating, managing, and deploying a process to check for changes and update the cache.</span></span>

<span data-ttu-id="b59a7-127">Otro tipo de carga automático y el tipo que se podrá explorar en este tutorial, está cargando datos en la memoria caché al iniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-127">Another flavor of proactive loading, and the type we'll be exploring in this tutorial, is loading data into the cache at application startup.</span></span> <span data-ttu-id="b59a7-128">Este enfoque es especialmente útil para almacenar en caché datos estáticos, como los registros en tablas de búsqueda de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-128">This approach is especially useful for caching static data, such as the records in database lookup tables.</span></span>

> [!NOTE]
> <span data-ttu-id="b59a7-129">Para obtener una visión más detallada de las diferencias entre cargar reactiva y proactiva, así como las listas de los profesionales de TI, inconvenientes y recomendaciones de implementación, consulte el [administrar el contenido de una memoria caché](https://msdn.microsoft.com/en-us/library/ms978503.aspx) sección de la [ Almacenamiento en caché de la Guía de arquitectura para aplicaciones de .NET Framework](https://msdn.microsoft.com/en-us/library/ms978498.aspx).</span><span class="sxs-lookup"><span data-stu-id="b59a7-129">For a more in-depth look at the differences between proactive and reactive loading, as well as lists of pros, cons, and implementation recommendations, refer to the [Managing the Contents of a Cache](https://msdn.microsoft.com/en-us/library/ms978503.aspx) section of the [Caching Architecture Guide for .NET Framework Applications](https://msdn.microsoft.com/en-us/library/ms978498.aspx).</span></span>


## <a name="step-1-determining-what-data-to-cache-at-application-startup"></a><span data-ttu-id="b59a7-130">Paso 1: Determinar qué datos en memoria caché al iniciar la aplicación</span><span class="sxs-lookup"><span data-stu-id="b59a7-130">Step 1: Determining What Data to Cache at Application Startup</span></span>

<span data-ttu-id="b59a7-131">Los ejemplos de almacenamiento en caché utilizando reactivos de carga se examina en el trabajo de dos tutoriales anteriores bien con datos que pueden cambiar de forma periódica y no toman exorbitantly mucho para generar.</span><span class="sxs-lookup"><span data-stu-id="b59a7-131">The caching examples using reactive loading that we examined in the previous two tutorials work well with data that may periodically change and does not take exorbitantly long to generate.</span></span> <span data-ttu-id="b59a7-132">Pero si los datos almacenados en memoria caché nunca cambian, la expiración utilizada por carga reactiva es superflua.</span><span class="sxs-lookup"><span data-stu-id="b59a7-132">But if the cached data never changes, the expiry used by reactive loading is superfluous.</span></span> <span data-ttu-id="b59a7-133">Del mismo modo, si los datos se almacenen en caché tardan un tiempo extremadamente largo para generar, se recuperan los usuarios cuyas solicitudes encontrar la Vaciar caché tendrán a tolerar una espera larga mientras que los datos subyacentes.</span><span class="sxs-lookup"><span data-stu-id="b59a7-133">Likewise, if the data being cached takes an exceedingly long time to generate, then those users whose requests find the cache empty will have to endure a lengthy wait while the underlying data is retrieved.</span></span> <span data-ttu-id="b59a7-134">Considere la posibilidad de almacenar en caché datos estáticos y los datos que se tarda demasiado tiempo a generar al iniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-134">Consider caching static data and data that takes an exceptionally long time to generate at application startup.</span></span>

<span data-ttu-id="b59a7-135">Aunque las bases de datos tienen muchos dinámicos, valores cambian con frecuencia, la mayoría tienen también una cantidad considerable de datos estáticos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-135">While databases have many dynamic, frequently-changing values, most also have a fair amount of static data.</span></span> <span data-ttu-id="b59a7-136">Por ejemplo, prácticamente todos los modelos de datos tienen una o varias columnas que contienen un valor determinado de un conjunto fijo de opciones.</span><span class="sxs-lookup"><span data-stu-id="b59a7-136">For example, virtually all data models have one or more columns that contain a particular value from a fixed set of choices.</span></span> <span data-ttu-id="b59a7-137">A `Patients` tabla de base de datos podría tener un `PrimaryLanguage` columna, cuyo conjunto de valores podría estar inglés, español, francés, ruso, japonés y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="b59a7-137">A `Patients` database table might have a `PrimaryLanguage` column, whose set of values could be English, Spanish, French, Russian, Japanese, and so on.</span></span> <span data-ttu-id="b59a7-138">A menudo, estos tipos de columnas se implementan utilizando *tablas de búsqueda*.</span><span class="sxs-lookup"><span data-stu-id="b59a7-138">Oftentimes, these types of columns are implemented using *lookup tables*.</span></span> <span data-ttu-id="b59a7-139">En lugar de almacenar la cadena en inglés o francés en el `Patients` tabla, una segunda tabla se crea que, normalmente, tiene dos columnas: un identificador único y una descripción de cadena - con un registro para cada valor posible.</span><span class="sxs-lookup"><span data-stu-id="b59a7-139">Rather than storing the string English or French in the `Patients` table, a second table is created that has, commonly, two columns - a unique identifier and a string description - with a record for each possible value.</span></span> <span data-ttu-id="b59a7-140">El `PrimaryLanguage` columna en el `Patients` tabla almacena el identificador único correspondiente en la tabla de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b59a7-140">The `PrimaryLanguage` column in the `Patients` table stores the corresponding unique identifier in the lookup table.</span></span> <span data-ttu-id="b59a7-141">En la figura 1, paciente idioma principal de Juan García s es inglés, mientras que s Ed Johnson es ruso.</span><span class="sxs-lookup"><span data-stu-id="b59a7-141">In Figure 1, patient John Doe s primary language is English, while Ed Johnson s is Russian.</span></span>


![La tabla de idiomas es una tabla de búsqueda usa por la tabla de pacientes](caching-data-at-application-startup-vb/_static/image1.png)

<span data-ttu-id="b59a7-143">**Figura 1**: el `Languages` tabla es una tabla de búsqueda utilizado por el `Patients` tabla</span><span class="sxs-lookup"><span data-stu-id="b59a7-143">**Figure 1**: The `Languages` Table is a Lookup Table Used by the `Patients` Table</span></span>


<span data-ttu-id="b59a7-144">La interfaz de usuario para editar o crear un nuevo paciente incluye una lista desplegable de idiomas permitidos rellenado con los registros en la `Languages` tabla.</span><span class="sxs-lookup"><span data-stu-id="b59a7-144">The user interface for editing or creating a new patient would include a drop-down list of allowable languages populated by the records in the `Languages` table.</span></span> <span data-ttu-id="b59a7-145">Sin almacenamiento en caché, cada vez que esta interfaz visitó el sistema debe consultar el `Languages` tabla.</span><span class="sxs-lookup"><span data-stu-id="b59a7-145">Without caching, each time this interface is visited the system must query the `Languages` table.</span></span> <span data-ttu-id="b59a7-146">Esto es innecesarios e innecesarios porque cambian los valores de tabla de búsqueda con muy poca frecuencia si alguna vez.</span><span class="sxs-lookup"><span data-stu-id="b59a7-146">This is wasteful and unnecessary since lookup table values change very infrequently, if ever.</span></span>

<span data-ttu-id="b59a7-147">Se puede almacenar en caché el `Languages` datos mediante las mismas técnicas de carga reactiva examinadas en los tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="b59a7-147">We could cache the `Languages` data using the same reactive loading techniques examined in the previous tutorials.</span></span> <span data-ttu-id="b59a7-148">Sin embargo, se carga reactiva, usa una fecha de expiración basada en el tiempo, que no es necesario para los datos de la tabla de búsqueda estática.</span><span class="sxs-lookup"><span data-stu-id="b59a7-148">Reactive loading, however, uses a time-based expiry, which is not needed for static lookup table data.</span></span> <span data-ttu-id="b59a7-149">Mientras que el almacenamiento en caché con carga reactiva es mejor que ningún almacenamiento en caché en absoluto, el mejor método sería proactivamente cargar los datos de tabla de búsqueda en la memoria caché al iniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-149">While caching using reactive loading would be better than no caching at all, the best approach would be to proactively load the lookup table data into the cache at application startup.</span></span>

<span data-ttu-id="b59a7-150">En este tutorial, veremos cómo datos de la tabla de búsqueda de caché y otra información estática.</span><span class="sxs-lookup"><span data-stu-id="b59a7-150">In this tutorial we will look at how to cache lookup table data and other static information.</span></span>

## <a name="step-2-examining-the-different-ways-to-cache-data"></a><span data-ttu-id="b59a7-151">Paso 2: Examen de las distintas formas de almacenar datos en caché</span><span class="sxs-lookup"><span data-stu-id="b59a7-151">Step 2: Examining the Different Ways to Cache Data</span></span>

<span data-ttu-id="b59a7-152">Información puede utilizar caché mediante programación en una aplicación de ASP.NET mediante una variedad de métodos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-152">Information can be programmatically cached in an ASP.NET application using a variety of approaches.</span></span> <span data-ttu-id="b59a7-153">Se ha visto cómo utilizar la caché de datos en los tutoriales anteriores.</span><span class="sxs-lookup"><span data-stu-id="b59a7-153">We ve already seen how to use the data cache in previous tutorials.</span></span> <span data-ttu-id="b59a7-154">Como alternativa, los objetos pueden almacenarse mediante programación en caché mediante *miembros estáticos* o *estado de la aplicación*.</span><span class="sxs-lookup"><span data-stu-id="b59a7-154">Alternatively, objects can be programmatically cached using *static members* or *application state*.</span></span>

<span data-ttu-id="b59a7-155">Cuando se trabaja con una clase, normalmente la clase debe en primer lugar se crea una instancia para poder acceder a sus miembros.</span><span class="sxs-lookup"><span data-stu-id="b59a7-155">When working with a class, typically the class must first be instantiated before its members can be accessed.</span></span> <span data-ttu-id="b59a7-156">Por ejemplo, para invocar un método de una de las clases de la capa de lógica empresarial, debemos primero creamos una instancia de la clase:</span><span class="sxs-lookup"><span data-stu-id="b59a7-156">For example, in order to invoke a method from one of the classes in our Business Logic Layer, we must first create an instance of the class:</span></span>


[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample1.vb)]

<span data-ttu-id="b59a7-157">Antes de que podemos llamar *SomeMethod* o trabajar con *SomeProperty*, primero que debemos crear una instancia de la clase utilizando el `New` palabra clave.</span><span class="sxs-lookup"><span data-stu-id="b59a7-157">Before we can invoke *SomeMethod* or work with *SomeProperty*, we must first create an instance of the class using the `New` keyword.</span></span> <span data-ttu-id="b59a7-158">*SomeMethod* y *SomeProperty* están asociados a una instancia determinada.</span><span class="sxs-lookup"><span data-stu-id="b59a7-158">*SomeMethod* and *SomeProperty* are associated with a particular instance.</span></span> <span data-ttu-id="b59a7-159">La duración de estos miembros se vincula a la duración de su objeto asociado.</span><span class="sxs-lookup"><span data-stu-id="b59a7-159">The lifetime of these members is tied to the lifetime of their associated object.</span></span> <span data-ttu-id="b59a7-160">*Los miembros estáticos*, por otro lado, son las variables, propiedades y métodos que se comparten entre *todos los* instancias de la clase y, por lo tanto, tienen una duración siempre que la clase.</span><span class="sxs-lookup"><span data-stu-id="b59a7-160">*Static members*, on the other hand, are variables, properties, and methods that are shared among *all* instances of the class and, consequently, have a lifetime as long as the class.</span></span> <span data-ttu-id="b59a7-161">Los miembros estáticos se indican mediante la palabra clave `Shared`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-161">Static members are denoted by the keyword `Shared`.</span></span>

<span data-ttu-id="b59a7-162">Además de los miembros estáticos, datos pueden almacenarse en caché mediante el estado de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-162">In addition to static members, data can be cached using application state.</span></span> <span data-ttu-id="b59a7-163">Cada aplicación de ASP.NET mantiene una colección de nombre/valor s compartida todos los usuarios y las páginas de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-163">Each ASP.NET application maintains a name/value collection that s shared across all users and pages of the application.</span></span> <span data-ttu-id="b59a7-164">Puede tener acceso a esta colección mediante el [ `HttpContext` clase](https://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx) s [ `Application` propiedad](https://msdn.microsoft.com/en-us/library/system.web.httpcontext.application.aspx)y usar desde una clase de código subyacente ASP.NET page s así:</span><span class="sxs-lookup"><span data-stu-id="b59a7-164">This collection can be accessed using the [`HttpContext` class](https://msdn.microsoft.com/en-us/library/system.web.httpcontext.aspx) s [`Application` property](https://msdn.microsoft.com/en-us/library/system.web.httpcontext.application.aspx), and used from an ASP.NET page s code-behind class like so:</span></span>


[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample2.vb)]

<span data-ttu-id="b59a7-165">La caché de datos proporciona una cantidad API más enriquecida para almacenamiento en caché de datos, lo que ofrece mecanismos para basada en tiempo y dependencia caducados, las prioridades del elemento de caché y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="b59a7-165">The data cache provides a much richer API for caching data, providing mechanisms for time- and dependency-based expiries, cache item priorities, and so forth.</span></span> <span data-ttu-id="b59a7-166">Con los miembros estáticos y estado de la aplicación, se deben agregar manualmente estas características por el desarrollador de la página.</span><span class="sxs-lookup"><span data-stu-id="b59a7-166">With static members and application state, such features must be manually added by the page developer.</span></span> <span data-ttu-id="b59a7-167">Al almacenar en caché datos al iniciar la aplicación para la duración de la aplicación, sin embargo, las ventajas de la memoria caché s de datos son discutible.</span><span class="sxs-lookup"><span data-stu-id="b59a7-167">When caching data at application startup for the lifetime of the application, however, the data cache s advantages are moot.</span></span> <span data-ttu-id="b59a7-168">En este tutorial se examinará código que usa las tres técnicas para almacenar en caché datos estáticos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-168">In this tutorial we'll look at code that uses all three techniques for caching static data.</span></span>

## <a name="step-3-caching-thesupplierstable-data"></a><span data-ttu-id="b59a7-169">Paso 3: El almacenamiento en caché el`Suppliers`datos de tabla</span><span class="sxs-lookup"><span data-stu-id="b59a7-169">Step 3: Caching the`Suppliers`Table Data</span></span>

<span data-ttu-id="b59a7-170">El tablas de base de datos se ha implementado hasta la fecha de Northwind no incluyen ninguna tabla de búsqueda tradicional.</span><span class="sxs-lookup"><span data-stu-id="b59a7-170">The Northwind database tables we ve implemented to date do not include any traditional lookup tables.</span></span> <span data-ttu-id="b59a7-171">Las cuatro tablas de datos implementan en nuestro DAL todas las tablas del modelo cuyos valores son no estáticos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-171">The four DataTables implemented in our DAL all model tables whose values are non-static.</span></span> <span data-ttu-id="b59a7-172">En lugar de dedicar el tiempo para agregar un nuevo objeto DataTable a la capa DAL y, a continuación, una nueva clase y los métodos a la capa BLL, para este tutorial permite s simplemente supongamos que la `Suppliers` datos de la tabla s están estáticos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-172">Rather than spending the time to add a new DataTable to the DAL and then a new class and methods to the BLL, for this tutorial let s just pretend that the `Suppliers` table s data is static.</span></span> <span data-ttu-id="b59a7-173">Por lo tanto, se pueden almacenar en caché estos datos al iniciarse la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-173">Therefore, we could cache this data at application startup.</span></span>

<span data-ttu-id="b59a7-174">Para empezar, cree una nueva clase denominada `StaticCache.cs` en el `CL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="b59a7-174">To start, create a new class named `StaticCache.cs` in the `CL` folder.</span></span>


![Crear la clase StaticCache.vb en la carpeta de CL](caching-data-at-application-startup-vb/_static/image2.png)

<span data-ttu-id="b59a7-176">**Figura 2**: crear el `StaticCache.vb` clase en el `CL` carpeta</span><span class="sxs-lookup"><span data-stu-id="b59a7-176">**Figure 2**: Create the `StaticCache.vb` Class in the `CL` Folder</span></span>


<span data-ttu-id="b59a7-177">Tenemos que agregar un método que carga los datos en el inicio en el almacén de caché adecuada, así como métodos que devuelven datos de esta memoria caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-177">We need to add a method that loads the data at startup into the appropriate cache store, as well as methods that return data from this cache.</span></span>


[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample3.vb)]

<span data-ttu-id="b59a7-178">El código anterior utiliza una variable de miembro estático, `suppliers`, para almacenar los resultados de la `SuppliersBLL` clase s `GetSuppliers()` método, que se llama desde el `LoadStaticCache()` método.</span><span class="sxs-lookup"><span data-stu-id="b59a7-178">The above code uses a static member variable, `suppliers`, to hold the results from the `SuppliersBLL` class s `GetSuppliers()` method, which is called from the `LoadStaticCache()` method.</span></span> <span data-ttu-id="b59a7-179">El `LoadStaticCache()` método está pensado para llamarse durante el inicio de s de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-179">The `LoadStaticCache()` method is meant to be called during the application s start.</span></span> <span data-ttu-id="b59a7-180">Una vez que estos datos se han cargado al iniciar la aplicación, puede llamar cualquier página que necesita para trabajar con datos de proveedor la `StaticCache` clase s. `GetSuppliers()` método.</span><span class="sxs-lookup"><span data-stu-id="b59a7-180">Once this data has been loaded at application startup, any page that needs to work with supplier data can call the `StaticCache` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="b59a7-181">Por lo tanto, la llamada a la base de datos para obtener los proveedores solo se produce una vez, al iniciarse la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-181">Therefore, the call to the database to get the suppliers only happens once, at application start.</span></span>

<span data-ttu-id="b59a7-182">En lugar de usar una variable miembro estática como el almacén de caché, podríamos haber utilizado también el estado de aplicación o la caché de datos.</span><span class="sxs-lookup"><span data-stu-id="b59a7-182">Rather than using a static member variable as the cache store, we could have alternatively used application state or the data cache.</span></span> <span data-ttu-id="b59a7-183">El código siguiente muestra la clase reformó para usar el estado de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="b59a7-183">The following code shows the class retooled to use application state:</span></span>


[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample4.vb)]

<span data-ttu-id="b59a7-184">En `LoadStaticCache()`, la información de proveedor se almacena en la variable de aplicación *clave*.</span><span class="sxs-lookup"><span data-stu-id="b59a7-184">In `LoadStaticCache()`, the supplier information is stored to the application variable *key*.</span></span> <span data-ttu-id="b59a7-185">Lo s se devuelve como el tipo adecuado (`Northwind.SuppliersDataTable`) desde `GetSuppliers()`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-185">It s returned as the appropriate type (`Northwind.SuppliersDataTable`) from `GetSuppliers()`.</span></span> <span data-ttu-id="b59a7-186">Mientras que el estado de aplicación son accesibles en las clases de código subyacente de páginas ASP.NET mediante `Application("key")`, en la arquitectura que debemos usar `HttpContext.Current.Application("key")` con el fin de obtener actual `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-186">While application state can be accessed in the code-behind classes of ASP.NET pages using `Application("key")`, in the architecture we must use `HttpContext.Current.Application("key")` in order to get the current `HttpContext`.</span></span>

<span data-ttu-id="b59a7-187">Del mismo modo, la caché de datos puede utilizarse como un almacén de caché, como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="b59a7-187">Likewise, the data cache can be used as a cache store, as the following code shows:</span></span>


[!code-vb[Main](caching-data-at-application-startup-vb/samples/sample5.vb)]

<span data-ttu-id="b59a7-188">Para agregar un elemento a la caché de datos y sin ninguna caducidad basadas en tiempo, use la `System.Web.Caching.Cache.NoAbsoluteExpiration` y `System.Web.Caching.Cache.NoSlidingExpiration` valores como parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="b59a7-188">To add an item to the data cache with no time-based expiry, use the `System.Web.Caching.Cache.NoAbsoluteExpiration` and `System.Web.Caching.Cache.NoSlidingExpiration` values as input parameters.</span></span> <span data-ttu-id="b59a7-189">Esta sobrecarga en particular de la caché de datos s `Insert` seleccionó el método para que se puede especificar el *prioridad* de elemento de la caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-189">This particular overload of the data cache s `Insert` method was selected so that we could specify the *priority* of the cache item.</span></span> <span data-ttu-id="b59a7-190">La prioridad se utiliza para determinar qué elementos se deben borrar de la memoria caché cuando hay poca memoria disponible.</span><span class="sxs-lookup"><span data-stu-id="b59a7-190">The priority is used to determine what items to scavenge from the cache when available memory runs low.</span></span> <span data-ttu-id="b59a7-191">Aquí usamos la prioridad `NotRemovable`, lo que garantiza que este elemento en caché won t se eliminen.</span><span class="sxs-lookup"><span data-stu-id="b59a7-191">Here we use the priority `NotRemovable`, which ensures that this cache item won t be scavenged.</span></span>

> [!NOTE]
> <span data-ttu-id="b59a7-192">Esta descarga tutorial s implementa la `StaticCache` clase utilizando el enfoque de variable de miembro estático.</span><span class="sxs-lookup"><span data-stu-id="b59a7-192">This tutorial s download implements the `StaticCache` class using the static member variable approach.</span></span> <span data-ttu-id="b59a7-193">El código de las técnicas de caché de estado y los datos de aplicación está disponible en los comentarios en el archivo de clase.</span><span class="sxs-lookup"><span data-stu-id="b59a7-193">The code for the application state and data cache techniques is available in the comments in the class file.</span></span>


## <a name="step-4-executing-code-at-application-startup"></a><span data-ttu-id="b59a7-194">Paso 4: Ejecutar código en el inicio de la aplicación</span><span class="sxs-lookup"><span data-stu-id="b59a7-194">Step 4: Executing Code at Application Startup</span></span>

<span data-ttu-id="b59a7-195">Para ejecutar código cuando se inicia por primera vez una aplicación web, es necesario crear un archivo especial denominado `Global.asax`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-195">To execute code when a web application first starts, we need to create a special file named `Global.asax`.</span></span> <span data-ttu-id="b59a7-196">Este archivo puede contener controladores de eventos de aplicación-, sesión:, y eventos de nivel de solicitud y aquí es donde podemos agregar código que se ejecutará cada vez que inicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-196">This file can contain event handlers for application-, session-, and request-level events, and it is here where we can add code that will be executed whenever the application starts.</span></span>

<span data-ttu-id="b59a7-197">Agregar el `Global.asax` archivo para el directorio raíz de s de aplicación web, haga doble clic en el nombre del proyecto de sitio Web en Visual Studio s el Explorador de soluciones y elija Agregar nuevo elemento.</span><span class="sxs-lookup"><span data-stu-id="b59a7-197">Add the `Global.asax` file to your web application s root directory by right-clicking on the website project name in Visual Studio s Solution Explorer and choosing Add New Item.</span></span> <span data-ttu-id="b59a7-198">En el cuadro de diálogo Agregar nuevo elemento, seleccione el tipo de elemento de la clase de aplicación Global y, a continuación, haga clic en el botón Agregar.</span><span class="sxs-lookup"><span data-stu-id="b59a7-198">From the Add New Item dialog box, select the Global Application Class item type and then click the Add button.</span></span>

> [!NOTE]
> <span data-ttu-id="b59a7-199">Si ya tiene un `Global.asax` archivo en el proyecto, el tipo de elemento no se mostrarán en el cuadro de diálogo Agregar nuevo elemento de clase de aplicación Global.</span><span class="sxs-lookup"><span data-stu-id="b59a7-199">If you already have a `Global.asax` file in your project, the Global Application Class item type will not be listed in the Add New Item dialog box.</span></span>


<span data-ttu-id="b59a7-200">[![Agregue el archivo Global.asax a su directorio de raíz de s de la aplicación Web](caching-data-at-application-startup-vb/_static/image4.png)](caching-data-at-application-startup-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b59a7-200">[![Add the Global.asax File to Your Web Application s Root Directory](caching-data-at-application-startup-vb/_static/image4.png)](caching-data-at-application-startup-vb/_static/image3.png)</span></span>

<span data-ttu-id="b59a7-201">**Figura 3**: agregar la `Global.asax` archivo a una aplicación Web s directorio raíz ([haga clic aquí para ver la imagen a tamaño completo](caching-data-at-application-startup-vb/_static/image5.png))</span><span class="sxs-lookup"><span data-stu-id="b59a7-201">**Figure 3**: Add the `Global.asax` File to Your Web Application s Root Directory ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image5.png))</span></span>


<span data-ttu-id="b59a7-202">El valor predeterminado `Global.asax` plantilla de archivo incluye cinco métodos dentro de un servidor `<script>` etiqueta:</span><span class="sxs-lookup"><span data-stu-id="b59a7-202">The default `Global.asax` file template includes five methods within a server-side `<script>` tag:</span></span>

- <span data-ttu-id="b59a7-203">**`Application_Start`**se ejecuta cuando se inicia por primera vez la aplicación web</span><span class="sxs-lookup"><span data-stu-id="b59a7-203">**`Application_Start`** executes when the web application first starts</span></span>
- <span data-ttu-id="b59a7-204">**`Application_End`**se ejecuta cuando se está cerrando la aplicación</span><span class="sxs-lookup"><span data-stu-id="b59a7-204">**`Application_End`** runs when the application is shutting down</span></span>
- <span data-ttu-id="b59a7-205">**`Application_Error`**se ejecuta cada vez que una excepción no controlada llega a la aplicación</span><span class="sxs-lookup"><span data-stu-id="b59a7-205">**`Application_Error`** executes whenever an unhandled exception reaches the application</span></span>
- <span data-ttu-id="b59a7-206">**`Session_Start`**se ejecuta cuando se crea una nueva sesión</span><span class="sxs-lookup"><span data-stu-id="b59a7-206">**`Session_Start`** executes when a new session is created</span></span>
- <span data-ttu-id="b59a7-207">**`Session_End`**se ejecuta cuando una sesión está expirada o se abandonó el proceso</span><span class="sxs-lookup"><span data-stu-id="b59a7-207">**`Session_End`** runs when a session is expired or abandoned</span></span>

<span data-ttu-id="b59a7-208">El `Application_Start` controlador de eventos se llama solo una vez durante un ciclo de vida de aplicación s.</span><span class="sxs-lookup"><span data-stu-id="b59a7-208">The `Application_Start` event handler is called only once during an application s life cycle.</span></span> <span data-ttu-id="b59a7-209">La aplicación inicia la primera vez un recurso ASP.NET se solicita la aplicación y continúa ejecutándose hasta que se reinicie la aplicación, lo cual puede suceder si modifica el contenido de la `/Bin` carpeta, modificar `Global.asax`, modificar el contenido en el `App_Code` carpeta, o modificar el `Web.config` archivo, entre otras causas.</span><span class="sxs-lookup"><span data-stu-id="b59a7-209">The application starts the first time an ASP.NET resource is requested from the application and continues to run until the application is restarted, which can happen by modifying the contents of the `/Bin` folder, modifying `Global.asax`, modifying the contents in the `App_Code` folder, or modifying the `Web.config` file, among other causes.</span></span> <span data-ttu-id="b59a7-210">Hacer referencia a [información general sobre el ciclo de vida de aplicaciones ASP.NET](https://msdn.microsoft.com/en-us/library/ms178473.aspx) para obtener una explicación más detallada en el ciclo de vida de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-210">Refer to [ASP.NET Application Life Cycle Overview](https://msdn.microsoft.com/en-us/library/ms178473.aspx) for a more detailed discussion on the application life cycle.</span></span>

<span data-ttu-id="b59a7-211">Para estos tutoriales únicamente se necesita agregar código a la  `Application_Start` /método siguiente, por lo que no dude en quitar las demás.</span><span class="sxs-lookup"><span data-stu-id="b59a7-211">For these tutorials we only need to add code to the `Application_Start` method, so feel free to remove the others.</span></span> <span data-ttu-id="b59a7-212">En `Application_Start`, basta con llamar a la `StaticCache` clase s. `LoadStaticCache()` método, que se cargarán y almacenar en caché la información del proveedor:</span><span class="sxs-lookup"><span data-stu-id="b59a7-212">In `Application_Start`, simply call the `StaticCache` class s `LoadStaticCache()` method, which will load and cache the supplier information:</span></span>


[!code-aspx[Main](caching-data-at-application-startup-vb/samples/sample6.aspx)]

<span data-ttu-id="b59a7-213">S todo es a él.</span><span class="sxs-lookup"><span data-stu-id="b59a7-213">That s all there is to it!</span></span> <span data-ttu-id="b59a7-214">Al iniciar la aplicación, el `LoadStaticCache()` método agarre la información del proveedor de la capa BLL y almacenarlo en una variable miembro estática (o almacenar la memoria caché se ha terminado de selección en la `StaticCache` clase).</span><span class="sxs-lookup"><span data-stu-id="b59a7-214">At application startup, the `LoadStaticCache()` method will grab the supplier information from the BLL, and store it in a static member variable (or whatever cache store you ended up using in the `StaticCache` class).</span></span> <span data-ttu-id="b59a7-215">Para comprobar este comportamiento, establezca un punto de interrupción la `Application_Start` (método) y ejecute la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-215">To verify this behavior, set a breakpoint in the `Application_Start` method and run your application.</span></span> <span data-ttu-id="b59a7-216">Tenga en cuenta que el punto de interrupción en el inicio de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-216">Note that the breakpoint is hit upon the application starting.</span></span> <span data-ttu-id="b59a7-217">Las solicitudes posteriores, sin embargo, no se realiza el `Application_Start` método se debe ejecutar.</span><span class="sxs-lookup"><span data-stu-id="b59a7-217">Subsequent requests, however, do not cause the `Application_Start` method to execute.</span></span>


<span data-ttu-id="b59a7-218">[![Usar un punto de interrupción para comprobar que el controlador de eventos Application_Start es que se está ejecutando](caching-data-at-application-startup-vb/_static/image7.png)](caching-data-at-application-startup-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="b59a7-218">[![Use a Breakpoint to Verify that the Application_Start Event Handler is Being Executed](caching-data-at-application-startup-vb/_static/image7.png)](caching-data-at-application-startup-vb/_static/image6.png)</span></span>

<span data-ttu-id="b59a7-219">**Figura 4**: usar un punto de interrupción para comprobar que la `Application_Start` controlador de eventos es que se está ejecutando ([haga clic aquí para ver la imagen a tamaño completo](caching-data-at-application-startup-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="b59a7-219">**Figure 4**: Use a Breakpoint to Verify that the `Application_Start` Event Handler is Being Executed ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image8.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b59a7-220">Si no se produce la `Application_Start` punto de interrupción al primero iniciar la depuración, es que ya ha iniciado la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-220">If you do not hit the `Application_Start` breakpoint when you first start debugging, it is because your application has already started.</span></span> <span data-ttu-id="b59a7-221">Forzar la aplicación se reinicie modificando su `Global.asax` o `Web.config` archivos y, a continuación, vuelva a intentarlo.</span><span class="sxs-lookup"><span data-stu-id="b59a7-221">Force the application to restart by modifying your `Global.asax` or `Web.config` files and then try again.</span></span> <span data-ttu-id="b59a7-222">Se puede simplemente agregar (o quitar) una línea en blanco al final de uno de estos archivos rápidamente reiniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-222">You can simply add (or remove) a blank line at the end of one of these files to quickly restart the application.</span></span>


## <a name="step-5-displaying-the-cached-data"></a><span data-ttu-id="b59a7-223">Paso 5: Mostrar los datos en caché</span><span class="sxs-lookup"><span data-stu-id="b59a7-223">Step 5: Displaying the Cached Data</span></span>

<span data-ttu-id="b59a7-224">En este momento la `StaticCache` clase tiene una versión de los datos de proveedor almacenado en caché en el inicio de la aplicación que se puede tener acceso a través de su `GetSuppliers()` método.</span><span class="sxs-lookup"><span data-stu-id="b59a7-224">At this point the `StaticCache` class has a version of the supplier data cached at application startup that can be accessed through its `GetSuppliers()` method.</span></span> <span data-ttu-id="b59a7-225">Para trabajar con estos datos de la capa de presentación, podemos usar un ObjectDataSource o invocar mediante programación el `StaticCache` clase s. `GetSuppliers()` método de una clase de código subyacente de la página s ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="b59a7-225">To work with this data from the Presentation Layer, we can use an ObjectDataSource or programmatically invoke the `StaticCache` class s `GetSuppliers()` method from an ASP.NET page s code-behind class.</span></span> <span data-ttu-id="b59a7-226">Permiten s mirar mediante los controles ObjectDataSource y GridView para mostrar la información de proveedor almacenados en caché.</span><span class="sxs-lookup"><span data-stu-id="b59a7-226">Let s look at using the ObjectDataSource and GridView controls to display the cached supplier information.</span></span>

<span data-ttu-id="b59a7-227">Comience abriendo la `AtApplicationStartup.aspx` página en el `Caching` carpeta.</span><span class="sxs-lookup"><span data-stu-id="b59a7-227">Start by opening the `AtApplicationStartup.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="b59a7-228">Arrastre un control GridView del cuadro de herramientas hasta el diseñador, establecer su `ID` propiedad `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-228">Drag a GridView from the Toolbox onto the designer, setting its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="b59a7-229">A continuación, desde GridView etiqueta inteligente s optar por crear un nuevo origen ObjectDataSource denominado `SuppliersCachedDataSource`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-229">Next, from the GridView s smart tag choose to create a new ObjectDataSource named `SuppliersCachedDataSource`.</span></span> <span data-ttu-id="b59a7-230">Configurar el ObjectDataSource para usar el `StaticCache` clase s. `GetSuppliers()` método.</span><span class="sxs-lookup"><span data-stu-id="b59a7-230">Configure the ObjectDataSource to use the `StaticCache` class s `GetSuppliers()` method.</span></span>


<span data-ttu-id="b59a7-231">[![Configurar el ObjectDataSource para utilizar la clase StaticCache](caching-data-at-application-startup-vb/_static/image10.png)](caching-data-at-application-startup-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="b59a7-231">[![Configure the ObjectDataSource to use the StaticCache Class](caching-data-at-application-startup-vb/_static/image10.png)](caching-data-at-application-startup-vb/_static/image9.png)</span></span>

<span data-ttu-id="b59a7-232">**Figura 5**: configurar el ObjectDataSource para usar el `StaticCache` clase ([haga clic aquí para ver la imagen a tamaño completo](caching-data-at-application-startup-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="b59a7-232">**Figure 5**: Configure the ObjectDataSource to use the `StaticCache` Class ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image11.png))</span></span>


<span data-ttu-id="b59a7-233">[![Utilice el método GetSuppliers() para recuperar los datos de proveedor almacenados en caché](caching-data-at-application-startup-vb/_static/image13.png)](caching-data-at-application-startup-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="b59a7-233">[![Use the GetSuppliers() Method to Retrieve the Cached Supplier Data](caching-data-at-application-startup-vb/_static/image13.png)](caching-data-at-application-startup-vb/_static/image12.png)</span></span>

<span data-ttu-id="b59a7-234">**Figura 6**: Use la `GetSuppliers()` método para recuperar los datos de proveedor almacenado en memoria caché ([haga clic aquí para ver la imagen a tamaño completo](caching-data-at-application-startup-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="b59a7-234">**Figure 6**: Use the `GetSuppliers()` Method to Retrieve the Cached Supplier Data ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image14.png))</span></span>


<span data-ttu-id="b59a7-235">Después de completar el asistente, Visual Studio agregará automáticamente BoundFields para cada uno de los campos de datos en `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="b59a7-235">After completing the wizard, Visual Studio will automatically add BoundFields for each of the data fields in `SuppliersDataTable`.</span></span> <span data-ttu-id="b59a7-236">El marcado declarativo de s GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="b59a7-236">Your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](caching-data-at-application-startup-vb/samples/sample7.aspx)]

<span data-ttu-id="b59a7-237">Figura 7 muestra la página cuando se ve mediante un explorador.</span><span class="sxs-lookup"><span data-stu-id="b59a7-237">Figure 7 shows the page when viewed through a browser.</span></span> <span data-ttu-id="b59a7-238">El resultado es el mismo hubieran se extraen los datos de las operaciones de asignación BLL `SuppliersBLL` clase, pero utilizando la `StaticCache` clase devuelve los datos de proveedor como almacenado en caché al iniciar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-238">The output is the same had we pulled the data from the BLL s `SuppliersBLL` class, but using the `StaticCache` class returns the supplier data as cached at application startup.</span></span> <span data-ttu-id="b59a7-239">Puede establecer puntos de interrupción la `StaticCache` clase s. `GetSuppliers()` método para comprobar este comportamiento.</span><span class="sxs-lookup"><span data-stu-id="b59a7-239">You can set breakpoints in the `StaticCache` class s `GetSuppliers()` method to verify this behavior.</span></span>


<span data-ttu-id="b59a7-240">[![Los datos de proveedor almacenado en memoria caché se muestra en un control GridView](caching-data-at-application-startup-vb/_static/image16.png)](caching-data-at-application-startup-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="b59a7-240">[![The Cached Supplier Data is Displayed in a GridView](caching-data-at-application-startup-vb/_static/image16.png)](caching-data-at-application-startup-vb/_static/image15.png)</span></span>

<span data-ttu-id="b59a7-241">**Figura 7**: el almacenado en memoria caché de datos de proveedor se muestra en un control GridView ([haga clic aquí para ver la imagen a tamaño completo](caching-data-at-application-startup-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="b59a7-241">**Figure 7**: The Cached Supplier Data is Displayed in a GridView ([Click to view full-size image](caching-data-at-application-startup-vb/_static/image17.png))</span></span>


## <a name="summary"></a><span data-ttu-id="b59a7-242">Resumen</span><span class="sxs-lookup"><span data-stu-id="b59a7-242">Summary</span></span>

<span data-ttu-id="b59a7-243">La mayoría de cada modelo de datos contiene una cantidad considerable de datos estáticos, que normalmente se implementa en forma de tabla de búsqueda.</span><span class="sxs-lookup"><span data-stu-id="b59a7-243">Most every data model contains a fair amount of static data, usually implemented in the form of lookup tables.</span></span> <span data-ttu-id="b59a7-244">Dado que esta información es estática, allí s ningún motivo para tener acceso a la base de datos continuamente cada vez que esta información se debe mostrar.</span><span class="sxs-lookup"><span data-stu-id="b59a7-244">Since this information is static, there s no reason to continually access the database each time this information needs to be displayed.</span></span> <span data-ttu-id="b59a7-245">Además, debido a su naturaleza estática, al almacenar en caché los datos allí s sin necesidad de una fecha de expiración.</span><span class="sxs-lookup"><span data-stu-id="b59a7-245">Furthermore, due to its static nature, when caching the data there s no need for an expiry.</span></span> <span data-ttu-id="b59a7-246">En este tutorial, hemos visto cómo utilizar estos datos y almacenarla en la caché en la caché de datos, el estado de la aplicación y a través de una variable de miembro estático.</span><span class="sxs-lookup"><span data-stu-id="b59a7-246">In this tutorial we saw how to take such data and cache it in the data cache, application state, and through a static member variable.</span></span> <span data-ttu-id="b59a7-247">Esta información se almacena en caché al iniciar la aplicación y permanece en la caché durante el ciclo de vida de aplicación s.</span><span class="sxs-lookup"><span data-stu-id="b59a7-247">This information is cached at application startup and remains in the cache throughout the application s lifetime.</span></span>

<span data-ttu-id="b59a7-248">En este tutorial y los dos últimos, se ha buscado en almacenamiento en caché datos para la duración de la duración de s de la aplicación, así como usar caducados basado en tiempo.</span><span class="sxs-lookup"><span data-stu-id="b59a7-248">In this tutorial and the past two, we ve looked at caching data for the duration of the application s lifetime as well as using time-based expiries.</span></span> <span data-ttu-id="b59a7-249">Al almacenar en caché datos de la base de datos, sin embargo, una expiración basada en el tiempo puede ser ni mucho menos ideal.</span><span class="sxs-lookup"><span data-stu-id="b59a7-249">When caching database data, though, a time-based expiry may be less than ideal.</span></span> <span data-ttu-id="b59a7-250">En lugar de forma periódica el vaciado de la memoria caché, sería óptimo para expulsar solo el elemento en caché cuando se modifican los datos de la base de datos subyacente.</span><span class="sxs-lookup"><span data-stu-id="b59a7-250">Rather than periodically flushing the cache, it would be optimal to only evict the cached item when the underlying database data is modified.</span></span> <span data-ttu-id="b59a7-251">Este ideal es posible mediante el uso de dependencias de caché SQL, que examinaremos en nuestro tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="b59a7-251">This ideal is possible through the use of SQL cache dependencies, which we'll examine in our next tutorial.</span></span>

<span data-ttu-id="b59a7-252">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="b59a7-252">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b59a7-253">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="b59a7-253">About the Author</span></span>

<span data-ttu-id="b59a7-254">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="b59a7-254">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b59a7-255">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="b59a7-255">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b59a7-256">Su último libro es [ *SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="b59a7-256">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b59a7-257">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="b59a7-257">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="b59a7-258">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="b59a7-258">Special Thanks To</span></span>

<span data-ttu-id="b59a7-259">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="b59a7-259">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="b59a7-260">Los revisores iniciales para este tutorial fueron Teresa Murphy y Zack Jones.</span><span class="sxs-lookup"><span data-stu-id="b59a7-260">Lead reviewers for this tutorial were Teresa Murphy and Zack Jones.</span></span> <span data-ttu-id="b59a7-261">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="b59a7-261">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="b59a7-262">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b59a7-262">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="b59a7-263">[Anterior](caching-data-in-the-architecture-vb.md)
[Siguiente](using-sql-cache-dependencies-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b59a7-263">[Previous](caching-data-in-the-architecture-vb.md)
[Next](using-sql-cache-dependencies-vb.md)</span></span>
