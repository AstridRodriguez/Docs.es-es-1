---
uid: web-forms/overview/data-access/paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb
title: Eficazmente paginar a través de grandes cantidades de datos (VB) | Documentos de Microsoft
author: rick-anderson
description: La opción de paginación predeterminada de un control de presentación de datos no es apropiada cuando se trabaja con grandes cantidades de datos, como su retriev de control de origen de datos subyacente...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/15/2006
ms.topic: article
ms.assetid: 3e20e64a-8808-4b49-88d6-014e2629d56f
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/efficiently-paging-through-large-amounts-of-data-vb
msc.type: authoredcontent
ms.openlocfilehash: 00057f9bfd9b1c479e500ac591db694388a5d358
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890702"
---
<a name="efficiently-paging-through-large-amounts-of-data-vb"></a><span data-ttu-id="88703-103">Eficazmente paginar a través de grandes cantidades de datos (VB)</span><span class="sxs-lookup"><span data-stu-id="88703-103">Efficiently Paging Through Large Amounts of Data (VB)</span></span>
====================
<span data-ttu-id="88703-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="88703-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="88703-105">[Descargar la aplicación de ejemplo](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_25_VB.exe) o [descarga de PDF](efficiently-paging-through-large-amounts-of-data-vb/_static/datatutorial25vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="88703-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_25_VB.exe) or [Download PDF](efficiently-paging-through-large-amounts-of-data-vb/_static/datatutorial25vb1.pdf)</span></span>

> <span data-ttu-id="88703-106">La opción de paginación predeterminada de un control de presentación de datos no es apropiada cuando se trabaja con grandes cantidades de datos, como el control de origen de datos subyacente recupera todos los registros, aunque se muestra solo un subconjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-106">The default paging option of a data presentation control is unsuitable when working with large amounts of data, as its underlying data source control retrieves all records, even though only a subset of data is displayed.</span></span> <span data-ttu-id="88703-107">En estas circunstancias, debemos activamos personalizados a la paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-107">In such circumstances, we must turn to custom paging.</span></span>


## <a name="introduction"></a><span data-ttu-id="88703-108">Introducción</span><span class="sxs-lookup"><span data-stu-id="88703-108">Introduction</span></span>

<span data-ttu-id="88703-109">Como se explicó en el tutorial anterior, se puede implementar la paginación en uno de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="88703-109">As we discussed in the preceding tutorial, paging can be implemented in one of two ways:</span></span>

- <span data-ttu-id="88703-110">**Paginación predeterminada** se puede implementar simplemente comprobando la opción Habilitar paginación en el control de Web s de datos de etiqueta inteligente; sin embargo, cuando ve una página de datos, recupera el ObjectDataSource *todos los* de registros, incluso Aunque solo un subconjunto de ellos se muestran en la página</span><span class="sxs-lookup"><span data-stu-id="88703-110">**Default Paging** can be implemented by simply checking the Enable Paging option in the data Web control s smart tag; however, whenever viewing a page of data, the ObjectDataSource retrieves *all* of the records, even though only a subset of them are displayed in the page</span></span>
- <span data-ttu-id="88703-111">**Paginación personalizada** mejora el rendimiento de manera predeterminada paginación al recuperar solo los registros de la base de datos que necesitan que se mostrará para la página concreta de los datos solicitados por el usuario; sin embargo, la paginación personalizada implica un poco más esfuerzo para implementar que la paginación de manera predeterminada</span><span class="sxs-lookup"><span data-stu-id="88703-111">**Custom Paging** improves the performance of default paging by retrieving only those records from the database that need to be displayed for the particular page of data requested by the user; however, custom paging involves a bit more effort to implement than default paging</span></span>

<span data-ttu-id="88703-112">Debido a la facilidad de comprobación de implementación solo una casilla de verificación y que se van a terminado.</span><span class="sxs-lookup"><span data-stu-id="88703-112">Due to the ease of implementation just check a checkbox and you re done!</span></span> <span data-ttu-id="88703-113">paginación predeterminada es una opción atractiva.</span><span class="sxs-lookup"><span data-stu-id="88703-113">default paging is an attractive option.</span></span> <span data-ttu-id="88703-114">Su enfoque de tegorías na recuperar todos los registros, sin embargo, resulta una opción plausible al paginar a través de suficientemente grandes cantidades de datos o para sitios con muchos usuarios simultáneos.</span><span class="sxs-lookup"><span data-stu-id="88703-114">Its na�ve approach in retrieving all of the records, though, makes it an implausible choice when paging through sufficiently large amounts of data or for sites with many concurrent users.</span></span> <span data-ttu-id="88703-115">En estas circunstancias, debemos activamos en personalizada con el fin de proporcionar un sistema eficaz de paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-115">In such circumstances, we must turn to custom paging in order to provide a responsive system.</span></span>

<span data-ttu-id="88703-116">El desafío de paginación personalizada es poder escribir una consulta que devuelve el conjunto de registros necesarios para una determinada página de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-116">The challenge of custom paging is being able to write a query that returns the precise set of records needed for a particular page of data.</span></span> <span data-ttu-id="88703-117">Afortunadamente, Microsoft SQL Server 2005 proporciona una nueva palabra clave para los resultados de clasificación, que permite escribir una consulta que puede recuperar el subconjunto correcto de registros de forma eficaz.</span><span class="sxs-lookup"><span data-stu-id="88703-117">Fortunately, Microsoft SQL Server 2005 provides a new keyword for ranking results, which enables us to write a query that can efficiently retrieve the proper subset of records.</span></span> <span data-ttu-id="88703-118">En este tutorial veremos cómo usar esta nueva palabra clave de SQL Server 2005 para implementar la paginación personalizada en un control GridView.</span><span class="sxs-lookup"><span data-stu-id="88703-118">In this tutorial we'll see how to use this new SQL Server 2005 keyword to implement custom paging in a GridView control.</span></span> <span data-ttu-id="88703-119">Mientras que es idéntica a la de paginación de forma predeterminada, ejecución paso a paso de una página a la siguiente mediante la interfaz de usuario de paginación personalizada paginación personalizada puede ser varias órdenes de magnitud más rápido que la paginación de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="88703-119">While the user interface for custom paging is identical to that for default paging, stepping from one page to the next using custom paging can be several orders of magnitude faster than default paging.</span></span>

> [!NOTE]
> <span data-ttu-id="88703-120">La ganancia de rendimiento exacto mostrada por la paginación personalizada depende del número total de registros que se va a paginar a través de y la carga que se ubican en el servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-120">The exact performance gain exhibited by custom paging depends on the total number of records being paged through and the load being placed on the database server.</span></span> <span data-ttu-id="88703-121">Al final de este tutorial analizaremos algunas métricas aproximadas que muestran las ventajas de rendimiento obtenido a través de la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="88703-121">At the end of this tutorial we'll look at some rough metrics that showcase the benefits in performance obtained through custom paging.</span></span>


## <a name="step-1-understanding-the-custom-paging-process"></a><span data-ttu-id="88703-122">Paso 1: Descripción del proceso de paginación personalizada</span><span class="sxs-lookup"><span data-stu-id="88703-122">Step 1: Understanding the Custom Paging Process</span></span>

<span data-ttu-id="88703-123">Al paginar a través de los datos, los registros precisos de una página dependen de la página de datos que se solicita y el número de registros mostrados por página.</span><span class="sxs-lookup"><span data-stu-id="88703-123">When paging through data, the precise records displayed in a page depend upon the page of data being requested and the number of records displayed per page.</span></span> <span data-ttu-id="88703-124">Por ejemplo, imagine que deseamos paginar a través de los 81 productos, mostrar los 10 productos más vendidos por página.</span><span class="sxs-lookup"><span data-stu-id="88703-124">For example, imagine that we wanted to page through the 81 products, displaying 10 products per page.</span></span> <span data-ttu-id="88703-125">Al ver la primera página, d queremos productos 1 a 10; al ver la segunda página se d esté interesado en 11 20 a través de productos y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="88703-125">When viewing the first page, we d want products 1 through 10; when viewing the second page we d be interested in products 11 through 20, and so on.</span></span>

<span data-ttu-id="88703-126">Hay tres variables que obliguen a lo que deben recuperarse de los registros y cómo se debe representar la interfaz de paginación:</span><span class="sxs-lookup"><span data-stu-id="88703-126">There are three variables that dictate what records need to be retrieved and how the paging interface should be rendered:</span></span>

- <span data-ttu-id="88703-127">**Índice de fila inicial** el índice de la primera fila en la página de datos que se va a mostrar; esto puede de índice se calcula multiplicando el índice de la página por los registros que se va a mostrar en cada página y agregar uno.</span><span class="sxs-lookup"><span data-stu-id="88703-127">**Start Row Index** the index of the first row in the page of data to display; this index can be calculated by multiplying the page index by the records to display per page and adding one.</span></span> <span data-ttu-id="88703-128">Por ejemplo, al paginar a través de registros de 10 a la vez, para la primera página (cuyo índice de la página es 0), el índice de fila inicial es 0 \* 10 + 1 ó 1; para la segunda página (cuyo índice de la página es 1), el índice de fila inicial es 1 \* 10 + 1 , o 11.</span><span class="sxs-lookup"><span data-stu-id="88703-128">For example, when paging through records 10 at a time, for the first page (whose page index is 0), the Start Row Index is 0 \* 10 + 1, or 1; for the second page (whose page index is 1), the Start Row Index is 1 \* 10 + 1, or 11.</span></span>
- <span data-ttu-id="88703-129">**Número máximo de filas** el número máximo de registros que se va a mostrar en cada página.</span><span class="sxs-lookup"><span data-stu-id="88703-129">**Maximum Rows** the maximum number of records to display per page.</span></span> <span data-ttu-id="88703-130">Esta variable se conoce como el número máximo de filas ya durante la última página se puede ser menos registros devueltos que el tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="88703-130">This variable is referred to as maximum rows since for the last page there may be fewer records returned than the page size.</span></span> <span data-ttu-id="88703-131">Por ejemplo, al paginar a través de los registros de 81 productos 10 por página, la página novena y final tendrá un solo registro.</span><span class="sxs-lookup"><span data-stu-id="88703-131">For example, when paging through the 81 products 10 records per page, the ninth and final page will have just one record.</span></span> <span data-ttu-id="88703-132">Sin embargo, no hay ninguna página mostrará más registros que el valor de número máximo de filas.</span><span class="sxs-lookup"><span data-stu-id="88703-132">No page, though, will show more records than the Maximum Rows value.</span></span>
- <span data-ttu-id="88703-133">**Número de registros total** el número total de registros que se va a paginar a través de.</span><span class="sxs-lookup"><span data-stu-id="88703-133">**Total Record Count** the total number of records being paged through.</span></span> <span data-ttu-id="88703-134">Aunque esta variable no es necesario para determinar qué registros para recuperar para una página determinada, indican la interfaz de paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-134">While this variable isn t needed to determine what records to retrieve for a given page, it does dictate the paging interface.</span></span> <span data-ttu-id="88703-135">Por ejemplo, si hay 81 productos que se va a paginar a través de, la interfaz de paginación sepa que puede para mostrar los nueve números de página en la interfaz de usuario de paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-135">For example, if there are 81 products being paged through, the paging interface knows to display nine page numbers in the paging UI.</span></span>

<span data-ttu-id="88703-136">Con la paginación de manera predeterminada, el índice de fila inicial se calcula como el producto del índice de la página y el tamaño de página más uno, mientras que el número máximo de filas es simplemente el tamaño de página.</span><span class="sxs-lookup"><span data-stu-id="88703-136">With default paging, the Start Row Index is computed as the product of the page index and the page size plus one, whereas the Maximum Rows is simply the page size.</span></span> <span data-ttu-id="88703-137">Puesto que la paginación predeterminada recupera todos los registros de la base de datos cuando se procesa cualquier página de datos, el índice para cada fila se conoce, haciéndolos móvil a la fila de índice de fila de iniciar una tarea trivial.</span><span class="sxs-lookup"><span data-stu-id="88703-137">Since default paging retrieves all of the records from the database when rendering any page of data, the index for each row is known, thereby making moving to Start Row Index row a trivial task.</span></span> <span data-ttu-id="88703-138">Además, el número Total de registros está disponible fácilmente, tal y como s simplemente el número de registros en la tabla de datos (o cualquier objeto se usa para almacenar los resultados de la base de datos).</span><span class="sxs-lookup"><span data-stu-id="88703-138">Moreover, the Total Record Count is readily available, as it s simply the number of records in the DataTable (or whatever object is being used to hold the database results).</span></span>

<span data-ttu-id="88703-139">Dado que las variables de índice de fila inicial y el número máximo de filas, una implementación de paginación personalizada debe devolver solo el subconjunto de registros empezando por el índice de fila inicial y hasta el número máximo de filas de registros después de precisa.</span><span class="sxs-lookup"><span data-stu-id="88703-139">Given the Start Row Index and Maximum Rows variables, a custom paging implementation must only return the precise subset of records starting at the Start Row Index and up to Maximum Rows number of records after that.</span></span> <span data-ttu-id="88703-140">Paginación personalizada proporciona dos desafíos:</span><span class="sxs-lookup"><span data-stu-id="88703-140">Custom paging provides two challenges:</span></span>

- <span data-ttu-id="88703-141">Debemos ser capaces de forma eficaz asociar un índice de fila a cada fila de todos los datos que se va a paginar a través de para que podamos comenzar a devolver los registros en el índice de fila de inicio especificado</span><span class="sxs-lookup"><span data-stu-id="88703-141">We must be able to efficiently associate a row index with each row in the entire data being paged through so that we can start returning records at the specified Start Row Index</span></span>
- <span data-ttu-id="88703-142">Es necesario proporcionar el número total de registros que se va a paginar a través de</span><span class="sxs-lookup"><span data-stu-id="88703-142">We need to provide the total number of records being paged through</span></span>

<span data-ttu-id="88703-143">En los dos pasos siguientes examinaremos la secuencia de comandos SQL necesaria para responder a estas dos desafíos.</span><span class="sxs-lookup"><span data-stu-id="88703-143">In the next two steps we'll examine the SQL script needed to respond to these two challenges.</span></span> <span data-ttu-id="88703-144">Además de la secuencia de comandos SQL, se necesitará implementar métodos en la capa DAL y BLL.</span><span class="sxs-lookup"><span data-stu-id="88703-144">In addition to the SQL script, we'll also need to implement methods in the DAL and BLL.</span></span>

## <a name="step-2-returning-the-total-number-of-records-being-paged-through"></a><span data-ttu-id="88703-145">Paso 2: Devolver el número Total de registros que se va a paginar a través de</span><span class="sxs-lookup"><span data-stu-id="88703-145">Step 2: Returning the Total Number of Records Being Paged Through</span></span>

<span data-ttu-id="88703-146">Antes de que se examina cómo recuperar el subconjunto de registros para que se va a mostrar la página preciso, permiten s primero observaremos cómo devolver el número total de registros que se va a paginar a través de.</span><span class="sxs-lookup"><span data-stu-id="88703-146">Before we examine how to retrieve the precise subset of records for the page being displayed, let s first look at how to return the total number of records being paged through.</span></span> <span data-ttu-id="88703-147">Esta información es necesaria para configurar correctamente la interfaz de usuario de paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-147">This information is needed in order to properly configure the paging user interface.</span></span> <span data-ttu-id="88703-148">El número total de registros devueltos por una consulta SQL determinada puede obtenerse mediante la [ `COUNT` función de agregado](https://msdn.microsoft.com/library/ms175997.aspx).</span><span class="sxs-lookup"><span data-stu-id="88703-148">The total number of records returned by a particular SQL query can be obtained by using the [`COUNT` aggregate function](https://msdn.microsoft.com/library/ms175997.aspx).</span></span> <span data-ttu-id="88703-149">Por ejemplo, para determinar el número total de registros en la `Products` tabla, podemos usar la consulta siguiente:</span><span class="sxs-lookup"><span data-stu-id="88703-149">For example, to determine the total number of records in the `Products` table, we can use the following query:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample1.sql)]

<span data-ttu-id="88703-150">Permitir s Agregar un método a nuestro DAL que devuelve esta información.</span><span class="sxs-lookup"><span data-stu-id="88703-150">Let s add a method to our DAL that returns this information.</span></span> <span data-ttu-id="88703-151">En concreto, vamos a crear un método de la capa DAL llamado `TotalNumberOfProducts()` que se ejecuta el `SELECT` instrucción mostrada anteriormente.</span><span class="sxs-lookup"><span data-stu-id="88703-151">In particular, we'll create a DAL method called `TotalNumberOfProducts()` that executes the `SELECT` statement shown above.</span></span>

<span data-ttu-id="88703-152">Comience abriendo la `Northwind.xsd` archivo de conjunto de datos con tipo en el `App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="88703-152">Start by opening the `Northwind.xsd` Typed DataSet file in the `App_Code/DAL` folder.</span></span> <span data-ttu-id="88703-153">A continuación, haga doble clic en el `ProductsTableAdapter` en el diseñador y elija Agregar consulta.</span><span class="sxs-lookup"><span data-stu-id="88703-153">Next, right-click on the `ProductsTableAdapter` in the Designer and choose Add Query.</span></span> <span data-ttu-id="88703-154">Como se ha visto en tutoriales anteriores, esto nos permitirá agregar un nuevo método a la capa DAL que, cuando se invoca, se ejecutará una instrucción SQL determinada o un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="88703-154">As we ve seen in previous tutorials, this will allow us to add a new method to the DAL that, when invoked, will execute a particular SQL statement or stored procedure.</span></span> <span data-ttu-id="88703-155">Al igual que con nuestros métodos de TableAdapter en tutoriales anteriores, para este optar por utilizar una instrucción de SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="88703-155">As with our TableAdapter methods in previous tutorials, for this one opt to use an ad-hoc SQL statement.</span></span>


![Utilizar una instrucción de SQL Ad Hoc](efficiently-paging-through-large-amounts-of-data-vb/_static/image1.png)

<span data-ttu-id="88703-157">**Figura 1**: utilizar una instrucción de SQL Ad Hoc</span><span class="sxs-lookup"><span data-stu-id="88703-157">**Figure 1**: Use an Ad-Hoc SQL Statement</span></span>


<span data-ttu-id="88703-158">En la siguiente pantalla se puede especificar qué tipo de consulta para crear.</span><span class="sxs-lookup"><span data-stu-id="88703-158">On the next screen we can specify what type of query to create.</span></span> <span data-ttu-id="88703-159">Puesto que esta consulta devolverá un único valor escalar el número total de registros en la `Products` Elegir tabla el `SELECT` que devuelve una opción de valor único.</span><span class="sxs-lookup"><span data-stu-id="88703-159">Since this query will return a single, scalar value the total number of records in the `Products` table choose the `SELECT` which returns a singe value option.</span></span>


![Configurar la consulta para utilizar una instrucción SELECT que devuelve un valor único](efficiently-paging-through-large-amounts-of-data-vb/_static/image2.png)

<span data-ttu-id="88703-161">**Figura 2**: configurar la consulta para utilizar una instrucción SELECT que devuelve un valor único</span><span class="sxs-lookup"><span data-stu-id="88703-161">**Figure 2**: Configure the Query to Use a SELECT Statement that Returns a Single Value</span></span>


<span data-ttu-id="88703-162">Después de que indica el tipo de consulta que se utilizará, debemos especificamos a continuación la consulta.</span><span class="sxs-lookup"><span data-stu-id="88703-162">After indicating the type of query to use, we must next specify the query.</span></span>


![Use el SELECT Count de consulta de productos](efficiently-paging-through-large-amounts-of-data-vb/_static/image3.png)

<span data-ttu-id="88703-164">**Figura 3**: usan el número de SELECT (\*) FROM productos consulta</span><span class="sxs-lookup"><span data-stu-id="88703-164">**Figure 3**: Use the SELECT COUNT(\*) FROM Products Query</span></span>


<span data-ttu-id="88703-165">Por último, especifique el nombre del método.</span><span class="sxs-lookup"><span data-stu-id="88703-165">Finally, specify the name for the method.</span></span> <span data-ttu-id="88703-166">Como s mencionado anteriormente, permiten usar `TotalNumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="88703-166">As aforementioned, let s use `TotalNumberOfProducts`.</span></span>


![Nombre del método de la capa DAL TotalNumberOfProducts](efficiently-paging-through-large-amounts-of-data-vb/_static/image4.png)

<span data-ttu-id="88703-168">**Figura 4**: nombre de la capa DAL método TotalNumberOfProducts</span><span class="sxs-lookup"><span data-stu-id="88703-168">**Figure 4**: Name the DAL Method TotalNumberOfProducts</span></span>


<span data-ttu-id="88703-169">Después de hacer clic en Finalizar, el asistente agregará la `TotalNumberOfProducts` método a la capa DAL.</span><span class="sxs-lookup"><span data-stu-id="88703-169">After clicking Finish, the wizard will add the `TotalNumberOfProducts` method to the DAL.</span></span> <span data-ttu-id="88703-170">Los métodos de devolución escalares en la capa DAL devuelven tipos que aceptan valores NULL, en caso de que el resultado de la consulta SQL es `NULL`.</span><span class="sxs-lookup"><span data-stu-id="88703-170">The scalar returning methods in the DAL return nullable types, in case the result from the SQL query is `NULL`.</span></span> <span data-ttu-id="88703-171">Nuestro `COUNT` consulta, sin embargo, siempre devolverá no`NULL` valor; en cualquier caso, el método de la capa DAL devuelve un entero que acepta valores NULL.</span><span class="sxs-lookup"><span data-stu-id="88703-171">Our `COUNT` query, however, will always return a non-`NULL` value; regardless, the DAL method returns a nullable integer.</span></span>

<span data-ttu-id="88703-172">Además del método de la capa DAL, también se necesita un método en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="88703-172">In addition to the DAL method, we also need a method in the BLL.</span></span> <span data-ttu-id="88703-173">Abra la `ProductsBLL` archivo de clase y agregue un `TotalNumberOfProducts` método que simplemente llama hacia abajo a la capa DAL s `TotalNumberOfProducts` método:</span><span class="sxs-lookup"><span data-stu-id="88703-173">Open the `ProductsBLL` class file and add a `TotalNumberOfProducts` method that simply calls down to the DAL s `TotalNumberOfProducts` method:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample2.vb)]

<span data-ttu-id="88703-174">Las operaciones de asignación DAL `TotalNumberOfProducts` método devuelve un entero que acepta valores NULL; sin embargo, se ha creado la `ProductsBLL` clase s. `TotalNumberOfProducts` método para que devuelva un entero estándar.</span><span class="sxs-lookup"><span data-stu-id="88703-174">The DAL s `TotalNumberOfProducts` method returns a nullable integer; however, we ve created the `ProductsBLL` class s `TotalNumberOfProducts` method so that it returns a standard integer.</span></span> <span data-ttu-id="88703-175">Por lo tanto, es necesario tener la `ProductsBLL` clase s `TotalNumberOfProducts` método devuelve la parte del valor del entero que acepta valores NULL devuelto por las operaciones de asignación DAL `TotalNumberOfProducts` método.</span><span class="sxs-lookup"><span data-stu-id="88703-175">Therefore, we need to have the `ProductsBLL` class s `TotalNumberOfProducts` method return the value portion of the nullable integer returned by the DAL s `TotalNumberOfProducts` method.</span></span> <span data-ttu-id="88703-176">La llamada a `GetValueOrDefault()` devuelve el valor del entero que acepta valores NULL, si existe; si el entero que acepta valores NULL es `null`, sin embargo, devuelve el valor de entero del valor predeterminado, 0.</span><span class="sxs-lookup"><span data-stu-id="88703-176">The call to `GetValueOrDefault()` returns the value of the nullable integer, if it exists; if the nullable integer is `null`, however, it returns the default integer value, 0.</span></span>

## <a name="step-3-returning-the-precise-subset-of-records"></a><span data-ttu-id="88703-177">Paso 3: Devolver el subconjunto preciso de registros</span><span class="sxs-lookup"><span data-stu-id="88703-177">Step 3: Returning the Precise Subset of Records</span></span>

<span data-ttu-id="88703-178">La siguiente tarea consiste en crear métodos en la capa DAL y BLL que aceptan el índice de fila inicial y las variables de número máximo de filas expuesto anteriormente y devuelvan los registros correspondientes.</span><span class="sxs-lookup"><span data-stu-id="88703-178">Our next task is to create methods in the DAL and BLL that accept the Start Row Index and Maximum Rows variables discussed earlier and return the appropriate records.</span></span> <span data-ttu-id="88703-179">Antes de hacerlo, permiten s busque primero en la secuencia de comandos SQL necesario.</span><span class="sxs-lookup"><span data-stu-id="88703-179">Before we do that, let s first look at the needed SQL script.</span></span> <span data-ttu-id="88703-180">El desafío nos encontramos es que debemos ser capaz de asignar eficazmente un índice para cada fila de todos los resultados que se va a paginar a través de para que podamos devolvemos aquellos registros empezando por el índice de fila inicial (y hasta el número máximo de registros de registros).</span><span class="sxs-lookup"><span data-stu-id="88703-180">The challenge facing us is that we must be able to efficiently assign an index to each row in the entire results being paged through so that we can return just those records starting at the Start Row Index (and up to the Maximum Records number of records).</span></span>

<span data-ttu-id="88703-181">Esto no es un desafío si ya existe una columna en la tabla de base de datos que actúa como un índice de fila.</span><span class="sxs-lookup"><span data-stu-id="88703-181">This is not a challenge if there is already a column in the database table that serves as a row index.</span></span> <span data-ttu-id="88703-182">A primera vista tengamos que creemos que la `Products` tabla s `ProductID` campo sería suficiente, ya que el primer producto tiene `ProductID` de 1, el segundo un 2, y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="88703-182">At first glance we might think that the `Products` table s `ProductID` field would suffice, as the first product has `ProductID` of 1, the second a 2, and so on.</span></span> <span data-ttu-id="88703-183">Sin embargo, la eliminación de un producto deja un espacio en la secuencia, anulando este enfoque.</span><span class="sxs-lookup"><span data-stu-id="88703-183">However, deleting a product leaves a gap in the sequence, nullifying this approach.</span></span>

<span data-ttu-id="88703-184">Hay dos técnicas generales que permiten asociar eficazmente un índice de fila a los datos a la página, lo que permite el subconjunto de registros que va a recuperar preciso:</span><span class="sxs-lookup"><span data-stu-id="88703-184">There are two general techniques used to efficiently associate a row index with the data to page through, thereby enabling the precise subset of records to be retrieved:</span></span>

- <span data-ttu-id="88703-185">**Con SQL Server 2005 s `ROW_NUMBER()` palabra clave** familiarizado con SQL Server 2005, la `ROW_NUMBER()` palabra clave asocia una clasificación de cada registro devuelto basándose en el orden de algunos.</span><span class="sxs-lookup"><span data-stu-id="88703-185">**Using SQL Server 2005 s `ROW_NUMBER()` Keyword** new to SQL Server 2005, the `ROW_NUMBER()` keyword associates a ranking with each returned record based on some ordering.</span></span> <span data-ttu-id="88703-186">Esta clasificación se puede usar como un índice de fila para cada fila.</span><span class="sxs-lookup"><span data-stu-id="88703-186">This ranking can be used as a row index for each row.</span></span>
- <span data-ttu-id="88703-187">**Usar una Variable de tabla y `SET ROWCOUNT`**  s de SQL Server [ `SET ROWCOUNT` instrucción](https://msdn.microsoft.com/library/ms188774.aspx) puede utilizarse para especificar el número total de registros debe procesar una consulta antes de terminar; [las variables de tabla](http://www.sqlteam.com/item.asp?ItemID=9454) son variables locales de T-SQL que pueden contener datos tabulares, akin a [tablas temporales](http://www.sqlteam.com/item.asp?ItemID=2029).</span><span class="sxs-lookup"><span data-stu-id="88703-187">**Using a Table Variable and `SET ROWCOUNT`** SQL Server s [`SET ROWCOUNT` statement](https://msdn.microsoft.com/library/ms188774.aspx) can be used to specify how many total records a query should process before terminating; [table variables](http://www.sqlteam.com/item.asp?ItemID=9454) are local T-SQL variables that can hold tabular data, akin to [temporary tables](http://www.sqlteam.com/item.asp?ItemID=2029).</span></span> <span data-ttu-id="88703-188">Este enfoque funciona igualmente bien con Microsoft SQL Server 2005 y SQL Server 2000 (mientras que el `ROW_NUMBER()` enfoque sólo funciona con SQL Server 2005).</span><span class="sxs-lookup"><span data-stu-id="88703-188">This approach works equally well with both Microsoft SQL Server 2005 and SQL Server 2000 (whereas the `ROW_NUMBER()` approach only works with SQL Server 2005).</span></span>  
  
  <span data-ttu-id="88703-189">La idea es crear una variable de tabla que tiene un `IDENTITY` y columnas para las claves principales de la tabla cuyos datos se envía un mensaje a través de.</span><span class="sxs-lookup"><span data-stu-id="88703-189">The idea here is to create a table variable that has an `IDENTITY` column and columns for the primary keys of the table whose data is being paged through.</span></span> <span data-ttu-id="88703-190">A continuación, se vuelca el contenido de la tabla cuyos datos se envía un mensaje a través de en la variable de tabla, con lo que se asocia un índice de fila secuenciales (a través de la `IDENTITY` columna) para cada registro en la tabla.</span><span class="sxs-lookup"><span data-stu-id="88703-190">Next, the contents of the table whose data is being paged through is dumped into the table variable, thereby associating a sequential row index (via the `IDENTITY` column) for each record in the table.</span></span> <span data-ttu-id="88703-191">Una vez que se ha rellenado la variable de tabla, un `SELECT` instrucción en la variable de tabla, se combina con la tabla subyacente, se puede ejecutar para extraer los registros determinados.</span><span class="sxs-lookup"><span data-stu-id="88703-191">Once the table variable has been populated, a `SELECT` statement on the table variable, joined with the underlying table, can be executed to pull out the particular records.</span></span> <span data-ttu-id="88703-192">El `SET ROWCOUNT` instrucción se utiliza para limitar el número de registros que necesita para realizar el volcado en la variable de tabla de forma inteligente.</span><span class="sxs-lookup"><span data-stu-id="88703-192">The `SET ROWCOUNT` statement is used to intelligently limit the number of records that need to be dumped into the table variable.</span></span>  
  
  <span data-ttu-id="88703-193">Esta eficacia enfoque s se basa en el número de página que se solicita, como la `SET ROWCOUNT` valor se asigna el valor de índice de fila inicial más el número máximo de filas.</span><span class="sxs-lookup"><span data-stu-id="88703-193">This approach s efficiency is based on the page number being requested, as the `SET ROWCOUNT` value is assigned the value of Start Row Index plus the Maximum Rows.</span></span> <span data-ttu-id="88703-194">Al paginar a través de páginas impares baja como la primera pocas páginas de datos de este enfoque es muy eficaz.</span><span class="sxs-lookup"><span data-stu-id="88703-194">When paging through low-numbered pages such as the first few pages of data this approach is very efficient.</span></span> <span data-ttu-id="88703-195">Sin embargo, exhibe performance de paginación de forma predeterminada cuando se recuperan de una página cuando se acerque el final.</span><span class="sxs-lookup"><span data-stu-id="88703-195">However, it exhibits default paging-like performance when retrieving a page near the end.</span></span>

<span data-ttu-id="88703-196">Este tutorial implementa la paginación personalizado con el `ROW_NUMBER()` palabra clave.</span><span class="sxs-lookup"><span data-stu-id="88703-196">This tutorial implements custom paging using the `ROW_NUMBER()` keyword.</span></span> <span data-ttu-id="88703-197">Para obtener más información sobre el uso de la variable de tabla y `SET ROWCOUNT` técnica, consulte [A varios eficaz métodos para paginar a través de grandes conjuntos de resultados](http://www.4guysfromrolla.com/webtech/042606-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="88703-197">For more information on using the table variable and `SET ROWCOUNT` technique, see [A More Efficient Method for Paging Through Large Result Sets](http://www.4guysfromrolla.com/webtech/042606-1.shtml).</span></span>

<span data-ttu-id="88703-198">El `ROW_NUMBER()` palabra clave asociada a una categoría cada registro devuelto en un orden concreto utilizando la sintaxis siguiente:</span><span class="sxs-lookup"><span data-stu-id="88703-198">The `ROW_NUMBER()` keyword associated a ranking with each record returned over a particular ordering using the following syntax:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample3.sql)]

<span data-ttu-id="88703-199">`ROW_NUMBER()` Devuelve un valor numérico que especifica el rango de cada registro con respecto a que el orden indicado.</span><span class="sxs-lookup"><span data-stu-id="88703-199">`ROW_NUMBER()` returns a numerical value that specifies the rank for each record with regards to the indicated ordering.</span></span> <span data-ttu-id="88703-200">Por ejemplo, para ver el rango de cada producto, ordenada de mayor cara a la menor, podríamos usar la siguiente consulta:</span><span class="sxs-lookup"><span data-stu-id="88703-200">For example, to see the rank for each product, ordered from the most expensive to the least, we could use the following query:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample4.sql)]

<span data-ttu-id="88703-201">Figura 5 se muestra esta consulta resultados de s cuando se ejecuta a través de la ventana de consulta en Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="88703-201">Figure 5 shows this query s results when run through the query window in Visual Studio.</span></span> <span data-ttu-id="88703-202">Tenga en cuenta que los productos se ordenan por precio, junto con un rango de precio para cada fila.</span><span class="sxs-lookup"><span data-stu-id="88703-202">Note that the products are ordered by price, along with a price rank for each row.</span></span>


![Se incluye el rango de precio para cada registro devuelto](efficiently-paging-through-large-amounts-of-data-vb/_static/image5.png)

<span data-ttu-id="88703-204">**Figura 5**: incluido el rango de precio de cada registro devuelto</span><span class="sxs-lookup"><span data-stu-id="88703-204">**Figure 5**: The Price Rank is Included for Each Returned Record</span></span>


> [!NOTE]
> <span data-ttu-id="88703-205">`ROW_NUMBER()` es simplemente una de las muchas nuevas funciones de clasificación disponibles en SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="88703-205">`ROW_NUMBER()` is just one of the many new ranking functions available in SQL Server 2005.</span></span> <span data-ttu-id="88703-206">Para obtener una explicación más exhaustiva de `ROW_NUMBER()`, junto con las demás funciones de clasificación, leer [devolver resultados clasificados con Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="88703-206">For a more thorough discussion of `ROW_NUMBER()`, along with the other ranking functions, read [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml).</span></span>


<span data-ttu-id="88703-207">Cuando los resultados de clasificación según los valores especificados `ORDER BY` columna en el `OVER` cláusula (`UnitPrice`, en el ejemplo anterior), SQL Server debe ordenar los resultados.</span><span class="sxs-lookup"><span data-stu-id="88703-207">When ranking the results by the specified `ORDER BY` column in the `OVER` clause (`UnitPrice`, in the above example), SQL Server must sort the results.</span></span> <span data-ttu-id="88703-208">Esto es una operación rápida si hay un índice clúster sobre las columnas que se va a se ordenan los resultados por, o si hay una cobertura de índice, pero puede ser más costoso en caso contrario.</span><span class="sxs-lookup"><span data-stu-id="88703-208">This is a quick operation if there is a clustered index over the column(s) the results are being ordered by, or if there is a covering index, but can be more costly otherwise.</span></span> <span data-ttu-id="88703-209">Con el fin de mejorar el rendimiento de las consultas lo suficientemente grandes, considere la posibilidad de agregar un índice no agrupado de la columna por la que los resultados se ordenan por.</span><span class="sxs-lookup"><span data-stu-id="88703-209">To help improve performance for sufficiently large queries, consider adding a non-clustered index for the column by which the results are ordered by.</span></span> <span data-ttu-id="88703-210">Vea [funciones de categoría y el rendimiento en SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) para obtener una visión más detallada en las consideraciones de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="88703-210">See [Ranking Functions and Performance in SQL Server 2005](http://www.sql-server-performance.com/ak_ranking_functions.asp) for a more detailed look at the performance considerations.</span></span>

<span data-ttu-id="88703-211">La información de clasificación devuelta por `ROW_NUMBER()` no se pueden usar directamente en el `WHERE` cláusula.</span><span class="sxs-lookup"><span data-stu-id="88703-211">The ranking information returned by `ROW_NUMBER()` cannot directly be used in the `WHERE` clause.</span></span> <span data-ttu-id="88703-212">Sin embargo, puede usarse una tabla derivada para devolver el `ROW_NUMBER()` resultado, que, a continuación, puede aparecer en el `WHERE` cláusula.</span><span class="sxs-lookup"><span data-stu-id="88703-212">However, a derived table can be used to return the `ROW_NUMBER()` result, which can then appear in the `WHERE` clause.</span></span> <span data-ttu-id="88703-213">Por ejemplo, la consulta siguiente utiliza una tabla derivada para devolver las columnas ProductName y UnitPrice, junto con el `ROW_NUMBER()` resultado y, a continuación, utiliza un `WHERE` cláusula para devolver únicamente los productos cuya clasificación precio es entre 11 y 20:</span><span class="sxs-lookup"><span data-stu-id="88703-213">For example, the following query uses a derived table to return the ProductName and UnitPrice columns, along with the `ROW_NUMBER()` result, and then uses a `WHERE` clause to only return those products whose price rank is between 11 and 20:</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample5.sql)]

<span data-ttu-id="88703-214">Extender un poco más este concepto, podemos utilizar este enfoque para recuperar una página específica de datos dados los valores de índice de fila inicial y el número máximo de filas deseados:</span><span class="sxs-lookup"><span data-stu-id="88703-214">Extending this concept a bit further, we can utilize this approach to retrieve a specific page of data given the desired Start Row Index and Maximum Rows values:</span></span>


[!code-html[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample6.html)]

> [!NOTE]
> <span data-ttu-id="88703-215">Como veremos más adelante en este tutorial, el *`StartRowIndex`* proporcionado por el ObjectDataSource se indiza empezando por cero, mientras que la `ROW_NUMBER()` valor devuelto por SQL Server 2005 se indiza empezando por 1.</span><span class="sxs-lookup"><span data-stu-id="88703-215">As we will see later on in this tutorial, the *`StartRowIndex`* supplied by the ObjectDataSource is indexed starting at zero, whereas the `ROW_NUMBER()` value returned by SQL Server 2005 is indexed starting at 1.</span></span> <span data-ttu-id="88703-216">Por lo tanto, la `WHERE` cláusula devuelve los registros donde `PriceRank` es estrictamente mayor que *`StartRowIndex`* y menor o igual que *`StartRowIndex`*  +  *`MaximumRows`*.</span><span class="sxs-lookup"><span data-stu-id="88703-216">Therefore, the `WHERE` clause returns those records where `PriceRank` is strictly greater than *`StartRowIndex`* and less than or equal to *`StartRowIndex`* + *`MaximumRows`*.</span></span>


<span data-ttu-id="88703-217">Ahora que nos ha explica cómo `ROW_NUMBER()` puede ser utilizado para recuperar una página determinada de dados los valores de índice de fila inicial y el número máximo de filas de datos, ahora debemos implementar esta lógica como métodos en la capa DAL y BLL.</span><span class="sxs-lookup"><span data-stu-id="88703-217">Now that we ve discussed how `ROW_NUMBER()` can be used to retrieve a particular page of data given the Start Row Index and Maximum Rows values, we now need to implement this logic as methods in the DAL and BLL.</span></span>

<span data-ttu-id="88703-218">Al crear esta consulta que debemos decidir la ordenación por el que los resultados se clasificará; permiten s ordenar los productos por su nombre en orden alfabético.</span><span class="sxs-lookup"><span data-stu-id="88703-218">When creating this query we must decide the ordering by which the results will be ranked; let s sort the products by their name in alphabetical order.</span></span> <span data-ttu-id="88703-219">Esto significa que con la implementación de paginación personalizada en este tutorial no se será capaz de crear un informe paginado personalizado que también se pueden ordenar.</span><span class="sxs-lookup"><span data-stu-id="88703-219">This means that with the custom paging implementation in this tutorial we will not be able to create a custom paged report than can also be sorted.</span></span> <span data-ttu-id="88703-220">En el tutorial siguiente, sin embargo, veremos cómo se puede proporcionar esta funcionalidad.</span><span class="sxs-lookup"><span data-stu-id="88703-220">In the next tutorial, though, we'll see how such functionality can be provided.</span></span>

<span data-ttu-id="88703-221">En la sección anterior, creamos el método DAL instrucción SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="88703-221">In the previous section we created the DAL method as an ad-hoc SQL statement.</span></span> <span data-ttu-id="88703-222">Desafortunadamente, el analizador de T-SQL en Visual Studio usa TableAdapter Asistente t como el `OVER` sintaxis utilizada por el `ROW_NUMBER()` (función).</span><span class="sxs-lookup"><span data-stu-id="88703-222">Unfortunately, the T-SQL parser in Visual Studio used by the TableAdapter wizard doesn t like the `OVER` syntax used by the `ROW_NUMBER()` function.</span></span> <span data-ttu-id="88703-223">Por lo tanto, este método DAL que debemos crear como un procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="88703-223">Therefore, we must create this DAL method as a stored procedure.</span></span> <span data-ttu-id="88703-224">Seleccione el Explorador de servidores desde el menú Ver (o el posicionamiento Ctrl + Alt + S) y expanda el `NORTHWND.MDF` nodo.</span><span class="sxs-lookup"><span data-stu-id="88703-224">Select the Server Explorer from the View menu (or hit Ctrl+Alt+S) and expand the `NORTHWND.MDF` node.</span></span> <span data-ttu-id="88703-225">Para agregar un nuevo procedimiento almacenado, haga doble clic en el nodo procedimientos almacenados y elija Agregar un nuevo procedimiento almacenado (consulte la figura 6).</span><span class="sxs-lookup"><span data-stu-id="88703-225">To add a new stored procedure, right-click on the Stored Procedures node and choose Add a New Stored Procedure (see Figure 6).</span></span>


![Agregar un nuevo procedimiento almacenado para la paginación a través de los productos](efficiently-paging-through-large-amounts-of-data-vb/_static/image6.png)

<span data-ttu-id="88703-227">**Figura 6**: agregar un nuevo procedimiento almacenado para la paginación a través de los productos</span><span class="sxs-lookup"><span data-stu-id="88703-227">**Figure 6**: Add a New Stored Procedure for Paging Through the Products</span></span>


<span data-ttu-id="88703-228">Este procedimiento almacenado debe aceptar dos parámetros de entrada enteros - `@startRowIndex` y `@maximumRows` y use la `ROW_NUMBER()` función ordenados por la `ProductName` campo, devolver sólo aquellas filas mayor que el especificado `@startRowIndex` y menor que o igual que `@startRowIndex`  +  `@maximumRow` s.</span><span class="sxs-lookup"><span data-stu-id="88703-228">This stored procedure should accept two integer input parameters - `@startRowIndex` and `@maximumRows` and use the `ROW_NUMBER()` function ordered by the `ProductName` field, returning only those rows greater than the specified `@startRowIndex` and less than or equal to `@startRowIndex` + `@maximumRow` s.</span></span> <span data-ttu-id="88703-229">Escriba el siguiente script en el nuevo procedimiento almacenado y, a continuación, haga clic en el icono de guardar para agregar el procedimiento almacenado a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-229">Enter the following script into the new stored procedure and then click the Save icon to add the stored procedure to the database.</span></span>


[!code-sql[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample7.sql)]

<span data-ttu-id="88703-230">Después de crear el procedimiento almacenado, tómese un momento para probarlo. Haga doble clic en el `GetProductsPaged` procedimiento almacenado un nombre en el Explorador de servidores y elija la opción de ejecución.</span><span class="sxs-lookup"><span data-stu-id="88703-230">After creating the stored procedure, take a moment to test it out. Right-click on the `GetProductsPaged` stored procedure name in the Server Explorer and choose the Execute option.</span></span> <span data-ttu-id="88703-231">Visual Studio le pedirá que, a continuación, para los parámetros de entrada, `@startRowIndex` y `@maximumRow` s (consulte la figura 7).</span><span class="sxs-lookup"><span data-stu-id="88703-231">Visual Studio will then prompt you for the input parameters, `@startRowIndex` and `@maximumRow` s (see Figure 7).</span></span> <span data-ttu-id="88703-232">Probar valores diferentes y examinar los resultados.</span><span class="sxs-lookup"><span data-stu-id="88703-232">Try different values and examine the results.</span></span>


![Escriba un valor para el @startRowIndex y @maximumRows parámetros](efficiently-paging-through-large-amounts-of-data-vb/_static/image7.png)

<span data-ttu-id="88703-234"><strong>Figura 7</strong>: escriba un valor para el @startRowIndex y @maximumRows parámetros</span><span class="sxs-lookup"><span data-stu-id="88703-234"><strong>Figure 7</strong>: Enter a Value for the @startRowIndex and @maximumRows Parameters</span></span>


<span data-ttu-id="88703-235">Después de elegir estos valores de parámetros de entrada, la ventana de salida muestra los resultados.</span><span class="sxs-lookup"><span data-stu-id="88703-235">After choosing these input parameters values, the Output window will show the results.</span></span> <span data-ttu-id="88703-236">La figura 8 muestra los resultados cuando se pasan en 10 tanto para el `@startRowIndex` y `@maximumRows` parámetros.</span><span class="sxs-lookup"><span data-stu-id="88703-236">Figure 8 shows the results when passing in 10 for both the `@startRowIndex` and `@maximumRows` parameters.</span></span>


<span data-ttu-id="88703-237">[![Se devuelven los registros que aparecería en la segunda página de datos](efficiently-paging-through-large-amounts-of-data-vb/_static/image9.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="88703-237">[![The Records That Would Appear in the Second Page of Data are Returned](efficiently-paging-through-large-amounts-of-data-vb/_static/image9.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image8.png)</span></span>

<span data-ttu-id="88703-238">**Figura 8**: los registros que aparecería en la segunda página de datos se devuelven ([haga clic aquí para ver la imagen a tamaño completo](efficiently-paging-through-large-amounts-of-data-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="88703-238">**Figure 8**: The Records That Would Appear in the Second Page of Data are Returned ([Click to view full-size image](efficiently-paging-through-large-amounts-of-data-vb/_static/image10.png))</span></span>


<span data-ttu-id="88703-239">Con este procedimiento almacenado creado, se re listo para crear el `ProductsTableAdapter` método.</span><span class="sxs-lookup"><span data-stu-id="88703-239">With this stored procedure created, we re ready to create the `ProductsTableAdapter` method.</span></span> <span data-ttu-id="88703-240">Abra la `Northwind.xsd` Typed DataSet, menú contextual en el `ProductsTableAdapter`y elija la opción de Agregar consulta.</span><span class="sxs-lookup"><span data-stu-id="88703-240">Open the `Northwind.xsd` Typed DataSet, right-click in the `ProductsTableAdapter`, and choose the Add Query option.</span></span> <span data-ttu-id="88703-241">En lugar de crear la consulta mediante una instrucción SQL ad hoc, crearlo mediante un procedimiento almacenado existente.</span><span class="sxs-lookup"><span data-stu-id="88703-241">Instead of creating the query using an ad-hoc SQL statement, create it using an existing stored procedure.</span></span>


![Cree el método de la capa DAL mediante un procedimiento almacenado existente](efficiently-paging-through-large-amounts-of-data-vb/_static/image11.png)

<span data-ttu-id="88703-243">**Figura 9**: crear el método de DAL mediante un procedimiento almacenado existente</span><span class="sxs-lookup"><span data-stu-id="88703-243">**Figure 9**: Create the DAL Method Using an Existing Stored Procedure</span></span>


<span data-ttu-id="88703-244">A continuación, se nos pide que seleccione el procedimiento almacenado para invocar.</span><span class="sxs-lookup"><span data-stu-id="88703-244">Next, we are prompted to select the stored procedure to invoke.</span></span> <span data-ttu-id="88703-245">Elegir el `GetProductsPaged` el procedimiento almacenado de la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="88703-245">Pick the `GetProductsPaged` stored procedure from the drop-down list.</span></span>


![Elija la GetProductsPaged el procedimiento almacenado de la lista desplegable](efficiently-paging-through-large-amounts-of-data-vb/_static/image12.png)

<span data-ttu-id="88703-247">**Figura 10**: elija la GetProductsPaged el procedimiento almacenado de la lista desplegable</span><span class="sxs-lookup"><span data-stu-id="88703-247">**Figure 10**: Choose the GetProductsPaged Stored Procedure from the Drop-Down List</span></span>


<span data-ttu-id="88703-248">La siguiente pantalla, a continuación, le pregunta qué tipo de datos devuelto por el procedimiento almacenado: datos tabulares, un valor único o ningún valor.</span><span class="sxs-lookup"><span data-stu-id="88703-248">The next screen then asks you what kind of data is returned by the stored procedure: tabular data, a single value, or no value.</span></span> <span data-ttu-id="88703-249">Puesto que la `GetProductsPaged` procedimiento almacenado puede devolver varios registros, indique que devuelve datos tabulares.</span><span class="sxs-lookup"><span data-stu-id="88703-249">Since the `GetProductsPaged` stored procedure can return multiple records, indicate that it returns tabular data.</span></span>


![Indicar que el procedimiento almacenado devuelve datos tabulares](efficiently-paging-through-large-amounts-of-data-vb/_static/image13.png)

<span data-ttu-id="88703-251">**Figura 11**: indica que el procedimiento almacenado devuelve datos tabulares</span><span class="sxs-lookup"><span data-stu-id="88703-251">**Figure 11**: Indicate that the Stored Procedure Returns Tabular Data</span></span>


<span data-ttu-id="88703-252">Por último, se indican los nombres de los métodos que desea crear.</span><span class="sxs-lookup"><span data-stu-id="88703-252">Finally, indicate the names of the methods you want to have created.</span></span> <span data-ttu-id="88703-253">Al igual que con nuestros tutoriales anteriores, continúe y crear un objeto DataTable de métodos que utilizan tanto el relleno y devolver un DataTable.</span><span class="sxs-lookup"><span data-stu-id="88703-253">As with our previous tutorials, go ahead and create methods using both the Fill a DataTable and Return a DataTable.</span></span> <span data-ttu-id="88703-254">El primer método el nombre `FillPaged` y el segundo `GetProductsPaged`.</span><span class="sxs-lookup"><span data-stu-id="88703-254">Name the first method `FillPaged` and the second `GetProductsPaged`.</span></span>


![Nombre de lo métodos FillPaged y GetProductsPaged](efficiently-paging-through-large-amounts-of-data-vb/_static/image14.png)

<span data-ttu-id="88703-256">**Figura 12**: nombre de lo métodos FillPaged y GetProductsPaged</span><span class="sxs-lookup"><span data-stu-id="88703-256">**Figure 12**: Name the Methods FillPaged and GetProductsPaged</span></span>


<span data-ttu-id="88703-257">Por otra parte para crear un método de la capa DAL para devolver una página determinada de productos, también es necesario proporcionar esta funcionalidad en la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="88703-257">In addition to created a DAL method to return a particular page of products, we also need to provide such functionality in the BLL.</span></span> <span data-ttu-id="88703-258">Como el método de la capa DAL, la s BLL GetProductsPaged método debe aceptar dos entradas de entero para especificar el índice de fila inicial y el número máximo de filas y debe devolver solo los registros que se encuentran dentro del intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="88703-258">Like the DAL method, the BLL s GetProductsPaged method must accept two integer inputs for specifying the Start Row Index and Maximum Rows, and must return just those records that fall within the specified range.</span></span> <span data-ttu-id="88703-259">Cree este tipo de método BLL en la clase ProductsBLL que simplemente llamadas hacia abajo en la s DAL GetProductsPaged método, de este modo:</span><span class="sxs-lookup"><span data-stu-id="88703-259">Create such a BLL method in the ProductsBLL class that merely calls down into the DAL s GetProductsPaged method, like so:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample8.vb)]

<span data-ttu-id="88703-260">Puede utilizar cualquier nombre para los parámetros de entrada de método s BLL, pero, como verá en breve, decide usar `startRowIndex` y `maximumRows` nos evita adicional de un poco de trabajo al configurar un ObjectDataSource para usar este método.</span><span class="sxs-lookup"><span data-stu-id="88703-260">You can use any name for the BLL method s input parameters, but, as we will see shortly, choosing to use `startRowIndex` and `maximumRows` saves us from an extra bit of work when configuring an ObjectDataSource to use this method.</span></span>

## <a name="step-4-configuring-the-objectdatasource-to-use-custom-paging"></a><span data-ttu-id="88703-261">Paso 4: Configurar el ObjectDataSource para utilizar la paginación personalizada</span><span class="sxs-lookup"><span data-stu-id="88703-261">Step 4: Configuring the ObjectDataSource to Use Custom Paging</span></span>

<span data-ttu-id="88703-262">Con los métodos BLL y DAL para tener acceso a un subconjunto específico de registros completados, se re listo para crear un control GridView controlan esa páginas a través de sus registros subyacentes mediante la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="88703-262">With the BLL and DAL methods for accessing a particular subset of records complete, we re ready to create a GridView control that pages through its underlying records using custom paging.</span></span> <span data-ttu-id="88703-263">Comience abriendo la `EfficientPaging.aspx` página en el `PagingAndSorting` carpeta, agregar un control GridView a la página y configurarlo para usar un nuevo control ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="88703-263">Start by opening the `EfficientPaging.aspx` page in the `PagingAndSorting` folder, add a GridView to the page, and configure it to use a new ObjectDataSource control.</span></span> <span data-ttu-id="88703-264">En los tutoriales anteriores, tuvimos a menudo ObjectDataSource configurado para usar el `ProductsBLL` clase s. `GetProducts` método.</span><span class="sxs-lookup"><span data-stu-id="88703-264">In our past tutorials, we often had the ObjectDataSource configured to use the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="88703-265">Esta vez, sin embargo, deseamos usar el `GetProductsPaged` método en su lugar, desde el `GetProducts` método devuelve *todos los* de los productos en la base de datos, mientras que `GetProductsPaged` devuelve solo un subconjunto específico de registros.</span><span class="sxs-lookup"><span data-stu-id="88703-265">This time, however, we want to use the `GetProductsPaged` method instead, since the `GetProducts` method returns *all* of the products in the database whereas `GetProductsPaged` returns just a particular subset of records.</span></span>


![Configurar el ObjectDataSource para utilizar el método de GetProductsPaged ProductsBLL clase s.](efficiently-paging-through-large-amounts-of-data-vb/_static/image15.png)

<span data-ttu-id="88703-267">**Figura 13**: configurar el ObjectDataSource para utilizar el método de GetProductsPaged ProductsBLL clase s.</span><span class="sxs-lookup"><span data-stu-id="88703-267">**Figure 13**: Configure the ObjectDataSource to Use the ProductsBLL Class s GetProductsPaged Method</span></span>


<span data-ttu-id="88703-268">Desde se re creando un GridView de solo lectura, tómese un momento para establecer la lista desplegable método en la instrucción INSERT, UPDATE y eliminar las fichas (ninguno).</span><span class="sxs-lookup"><span data-stu-id="88703-268">Since we re creating a read-only GridView, take a moment to set the method drop-down list in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>

<span data-ttu-id="88703-269">A continuación, el Asistente ObjectDataSource nos solicita para los orígenes de la `GetProductsPaged` método s `startRowIndex` y `maximumRows` valores de parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="88703-269">Next, the ObjectDataSource wizard prompts us for the sources of the `GetProductsPaged` method s `startRowIndex` and `maximumRows` input parameters values.</span></span> <span data-ttu-id="88703-270">Estos parámetros de entrada realmente se establecerá de GridView automáticamente, por lo que simplemente deje el juego de origen en ninguno y haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="88703-270">These input parameters will actually be set by the GridView automatically, so simply leave the source set to None and click Finish.</span></span>


![Deje los orígenes de parámetro de entrada como ninguno](efficiently-paging-through-large-amounts-of-data-vb/_static/image16.png)

<span data-ttu-id="88703-272">**Figura 14**: deje los orígenes de parámetro de entrada como ninguno</span><span class="sxs-lookup"><span data-stu-id="88703-272">**Figure 14**: Leave the Input Parameter Sources as None</span></span>


<span data-ttu-id="88703-273">Después de completar al Asistente de ObjectDataSource GridView contendrá un BoundField o CampoCasillaVerificación para cada uno de los campos de datos de producto.</span><span class="sxs-lookup"><span data-stu-id="88703-273">After completing the ObjectDataSource wizard, the GridView will contain a BoundField or CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="88703-274">Puede personalizar la apariencia de s GridView como considere oportuno.</span><span class="sxs-lookup"><span data-stu-id="88703-274">Feel free to tailor the GridView s appearance as you see fit.</span></span> <span data-ttu-id="88703-275">Se ha elegido para mostrar solamente el `ProductName`, `CategoryName`, `SupplierName`, `QuantityPerUnit`, y `UnitPrice` BoundFields.</span><span class="sxs-lookup"><span data-stu-id="88703-275">I ve opted to display only the `ProductName`, `CategoryName`, `SupplierName`, `QuantityPerUnit`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="88703-276">Además, configurar el control GridView para admitir paginación activando la casilla de verificación Habilitar paginación en su etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="88703-276">Also, configure the GridView to support paging by checking the Enable Paging checkbox in its smart tag.</span></span> <span data-ttu-id="88703-277">Después de estos cambios, el marcado declarativo GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88703-277">After these changes, the GridView and ObjectDataSource declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample9.aspx)]

<span data-ttu-id="88703-278">Si visita la página a través de un explorador, sin embargo, el control GridView es no donde se encuentre.</span><span class="sxs-lookup"><span data-stu-id="88703-278">If you visit the page through a browser, however, the GridView is no where to be found.</span></span>


![GridView no es aparece](efficiently-paging-through-large-amounts-of-data-vb/_static/image17.png)

<span data-ttu-id="88703-280">**Figura 15**: The GridView no es aparece</span><span class="sxs-lookup"><span data-stu-id="88703-280">**Figure 15**: The GridView is Not Displayed</span></span>


<span data-ttu-id="88703-281">GridView es falta porque el ObjectDataSource está utilizando actualmente 0 como valores para ambas la `GetProductsPaged` `startRowIndex` y `maximumRows` parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="88703-281">The GridView is missing because the ObjectDataSource is currently using 0 as the values for both of the `GetProductsPaged` `startRowIndex` and `maximumRows` input parameters.</span></span> <span data-ttu-id="88703-282">Por lo tanto, la consulta SQL resultante es que no devuelve ningún registro y, por tanto, no se muestra el control GridView.</span><span class="sxs-lookup"><span data-stu-id="88703-282">Hence, the resulting SQL query is returning no records and therefore the GridView is not displayed.</span></span>

<span data-ttu-id="88703-283">Para solucionar esto, es necesario configurar el ObjectDataSource para utilizar la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="88703-283">To remedy this, we need to configure the ObjectDataSource to use custom paging.</span></span> <span data-ttu-id="88703-284">Esto puede realizarse en los pasos siguientes:</span><span class="sxs-lookup"><span data-stu-id="88703-284">This can be accomplished in the following steps:</span></span>

1. <span data-ttu-id="88703-285">**Establecer la s ObjectDataSource `EnablePaging` propiedad `true`**  esto indica a ObjectDataSource que debe pasar a la `SelectMethod` dos parámetros adicionales: uno para especificar el índice de fila inicial ([ `StartRowIndexParameterName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.startrowindexparametername.aspx)) y otra para especificar el número máximo de filas ([`MaximumRowsParameterName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.maximumrowsparametername.aspx)).</span><span class="sxs-lookup"><span data-stu-id="88703-285">**Set the ObjectDataSource s `EnablePaging` property to `true`** this indicates to the ObjectDataSource that it must pass to the `SelectMethod` two additional parameters: one to specify the Start Row Index ([`StartRowIndexParameterName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.startrowindexparametername.aspx)), and one to specify the Maximum Rows ([`MaximumRowsParameterName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.maximumrowsparametername.aspx)).</span></span>
2. <span data-ttu-id="88703-286">**Establecer la s ObjectDataSource `StartRowIndexParameterName` y `MaximumRowsParameterName` propiedades según corresponda** el `StartRowIndexParameterName` y `MaximumRowsParameterName` propiedades indican los nombres de los parámetros de entrada que pasan a la `SelectMethod` para fines de paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="88703-286">**Set the ObjectDataSource s `StartRowIndexParameterName` and `MaximumRowsParameterName` Properties Accordingly** the `StartRowIndexParameterName` and `MaximumRowsParameterName` properties indicate the names of the input parameters passed into the `SelectMethod` for custom paging purposes.</span></span> <span data-ttu-id="88703-287">De forma predeterminada, estos nombres de parámetro son `startIndexRow` y `maximumRows`, que es por este motivo, al crear el `GetProductsPaged` método en el BLL, usé estos valores para los parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="88703-287">By default, these parameter names are `startIndexRow` and `maximumRows`, which is why, when creating the `GetProductsPaged` method in the BLL, I used these values for the input parameters.</span></span> <span data-ttu-id="88703-288">Si decide utilizar nombres de parámetro diferente para las operaciones de asignación BLL `GetProductsPaged` método como `startIndex` y `maxRows`, por ejemplo tendría que establecer la s ObjectDataSource `StartRowIndexParameterName` y `MaximumRowsParameterName` propiedades según corresponda (por ejemplo, startIndex para `StartRowIndexParameterName` y maxRows para `MaximumRowsParameterName`).</span><span class="sxs-lookup"><span data-stu-id="88703-288">If you chose to use different parameter names for the BLL s `GetProductsPaged` method such as `startIndex` and `maxRows`, for example you would need to set the ObjectDataSource s `StartRowIndexParameterName` and `MaximumRowsParameterName` properties accordingly (such as startIndex for `StartRowIndexParameterName` and maxRows for `MaximumRowsParameterName`).</span></span>
3. <span data-ttu-id="88703-289">**Establecer la s ObjectDataSource [ `SelectCountMethod` propiedad](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selectcountmethod(VS.80).aspx) en el nombre del método que devuelve el Total número de registros que se va a paginar a través de (`TotalNumberOfProducts`)** Recuerde que la `ProductsBLL` clase s `TotalNumberOfProducts`método devuelve el número total de registros que se va a paginar a través de un método de la capa DAL que ejecuta un `SELECT COUNT(*) FROM Products` consulta.</span><span class="sxs-lookup"><span data-stu-id="88703-289">**Set the ObjectDataSource s [`SelectCountMethod` Property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selectcountmethod(VS.80).aspx) to the Name of the Method that Returns the Total Number of Records Being Paged Through (`TotalNumberOfProducts`)** recall that the `ProductsBLL` class s `TotalNumberOfProducts` method returns the total number of records being paged through using a DAL method that executes a `SELECT COUNT(*) FROM Products` query.</span></span> <span data-ttu-id="88703-290">Esta información es necesaria por el ObjectDataSource para representar correctamente la interfaz de paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-290">This information is needed by the ObjectDataSource in order to correctly render the paging interface.</span></span>
4. <span data-ttu-id="88703-291">**Quitar el `startRowIndex` y `maximumRows` `<asp:Parameter>` elementos desde el marcado declarativo de ObjectDataSource s** al configurar el ObjectDataSource a través del asistente, Visual Studio agrega automáticamente dos `<asp:Parameter>` elementos para el `GetProductsPaged` método s parámetros de entrada.</span><span class="sxs-lookup"><span data-stu-id="88703-291">**Remove the `startRowIndex` and `maximumRows` `<asp:Parameter>` Elements from the ObjectDataSource s Declarative Markup** when configuring the ObjectDataSource through the wizard, Visual Studio automatically added two `<asp:Parameter>` elements for the `GetProductsPaged` method s input parameters.</span></span> <span data-ttu-id="88703-292">Estableciendo `EnablePaging` a `true`, estos parámetros se pasará automáticamente; si también aparecen en la sintaxis declarativa, ObjectDataSource intentar pasar *cuatro* parámetros para el `GetProductsPaged` (método) y dos parámetros para el `TotalNumberOfProducts` método.</span><span class="sxs-lookup"><span data-stu-id="88703-292">By setting `EnablePaging` to `true`, these parameters will be passed automatically; if they also appear in the declarative syntax, the ObjectDataSource will attempt to pass *four* parameters to the `GetProductsPaged` method and two parameters to the `TotalNumberOfProducts` method.</span></span> <span data-ttu-id="88703-293">Si se olvida de quitar estos `<asp:Parameter>` elementos, al visitar la página a través de un explorador que se obtendrá un mensaje de error como: *ObjectDataSource 'ObjectDataSource1' no encontró un método no genérico 'TotalNumberOfProducts' que tiene parámetros: startRowIndex, maximumRows*.</span><span class="sxs-lookup"><span data-stu-id="88703-293">If you forget to remove these `<asp:Parameter>` elements, when visiting the page through a browser you'll get an error message like: *ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'TotalNumberOfProducts' that has parameters: startRowIndex, maximumRows*.</span></span>

<span data-ttu-id="88703-294">Después de realizar estos cambios, la sintaxis declarativa de ObjectDataSource s debería ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88703-294">After making these changes, the ObjectDataSource s declarative syntax should look like the following:</span></span>


[!code-aspx[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample10.aspx)]

<span data-ttu-id="88703-295">Tenga en cuenta que la `EnablePaging` y `SelectCountMethod` se han establecido propiedades y `<asp:Parameter>` elementos se han quitado.</span><span class="sxs-lookup"><span data-stu-id="88703-295">Note that the `EnablePaging` and `SelectCountMethod` properties have been set and the `<asp:Parameter>` elements have been removed.</span></span> <span data-ttu-id="88703-296">La figura 16 muestra una captura de pantalla de la ventana Propiedades una vez realizados estos cambios.</span><span class="sxs-lookup"><span data-stu-id="88703-296">Figure 16 shows a screen shot of the Properties window after these changes have been made.</span></span>


![Para utilizar la paginación personalizada, configurar el Control ObjectDataSource](efficiently-paging-through-large-amounts-of-data-vb/_static/image18.png)

<span data-ttu-id="88703-298">**Figura 16**: para utilizar la paginación personalizada, configurar el Control ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="88703-298">**Figure 16**: To Use Custom Paging, Configure the ObjectDataSource Control</span></span>


<span data-ttu-id="88703-299">Después de realizar estos cambios, visite esta página a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="88703-299">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="88703-300">Debería ver los 10 productos de la lista, ordenadas alfabéticamente.</span><span class="sxs-lookup"><span data-stu-id="88703-300">You should see 10 products listed, ordered alphabetically.</span></span> <span data-ttu-id="88703-301">Tómese un momento para recorrer la datos página a la vez.</span><span class="sxs-lookup"><span data-stu-id="88703-301">Take a moment to step through the data one page at a time.</span></span> <span data-ttu-id="88703-302">Aunque no hay ninguna diferencia visual desde la perspectiva del usuario final s entre paginación predeterminada y la paginación personalizada, más eficazmente la paginación personalizada páginas a través de grandes cantidades de datos, ya que sólo recupera los registros que deben mostrarse para una página determinada.</span><span class="sxs-lookup"><span data-stu-id="88703-302">While there is no visual difference from the end user s perspective between default paging and custom paging, custom paging more efficiently pages through large amounts of data as it only retrieves those records that need to be displayed for a given page.</span></span>


<span data-ttu-id="88703-303">[![Los datos, ordenados por el producto es nombre, está paginado utilizando paginación personalizada](efficiently-paging-through-large-amounts-of-data-vb/_static/image20.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="88703-303">[![The Data, Ordered by the Product s Name, is Paged Using Custom Paging](efficiently-paging-through-large-amounts-of-data-vb/_static/image20.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image19.png)</span></span>

<span data-ttu-id="88703-304">**Figura 17**: los datos, ordenados por el producto es nombre, está paginado utilizando paginación personalizada ([haga clic aquí para ver la imagen a tamaño completo](efficiently-paging-through-large-amounts-of-data-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="88703-304">**Figure 17**: The Data, Ordered by the Product s Name, is Paged Using Custom Paging ([Click to view full-size image](efficiently-paging-through-large-amounts-of-data-vb/_static/image21.png))</span></span>


> [!NOTE]
> <span data-ttu-id="88703-305">Con la paginación personalizada, la página de recuento de valor devuelto por las operaciones de asignación ObjectDataSource `SelectCountMethod` se almacena en el estado de vista de s de GridView.</span><span class="sxs-lookup"><span data-stu-id="88703-305">With custom paging, the page count value returned by the ObjectDataSource�s `SelectCountMethod` is stored in the GridView�s view state.</span></span> <span data-ttu-id="88703-306">Otras variables de GridView el `PageIndex`, `EditIndex`, `SelectedIndex`, `DataKeys` colección y así sucesivamente se almacenan en *el estado de control*, que se mantiene independientemente del valor de las operaciones de asignación GridView `EnableViewState` propiedad.</span><span class="sxs-lookup"><span data-stu-id="88703-306">Other GridView variables the `PageIndex`, `EditIndex`, `SelectedIndex`, `DataKeys` collection, and so on are stored in *control state*, which is persisted regardless of the value of the GridView�s `EnableViewState` property.</span></span> <span data-ttu-id="88703-307">Puesto que el `PageCount` valor se conserva entre las devoluciones de datos usando el estado de vista, cuando se usa una interfaz de paginación que incluye un vínculo para ir a la última página, es imperativo que esté habilitado el estado de vista de s de GridView.</span><span class="sxs-lookup"><span data-stu-id="88703-307">Since the `PageCount` value is persisted across postbacks using view state, when using a paging interface that includes a link to take you to the last page, it is imperative that the GridView�s view state be enabled.</span></span> <span data-ttu-id="88703-308">(Si la interfaz de paginación no incluye un vínculo directo a la última página, a continuación, puede deshabilitar el estado de vista).</span><span class="sxs-lookup"><span data-stu-id="88703-308">(If your paging interface does not include a direct link to the last page, then you may disable view state.)</span></span>


<span data-ttu-id="88703-309">Haga clic en el último vínculo de página provoca una devolución de datos e indica a la GridView para actualizar su `PageIndex` propiedad.</span><span class="sxs-lookup"><span data-stu-id="88703-309">Clicking the last page link causes a postback and instructs the GridView to update its `PageIndex` property.</span></span> <span data-ttu-id="88703-310">Si se hace clic en el último vínculo de página, el control GridView asigna su `PageIndex` propiedad con un valor uno menor que su `PageCount` propiedad.</span><span class="sxs-lookup"><span data-stu-id="88703-310">If the last page link is clicked, the GridView assigns its `PageIndex` property to a value one less than its `PageCount` property.</span></span> <span data-ttu-id="88703-311">Con estado de vista deshabilitado, la `PageCount` valor se pierde en las devoluciones y `PageIndex` se asigna el valor entero máximo en su lugar.</span><span class="sxs-lookup"><span data-stu-id="88703-311">With view state disabled, the `PageCount` value is lost across postbacks and the `PageIndex` is assigned the maximum integer value instead.</span></span> <span data-ttu-id="88703-312">A continuación, el control GridView intenta determinar el índice de fila inicial multiplicando el `PageSize` y `PageCount` propiedades.</span><span class="sxs-lookup"><span data-stu-id="88703-312">Next, the GridView attempts to determine the starting row index by multiplying the `PageSize` and `PageCount` properties.</span></span> <span data-ttu-id="88703-313">Esto da como resultado un `OverflowException` ya que el producto supera el tamaño máximo entero permitido.</span><span class="sxs-lookup"><span data-stu-id="88703-313">This results in an `OverflowException` since the product exceeds the maximum allowed integer size.</span></span>

## <a name="implement-custom-paging-and-sorting"></a><span data-ttu-id="88703-314">Implemente la paginación personalizada y la ordenación</span><span class="sxs-lookup"><span data-stu-id="88703-314">Implement Custom Paging and Sorting</span></span>

<span data-ttu-id="88703-315">Nuestra implementación de paginación personalizada actual requiere que se especifique el orden por el que se paginan los datos a través de forma estática al crear la `GetProductsPaged` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="88703-315">Our current custom paging implementation requires that the order by which the data is paged through be specified statically when creating the `GetProductsPaged` stored procedure.</span></span> <span data-ttu-id="88703-316">Sin embargo, puede haber tomado nota de que la etiqueta inteligente de GridView s contiene una casilla de verificación Habilitar ordenación además de la opción de habilitar la paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-316">However, you may have noted that the GridView s smart tag contains an Enable Sorting checkbox in addition to the Enable Paging option.</span></span> <span data-ttu-id="88703-317">Por desgracia, agregar compatibilidad con la ordenación a la GridView con nuestra implementación de paginación personalizada actual, solo se ordenarán los registros en la página de datos está viendo actualmente.</span><span class="sxs-lookup"><span data-stu-id="88703-317">Unfortunately, adding sorting support to the GridView with our current custom paging implementation will only sort the records on the currently viewed page of data.</span></span> <span data-ttu-id="88703-318">Por ejemplo, si configura el control GridView para también admitir paginación y, a continuación, al ver la primera página de datos, ordenar por nombre de producto en orden descendente, invertirá el orden de los productos en la página 1.</span><span class="sxs-lookup"><span data-stu-id="88703-318">For example, if you configure the GridView to also support paging and then, when viewing the first page of data, sort by product name in descending order, it will reverse the order of the products on page 1.</span></span> <span data-ttu-id="88703-319">Como se muestra en la figura 18, por ejemplo, muestra tigre Carnarvon como el primer producto al ordenar en orden alfabético inverso, que omite 71 otros productos que venga después tigre Carnarvon, por orden alfabético; solo los registros en la primera página se consideran en la ordenación.</span><span class="sxs-lookup"><span data-stu-id="88703-319">As Figure 18 shows, such shows Carnarvon Tigers as the first product when sorting in reverse alphabetical order, which ignores the 71 other products that come after Carnarvon Tigers, alphabetically; only those records on the first page are considered in the sorting.</span></span>


<span data-ttu-id="88703-320">[![Solo los datos se muestran en la página actual está ordenada](efficiently-paging-through-large-amounts-of-data-vb/_static/image23.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="88703-320">[![Only the Data Shown on the Current Page is Sorted](efficiently-paging-through-large-amounts-of-data-vb/_static/image23.png)](efficiently-paging-through-large-amounts-of-data-vb/_static/image22.png)</span></span>

<span data-ttu-id="88703-321">**Figura 18**: solo los datos se muestran en la página actual se ordena ([haga clic aquí para ver la imagen a tamaño completo](efficiently-paging-through-large-amounts-of-data-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="88703-321">**Figure 18**: Only the Data Shown on the Current Page is Sorted ([Click to view full-size image](efficiently-paging-through-large-amounts-of-data-vb/_static/image24.png))</span></span>


<span data-ttu-id="88703-322">La ordenación sólo se aplica a la página actual de datos porque la ordenación se está produciendo una vez recuperados los datos de las operaciones de asignación BLL `GetProductsPaged` método y este método solo devuelve los registros de la página específica.</span><span class="sxs-lookup"><span data-stu-id="88703-322">The sorting only applies to the current page of data because the sorting is occurring after the data has been retrieved from the BLL s `GetProductsPaged` method, and this method only returns those records for the specific page.</span></span> <span data-ttu-id="88703-323">Para implementar correctamente una ordenación, es necesario pasar la expresión de ordenación para el `GetProductsPaged` método para que los datos se pueden clasificar adecuadamente antes de devolver la página específica de los datos.</span><span class="sxs-lookup"><span data-stu-id="88703-323">To implement sorting correctly, we need to pass the sort expression to the `GetProductsPaged` method so that the data can be ranked appropriately before returning the specific page of data.</span></span> <span data-ttu-id="88703-324">Veremos cómo hacerlo en nuestro tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="88703-324">We'll see how to accomplish this in our next tutorial.</span></span>

## <a name="implementing-custom-paging-and-deleting"></a><span data-ttu-id="88703-325">Implementación personalizada de paginación y eliminar</span><span class="sxs-lookup"><span data-stu-id="88703-325">Implementing Custom Paging and Deleting</span></span>

<span data-ttu-id="88703-326">Si es habilitar la funcionalidad de eliminación en un control GridView cuyos datos se paginan mediante técnicas de paginación personalizada que encontrará al eliminar el último registro de la última página, GridView desaparece en lugar de disminuir de forma adecuada la s de GridView `PageIndex`.</span><span class="sxs-lookup"><span data-stu-id="88703-326">If you enabling deleting functionality in a GridView whose data is paged using custom paging techniques you will find that when deleting the last record from the last page, the GridView disappears rather than appropriately decrementing the GridView s `PageIndex`.</span></span> <span data-ttu-id="88703-327">Para reproducir este error, habilitar la eliminación para el tutorial simplemente que acabamos de crear.</span><span class="sxs-lookup"><span data-stu-id="88703-327">To reproduce this bug, enable deleting for the tutorial just we just created.</span></span> <span data-ttu-id="88703-328">Vaya a la última página (9), donde debería ver un único producto ya que nos estamos paginar a través de 81 productos, 10 productos a la vez.</span><span class="sxs-lookup"><span data-stu-id="88703-328">Go to the last page (page 9), where you should see a single product since we are paging through 81 products, 10 products at a time.</span></span> <span data-ttu-id="88703-329">Eliminar este producto.</span><span class="sxs-lookup"><span data-stu-id="88703-329">Delete this product.</span></span>

<span data-ttu-id="88703-330">Cuando se elimina el último producto, GridView *debe* ir automáticamente a la página octava y esta funcionalidad se logran con paginación predeterminada.</span><span class="sxs-lookup"><span data-stu-id="88703-330">Upon deleting the last product, the GridView *should* automatically go to the eighth page, and such functionality is exhibited with default paging.</span></span> <span data-ttu-id="88703-331">Con la paginación personalizada, sin embargo, después de eliminar ese producto en la última página, última GridView simplemente desaparece de la pantalla por completo.</span><span class="sxs-lookup"><span data-stu-id="88703-331">With custom paging, however, after deleting that last product on the last page, the GridView simply disappears from the screen altogether.</span></span> <span data-ttu-id="88703-332">El motivo exacto *¿por qué* esto sucede es un poco más allá del ámbito de este tutorial, consulte [eliminar el último registro de la última página de un control GridView con paginación personalizada](http://scottonwriting.net/sowblog/posts/7326.aspx) para obtener los detalles de bajo nivel en cuanto a la fuente de Este problema.</span><span class="sxs-lookup"><span data-stu-id="88703-332">The precise reason *why* this happens is a bit beyond the scope of this tutorial; see [Deleting the Last Record on the Last Page from a GridView with Custom Paging](http://scottonwriting.net/sowblog/posts/7326.aspx) for the low-level details as to the source of this problem.</span></span> <span data-ttu-id="88703-333">En resumen, s debido a la siguiente secuencia de pasos que se realizan mediante el control GridView cuando se hace clic en el botón Eliminar:</span><span class="sxs-lookup"><span data-stu-id="88703-333">In summary it s due to the following sequence of steps that are performed by the GridView when the Delete button is clicked:</span></span>

1. <span data-ttu-id="88703-334">Eliminar el registro</span><span class="sxs-lookup"><span data-stu-id="88703-334">Delete the record</span></span>
2. <span data-ttu-id="88703-335">Obtener los registros adecuados para mostrar para el elemento especificado `PageIndex` y `PageSize`</span><span class="sxs-lookup"><span data-stu-id="88703-335">Get the appropriate records to display for the specified `PageIndex` and `PageSize`</span></span>
3. <span data-ttu-id="88703-336">Asegúrese de que el `PageIndex` no supera el número de páginas de datos en el origen de datos; si lo automáticamente, disminuir la s GridView `PageIndex` propiedad</span><span class="sxs-lookup"><span data-stu-id="88703-336">Check to ensure that the `PageIndex` does not exceed the number of pages of data in the data source; if it does, automatically decrement the GridView s `PageIndex` property</span></span>
4. <span data-ttu-id="88703-337">Enlazar la página apropiada de los datos en GridView con los registros obtenidos en el paso 2</span><span class="sxs-lookup"><span data-stu-id="88703-337">Bind the appropriate page of data to the GridView using the records obtained in Step 2</span></span>

<span data-ttu-id="88703-338">El problema proviene del hecho de ese paso 2 en el `PageIndex` utiliza al arrastrar los registros que se va a mostrar sigue siendo el `PageIndex` de la última página cuyo registro único solo se ha eliminado.</span><span class="sxs-lookup"><span data-stu-id="88703-338">The problem stems from the fact that in Step 2 the `PageIndex` used when grabbing the records to display is still the `PageIndex` of the last page whose sole record was just deleted.</span></span> <span data-ttu-id="88703-339">Por lo tanto, en el paso 2, *no* se devuelven registros desde esa última página de datos ya no contiene ningún registro.</span><span class="sxs-lookup"><span data-stu-id="88703-339">Therefore, in Step 2, *no* records are returned since that last page of data no longer contains any records.</span></span> <span data-ttu-id="88703-340">A continuación, en el paso 3, GridView es consciente de que su `PageIndex` propiedad es mayor que el número total de páginas en el origen de datos (desde que se ha eliminado el último registro de la última página) y, por tanto, disminuye su `PageIndex` propiedad.</span><span class="sxs-lookup"><span data-stu-id="88703-340">Then, in Step 3, the GridView realizes that its `PageIndex` property is greater than the total number of pages in the data source (since we ve deleted the last record in the last page) and therefore decrements its `PageIndex` property.</span></span> <span data-ttu-id="88703-341">En el paso 4 GridView intenta enlazar a los datos recuperados en el paso 2; Sin embargo, en el paso 2 no se han devuelto registros, lo que un GridView vacía.</span><span class="sxs-lookup"><span data-stu-id="88703-341">In Step 4 the GridView attempts to bind itself to the data retrieved in Step 2; however, in Step 2 no records were returned, therefore resulting in an empty GridView.</span></span> <span data-ttu-id="88703-342">Con la paginación de manera predeterminada, este problema tipo t superficie porque en el paso 2 *todos los* se recuperan los registros del origen de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-342">With default paging, this problem doesn t surface because in Step 2 *all* records are retrieved from the data source.</span></span>

<span data-ttu-id="88703-343">Para solucionar este problema, se tiene dos opciones.</span><span class="sxs-lookup"><span data-stu-id="88703-343">To fix this we have two options.</span></span> <span data-ttu-id="88703-344">La primera consiste en crear un controlador de eventos para el s GridView `RowDeleted` controlador de eventos que determina el número de registros se muestra en la página que acaba de eliminar.</span><span class="sxs-lookup"><span data-stu-id="88703-344">The first is to create an event handler for the GridView s `RowDeleted` event handler that determines how many records were displayed in the page that was just deleted.</span></span> <span data-ttu-id="88703-345">Si se produjo un único registro, a continuación, el registro eliminado solo debe haber sido la última de ellas y necesitamos reducir las operaciones de asignación GridView `PageIndex`.</span><span class="sxs-lookup"><span data-stu-id="88703-345">If there was only one record, then the record just deleted must have been the last one and we need to decrement the GridView s `PageIndex`.</span></span> <span data-ttu-id="88703-346">Por supuesto, solamente queremos actualizar la `PageIndex` si la operación de eliminación fue realmente correcta, que se puede determinar asegurándose de que el `e.Exception` propiedad es `null`.</span><span class="sxs-lookup"><span data-stu-id="88703-346">Of course, we only want to update the `PageIndex` if the delete operation was actually successful, which can be determined by ensuring that the `e.Exception` property is `null`.</span></span>

<span data-ttu-id="88703-347">Este enfoque funciona porque actualiza el `PageIndex` después del paso 1, pero antes del paso 2.</span><span class="sxs-lookup"><span data-stu-id="88703-347">This approach works because it updates the `PageIndex` after Step 1 but before Step 2.</span></span> <span data-ttu-id="88703-348">Por lo tanto, en el paso 2, se devuelve el conjunto de registros adecuado.</span><span class="sxs-lookup"><span data-stu-id="88703-348">Therefore, in Step 2, the appropriate set of records is returned.</span></span> <span data-ttu-id="88703-349">Para ello, use código similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88703-349">To accomplish this, use code like the following:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample11.vb)]

<span data-ttu-id="88703-350">Una solución alternativa consiste en crear un controlador de eventos para el s ObjectDataSource `RowDeleted` eventos y para establecer el `AffectedRows` en un valor de 1.</span><span class="sxs-lookup"><span data-stu-id="88703-350">An alternative workaround is to create an event handler for the ObjectDataSource s `RowDeleted` event and to set the `AffectedRows` property to a value of 1.</span></span> <span data-ttu-id="88703-351">Después de eliminar el registro en el paso 1 (pero antes de volver a recuperar los datos en el paso 2), se actualiza el control GridView su `PageIndex` propiedad si una o varias filas afectadas por la operación.</span><span class="sxs-lookup"><span data-stu-id="88703-351">After deleting the record in Step 1 (but before re-retrieving the data in Step 2), the GridView updates its `PageIndex` property if one or more rows were affected by the operation.</span></span> <span data-ttu-id="88703-352">Sin embargo, la `AffectedRows` ObjectDataSource no establece la propiedad y, por tanto, se omite este paso.</span><span class="sxs-lookup"><span data-stu-id="88703-352">However, the `AffectedRows` property is not set by the ObjectDataSource and therefore this step is omitted.</span></span> <span data-ttu-id="88703-353">Una manera de que este paso ejecuta consiste en definir manualmente la `AffectedRows` propiedad si la operación de eliminación se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="88703-353">One way to have this step executed is to manually set the `AffectedRows` property if the delete operation completes successfully.</span></span> <span data-ttu-id="88703-354">Esto puede realizarse mediante código similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="88703-354">This can be accomplished using code like the following:</span></span>


[!code-vb[Main](efficiently-paging-through-large-amounts-of-data-vb/samples/sample12.vb)]

<span data-ttu-id="88703-355">El código para ambos de estos controladores de eventos puede encontrarse en la clase de código subyacente de la `EfficientPaging.aspx` ejemplo.</span><span class="sxs-lookup"><span data-stu-id="88703-355">The code for both of these events handlers can be found in code-behind class of the `EfficientPaging.aspx` example.</span></span>

## <a name="comparing-the-performance-of-default-and-custom-paging"></a><span data-ttu-id="88703-356">Comparar el rendimiento de manera predeterminada y la paginación personalizada</span><span class="sxs-lookup"><span data-stu-id="88703-356">Comparing the Performance of Default and Custom Paging</span></span>

<span data-ttu-id="88703-357">Puesto que la paginación personalizada solo recupera los registros necesarios, mientras que devuelve la paginación predeterminada *todos los* de los registros para cada página que se está viendo, s borrar que paginación personalizada es más eficaz que la paginación de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="88703-357">Since custom paging only retrieves the needed records, whereas default paging returns *all* of the records for each page being viewed, it s clear that custom paging is more efficient than default paging.</span></span> <span data-ttu-id="88703-358">¿Pero simplemente cuánto más eficaz es paginación personalizada?</span><span class="sxs-lookup"><span data-stu-id="88703-358">But just how much more efficient is custom paging?</span></span> <span data-ttu-id="88703-359">¿Qué tipo de mejoras de rendimiento puede verse moviendo paginación predeterminada a la paginación personalizada?</span><span class="sxs-lookup"><span data-stu-id="88703-359">What sort of performance gains can be seen by moving from default paging to custom paging?</span></span>

<span data-ttu-id="88703-360">Desafortunadamente, hay s ningún talla única todos responder aquí.</span><span class="sxs-lookup"><span data-stu-id="88703-360">Unfortunately, there s no one size fits all answer here.</span></span> <span data-ttu-id="88703-361">La ganancia de rendimiento depende de una serie de factores, más destacada dos está el número de registros que se va a paginar a través de y la carga se colocan en la base de datos servidor y canales de comunicación entre el servidor web y el servidor de base de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-361">The performance gain depends on a number of factors, the most prominent two being the number of records being paged through and the load placed on the database server and communication channels between the web server and database server.</span></span> <span data-ttu-id="88703-362">Para tablas pequeñas con unos pocos docenas registros, la diferencia de rendimiento puede ser insignificante.</span><span class="sxs-lookup"><span data-stu-id="88703-362">For small tables with just a few dozen records, the performance difference may be negligible.</span></span> <span data-ttu-id="88703-363">Sin embargo, para las tablas grandes, con miles de cientos de miles de filas, la diferencia de rendimiento es aguda.</span><span class="sxs-lookup"><span data-stu-id="88703-363">For large tables, with thousands to hundreds of thousands of rows, though, the performance difference is acute.</span></span>

<span data-ttu-id="88703-364">Un artículo mío, [paginación personalizada en ASP.NET 2.0 con SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx), contiene algunas pruebas de rendimiento ejecutó para presentar las diferencias de rendimiento entre estas dos técnicas de paginación al paginar a través de una tabla de base de datos con 50.000 registros.</span><span class="sxs-lookup"><span data-stu-id="88703-364">An article of mine, [Custom Paging in ASP.NET 2.0 with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx), contains some performance tests I ran to exhibit the differences in performance between these two paging techniques when paging through a database table with 50,000 records.</span></span> <span data-ttu-id="88703-365">En estas pruebas examina tanto el tiempo para ejecutar la consulta en el nivel de SQL Server (mediante [SQL Profiler](https://msdn.microsoft.com/library/ms173757.aspx)) y en la página ASP.NET mediante [características de seguimiento de ASP.NET s](https://msdn.microsoft.com/library/y13fw6we.aspx).</span><span class="sxs-lookup"><span data-stu-id="88703-365">In these tests I examined both the time to execute the query at the SQL Server level (using [SQL Profiler](https://msdn.microsoft.com/library/ms173757.aspx)) and at the ASP.NET page using [ASP.NET s tracing features](https://msdn.microsoft.com/library/y13fw6we.aspx).</span></span> <span data-ttu-id="88703-366">Tenga en cuenta que estas pruebas estaban ejecutar en el cuadro de desarrollo con un solo usuario activo, por lo tanto no científicos y son no imitar patrones de carga del sitio Web típica.</span><span class="sxs-lookup"><span data-stu-id="88703-366">Keep in mind that these tests were run on my development box with a single active user, and therefore are unscientific and do not mimic typical website load patterns.</span></span> <span data-ttu-id="88703-367">En cualquier caso, los resultados de mostrar las diferencias relativas en tiempo de ejecución de forma predeterminada y la paginación personalizada cuando se trabaja con suficientemente grandes cantidades de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-367">Regardless, the results illustrate the relative differences in execution time for default and custom paging when working with sufficiently large amounts of data.</span></span>


|  | <span data-ttu-id="88703-368">**AVG. Duración (seg.)**</span><span class="sxs-lookup"><span data-stu-id="88703-368">**Avg. Duration (sec)**</span></span> | <span data-ttu-id="88703-369">**Lecturas**</span><span class="sxs-lookup"><span data-stu-id="88703-369">**Reads**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="88703-370">**Analizador de SQL de paginación de manera predeterminada**</span><span class="sxs-lookup"><span data-stu-id="88703-370">**Default Paging SQL Profiler**</span></span> | <span data-ttu-id="88703-371">1.411</span><span class="sxs-lookup"><span data-stu-id="88703-371">1.411</span></span> | <span data-ttu-id="88703-372">383</span><span class="sxs-lookup"><span data-stu-id="88703-372">383</span></span> |
| <span data-ttu-id="88703-373">**Analizador de SQL paginación personalizado**</span><span class="sxs-lookup"><span data-stu-id="88703-373">**Custom Paging SQL Profiler**</span></span> | <span data-ttu-id="88703-374">0.002</span><span class="sxs-lookup"><span data-stu-id="88703-374">0.002</span></span> | <span data-ttu-id="88703-375">29</span><span class="sxs-lookup"><span data-stu-id="88703-375">29</span></span> |
| <span data-ttu-id="88703-376">**Seguimiento de ASP.NET de paginación predeterminado**</span><span class="sxs-lookup"><span data-stu-id="88703-376">**Default Paging ASP.NET Trace**</span></span> | <span data-ttu-id="88703-377">2.379</span><span class="sxs-lookup"><span data-stu-id="88703-377">2.379</span></span> | <span data-ttu-id="88703-378">*N/A*</span><span class="sxs-lookup"><span data-stu-id="88703-378">*N/A*</span></span> |
| <span data-ttu-id="88703-379">**Seguimiento de ASP.NET de paginación personalizada**</span><span class="sxs-lookup"><span data-stu-id="88703-379">**Custom Paging ASP.NET Trace**</span></span> | <span data-ttu-id="88703-380">0.029</span><span class="sxs-lookup"><span data-stu-id="88703-380">0.029</span></span> | <span data-ttu-id="88703-381">*N/A*</span><span class="sxs-lookup"><span data-stu-id="88703-381">*N/A*</span></span> |


<span data-ttu-id="88703-382">Como puede ver, recuperar una página concreta de los datos necesarios 354 menos lecturas en promedio y completadas en una fracción del tiempo.</span><span class="sxs-lookup"><span data-stu-id="88703-382">As you can see, retrieving a particular page of data required 354 less reads on average and completed in a fraction of the time.</span></span> <span data-ttu-id="88703-383">En la página ASP.NET, personalizado la página era puede representar en el próximo a 1/100<sup>th</sup> del tiempo que tardó cuando use la paginación de manera predeterminada.</span><span class="sxs-lookup"><span data-stu-id="88703-383">At the ASP.NET page, custom the page was able to render in close to 1/100<sup>th</sup> of the time it took when using default paging.</span></span> <span data-ttu-id="88703-384">Vea [mi artículo](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx) para obtener más información sobre estos resultados junto con el código y una base de datos puede descargar para reproducir estas pruebas en su propio entorno.</span><span class="sxs-lookup"><span data-stu-id="88703-384">See [my article](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx) for more information on these results along with code and a database you can download to reproduce these tests in your own environment.</span></span>

## <a name="summary"></a><span data-ttu-id="88703-385">Resumen</span><span class="sxs-lookup"><span data-stu-id="88703-385">Summary</span></span>

<span data-ttu-id="88703-386">Paginación predeterminada es muy fácil de implementar la casilla de verificación Habilitar paginación de comprobación solo en la etiqueta inteligente de datos Web control s pero tal simplicidad a costa de rendimiento.</span><span class="sxs-lookup"><span data-stu-id="88703-386">Default paging is a cinch to implement just check the Enable Paging checkbox in the data Web control s smart tag but such simplicity comes at the cost of performance.</span></span> <span data-ttu-id="88703-387">Con la paginación de manera predeterminada, cuando un usuario solicita cualquier página de datos *todos los* se devuelven registros, aunque es posible que aparezcan solo una pequeña parte de ellos.</span><span class="sxs-lookup"><span data-stu-id="88703-387">With default paging, when a user requests any page of data *all* records are returned, even though only a tiny fraction of them may be shown.</span></span> <span data-ttu-id="88703-388">Para hacer frente a esta sobrecarga de rendimiento, ObjectDataSource ofrece una alternativa paginación personalizada de opción de paginación.</span><span class="sxs-lookup"><span data-stu-id="88703-388">To combat this performance overhead, the ObjectDataSource offers an alternative paging option custom paging.</span></span>

<span data-ttu-id="88703-389">Mientras la paginación personalizada mejora en los problemas de rendimiento de s de paginación mediante la recuperación de solo aquellos registros que deben mostrarse, de manera predeterminada, s más compleja implementar la paginación personalizada.</span><span class="sxs-lookup"><span data-stu-id="88703-389">While custom paging improves upon default paging s performance issues by retrieving only those records that need to be displayed, it s more involved to implement custom paging.</span></span> <span data-ttu-id="88703-390">En primer lugar, debe escribir una consulta que correcta (y eficaz) tenga acceso el subconjunto específico de registros solicitados.</span><span class="sxs-lookup"><span data-stu-id="88703-390">First, a query must be written that correctly (and efficiently) accesses the specific subset of records requested.</span></span> <span data-ttu-id="88703-391">Esto puede realizarse de varias maneras; uno se examinan en este tutorial consiste en usar SQL Server 2005 s nuevo `ROW_NUMBER()` resultados de función para clasificar y, a continuación, para solamente los devolver resultados cuya clasificación se encuentra dentro de un intervalo especificado.</span><span class="sxs-lookup"><span data-stu-id="88703-391">This can be accomplished in a number of ways; the one we examined in this tutorial is to use SQL Server 2005 s new `ROW_NUMBER()` function to rank results, and then to return just those results whose ranking falls within a specified range.</span></span> <span data-ttu-id="88703-392">Además, tenemos que agregar a fin de determinar el número total de registros que se va a paginar a través de.</span><span class="sxs-lookup"><span data-stu-id="88703-392">Furthermore, we need to add a means to determine the total number of records being paged through.</span></span> <span data-ttu-id="88703-393">Después de crear estos métodos de la capa DAL y BLL, también es necesario configurar el ObjectDataSource para que pueda determinar el número total de registros son que se va a paginar a través y correctamente pueden pasar los valores de índice de fila inicial y el número máximo de filas a la capa BLL.</span><span class="sxs-lookup"><span data-stu-id="88703-393">After creating these DAL and BLL methods, we also need to configure the ObjectDataSource so that it can determine how many total records are being paged through and can correctly pass the Start Row Index and Maximum Rows values to the BLL.</span></span>

<span data-ttu-id="88703-394">Mientras que implementar la paginación personalizada requiere una serie de pasos y es no casi tan sencillo como paginación de manera predeterminada, la paginación personalizada es una necesidad al paginar a través de suficientemente grandes cantidades de datos.</span><span class="sxs-lookup"><span data-stu-id="88703-394">While implementing custom paging does require a number of steps and is not nearly as simple as default paging, custom paging is a necessity when paging through sufficiently large amounts of data.</span></span> <span data-ttu-id="88703-395">A medida que examinan los resultados de la paginación personalizada, mostraron puede perder a segundos en el tiempo de procesamiento de la página ASP.NET y puede aclarar la carga en el servidor de base de datos por una o más órdenes de magnitud.</span><span class="sxs-lookup"><span data-stu-id="88703-395">As the results examined showed, custom paging can shed seconds off of the ASP.NET page render time and can lighten the load on the database server by one ore more orders of magnitude.</span></span>

<span data-ttu-id="88703-396">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="88703-396">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="88703-397">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="88703-397">About the Author</span></span>

<span data-ttu-id="88703-398">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="88703-398">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="88703-399">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="88703-399">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="88703-400">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="88703-400">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="88703-401">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="88703-401">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="88703-402">[Anterior](paging-and-sorting-report-data-vb.md)
> [Siguiente](sorting-custom-paged-data-vb.md)</span><span class="sxs-lookup"><span data-stu-id="88703-402">[Previous](paging-and-sorting-report-data-vb.md)
[Next](sorting-custom-paged-data-vb.md)</span></span>
