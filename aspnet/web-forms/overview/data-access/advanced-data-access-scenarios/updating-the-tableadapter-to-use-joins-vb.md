---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
title: Actualización de TableAdapter que se utilizan combinaciones (VB) | Documentos de Microsoft
author: rick-anderson
description: Cuando se trabaja con una base de datos es común a los datos de solicitud que se reparten entre varias tablas. Para recuperar datos de dos tablas diferentes, podemos utilizar cualquiera...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: e624a3e0-061b-4efc-8b0e-5877f9ff6714
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-vb
msc.type: authoredcontent
ms.openlocfilehash: 91d700f3de02dc78692e933644e221e2ac8175a1
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
---
<a name="updating-the-tableadapter-to-use-joins-vb"></a><span data-ttu-id="84887-104">Actualización de TableAdapter que se utilizan combinaciones (VB)</span><span class="sxs-lookup"><span data-stu-id="84887-104">Updating the TableAdapter to Use JOINs (VB)</span></span>
====================
<span data-ttu-id="84887-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="84887-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="84887-106">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) o [descarga de PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="84887-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_VB.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-vb/_static/datatutorial69vb1.pdf)</span></span>

> <span data-ttu-id="84887-107">Cuando se trabaja con una base de datos es común a los datos de solicitud que se reparten entre varias tablas.</span><span class="sxs-lookup"><span data-stu-id="84887-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="84887-108">Para recuperar datos de dos tablas diferentes podemos usar una subconsulta correlacionada o una operación de combinación.</span><span class="sxs-lookup"><span data-stu-id="84887-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="84887-109">En este tutorial se compare subconsultas correlacionadas y la sintaxis de unión antes de ver cómo crear un TableAdapter que incluye una combinación en la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="84887-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="84887-110">Introducción</span><span class="sxs-lookup"><span data-stu-id="84887-110">Introduction</span></span>

<span data-ttu-id="84887-111">Con bases de datos relacionales los datos con que se está interesados en trabajar a menudo se reparten entre varias tablas.</span><span class="sxs-lookup"><span data-stu-id="84887-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="84887-112">Por ejemplo, al mostrar información de producto es probable que queremos mostrar cada categoría de producto s correspondiente y los nombres de proveedor s.</span><span class="sxs-lookup"><span data-stu-id="84887-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="84887-113">El `Products` tabla tiene `CategoryID` y `SupplierID` valores, pero los nombres reales de categoría y el proveedor están en el `Categories` y `Suppliers` tablas, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="84887-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="84887-114">Para recuperar información de otra tabla relacionada, se puede usar *subconsultas correlacionadas* o `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="84887-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="84887-115">Una subconsulta correlacionada está anidada `SELECT` consulta que haga referencia a columnas en la consulta externa.</span><span class="sxs-lookup"><span data-stu-id="84887-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="84887-116">Por ejemplo, en la [crear una capa de acceso a datos](../introduction/creating-a-data-access-layer-vb.md) tutorial se utilizan dos subconsultas correlacionadas en el `ProductsTableAdapter` consulta principal de s para devolver los nombres de categoría y el proveedor para cada producto.</span><span class="sxs-lookup"><span data-stu-id="84887-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="84887-117">A `JOIN` es una construcción SQL que combina las filas relacionadas de dos tablas diferentes.</span><span class="sxs-lookup"><span data-stu-id="84887-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="84887-118">Se usa un `JOIN` en el [consultar datos con el SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial para mostrar información de categorías junto a cada producto.</span><span class="sxs-lookup"><span data-stu-id="84887-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-vb.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="84887-119">El motivo nos hemos abstained utilizasen `JOIN` s con los TableAdapters es debido a las limitaciones en el Asistente para la s de TableAdapter para generar automáticamente la correspondiente `INSERT`, `UPDATE`, y `DELETE` las instrucciones.</span><span class="sxs-lookup"><span data-stu-id="84887-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="84887-120">Más específicamente, si la consulta principal de TableAdapter s contiene cualquier `JOIN` s, lo TableAdapter no puede crear automáticamente las instrucciones SQL ad hoc o procedimientos almacenados para su `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades.</span><span class="sxs-lookup"><span data-stu-id="84887-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="84887-121">En este tutorial se comparará brevemente y el contraste de las subconsultas correlacionadas y `JOIN` s antes de explorar cómo crear un TableAdapter que incluya `JOIN` s en su consulta principal.</span><span class="sxs-lookup"><span data-stu-id="84887-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="84887-122">Comparar y contrastar las subconsultas correlacionadas y`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="84887-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="84887-123">Recuerde que el `ProductsTableAdapter` creada en el primer tutorial en el `Northwind` conjunto de datos utiliza subconsultas correlativas para devolver cada nombre de categoría y el proveedor de correspondientes de un producto s.</span><span class="sxs-lookup"><span data-stu-id="84887-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="84887-124">El `ProductsTableAdapter` consulta principal s se muestra a continuación.</span><span class="sxs-lookup"><span data-stu-id="84887-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample1.sql)]

<span data-ttu-id="84887-125">Los dos de las subconsultas - correlacionadas `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` y `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -son `SELECT` consultas que devuelven un único valor por producto como una columna adicional en el exterior `SELECT` lista de columnas de la instrucción s.</span><span class="sxs-lookup"><span data-stu-id="84887-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="84887-126">Como alternativa, un `JOIN` puede usarse para devolver cada nombre de proveedor y de categoría de producto s.</span><span class="sxs-lookup"><span data-stu-id="84887-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="84887-127">La siguiente consulta devuelve el mismo resultado que el anterior, pero usa `JOIN` s en lugar de subconsultas:</span><span class="sxs-lookup"><span data-stu-id="84887-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample2.sql)]

<span data-ttu-id="84887-128">Un `JOIN` combina los registros de una tabla con los registros de otra tabla en función de algunos criterios.</span><span class="sxs-lookup"><span data-stu-id="84887-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="84887-129">En la consulta anterior, por ejemplo, el `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` indica a SQL Server para combinar cada registro de producto con la categoría cuyo registro `CategoryID` valor coincide con el producto s `CategoryID` valor.</span><span class="sxs-lookup"><span data-stu-id="84887-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="84887-130">El resultado combinado nos permite trabajar con los campos de categoría correspondiente para cada producto (como `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="84887-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="84887-131">`JOIN` s se usan normalmente al consultar datos de bases de datos relacionales.</span><span class="sxs-lookup"><span data-stu-id="84887-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="84887-132">Si está familiarizado con la `JOIN` sintaxis o deba perfeccionar sus conocimientos un poco sobre su uso, d recomiendo el [tutorial Join de SQL](http://www.w3schools.com/sql/sql_join.asp) en [W3 varios centros escolares](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="84887-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="84887-133">También cabe lectura son el [ `JOIN` Fundamentos](https://msdn.microsoft.com/library/ms191517.aspx) y [conceptos básicos de subconsultas](https://msdn.microsoft.com/library/ms189575.aspx) secciones de la [libros en pantalla de SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="84887-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="84887-134">Puesto que `JOIN` s y subconsultas correlacionadas se pueden usar para recuperar datos relacionados de otras tablas, muchos desarrolladores quedan arañar sus cabezales y pregunte qué aproximación utilizar.</span><span class="sxs-lookup"><span data-stu-id="84887-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="84887-135">Todos los gurús de SQL se ha analizado para han dicho aproximadamente lo mismo que TI t realmente importa refiere al rendimiento cuando SQL Server generará planes de ejecución casi idénticos.</span><span class="sxs-lookup"><span data-stu-id="84887-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="84887-136">Sus consejos, a continuación, consiste en utilizar la técnica que están más familiarizados con usted y su equipo.</span><span class="sxs-lookup"><span data-stu-id="84887-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="84887-137">Merece teniendo en cuenta que después de transmitir estos consejos estos expertos inmediatamente expresan en sus preferencias de `JOIN` s a lo largo de las subconsultas.</span><span class="sxs-lookup"><span data-stu-id="84887-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="84887-138">Cuando se crea una capa de acceso a datos mediante conjuntos de datos con tipo, las herramientas funcionan mejor cuando se utiliza subconsultas.</span><span class="sxs-lookup"><span data-stu-id="84887-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="84887-139">En concreto, el Asistente para la s de TableAdapter no generará automáticamente correspondiente `INSERT`, `UPDATE`, y `DELETE` instrucciones si la consulta principal contiene cualquier `JOIN` s, pero generará automáticamente estas instrucciones cuando correlacionado subconsultas se utilizan.</span><span class="sxs-lookup"><span data-stu-id="84887-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="84887-140">Para explorar este inconveniente, cree un conjunto de datos de tipo temporal en el `~/App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="84887-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="84887-141">Durante el Asistente para configuración de TableAdapter, decide usar instrucciones SQL ad hoc y escriba la siguiente `SELECT` consulta (consulte la figura 1):</span><span class="sxs-lookup"><span data-stu-id="84887-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample3.sql)]


<span data-ttu-id="84887-142">[![Escriba una consulta principal que contiene las combinaciones](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="84887-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-vb/_static/image2.png)](updating-the-tableadapter-to-use-joins-vb/_static/image1.png)</span></span>

<span data-ttu-id="84887-143">**Figura 1**: escriba una consulta principal que contiene `JOIN` s ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="84887-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image3.png))</span></span>


<span data-ttu-id="84887-144">De forma predeterminada, se creará automáticamente el TableAdapter `INSERT`, `UPDATE`, y `DELETE` las instrucciones en función de la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="84887-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="84887-145">Si hace clic en el botón avanzadas que puede ver que esta característica está habilitada.</span><span class="sxs-lookup"><span data-stu-id="84887-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="84887-146">A pesar de esta configuración, lo TableAdapter no podrá crear el `INSERT`, `UPDATE`, y `DELETE` instrucciones porque la consulta principal contiene un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="84887-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Escriba una consulta principal que contiene las combinaciones](updating-the-tableadapter-to-use-joins-vb/_static/image4.png)

<span data-ttu-id="84887-148">**Figura 2**: escriba una consulta principal que contenga `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="84887-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="84887-149">Haga clic en Finalizar para completar al asistente.</span><span class="sxs-lookup"><span data-stu-id="84887-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="84887-150">En este momento su diseñador de DataSet s incluirá un TableAdapter único con un objeto DataTable con columnas para cada uno de los campos devueltos en la `SELECT` lista de columnas de la consulta s.</span><span class="sxs-lookup"><span data-stu-id="84887-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="84887-151">Esto incluye la `CategoryName` y `SupplierName`, como se muestra en la figura 3.</span><span class="sxs-lookup"><span data-stu-id="84887-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![La tabla de datos incluye una columna para cada campo devuelto en la lista de columnas](updating-the-tableadapter-to-use-joins-vb/_static/image5.png)

<span data-ttu-id="84887-153">**Figura 3**: la tabla de datos incluye una columna para cada campo que se devuelve en la lista de columnas</span><span class="sxs-lookup"><span data-stu-id="84887-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="84887-154">Mientras que la tabla de datos tiene las columnas apropiadas, lo TableAdapter no tiene los valores para su `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades.</span><span class="sxs-lookup"><span data-stu-id="84887-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="84887-155">Para confirmarlo, haga clic en el objeto TableAdapter en el diseñador y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="84887-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="84887-156">No existe, verá que el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades se establecen en (ninguno).</span><span class="sxs-lookup"><span data-stu-id="84887-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="84887-157">[![El InsertCommand, UpdateCommand y DeleteCommand propiedades se establecen en (ninguno)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="84887-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-vb/_static/image7.png)](updating-the-tableadapter-to-use-joins-vb/_static/image6.png)</span></span>

<span data-ttu-id="84887-158">**Figura 4**: el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades se establecen en (ninguno) ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="84887-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image8.png))</span></span>


<span data-ttu-id="84887-159">Para solucionar este inconveniente, podemos proporcionar manualmente las instrucciones SQL y parámetros para la `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades a través de la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="84887-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="84887-160">Como alternativa, podríamos comenzamos mediante la configuración de la consulta principal de TableAdapter s a *no* incluir cualquier `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="84887-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="84887-161">Esto le permitirá la `INSERT`, `UPDATE`, y `DELETE` instrucciones que se va a generar automáticamente para que podamos.</span><span class="sxs-lookup"><span data-stu-id="84887-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="84887-162">Después de completar el asistente, se pueden, a continuación, actualizar manualmente TableAdapters `SelectCommand` desde la ventana Propiedades, por lo que incluye el `JOIN` sintaxis.</span><span class="sxs-lookup"><span data-stu-id="84887-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="84887-163">Aunque este enfoque funciona, resulta muy complicado cuando el uso de consultas SQL ad hoc porque cada vez que la consulta principal de TableAdapter s es volver a configurar mediante el asistente, el generado automáticamente `INSERT`, `UPDATE`, y `DELETE` se vuelven a crear instrucciones.</span><span class="sxs-lookup"><span data-stu-id="84887-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="84887-164">Esto significa que todas las personalizaciones se realizan más adelante se perderían si se con el botón secundario en TableAdapter, eligió configurar en el menú contextual y completa al Asistente para nuevo.</span><span class="sxs-lookup"><span data-stu-id="84887-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="84887-165">La fragilidad de las operaciones de asignación TableAdapter generado automáticamente `INSERT`, `UPDATE`, y `DELETE` instrucciones es, Afortunadamente, limitada a instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="84887-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="84887-166">Si el TableAdapter utiliza los procedimientos almacenados, puede personalizar el `SelectCommand`, `InsertCommand`, `UpdateCommand`, o `DeleteCommand` procedimientos almacenados y vuelva a ejecutar el Asistente para configuración de TableAdapter sin tener que temen que será los procedimientos almacenados modificar.</span><span class="sxs-lookup"><span data-stu-id="84887-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="84887-167">En los próximos varios pasos, vamos a crear un TableAdapter que, en principio, utiliza una consulta principal que omita cualquier `JOIN` s para que los correspondientes a insertar, actualizar y procedimientos almacenados de eliminación se va a generar automáticamente.</span><span class="sxs-lookup"><span data-stu-id="84887-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="84887-168">A continuación, actualizaremos la `SelectCommand` por lo tanto que utiliza un `JOIN` que devuelve más columnas de las tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="84887-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="84887-169">Por último, se creará una clase correspondiente de la capa de lógica empresarial y muestran cómo utilizar el objeto TableAdapter en una página web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="84887-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="84887-170">Paso 1: Creación de TableAdapter utilizando una consulta principal simplificada</span><span class="sxs-lookup"><span data-stu-id="84887-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="84887-171">Para este tutorial agregaremos un TableAdapter y DataTable fuertemente tipados para la `Employees` tabla el `NorthwindWithSprocs` conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="84887-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="84887-172">El `Employees` tabla contiene un `ReportsTo` campo que especifica la `EmployeeID` del Administrador de empleado s.</span><span class="sxs-lookup"><span data-stu-id="84887-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="84887-173">Por ejemplo, los empleados Anne Dodsworth tiene un `ReportTo` valor de 5, que es el `EmployeeID` de Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="84887-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="84887-174">Por lo tanto, Anne informa a Carlos, su administrador.</span><span class="sxs-lookup"><span data-stu-id="84887-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="84887-175">Junto con informes de cada empleado s `ReportsTo` valor, que también queramos recuperar el nombre de su jefe.</span><span class="sxs-lookup"><span data-stu-id="84887-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="84887-176">Esto puede realizarse mediante un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="84887-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="84887-177">Pero con un `JOIN` al crear inicialmente el TableAdapter, impide que el Asistente para generar automáticamente la inserción correspondiente, actualizar y eliminar las capacidades.</span><span class="sxs-lookup"><span data-stu-id="84887-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="84887-178">Por lo tanto, se iniciará mediante la creación de un TableAdapter cuya consulta principal no contiene ninguno `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="84887-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="84887-179">A continuación, en el paso 2, actualizaremos el procedimiento almacenado de consulta principal para recuperar el nombre del administrador s a través de un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="84887-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="84887-180">Comience abriendo la `NorthwindWithSprocs` conjunto de datos en el `~/App_Code/DAL` carpeta.</span><span class="sxs-lookup"><span data-stu-id="84887-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="84887-181">Haga doble clic en el diseñador, seleccione la opción Agregar en el menú contextual y elija el elemento de menú de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="84887-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="84887-182">Se iniciará al Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="84887-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="84887-183">Tal y como se muestra en la figura 5, que el asistente cree nuevos procedimientos almacenados y haga clic en siguiente.</span><span class="sxs-lookup"><span data-stu-id="84887-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="84887-184">Para repasar sobre la creación de nuevos procedimientos almacenados desde el Asistente para la s de TableAdapter, consulte el [crear procedimientos almacenados nuevos para la s de conjunto de datos con tipo TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="84887-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>


<span data-ttu-id="84887-185">[![Seleccione el crear nuevos procedimientos almacenados opción](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="84887-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-vb/_static/image10.png)](updating-the-tableadapter-to-use-joins-vb/_static/image9.png)</span></span>

<span data-ttu-id="84887-186">**Figura 5**: seleccione el crear nuevos almacenados procedures (opción) ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="84887-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image11.png))</span></span>


<span data-ttu-id="84887-187">Utilice la siguiente `SELECT` instrucción de la consulta principal de TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="84887-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample4.sql)]

<span data-ttu-id="84887-188">Puesto que esta consulta no incluye ningún `JOIN` s, el Asistente de TableAdapter creará automáticamente los procedimientos almacenados con el correspondiente `INSERT`, `UPDATE`, y `DELETE` instrucciones, así como un procedimiento almacenado para ejecutar el método main consulta.</span><span class="sxs-lookup"><span data-stu-id="84887-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="84887-189">El siguiente paso nos permite un nombre de los procedimientos almacenados de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="84887-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="84887-190">Use los nombres `Employees_Select`, `Employees_Insert`, `Employees_Update`, y `Employees_Delete`, tal y como se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="84887-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="84887-191">[![Nombre de los procedimientos almacenados de TableAdapter](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="84887-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-vb/_static/image13.png)](updating-the-tableadapter-to-use-joins-vb/_static/image12.png)</span></span>

<span data-ttu-id="84887-192">**Figura 6**: el nombre de los procedimientos almacenados de TableAdapter s ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="84887-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image14.png))</span></span>


<span data-ttu-id="84887-193">El último paso le pide que asigne nombre a los métodos de TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="84887-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="84887-194">Use `Fill` y `GetEmployees` como los nombres de método.</span><span class="sxs-lookup"><span data-stu-id="84887-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="84887-195">Además, asegúrese de dejar el crear métodos para enviar actualizaciones directamente a la casilla de verificación de la base de datos (GenerateDBDirectMethods) activada.</span><span class="sxs-lookup"><span data-stu-id="84887-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="84887-196">[![Nombre del relleno de métodos de TableAdapter s y GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="84887-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-vb/_static/image16.png)](updating-the-tableadapter-to-use-joins-vb/_static/image15.png)</span></span>

<span data-ttu-id="84887-197">**Figura 7**: nombre de los métodos de TableAdapter s `Fill` y `GetEmployees` ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="84887-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image17.png))</span></span>


<span data-ttu-id="84887-198">Después de completar al asistente, tómese un momento para examinar los procedimientos almacenados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="84887-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="84887-199">Debería ver cuatro nuevos: `Employees_Select`, `Employees_Insert`, `Employees_Update`, y `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="84887-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="84887-200">A continuación, inspeccione el `EmployeesDataTable` y `EmployeesTableAdapter` acaba de crear.</span><span class="sxs-lookup"><span data-stu-id="84887-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="84887-201">La tabla de datos contiene una columna para cada campo devuelto por la consulta principal.</span><span class="sxs-lookup"><span data-stu-id="84887-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="84887-202">Haga clic en el objeto TableAdapter y, a continuación, vaya a la ventana Propiedades.</span><span class="sxs-lookup"><span data-stu-id="84887-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="84887-203">No existe, verá que el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades están configuradas correctamente para llamar a los procedimientos almacenados correspondientes.</span><span class="sxs-lookup"><span data-stu-id="84887-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="84887-204">[![TableAdapter incluye Insertar, actualizar y eliminar las capacidades](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="84887-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-vb/_static/image19.png)](updating-the-tableadapter-to-use-joins-vb/_static/image18.png)</span></span>

<span data-ttu-id="84887-205">**Figura 8**: el TableAdapter incluye Insert, Update y eliminar capacidades ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="84887-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image20.png))</span></span>


<span data-ttu-id="84887-206">Al insertar, actualizar y eliminar los procedimientos almacenados creados automáticamente y la `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades configurados correctamente, estamos preparados para personalizar el `SelectCommand` s procedimiento almacenado para devolver adicionales información sobre cada empleado s Administrador.</span><span class="sxs-lookup"><span data-stu-id="84887-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="84887-207">En concreto, deberá actualizar el `Employees_Select` procedimiento almacenado para usar un `JOIN` y devolver el Administrador de s `FirstName` y `LastName` valores.</span><span class="sxs-lookup"><span data-stu-id="84887-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="84887-208">Después de que se ha actualizado el procedimiento almacenado, necesitamos actualizar la tabla de datos para que incluya estas columnas adicionales.</span><span class="sxs-lookup"><span data-stu-id="84887-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="84887-209">Abordaremos estas dos tareas en los pasos 2 y 3.</span><span class="sxs-lookup"><span data-stu-id="84887-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="84887-210">Paso 2: Personalizar el procedimiento almacenado debe incluir un`JOIN`</span><span class="sxs-lookup"><span data-stu-id="84887-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="84887-211">Inicio va en el Explorador de servidores, explorar en profundidad en la carpeta de procedimientos almacenados de s de la base de datos Northwind y abriendo la `Employees_Select` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="84887-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="84887-212">Si no ve este procedimiento almacenado, haga doble clic en la carpeta procedimientos almacenados y seleccione actualizar.</span><span class="sxs-lookup"><span data-stu-id="84887-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="84887-213">Actualizar el procedimiento almacenado para que utilice un `LEFT JOIN` para devolver el administrador s primero y el apellido:</span><span class="sxs-lookup"><span data-stu-id="84887-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample5.sql)]

<span data-ttu-id="84887-214">Después de actualizar el `SELECT` instrucción, guardar los cambios, vaya al menú archivo y elija Guardar `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="84887-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="84887-215">Como alternativa, puede haga clic en el icono Guardar en la barra de herramientas o aciertos CTRL+s.</span><span class="sxs-lookup"><span data-stu-id="84887-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="84887-216">Después de guardar los cambios, haga doble clic en el `Employees_Select` procedimiento almacenado en el Explorador de servidores y elija ejecutar.</span><span class="sxs-lookup"><span data-stu-id="84887-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="84887-217">Esto ejecutará el procedimiento almacenado y mostrar los resultados en la ventana de salida (consulte la figura 9).</span><span class="sxs-lookup"><span data-stu-id="84887-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="84887-218">[![Los resultados de los procedimientos almacenados se muestran en la ventana de salida](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="84887-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-vb/_static/image22.png)](updating-the-tableadapter-to-use-joins-vb/_static/image21.png)</span></span>

<span data-ttu-id="84887-219">**Figura 9**: los resultados de los procedimientos almacenados se muestran en la ventana de salida ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="84887-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="84887-220">Paso 3: Actualizar las columnas de s de DataTable</span><span class="sxs-lookup"><span data-stu-id="84887-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="84887-221">En este momento, el `Employees_Select` procedimiento almacenado devuelve `ManagerFirstName` y `ManagerLastName` valores, pero la `EmployeesDataTable` falta estas columnas.</span><span class="sxs-lookup"><span data-stu-id="84887-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="84887-222">Estas columnas que faltan pueden agregarse a la tabla de datos de una de dos maneras:</span><span class="sxs-lookup"><span data-stu-id="84887-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="84887-223">**Manualmente** : haga doble clic en la tabla de datos en el Diseñador de DataSet y, en el menú Agregar, elija la columna.</span><span class="sxs-lookup"><span data-stu-id="84887-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="84887-224">Puede, a continuación, la columna de nombre y establecer sus propiedades en consecuencia.</span><span class="sxs-lookup"><span data-stu-id="84887-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="84887-225">**Automáticamente** -el Asistente para configuración de TableAdapter actualizará las columnas de s DataTable para reflejar los campos devueltos por la `SelectCommand` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="84887-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="84887-226">Al usar instrucciones SQL ad hoc, el asistente también quitará el `InsertCommand`, `UpdateCommand`, y `DeleteCommand` propiedades desde el `SelectCommand` contiene ahora un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="84887-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="84887-227">Pero cuando utilice procedimientos almacenados, estas propiedades de comando permanecen intactas.</span><span class="sxs-lookup"><span data-stu-id="84887-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="84887-228">Agregar manualmente las columnas de tabla de datos se han analizado en tutoriales anteriores, incluidos los [principal/detalle con una lista con viñetas de registros maestros DataList detalles](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) y [cargar archivos](../working-with-binary-files/uploading-files-vb.md), y le enviaremos Buscar en este proceso nuevo con más detalle en nuestro tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="84887-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) and [Uploading Files](../working-with-binary-files/uploading-files-vb.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="84887-229">Para este tutorial, no obstante, permiten s, emplee el método automática mediante el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="84887-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="84887-230">Iniciar con el botón secundario en el `EmployeesTableAdapter` y seleccionando configurar en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="84887-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="84887-231">Se abrirá el Asistente para configuración de TableAdapter, que enumera los procedimientos almacenados utilizados para seleccionar, insertar, actualizar y eliminar, junto con sus valores devueltos y parámetros (si existe).</span><span class="sxs-lookup"><span data-stu-id="84887-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="84887-232">La figura 10 muestra a este asistente.</span><span class="sxs-lookup"><span data-stu-id="84887-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="84887-233">Aquí podemos ver que el `Employees_Select` procedimiento almacenado ahora devuelve el `ManagerFirstName` y `ManagerLastName` campos.</span><span class="sxs-lookup"><span data-stu-id="84887-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="84887-234">[![Se muestra en el Asistente para la lista de las filas actualizadas para el Employees_Select de procedimiento almacenado](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="84887-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-vb/_static/image25.png)](updating-the-tableadapter-to-use-joins-vb/_static/image24.png)</span></span>

<span data-ttu-id="84887-235">**Figura 10**: el asistente muestra la lista de columnas actualizado para el `Employees_Select` procedimiento almacenado ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="84887-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image26.png))</span></span>


<span data-ttu-id="84887-236">Complete el asistente, haga clic en Finalizar.</span><span class="sxs-lookup"><span data-stu-id="84887-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="84887-237">Al volver al diseñador de DataSet, el `EmployeesDataTable` incluye dos columnas adicionales: `ManagerFirstName` y `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="84887-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="84887-238">[![El EmployeesDataTable contiene dos nuevas columnas](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="84887-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-vb/_static/image28.png)](updating-the-tableadapter-to-use-joins-vb/_static/image27.png)</span></span>

<span data-ttu-id="84887-239">**Figura 11**: el `EmployeesDataTable` contiene dos nuevas columnas ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="84887-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image29.png))</span></span>


<span data-ttu-id="84887-240">Para ilustrar el hecho de que la actualización `Employees_Select` procedimiento almacenado está activo y que la inserción, actualización y eliminación de las capacidades del TableAdapter siguen siendo funcionales, permiten s crear una página web que permite a los usuarios ver y eliminar los empleados.</span><span class="sxs-lookup"><span data-stu-id="84887-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="84887-241">Antes de crear una página de este tipo, sin embargo, es necesario crear primero una nueva clase en la capa de lógica de negocios para trabajar con los empleados de la `NorthwindWithSprocs` conjunto de datos.</span><span class="sxs-lookup"><span data-stu-id="84887-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="84887-242">En el paso 4, crearemos un `EmployeesBLLWithSprocs` clase.</span><span class="sxs-lookup"><span data-stu-id="84887-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="84887-243">En el paso 5, se usará esta clase a partir de una página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="84887-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="84887-244">Paso 4: Implementación de la capa de lógica de negocios</span><span class="sxs-lookup"><span data-stu-id="84887-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="84887-245">Crear un nuevo archivo de clase en el `~/App_Code/BLL` carpeta denominada `EmployeesBLLWithSprocs.vb`.</span><span class="sxs-lookup"><span data-stu-id="84887-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.vb`.</span></span> <span data-ttu-id="84887-246">Esta clase imita la semántica de las existentes `EmployeesBLL` (clase), solo esta nueva uno proporciona métodos menos y utiliza el `NorthwindWithSprocs` conjunto de datos (en lugar de la `Northwind` conjunto de datos).</span><span class="sxs-lookup"><span data-stu-id="84887-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="84887-247">Agregue el código siguiente a la clase `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="84887-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-vb[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample6.vb)]

<span data-ttu-id="84887-248">El `EmployeesBLLWithSprocs` clase s `Adapter` propiedad devuelve una instancia de la `NorthwindWithSprocs` s de conjunto de datos `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="84887-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="84887-249">Se utiliza la clase s `GetEmployees` y `DeleteEmployee` métodos.</span><span class="sxs-lookup"><span data-stu-id="84887-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="84887-250">El `GetEmployees` llamadas al método el `EmployeesTableAdapter` s correspondiente `GetEmployees` método, que se invoca el `Employees_Select` procedimiento almacenado y rellena los resultados en un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="84887-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="84887-251">El `DeleteEmployee` método se llama de forma similar el `EmployeesTableAdapter` s `Delete` método, que se invoca el `Employees_Delete` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="84887-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="84887-252">Paso 5: Trabajar con los datos en el nivel de presentación</span><span class="sxs-lookup"><span data-stu-id="84887-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="84887-253">Con el `EmployeesBLLWithSprocs` clase completa, se re listo para trabajar con datos de empleados a través de una página ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="84887-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="84887-254">Abra el `JOINs.aspx` página en el `AdvancedDAL` carpeta y arrastre un control GridView del cuadro de herramientas hasta el diseñador, establecer su `ID` propiedad `Employees`.</span><span class="sxs-lookup"><span data-stu-id="84887-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="84887-255">A continuación, en la etiqueta inteligente de GridView s, enlazar la cuadrícula para un nuevo control ObjectDataSource denominado `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="84887-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="84887-256">Configurar el ObjectDataSource para usar el `EmployeesBLLWithSprocs` clase y, desde las pestañas de seleccionar y eliminar, asegúrese de que el `GetEmployees` y `DeleteEmployee` métodos estén seleccionados en las listas desplegables.</span><span class="sxs-lookup"><span data-stu-id="84887-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="84887-257">Haga clic en Finalizar para completar la configuración de s ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="84887-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="84887-258">[![Configurar el ObjectDataSource para utilizar la clase EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="84887-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-vb/_static/image31.png)](updating-the-tableadapter-to-use-joins-vb/_static/image30.png)</span></span>

<span data-ttu-id="84887-259">**Figura 12**: configurar el ObjectDataSource que se utilizan los `EmployeesBLLWithSprocs` clase ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="84887-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image32.png))</span></span>


<span data-ttu-id="84887-260">[![Tiene el uso de ObjectDataSource las GetEmployees y los métodos de DeleteEmployee](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="84887-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-vb/_static/image34.png)](updating-the-tableadapter-to-use-joins-vb/_static/image33.png)</span></span>

<span data-ttu-id="84887-261">**Figura 13**: el uso de ObjectDataSource el `GetEmployees` y `DeleteEmployee` métodos ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="84887-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image35.png))</span></span>


<span data-ttu-id="84887-262">Visual Studio agregará un BoundField a GridView para cada uno de los `EmployeesDataTable` columnas s.</span><span class="sxs-lookup"><span data-stu-id="84887-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="84887-263">Quite todos estos BoundFields excepto `Title`, `LastName`, `FirstName`, `ManagerFirstName`, y `ManagerLastName` y cambiar el nombre de la `HeaderText` propiedades para los cuatro últimos BoundFields apellido, nombre, nombre Manager s, y El Administrador de s apellidos, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="84887-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="84887-264">Para permitir que los usuarios puedan eliminar a los empleados desde esta página que debemos hacer dos cosas.</span><span class="sxs-lookup"><span data-stu-id="84887-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="84887-265">En primer lugar, indique a GridView para proporcionar capacidades de eliminación activando la opción Habilitar eliminación de la etiqueta inteligente.</span><span class="sxs-lookup"><span data-stu-id="84887-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="84887-266">En segundo lugar, cambie la s ObjectDataSource `OldValuesParameterFormatString` propiedad desde el valor especificado mediante el Asistente de ObjectDataSource (`original_{0}`) en su valor predeterminado (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="84887-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="84887-267">Después de realizar estos cambios, el marcado declarativo de s GridView y ObjectDataSource debe ser similar al siguiente:</span><span class="sxs-lookup"><span data-stu-id="84887-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-vb/samples/sample7.aspx)]

<span data-ttu-id="84887-268">Probar la página visitando a través de un explorador.</span><span class="sxs-lookup"><span data-stu-id="84887-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="84887-269">Como se muestra en la figura 14, mostrará la página de cada empleado y su nombre s manager (suponiendo que tienen uno).</span><span class="sxs-lookup"><span data-stu-id="84887-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="84887-270">[![La combinación en la Employees_Select procedimiento almacenado devuelve el nombre del administrador s](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="84887-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-vb/_static/image37.png)](updating-the-tableadapter-to-use-joins-vb/_static/image36.png)</span></span>

<span data-ttu-id="84887-271">**Figura 14**: el `JOIN` en el `Employees_Select` procedimiento almacenado devuelve el Administrador de s nombre ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="84887-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image38.png))</span></span>


<span data-ttu-id="84887-272">Haga clic en el botón Eliminar inicia el flujo de trabajo eliminando, culmina en la ejecución de la `Employees_Delete` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="84887-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="84887-273">Sin embargo, el intento `DELETE` se produce un error en la instrucción en el procedimiento almacenado debido a una infracción de restricción de clave externa (vea la figura 15).</span><span class="sxs-lookup"><span data-stu-id="84887-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="84887-274">En concreto, cada empleado tiene uno o más registros en la `Orders` tabla, que produce la eliminación de un error.</span><span class="sxs-lookup"><span data-stu-id="84887-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="84887-275">[![Eliminación de un empleado que tiene como consecuencia de pedidos correspondiente en una infracción de restricción de clave externa](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="84887-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-vb/_static/image40.png)](updating-the-tableadapter-to-use-joins-vb/_static/image39.png)</span></span>

<span data-ttu-id="84887-276">**Figura 15**: eliminación de un empleado que tiene como consecuencia de pedidos correspondiente en una infracción de restricción de clave externa ([haga clic aquí para ver la imagen a tamaño completo](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="84887-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-vb/_static/image41.png))</span></span>


<span data-ttu-id="84887-277">Para permitir a los empleados a ser eliminados se puede:</span><span class="sxs-lookup"><span data-stu-id="84887-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="84887-278">Actualizar la restricción foreign key para la eliminación en cascada</span><span class="sxs-lookup"><span data-stu-id="84887-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="84887-279">Elimine manualmente los registros de la `Orders` tabla para los empleados que desea eliminar, o</span><span class="sxs-lookup"><span data-stu-id="84887-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="84887-280">Actualización de la `Employees_Delete` procedimiento almacenado para eliminar los registros relacionados de la `Orders` tabla antes de eliminar el `Employees` registro.</span><span class="sxs-lookup"><span data-stu-id="84887-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="84887-281">Analizamos esta técnica en el [utilizando procedimientos almacenados existentes para la s de conjunto de datos con tipo TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="84887-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span>

<span data-ttu-id="84887-282">Dejar este como un ejercicio para el lector.</span><span class="sxs-lookup"><span data-stu-id="84887-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="84887-283">Resumen</span><span class="sxs-lookup"><span data-stu-id="84887-283">Summary</span></span>

<span data-ttu-id="84887-284">Cuando se trabaja con bases de datos relacionales, es común para las consultas extraer los datos de varias tablas relacionadas.</span><span class="sxs-lookup"><span data-stu-id="84887-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="84887-285">Subconsultas correlacionadas y `JOIN` proporcionan dos técnicas distintas para tener acceso a datos de las tablas relacionadas en una consulta.</span><span class="sxs-lookup"><span data-stu-id="84887-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="84887-286">En tutoriales anteriores hemos realizado suelen usan de subconsultas correlacionadas porque TableAdapter no puede Autogenerar `INSERT`, `UPDATE`, y `DELETE` instrucciones para las consultas que implican `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="84887-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="84887-287">Mientras estos valores se pueden proporcionar manualmente, al usar instrucciones SQL ad hoc las personalizaciones se sobrescribirán cuando se completa el Asistente para configuración de TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="84887-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="84887-288">Afortunadamente, los TableAdapters creados mediante los procedimientos almacenados no sufren la fragilidad mismo como los creados mediante instrucciones SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="84887-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="84887-289">Por lo tanto, resulta adecuado para crear un TableAdapter cuya consulta principal utiliza un `JOIN` cuando utilice procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="84887-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="84887-290">En este tutorial, hemos visto cómo crear este tipo de un TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="84887-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="84887-291">Se inició mediante un `JOIN`-menos `SELECT` de consulta para la consulta principal de TableAdapter s para que la correspondiente insert, update y procedimientos almacenados de eliminación sería creado automáticamente.</span><span class="sxs-lookup"><span data-stu-id="84887-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="84887-292">TableAdapter s inicial completado la configuración, hemos aumentado el `SelectCommand` procedimiento almacenado para usar un `JOIN` y vuelva a ejecutar el Asistente de configuración de TableAdapter para actualizar la `EmployeesDataTable` columnas s.</span><span class="sxs-lookup"><span data-stu-id="84887-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="84887-293">Volver a ejecutar el Asistente de configuración de TableAdapter se actualiza automáticamente la `EmployeesDataTable` columnas para reflejar los campos de datos devueltos por la `Employees_Select` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="84887-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="84887-294">Como alternativa, podríamos haber agregamos estas columnas manualmente a la tabla de datos.</span><span class="sxs-lookup"><span data-stu-id="84887-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="84887-295">Exploraremos manualmente agrega columnas a la tabla de datos en el tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="84887-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="84887-296">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="84887-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="84887-297">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="84887-297">About the Author</span></span>

<span data-ttu-id="84887-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="84887-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="84887-299">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="84887-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="84887-300">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="84887-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="84887-301">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="84887-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="84887-302">Agradecimientos especiales a</span><span class="sxs-lookup"><span data-stu-id="84887-302">Special Thanks To</span></span>

<span data-ttu-id="84887-303">Esta serie de tutoriales se revisó por varios revisores útiles.</span><span class="sxs-lookup"><span data-stu-id="84887-303">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="84887-304">Los revisores iniciales para este tutorial eran Hilton Geisenow, David Suru y Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="84887-304">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="84887-305">¿Está interesado en revisar mi próximos artículos MSDN?</span><span class="sxs-lookup"><span data-stu-id="84887-305">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="84887-306">Si es así, me quitar una línea en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="84887-306">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="84887-307">[Anterior](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [Siguiente](adding-additional-datatable-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="84887-307">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](adding-additional-datatable-columns-vb.md)</span></span>
