---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
title: Depurar procedimientos almacenados (VB) | Documentos de Microsoft
author: rick-anderson
description: "Ediciones de Visual Studio Professional y Team System permiten establecer puntos de interrupción y paso a paso los procedimientos almacenados de SQL Server, que realiza la depuración almacenados..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 9ed8ccb5-5f31-4eb4-976d-cabf4b45ca09
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
msc.type: authoredcontent
ms.openlocfilehash: ad09847d828d02019a72e3022d035a8fbe921568
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2018
---
<a name="debugging-stored-procedures-vb"></a><span data-ttu-id="cf0b6-103">Depurar procedimientos almacenados (VB)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-103">Debugging Stored Procedures (VB)</span></span>
====================
<span data-ttu-id="cf0b6-104">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cf0b6-105">[Descargar código](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) o [descarga de PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) or [Download PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span></span>

> <span data-ttu-id="cf0b6-106">Ediciones de Visual Studio Professional y Team System permiten establecer puntos de interrupción y paso a paso los procedimientos almacenados de SQL Server, que realiza la depuración de procedimientos almacenados tan sencillo como la depuración de código de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="cf0b6-107">Este tutorial muestra la depuración de base de datos directa y depuración de la aplicación de procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>


## <a name="introduction"></a><span data-ttu-id="cf0b6-108">Introducción</span><span class="sxs-lookup"><span data-stu-id="cf0b6-108">Introduction</span></span>

<span data-ttu-id="cf0b6-109">Visual Studio proporciona una rica experiencia de depuración.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="cf0b6-110">Con unas pocas pulsaciones de teclas o clics del mouse, se puede usar los puntos de interrupción para detener la ejecución de un programa y examinar su estado y control de flujo de s.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="cf0b6-111">Junto con la depuración de código de la aplicación, Visual Studio ofrece compatibilidad para depurar procedimientos almacenados desde dentro de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="cf0b6-112">Al igual que se pueden establecer puntos de interrupción en el código de una clase de código subyacente ASP.NET o una clase de la capa de lógica empresarial, por lo que demasiado se pueden colocar dentro de los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="cf0b6-113">En este tutorial, veremos ejecuta paso a paso los procedimientos almacenados desde el Explorador de servidores en Visual Studio, así como cómo establecer puntos de interrupción que se producen cuando el procedimiento almacenado se llama desde la aplicación ASP.NET en ejecución.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="cf0b6-114">Por desgracia, solo se pueden ejecutar paso a paso y depurar a través de las versiones Professional y sistemas de equipo de Visual Studio los procedimientos almacenados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="cf0b6-115">Si está utilizando la versión estándar de Visual Studio o Visual Web Developer, es para leer a lo largo de tal y como le guiará por los pasos necesarios para depurar procedimientos almacenados, pero no podrá replicar estos pasos en su equipo.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>


## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="cf0b6-116">Conceptos de depuración de SQL Server</span><span class="sxs-lookup"><span data-stu-id="cf0b6-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="cf0b6-117">Microsoft SQL Server 2005 se diseñó para proporcionar una integración con la [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), que es el tiempo de ejecución utilizado por todos los ensamblados. NET.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="cf0b6-118">Por lo tanto, SQL Server 2005 admite objetos de base de datos administrados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="cf0b6-119">Es decir, puede crear objetos de base de datos como procedimientos almacenados y funciones definidas por el usuario (UDF) como métodos en una clase de Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a Visual Basic class.</span></span> <span data-ttu-id="cf0b6-120">Esto permite que estos procedimientos almacenados y UDF para utilizar la funcionalidad de .NET Framework y de sus propias clases personalizadas.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="cf0b6-121">Por supuesto, SQL Server 2005 también proporciona compatibilidad con objetos de base de datos de T-SQL.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="cf0b6-122">SQL Server 2005 ofrece compatibilidad con la depuración de T-SQL y objetos de base de datos administrados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="cf0b6-123">Sin embargo, solo se pueden depurar estos objetos a través de las ediciones de Visual Studio 2005 Professional y sistemas de equipo.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="cf0b6-124">En este tutorial se examinará la depuración de los objetos de base de datos de T-SQL.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="cf0b6-125">El tutorial posterior se examina depurar objetos de base de datos administrados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="cf0b6-126">El [información general de T-SQL y CLR la depuración en SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) entrada del blog de la [equipo de integración de CLR de SQL Server 2005](https://blogs.msdn.com/sqlclr/default.aspx) resalta las tres maneras de depurar objetos de SQL Server 2005 desde Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="cf0b6-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="cf0b6-127">**Dirigir la depuración de base de datos (DDD)** : en el Explorador de servidores se puede ir a cualquier objeto de base de datos de T-SQL, como procedimientos almacenados y UDF.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="cf0b6-128">Examinaremos DDD en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="cf0b6-129">**Depuración de aplicación** -podemos establecer puntos de interrupción dentro de un objeto de base de datos y, a continuación, ejecutar la aplicación ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="cf0b6-130">Cuando se ejecuta el objeto de base de datos, se tendrán en cuenta el punto de interrupción y control traspase al depurador.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="cf0b6-131">Tenga en cuenta que con la depuración de la aplicación se no podemos depurar paso a paso un objeto de base de datos desde el código de aplicación.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="cf0b6-132">Debemos explícitamente establecemos puntos de interrupción en los procedimientos almacenados o UDF donde se desea que el depurador se detenga.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="cf0b6-133">Depuración de la aplicación se examina a partir del paso 2.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="cf0b6-134">**Depuración de un proyecto de SQL Server** -ediciones de Visual Studio Professional y sistemas de equipo son un tipo de proyecto de SQL Server que se usa normalmente para crear objetos de base de datos administrados.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="cf0b6-135">Examinaremos con proyectos de SQL Server y la depuración de su contenido en el siguiente tutorial.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="cf0b6-136">Visual Studio puede depurar procedimientos almacenados en instancias de SQL Server locales y remotos.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="cf0b6-137">Una instancia de SQL Server local es aquella que está instalado en el mismo equipo que Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="cf0b6-138">Si la base de datos de SQL Server que está utilizando no se encuentra en el equipo de desarrollo, se considera una instancia remota.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="cf0b6-139">Para estos tutoriales se ha utilizado las instancias de SQL Server locales.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="cf0b6-140">Depurar procedimientos almacenados en una instancia remota de SQL server requiere más pasos de configuración que cuando depura los procedimientos almacenados en una instancia local.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="cf0b6-141">Si está utilizando una instancia de SQL Server local, puede iniciar con el paso 1 y trabajar a través de este tutorial hasta el final.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="cf0b6-142">Si utilizas una instancia remota de SQL Server, sin embargo, tendrá que primero debe asegurarse de que al depurar se registran en el equipo de desarrollo con una cuenta de usuario de Windows que tiene un inicio de sesión de SQL Server en la instancia remota.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="cf0b6-143">Moveover, este inicio de sesión de base de datos y el inicio de sesión de base de datos que se usa para conectarse a la base de datos de la aplicación ASP.NET en ejecución debe ser miembros de los `sysadmin` rol.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-143">Moveover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="cf0b6-144">Ver los objetos de base de datos de T-SQL depuración en la sección de instancias remotas al final de este tutorial para obtener más información acerca de cómo configurar Visual Studio y SQL Server para depurar una instancia remota.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="cf0b6-145">Por último, comprender que la compatibilidad de depuración para objetos de base de datos de T-SQL no es tan variado como compatibilidad de depuración para aplicaciones .NET.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="cf0b6-146">Por ejemplo, condiciones de punto de interrupción y los filtros no son compatibles, únicamente un subconjunto de las ventanas de depuración están disponibles, no se puede usar Editar y continuar, se representa la ventana Inmediato inservible y así sucesivamente.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="cf0b6-147">Vea [las limitaciones de características y comandos del depurador](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="cf0b6-148">Paso 1: Entrar directamente en un procedimiento almacenado</span><span class="sxs-lookup"><span data-stu-id="cf0b6-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="cf0b6-149">Visual Studio resulta fácil de depurar directamente un objeto de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="cf0b6-150">Permiten s mire cómo usar la característica de depuración de base de datos directa (DDD) para ir a la `Products_SelectByCategoryID` procedimiento almacenado en la base de datos Northwind.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="cf0b6-151">Como su nombre implica, `Products_SelectByCategoryID` devuelve información de producto de una categoría determinada; se creó en el [utilizando procedimientos almacenados existentes para la s de conjunto de datos con tipo TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="cf0b6-152">Iniciar desde el Explorador de servidores y expanda el nodo de base de datos Northwind.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="cf0b6-153">A continuación, profundizar en la carpeta procedimientos almacenados, haga doble clic en el `Products_SelectByCategoryID` procedimiento almacenado y elija la opción de ir a procedimiento almacenado en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="cf0b6-154">Se iniciará al depurador.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-154">This will start the debugger.</span></span>

<span data-ttu-id="cf0b6-155">Puesto que la `Products_SelectByCategoryID` procedimiento almacenado espera un `@CategoryID` parámetro de entrada, se nos pide que proporcionar este valor.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="cf0b6-156">Escriba 1, que se devolverá información sobre las bebidas.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-156">Enter 1, which will return information about the beverages.</span></span>


![Utilice el valor 1 para el @CategoryID parámetro](debugging-stored-procedures-vb/_static/image1.png)

<span data-ttu-id="cf0b6-158">**Figura 1**: utilice el valor 1 para el `@CategoryID` parámetro</span><span class="sxs-lookup"><span data-stu-id="cf0b6-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>


<span data-ttu-id="cf0b6-159">Después de suministrar el valor de la `@CategoryID` , el procedimiento almacenado se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="cf0b6-160">Sin embargo, en lugar de ejecutarse hasta su finalización, el depurador detiene la ejecución en la primera instrucción.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="cf0b6-161">Tenga en cuenta la flecha amarilla en el margen, que indica la ubicación actual en el procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="cf0b6-162">Puede ver y editar los valores de parámetro a través de la ventana Inspección o mantenga el puntero sobre el nombre del parámetro en el procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>


<span data-ttu-id="cf0b6-163">[![El depurador se detiene en la primera instrucción del procedimiento almacenado](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span></span>

<span data-ttu-id="cf0b6-164">**Figura 2**: el depurador se detiene en la primera instrucción del procedimiento almacenado ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image4.png))</span></span>


<span data-ttu-id="cf0b6-165">Para conocer los pasos a través de la instrucción de un procedimiento almacenado a la vez, haga clic en el botón paso a paso por la barra de herramientas o presionar la tecla F10.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="cf0b6-166">El `Products_SelectByCategoryID` procedimiento almacenado contiene un único `SELECT` instrucción, por lo que presionar F10 van a pasar por alto la instrucción única y completar la ejecución del procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="cf0b6-167">Cuando haya finalizado el procedimiento almacenado, el resultado aparecerá en la ventana de salida y se cerrará el depurador.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="cf0b6-168">Depuración de T-SQL se produce en el nivel de instrucción; no se puede ir a un `SELECT` instrucción.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-168">T-SQL debugging occurs at the statement level; you cannot step into a `SELECT` statement.</span></span>


## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="cf0b6-169">Paso 2: Configuración del sitio Web para depurar la aplicación</span><span class="sxs-lookup"><span data-stu-id="cf0b6-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="cf0b6-170">Al depurar un procedimiento almacenado directamente desde el Explorador de servidores es útil, en muchos escenarios se está más interesados en depurar el procedimiento almacenado cuando se llama desde la aplicación de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="cf0b6-171">Podemos agregar puntos de interrupción a un procedimiento almacenado desde dentro de Visual Studio y, a continuación, empiece a depurar la aplicación de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="cf0b6-172">Cuando se invoca un procedimiento almacenado con los puntos de interrupción de la aplicación, se detendrá la ejecución en el punto de interrupción y podemos ver y cambiar los valores de parámetro de procedimiento almacenado s y recorre paso a paso sus instrucciones, al igual que hicimos en el paso 1.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="cf0b6-173">Antes de que podemos empezar a depurar procedimientos almacenados que se llama desde la aplicación, es necesario indicar a la aplicación web ASP.NET para integrar con el depurador de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="cf0b6-174">Iniciar con el botón secundario en el nombre del sitio Web en el Explorador de soluciones (`ASPNET_Data_Tutorial_74_VB`).</span><span class="sxs-lookup"><span data-stu-id="cf0b6-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_VB`).</span></span> <span data-ttu-id="cf0b6-175">Elija la opción de páginas de propiedades en el menú contextual, seleccione el elemento de opciones de inicio de la izquierda y Active la casilla de SQL Server en la sección de depuradores (consulte la figura 3).</span><span class="sxs-lookup"><span data-stu-id="cf0b6-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>


<span data-ttu-id="cf0b6-176">[![Active la casilla SQL Server en las páginas de propiedades de aplicación s](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span></span>

<span data-ttu-id="cf0b6-177">**Figura 3**: Active la casilla de SQL Server en las páginas de propiedades de asignación de aplicación ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image7.png))</span></span>


<span data-ttu-id="cf0b6-178">Además, deberá actualizar la cadena de conexión de base de datos utilizada por la aplicación para que la agrupación de conexiones está deshabilitada.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="cf0b6-179">Cuando se cierra una conexión a una base de datos, la correspondiente `SqlConnection` objeto se coloca en un grupo de conexiones disponibles.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="cf0b6-180">Al establecer una conexión a una base de datos, un objeto de conexión disponibles se pueden recuperar de este grupo en lugar de tener que crear y establecer una nueva conexión.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="cf0b6-181">Esta agrupación de objetos de conexión es una mejora del rendimiento y está habilitada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="cf0b6-182">Sin embargo, al depurar que queremos desactivar la agrupación de conexiones, dado que la infraestructura de depuración no se restablece correctamente cuando se trabaja con una conexión que se tomó del grupo.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="cf0b6-183">Agrupación de conexiones deshabilitada, actualizar el `NORTHWNDConnectionString` en `Web.config` para que incluya la configuración de `Pooling=false` .</span><span class="sxs-lookup"><span data-stu-id="cf0b6-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>


[!code-xml[Main](debugging-stored-procedures-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="cf0b6-184">Cuando haya terminado de depuración de SQL Server a través de la aplicación ASP.NET Asegúrese de volver a aplicar la agrupación de conexiones mediante la eliminación de la `Pooling` de la cadena de conexión (o si se establece en `Pooling=true` ).</span><span class="sxs-lookup"><span data-stu-id="cf0b6-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>


<span data-ttu-id="cf0b6-185">En este momento la aplicación de ASP.NET se ha configurado para permitir que Visual Studio depurar objetos de base de datos de SQL Server cuando se invoca a través de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="cf0b6-186">Lo único que queda ahora es agregar un punto de interrupción a un procedimiento almacenado e iniciar la depuración.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="cf0b6-187">Paso 3: Agregar un punto de interrupción y depuración</span><span class="sxs-lookup"><span data-stu-id="cf0b6-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="cf0b6-188">Abra la `Products_SelectByCategoryID` procedimiento almacenado y establezca un punto de interrupción al principio de la `SELECT` instrucción haciendo clic en el margen en el lugar adecuado o colocando el cursor al principio de la `SELECT` instrucción y presionar la tecla F9.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="cf0b6-189">Como se muestra en la figura 4, el punto de interrupción aparece como un círculo rojo en el margen.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>


<span data-ttu-id="cf0b6-190">[![Establecer un punto de interrupción en el Products_SelectByCategoryID procedimiento almacenado](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span></span>

<span data-ttu-id="cf0b6-191">**Figura 4**: establecer un punto de interrupción en la `Products_SelectByCategoryID` procedimiento almacenado ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image10.png))</span></span>


<span data-ttu-id="cf0b6-192">En el orden de un objeto de base de datos SQL que desea depurar a través de una aplicación cliente, es imperativo que la base de datos se configura para admitir la depuración de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="cf0b6-193">Al establecer un punto de interrupción, automáticamente se debe cambiar esta configuración, pero es recomendable comprobar de nuevo.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="cf0b6-194">Haga doble clic en el `NORTHWND.MDF` nodo en el Explorador de servidores.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="cf0b6-195">El menú contextual debe incluir un comprobado elemento de menú denominado depurar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-195">The context menu should include a checked menu item named Application Debugging .</span></span>


![Asegúrese de que está habilitada la opción de depuración de aplicaciones](debugging-stored-procedures-vb/_static/image11.png)

<span data-ttu-id="cf0b6-197">**Figura 5**: asegúrese de que está habilitada la opción de depuración de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="cf0b6-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>


<span data-ttu-id="cf0b6-198">Con el conjunto de puntos de interrupción y la opción de depuración de la aplicación habilitada, estamos preparados para depurar el procedimiento almacenado cuando se llama desde la aplicación de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="cf0b6-199">Iniciar al depurador, vaya al menú Depurar y elegir Iniciar depuración, al presionar F5 o haciendo clic en el color verde icono reproducir en la barra de herramientas.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="cf0b6-200">Esto inicia al depurador e iniciar el sitio Web.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="cf0b6-201">El `Products_SelectByCategoryID` se creó el procedimiento almacenado en el [utilizando procedimientos almacenados existentes para la s de conjunto de datos con tipo TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="cf0b6-202">Su página web correspondiente (`~/AdvancedDAL/ExistingSprocs.aspx`) contiene una GridView que muestra los resultados devueltos por este procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="cf0b6-203">Visite esta página a través del explorador.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-203">Visit this page through the browser.</span></span> <span data-ttu-id="cf0b6-204">Al llegar a la página, el punto de interrupción en el `Products_SelectByCategoryID` se alcanzarán el procedimiento almacenado y devuelve el control a Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="cf0b6-205">Al igual que en el paso 1, puede recorrer las instrucciones de s de procedimiento almacenado y la vista y modificar los valores de parámetro.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>


<span data-ttu-id="cf0b6-206">[![La página ExistingSprocs.aspx muestra inicialmente las bebidas](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span></span>

<span data-ttu-id="cf0b6-207">**Figura 6**: el `ExistingSprocs.aspx` página muestra inicialmente las bebidas ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image14.png))</span></span>


<span data-ttu-id="cf0b6-208">[![El procedimiento almacenado s se ha alcanzado el punto de interrupción](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span></span>

<span data-ttu-id="cf0b6-209">**Figura 7**: s el procedimiento almacenado se ha alcanzado el punto de interrupción ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-vb/_static/image17.png))</span></span>


<span data-ttu-id="cf0b6-210">Como la ventana de inspección en la figura 7 muestra, el valor de la `@CategoryID` del parámetro es 1.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="cf0b6-211">Esto es porque el `ExistingSprocs.aspx` página inicialmente muestra los productos en la categoría Bebidas, que tiene un `CategoryID` valor 1.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="cf0b6-212">Elija una categoría diferente en la lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="cf0b6-213">Si lo hace, provoca una devolución de datos y vuelve a ejecutar la `Products_SelectByCategoryID` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="cf0b6-214">El punto de interrupción, pero esta vez el `@CategoryID` el valor de parámetro s refleja el elemento de lista desplegable seleccionado s `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>


<span data-ttu-id="cf0b6-215">[![Elija una categoría diferente en la lista desplegable](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span></span>

<span data-ttu-id="cf0b6-216">**Figura 8**: elija una categoría diferente en la lista desplegable ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-vb/_static/image20.png))</span></span>


<span data-ttu-id="cf0b6-217">[![El @CategoryID parámetro refleja la categoría seleccionada desde la página Web](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span></span>

<span data-ttu-id="cf0b6-218">**Figura 9**: el `@CategoryID` parámetro refleja la categoría seleccionada desde la página Web ([haga clic aquí para ver la imagen a tamaño completo](debugging-stored-procedures-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="cf0b6-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-vb/_static/image23.png))</span></span>


> [!NOTE]
> <span data-ttu-id="cf0b6-219">Si el punto de interrupción en la `Products_SelectByCategoryID` procedimiento almacenado no se alcanza cuando se visita el `ExistingSprocs.aspx` página, asegúrese de que la casilla de verificación de SQL Server se ha comprobado en la sección de depuradores de la aplicación de ASP.NET s página de propiedades, que ha sido la agrupación de conexiones deshabilitado, y que la base de datos s: opción de depuración de la aplicación está habilitada.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="cf0b6-220">Si se van a sigue teniendo problemas, reinicie Visual Studio y vuelva a intentarlo.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-220">If you re still having problems, restart Visual Studio and try again.</span></span>


## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="cf0b6-221">Depurar objetos de base de datos de T-SQL en instancias remotas</span><span class="sxs-lookup"><span data-stu-id="cf0b6-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="cf0b6-222">Depurar objetos de base de datos a través de Visual Studio es bastante sencillo cuando la instancia de base de datos de SQL Server está en el mismo equipo que Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="cf0b6-223">Sin embargo, si SQL Server y Visual Studio se encuentran en equipos diferentes, a continuación, una configuración cuidadosa debe hacer que todo funciona correctamente.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="cf0b6-224">Hay dos tareas principales que nos enfrentamos con:</span><span class="sxs-lookup"><span data-stu-id="cf0b6-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="cf0b6-225">Asegúrese de que el inicio de sesión utilizado para conectarse a la base de datos mediante ADO.NET pertenece a la `sysadmin` rol.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="cf0b6-226">Asegúrese de que la cuenta de usuario de Windows utilizada por Visual Studio en el equipo de desarrollo es una cuenta válida de inicio de sesión de SQL Server que pertenezca a la `sysadmin` rol.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="cf0b6-227">El primer paso es relativamente sencillo.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="cf0b6-228">En primer lugar, identificar la cuenta de usuario utilizada para conectarse a la base de datos de la aplicación ASP.NET y, a continuación, desde SQL Server Management Studio, agregue esa cuenta de inicio de sesión para el `sysadmin` rol.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="cf0b6-229">La segunda tarea requiere que la cuenta de usuario de Windows que se utilizar para depurar la aplicación sea un inicio de sesión válido en la base de datos remota.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="cf0b6-230">Sin embargo, lo más probable es que conectado a la estación de trabajo con la cuenta de Windows no es un inicio de sesión válido en SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="cf0b6-231">En lugar de agregar la cuenta de inicio de sesión determinado a SQL Server, sería una opción mejor designar alguna cuenta de usuario de Windows como la cuenta de depuración de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="cf0b6-232">A continuación, para depurar los objetos de base de datos de una instancia de SQL Server remota, podría ejecutar Visual Studio con las credenciales que cuenta s de inicio de sesión de Windows.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="cf0b6-233">Un ejemplo debe ayudar a aclarar cosas.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-233">An example should help clarify things.</span></span> <span data-ttu-id="cf0b6-234">Imagine que hay una cuenta de Windows denominada `SQLDebug` dentro del dominio de Windows.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="cf0b6-235">Esta cuenta se debe agregarse a la instancia remota de SQL Server como un inicio de sesión válido, como un miembro de la `sysadmin` rol.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="cf0b6-236">A continuación, para depurar la instancia de SQL Server remota desde Visual Studio, se necesita ejecutar Visual Studio como la `SQLDebug` usuario.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="cf0b6-237">Esto puede realizarse al cerrar sesión en la estación de trabajo, en el registro como `SQLDebug`, y, a continuación, inicie Visual Studio, pero un enfoque más simple sería iniciar sesión en la estación de trabajo con nuestros propio credenciales y, a continuación, usar `runas.exe` para iniciar Visual Studio como el `SQLDebug` usuario.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="cf0b6-238">`runas.exe`permite que una aplicación concreta que se ejecuta en forma de una cuenta de usuario diferente.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="cf0b6-239">Para iniciar Visual Studio como `SQLDebug`, puede escribir la siguiente instrucción en la línea de comandos:</span><span class="sxs-lookup"><span data-stu-id="cf0b6-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>


[!code-console[Main](debugging-stored-procedures-vb/samples/sample2.cmd)]

<span data-ttu-id="cf0b6-240">Para obtener una explicación más detallada acerca de este proceso, consulte [William R. Vaughn](http://betav.com/BLOG/billva/) s *Autoestopista s Guide en Visual Studio y SQL Server, edición séptimo* como [How To: establecer permisos de SQL Server para la depuración](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="cf0b6-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="cf0b6-241">Si el equipo de desarrollo está ejecutando Windows XP Service Pack 2, debe configurar el Firewall de conexión a Internet para permitir la depuración remota.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="cf0b6-242">[Cómo para: habilitar la depuración de SQL Server 2005](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) artículo notas que esto conlleva dos pasos: (a) en el equipo host de Visual Studio, debe agregar `Devenv.exe` a la lista de excepciones y abrir el puerto TCP 135; y (b) en el equipo remoto de (SQL), debe abrir TCP 135 de puerto y agregue `sqlservr.exe` a la lista de excepciones.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="cf0b6-243">Si la directiva de dominio exige que la comunicación de red se realicen a través de IPSec, debe abrir los puertos UDP 4500 y UDP 500.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>


## <a name="summary"></a><span data-ttu-id="cf0b6-244">Resumen</span><span class="sxs-lookup"><span data-stu-id="cf0b6-244">Summary</span></span>

<span data-ttu-id="cf0b6-245">Además de proporcionar compatibilidad con la depuración de código de la aplicación. NET, Visual Studio también proporciona una variedad de opciones de depuración para SQL Server 2005.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="cf0b6-246">En este tutorial, observamos dos de estas opciones: depuración directa de base de datos y depurar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="cf0b6-247">Para depurar directamente un objeto de base de datos de T-SQL, busque el objeto mediante el Explorador de servidores, a continuación, haga doble clic en él y elija Depurar paso a paso.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="cf0b6-248">El depurador se inicia y se detiene en la primera instrucción en el objeto de base de datos, momento en que puede recorrer las instrucciones de s de objeto y la vista y modificar valores de parámetro.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="cf0b6-249">En el paso 1 se utiliza este enfoque para depurar paso a paso el `Products_SelectByCategoryID` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="cf0b6-250">Depuración de la aplicación permite a los puntos de interrupción se pueden establecer directamente en los objetos de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="cf0b6-251">Cuando un objeto de base de datos con puntos de interrupción se invoca desde una aplicación de cliente (por ejemplo, una aplicación web ASP.NET), el programa se detiene como asume el depurador.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="cf0b6-252">Depuración de la aplicación es útil porque muestra con más claridad qué acción de aplicación provoca que un objeto de base de datos concreta que se debe invocar.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="cf0b6-253">Sin embargo, requiere un poco más de configuración y el programa de instalación de la depuración directa de base de datos.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="cf0b6-254">También se pueden depurar objetos de base de datos a través de los proyectos de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="cf0b6-255">Examinaremos usando proyectos de SQL Server y cómo utilizarlas para crear y depurar los objetos de base de datos administrados en el tutorial siguiente.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="cf0b6-256">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cf0b6-257">Acerca del autor</span><span class="sxs-lookup"><span data-stu-id="cf0b6-257">About the Author</span></span>

<span data-ttu-id="cf0b6-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), autor de siete libros sobre ASP/ASP.NET y fundador de [4GuysFromRolla.com](http://www.4guysfromrolla.com), ha trabajado con las tecnologías Web de Microsoft desde 1998.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cf0b6-259">Scott funciona como un consultor independiente, instructor y escritor.</span><span class="sxs-lookup"><span data-stu-id="cf0b6-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cf0b6-260">Su último libro es [*SAM enseñar a usted mismo ASP.NET 2.0 en 24 horas*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="cf0b6-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cf0b6-261">Puede ponerse en [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o a través de su blog, que se pueden encontrar en [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="cf0b6-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="cf0b6-262">[Anterior](protecting-connection-strings-and-other-configuration-information-vb.md)
[Siguiente](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span><span class="sxs-lookup"><span data-stu-id="cf0b6-262">[Previous](protecting-connection-strings-and-other-configuration-information-vb.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span></span>
