---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/logging-error-details-with-asp-net-health-monitoring-vb
title: El registro de detalles del Error (VB) de supervisión de estado de ASP.NET | Documentos de Microsoft
author: rick-anderson
description: Sistema de supervisión de estado de Microsoft proporciona una manera fácil y personalizable para registrar varios eventos de web, incluidas las excepciones no controladas. Este tutorial le guía acc...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: 09a6c74e-936a-4c04-8547-5bb313a4e4a3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/logging-error-details-with-asp-net-health-monitoring-vb
msc.type: authoredcontent
ms.openlocfilehash: 0a457d4b8773f0f4ed343f5005c76f48a5cc178f
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888947"
---
<a name="logging-error-details-with-aspnet-health-monitoring-vb"></a><span data-ttu-id="2eb5c-104">Detalles de Error de registro con (VB) de supervisión de estado de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2eb5c-104">Logging Error Details with ASP.NET Health Monitoring (VB)</span></span>
====================
<span data-ttu-id="2eb5c-105">por [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2eb5c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2eb5c-106">[Descargar código](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_13_VB.zip) o [descarga de PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial13_HealthMonitoring_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="2eb5c-106">[Download Code](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_13_VB.zip) or [Download PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial13_HealthMonitoring_vb.pdf)</span></span>

> <span data-ttu-id="2eb5c-107">Sistema de supervisión de estado de Microsoft proporciona una manera fácil y personalizable para registrar varios eventos de web, incluidas las excepciones no controladas.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-107">Microsoft's health monitoring system provides an easy and customizable way to log various web events, including unhandled exceptions.</span></span> <span data-ttu-id="2eb5c-108">Este tutorial le guía a través de configurar el sistema de supervisión de estado para iniciar las excepciones no controladas en una base de datos y para notificar a los desarrolladores a través de un mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-108">This tutorial walks through setting up the health monitoring system to log unhandled exceptions to a database and to notify developers via an email message.</span></span>


## <a name="introduction"></a><span data-ttu-id="2eb5c-109">Introducción</span><span class="sxs-lookup"><span data-stu-id="2eb5c-109">Introduction</span></span>

<span data-ttu-id="2eb5c-110">El registro es una herramienta útil para supervisar el estado de una aplicación implementada y para diagnosticar los problemas que pueden surgir.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-110">Logging is a useful tool for monitoring the health of a deployed application and for diagnosing any problems that may arise.</span></span> <span data-ttu-id="2eb5c-111">Es especialmente importante registrar los errores que se producen en una aplicación implementada, por lo que puede resolverse.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-111">It is especially important to log errors that occur in a deployed application so that they can be remedied.</span></span> <span data-ttu-id="2eb5c-112">El `Error` evento se desencadena cuando se produce una excepción no controlada en una aplicación ASP.NET; la [tutorial anterior](processing-unhandled-exceptions-vb.md) se ha explicado cómo notificar a un desarrollador de un error y los detalles de registro mediante la creación de un controlador de eventos para el `Error` eventos.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-112">The `Error` event is raised whenever an unhandled exception occurs in an ASP.NET application; the [preceding tutorial](processing-unhandled-exceptions-vb.md) showed how to notify a developer of an error and log its details by creating an event handler for the `Error` event.</span></span> <span data-ttu-id="2eb5c-113">Sin embargo, creando un `Error` es necesario, el controlador de eventos para registrar los detalles del error y notifíquelo a un programador que esta tarea puede realizarse mediante ASP. De NET *sistema de supervisión de estado*.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-113">However, creating an `Error` event handler to log the error's details and notify a developer is unnecessary, as this task can be performed by ASP.NET's *health monitoring system*.</span></span>

<span data-ttu-id="2eb5c-114">El sistema de supervisión de estado se introdujo en ASP.NET 2.0 y está diseñado para supervisar el estado de una aplicación ASP.NET implementada registrando los eventos que se producen durante la vigencia de la solicitud o la aplicación.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-114">The health monitoring system was introduced in ASP.NET 2.0 and is designed to monitor the health of a deployed ASP.NET application by logging events that occur during the application or request's lifetime.</span></span> <span data-ttu-id="2eb5c-115">Los eventos registrados por el sistema de supervisión de estado se conocen como *eventos de supervisión de estado* o *Web eventos*e incluyen:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-115">The events logged by the health monitoring system are referred to as *health monitoring events* or *Web events*, and include:</span></span>

- <span data-ttu-id="2eb5c-116">Eventos de duración de la aplicación, por ejemplo, cuando una aplicación se inicia o detiene</span><span class="sxs-lookup"><span data-stu-id="2eb5c-116">Application lifetime events, such as when an application starts or stops</span></span>
- <span data-ttu-id="2eb5c-117">Eventos de seguridad, incluidos los intentos de inicio de sesión y errores de solicitud de autorización de dirección URL</span><span class="sxs-lookup"><span data-stu-id="2eb5c-117">Security events, including failed login attempts and failed URL authorization requests</span></span>
- <span data-ttu-id="2eb5c-118">Errores de aplicación, incluidos los no controladas excepciones, análisis de excepciones, las excepciones de validación de solicitud y errores de compilación, entre otros tipos de errores de estado de vista.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-118">Application errors, including unhandled exceptions, view state parsing exceptions, request validation exceptions, and compilation errors, among other types of errors.</span></span>

<span data-ttu-id="2eb5c-119">Cuando un estado se desencadena el evento de supervisión se puede registrar en cualquier número de especificado *orígenes de registro*.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-119">When a health monitoring event is raised it can be logged to any number of specified *log sources*.</span></span> <span data-ttu-id="2eb5c-120">El sistema de supervisión de estado se suministra con los orígenes de registro que registran eventos de Web en una base de datos de Microsoft SQL Server, o en el registro de eventos de Windows a través de un mensaje de correo electrónico, entre otros.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-120">The health monitoring system ships with log sources that log Web events to a Microsoft SQL Server database, to the Windows Event Log, or via an email message, among others.</span></span> <span data-ttu-id="2eb5c-121">También puede crear sus propios orígenes de registro.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-121">You can also create your own log sources.</span></span>

<span data-ttu-id="2eb5c-122">Los eventos que registra el sistema de supervisión de estado, junto con los orígenes de registro utilizados, se definen en `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-122">The events the health monitoring system logs, along with the log sources used, are defined in `Web.config`.</span></span> <span data-ttu-id="2eb5c-123">Con unas pocas líneas de marcado de configuración sirve para registrar todas las excepciones no controladas en una base de datos y notificaciones de la excepción a través de correo electrónico de seguimiento de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-123">With a few lines of configuration markup you can use health monitoring to log all unhandled exceptions to a database and to notify you of the exception via email.</span></span>

## <a name="exploring-the-health-monitoring-systems-configuration"></a><span data-ttu-id="2eb5c-124">Explorar la configuración del sistema de supervisión de estado</span><span class="sxs-lookup"><span data-stu-id="2eb5c-124">Exploring the Health Monitoring System's Configuration</span></span>

<span data-ttu-id="2eb5c-125">El comportamiento del sistema de supervisión de estado se define por su información de configuración, que se encuentra en la [ `<healthMonitoring>` elemento](https://msdn.microsoft.com/library/2fwh2ss9.aspx) en `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-125">The health monitoring system's behavior is defined by its configuration information, which is located in the [`<healthMonitoring>` element](https://msdn.microsoft.com/library/2fwh2ss9.aspx) in `Web.config`.</span></span> <span data-ttu-id="2eb5c-126">Esta sección de configuración define, entre otras cosas, las siguientes tres partes importantes de información:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-126">This configuration section defines, among other things, the following three important pieces of information:</span></span>

1. <span data-ttu-id="2eb5c-127">Los eventos de supervisión de estado que, cuando se produce, se deben registrar,</span><span class="sxs-lookup"><span data-stu-id="2eb5c-127">The health monitoring events that, when raised, should be logged,</span></span>
2. <span data-ttu-id="2eb5c-128">Los orígenes de registro, y</span><span class="sxs-lookup"><span data-stu-id="2eb5c-128">The log sources, and</span></span>
3. <span data-ttu-id="2eb5c-129">¿Cómo se asigna cada estado de supervisión de eventos definidos en (1) a los orígenes de registro definidos en (2).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-129">How each health monitoring event defined in (1) is mapped to the log sources defined in (2).</span></span>

<span data-ttu-id="2eb5c-130">Esta información se especifica a través de los elementos de configuración de tres nodos secundarios: [ `<eventMappings>` ](https://msdn.microsoft.com/library/yc5yk01w.aspx), [ `<providers>` ](https://msdn.microsoft.com/library/zaa41kz1.aspx), y [ `<rules>` ](https://msdn.microsoft.com/library/fe5wyxa0.aspx), respectivamente.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-130">This information is specified through three children configuration elements: [`<eventMappings>`](https://msdn.microsoft.com/library/yc5yk01w.aspx), [`<providers>`](https://msdn.microsoft.com/library/zaa41kz1.aspx), and [`<rules>`](https://msdn.microsoft.com/library/fe5wyxa0.aspx), respectively.</span></span>

<span data-ttu-id="2eb5c-131">Información de configuración del sistema de supervisión de estado de forma predeterminada se encuentra en la `Web.config` en el archivo `%WINDIR%\Microsoft.NET\Framework\version\CONFIG` carpeta.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-131">The default health monitoring system configuration information can be found in the `Web.config` file in `%WINDIR%\Microsoft.NET\Framework\version\CONFIG` folder.</span></span> <span data-ttu-id="2eb5c-132">Con algún marcado quitado para mayor brevedad, esta información de configuración de forma predeterminada, se muestra a continuación:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-132">This default configuration information, with some markup removed for brevity, is shown below:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample1.xml)]

<span data-ttu-id="2eb5c-133">El estado de eventos de supervisión de interés se definen en el `<eventMappings>` elemento, que proporciona un nombre descriptivo humanos a una clase de eventos de supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-133">The health monitoring events of interest are defined in the `<eventMappings>` element, which gives a human-friendly name to a class of health monitoring events.</span></span> <span data-ttu-id="2eb5c-134">En el código anterior, el `<eventMappings>` elemento asigna el nombre de lenguaje compatible con "todos los errores de" para el estado de supervisión de eventos de tipo `WebBaseErrorEvent` y el nombre "auditorías de errores" eventos de tipo de supervisión del estado `WebFailureAuditEvent`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-134">In the markup above, the `<eventMappings>` element assigns the human-friendly name "All Errors" to the health monitoring events of type `WebBaseErrorEvent` and the name "Failure Audits" to health monitoring events of type `WebFailureAuditEvent`.</span></span>

<span data-ttu-id="2eb5c-135">El `<providers>` elemento define los orígenes de registro, asignarles un nombre descriptivo humanos y especificar cualquier información de configuración específica del origen de registro.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-135">The `<providers>` element defines the log sources, giving them a human-friendly name and specifying any log source-specific configuration information.</span></span> <span data-ttu-id="2eb5c-136">La primera `<add>` elemento define el proveedor "EventLogProvider", que registra el estado especificado supervisión de eventos mediante la `EventLogWebEventProvider` clase.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-136">The first `<add>` element defines the "EventLogProvider" provider, which logs the specified health monitoring events using the `EventLogWebEventProvider` class.</span></span> <span data-ttu-id="2eb5c-137">La `EventLogWebEventProvider` clase registra el evento en el registro de eventos de Windows.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-137">The `EventLogWebEventProvider` class logs the event to the Windows Event Log.</span></span> <span data-ttu-id="2eb5c-138">El segundo `<add>` elemento define el proveedor "SqlWebEventProvider", que registra eventos en una base de datos de Microsoft SQL Server a través de la `SqlWebEventProvider` clase.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-138">The second `<add>` element defines the "SqlWebEventProvider" provider, which logs events to a Microsoft SQL Server database via the `SqlWebEventProvider` class.</span></span> <span data-ttu-id="2eb5c-139">La configuración de "SqlWebEventProvider" especifica la cadena de conexión de la base de datos (`connectionStringName`) entre otras opciones de configuración.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-139">The "SqlWebEventProvider" configuration specifies the database's connection string (`connectionStringName`) among other configuration options.</span></span>

<span data-ttu-id="2eb5c-140">El `<rules>` elemento asigna los eventos especificados en el `<eventMappings>` elemento a orígenes de registro el `<providers>` elemento.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-140">The `<rules>` element maps the events specified in the `<eventMappings>` element to log sources in the `<providers>` element.</span></span> <span data-ttu-id="2eb5c-141">De forma predeterminada, las aplicaciones web ASP.NET registrar todas las excepciones no controladas y auditoría de errores en el registro de eventos de Windows.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-141">By default, ASP.NET web applications log all unhandled exceptions and audit failures to the Windows Event Log.</span></span>

## <a name="logging-events-to-a-database"></a><span data-ttu-id="2eb5c-142">Eventos de registro para una base de datos</span><span class="sxs-lookup"><span data-stu-id="2eb5c-142">Logging Events to a Database</span></span>

<span data-ttu-id="2eb5c-143">Se pueden personalizar la configuración de predeterminada del sistema de supervisión de estado en una base de aplicación web a aplicación web mediante la adición de un `<healthMonitoring>` sección a la aplicación `Web.config` archivo.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-143">The health monitoring system's default configuration can be customized on a web application-by-web application basis by adding a `<healthMonitoring>` section to the application's `Web.config` file.</span></span> <span data-ttu-id="2eb5c-144">Puede incluir elementos adicionales en el `<eventMappings>`, `<providers>`, y `<rules>` secciones usando el `<add>` elemento.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-144">You can include additional elements in the `<eventMappings>`, `<providers>`, and `<rules>` sections by using the `<add>` element.</span></span> <span data-ttu-id="2eb5c-145">Para quitar una configuración de la utilización de la configuración predeterminada del `<remove>` elemento o use `<clear />` para quitar todos los valores predeterminados de una de estas secciones.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-145">To remove a setting from the default configuration use the `<remove>` element, or use `<clear />` to remove all default values from one of these sections.</span></span> <span data-ttu-id="2eb5c-146">Vamos a configurar la aplicación web de reseñas de libros para registrar las excepciones no controladas todos los en una base de datos de Microsoft SQL Server mediante la `SqlWebEventProvider` clase.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-146">Let's configure the Book Reviews web application to log all unhandled exceptions to a Microsoft SQL Server database using the `SqlWebEventProvider` class.</span></span>

<span data-ttu-id="2eb5c-147">La `SqlWebEventProvider` clase forma parte del sistema de supervisión de estado y registra un evento en una base de datos de SQL Server especificada de supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-147">The `SqlWebEventProvider` class is part of the health monitoring system and logs a health monitoring event to a specified SQL Server database.</span></span> <span data-ttu-id="2eb5c-148">El `SqlWebEventProvider` clase espera que la base de datos especificada incluye un procedimiento almacenado denominado `aspnet_WebEvent_LogEvent`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-148">The `SqlWebEventProvider` class expects that the specified database includes a stored procedure named `aspnet_WebEvent_LogEvent`.</span></span> <span data-ttu-id="2eb5c-149">Este procedimiento almacenado se pasa los detalles del evento y se encarga de almacenar los detalles del evento.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-149">This stored procedure is passed the details of the event and is tasked with storing the event details.</span></span> <span data-ttu-id="2eb5c-150">Lo bueno es que no es necesario crear este procedimiento almacenado procedimiento ni la tabla para almacenar los detalles del evento.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-150">The good news is that you do not need to create this stored procedure nor the table to store the event details.</span></span> <span data-ttu-id="2eb5c-151">Puede agregar estos objetos a la base de datos mediante el `aspnet_regsql.exe` herramienta.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-151">You can add these objects to your database using the `aspnet_regsql.exe` tool.</span></span>

> [!NOTE]
> <span data-ttu-id="2eb5c-152">El `aspnet_regsql.exe` herramienta tratada en la [ *configurar un sitio Web que utiliza servicios de aplicación* tutorial](configuring-a-website-that-uses-application-services-vb.md) cuando se agrega compatibilidad con ASP. Servicios de aplicaciones de red.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-152">The `aspnet_regsql.exe` tool was discussed back in the [*Configuring a Website That Uses Application Services* tutorial](configuring-a-website-that-uses-application-services-vb.md) when we added support for ASP.NET's application services.</span></span> <span data-ttu-id="2eb5c-153">Por lo tanto, base de datos del sitio Web de reseñas de libros ya contiene el `aspnet_WebEvent_LogEvent` procedimiento almacenado, que almacena la información de evento en una tabla denominada `aspnet_WebEvent_Events`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-153">Consequently, the Book Reviews website's database already contains the `aspnet_WebEvent_LogEvent` stored procedure, which stores the event information into a table named `aspnet_WebEvent_Events`.</span></span>


<span data-ttu-id="2eb5c-154">Una vez que el procedimiento almacenado necesario y la tabla que se agrega a la base de datos, lo único que queda es indicar a para registrar todas las excepciones no controladas en la base de datos de supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-154">Once you have the necessary stored procedure and table added to your database, all that remains is to instruct health monitoring to log all unhandled exceptions to the database.</span></span> <span data-ttu-id="2eb5c-155">Para ello, agregue el siguiente marcado de su sitio Web `Web.config` archivo:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-155">Accomplish this by adding the following markup to your website's `Web.config` file:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample2.xml)]

<span data-ttu-id="2eb5c-156">El estado de supervisión de marcado de la configuración anterior se usa `<clear />` elementos que se va a borrar el estado predefinido información de configuración de supervisión del `<eventMappings>`, `<providers>`, y `<rules>` secciones.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-156">The health monitoring configuration markup above uses `<clear />` elements to wipe the pre-defined health monitoring configuration information from the `<eventMappings>`, `<providers>`, and `<rules>` sections.</span></span> <span data-ttu-id="2eb5c-157">A continuación, se agrega una única entrada para cada una de estas secciones.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-157">It then adds a single entry to each of these sections.</span></span>

- <span data-ttu-id="2eb5c-158">El `<eventMappings>` elemento define un único evento de interés con el nombre "Todos los errores", que se desencadena cuando se produce una excepción no controlada de seguimiento de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-158">The `<eventMappings>` element defines a single health monitoring event of interest named "All Errors", which is raised whenever an unhandled exception occurs.</span></span>
- <span data-ttu-id="2eb5c-159">El `<providers>` elemento define un origen de registro único denominado "SqlWebEventProvider" que usa el `SqlWebEventProvider` clase.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-159">The `<providers>` element defines a single log source named "SqlWebEventProvider" that uses the `SqlWebEventProvider` class.</span></span> <span data-ttu-id="2eb5c-160">El `connectionStringName` atributo se ha establecido en "ReviewsConnectionString", que es el nombre de la conexión de cadena definida en la `<connectionStrings>` sección.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-160">The `connectionStringName` attribute has been set to "ReviewsConnectionString", which is the name of our connection string defined in the `<connectionStrings>` section.</span></span>
- <span data-ttu-id="2eb5c-161">Por último, el &lt;reglas&gt; elemento indica que cuando ocurre un evento de "Todos los errores" que se debe registrar con el proveedor de "SqlWebEventProvider".</span><span class="sxs-lookup"><span data-stu-id="2eb5c-161">Finally, the &lt;rules&gt; element indicates that when an "All Errors" event transpires that it should be logged using the "SqlWebEventProvider" provider.</span></span>

<span data-ttu-id="2eb5c-162">Esta información de configuración indica que el sistema para registrar todas las excepciones no controladas en la base de datos de reseñas de libros de supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-162">This configuration information instructs the health monitoring system to log all unhandled exceptions to the Book Reviews database.</span></span>

> [!NOTE]
> <span data-ttu-id="2eb5c-163">El `WebBaseErrorEvent` evento sólo se produce para errores del servidor; no se desencadena para los errores HTTP, como una solicitud para un recurso ASP.NET que no se encuentra.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-163">The `WebBaseErrorEvent` event is only raised for server errors; it is not raised for HTTP errors, such as a request for an ASP.NET resource that is not found.</span></span> <span data-ttu-id="2eb5c-164">Esto difiere del comportamiento de la `HttpApplication` la clase `Error` evento, que se desencadena para el servidor y errores HTTP.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-164">This differs from the behavior of the `HttpApplication` class's `Error` event, which is raised for both server and HTTP errors.</span></span>


<span data-ttu-id="2eb5c-165">Para ver el estado del sistema en la acción de supervisión, visite el sitio Web y generar un error en tiempo de ejecución, visita `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-165">To see the health monitoring system in action, visit the website and generate a runtime error by visiting `Genre.aspx?ID=foo`.</span></span> <span data-ttu-id="2eb5c-166">Debería ver la página de error adecuado: la excepción detalles amarillo pantalla de muerte (cuando se visita localmente) o la página de error personalizada (al visitar el sitio de producción).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-166">You should see the appropriate error page - either the Exception Details Yellow Screen of Death (when visiting locally) or the custom error page (when visiting the site in production).</span></span> <span data-ttu-id="2eb5c-167">En segundo plano, el sistema de supervisión de estado registra la información de error en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-167">Behind the scenes, the health monitoring system logged the error information to the database.</span></span> <span data-ttu-id="2eb5c-168">Debe haber un registro en el `aspnet_WebEvent_Events` tabla (vea **figura 1**); este registro contiene información sobre el error en tiempo de ejecución que acaba de producirse.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-168">There should be one record in the `aspnet_WebEvent_Events` table (see **Figure 1**); this record contains information about the runtime error that just occurred.</span></span>

[![](logging-error-details-with-asp-net-health-monitoring-vb/_static/image2.png)](logging-error-details-with-asp-net-health-monitoring-vb/_static/image1.png)

<span data-ttu-id="2eb5c-169">**Figura 1**: se registran los detalles del Error para el `aspnet_WebEvent_Events` tabla</span><span class="sxs-lookup"><span data-stu-id="2eb5c-169">**Figure 1**: The Error Details Were Logged to the `aspnet_WebEvent_Events` Table</span></span>  
<span data-ttu-id="2eb5c-170">([Haga clic aquí para ver la imagen a tamaño completo](logging-error-details-with-asp-net-health-monitoring-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2eb5c-170">([Click to view full-size image](logging-error-details-with-asp-net-health-monitoring-vb/_static/image3.png))</span></span>

### <a name="displaying-the-error-log-in-a-web-page"></a><span data-ttu-id="2eb5c-171">Mostrar el registro de errores en una página Web</span><span class="sxs-lookup"><span data-stu-id="2eb5c-171">Displaying the Error Log In a Web Page</span></span>

<span data-ttu-id="2eb5c-172">Con la configuración actual del sitio Web, el sistema de supervisión de estado registra todas las excepciones no controladas en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-172">With the website's current configuration, the health monitoring system logs all unhandled exceptions to the database.</span></span> <span data-ttu-id="2eb5c-173">Sin embargo, la supervisión de estado no proporciona ningún mecanismo para ver el registro de errores a través de una página web.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-173">However, health monitoring does not provide any mechanism to view the error log through a web page.</span></span> <span data-ttu-id="2eb5c-174">Sin embargo, puede generar una página ASP.NET que muestra esta información de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-174">However, you could build an ASP.NET page that displays this information from the database.</span></span> <span data-ttu-id="2eb5c-175">(Como veremos en breve, puede optar por tener los detalles del error que le enviados un mensaje de correo electrónico.)</span><span class="sxs-lookup"><span data-stu-id="2eb5c-175">(As we'll see momentarily, you can opt to have the error details sent to you in an email message.)</span></span>

<span data-ttu-id="2eb5c-176">Si crea una página de este tipo, asegúrese de que siga los pasos para permitir que sólo los usuarios autorizados ver los detalles del error.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-176">If you create such a page, make sure you take steps to allow only authorized users to view the error details.</span></span> <span data-ttu-id="2eb5c-177">Si el sitio ya utiliza las cuentas de usuario, a continuación, puede usar las reglas de autorización de dirección URL para restringir el acceso a la página a determinados usuarios o roles.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-177">If your site already employs user accounts then you can use URL authorization rules to restrict access to the page to certain users or roles.</span></span> <span data-ttu-id="2eb5c-178">Para obtener más información sobre cómo conceder o restringir el acceso a páginas web en función de la sesión del usuario, consulte mi [tutoriales de seguridad del sitio Web](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-178">For more information on how to grant or restrict access to web pages based on the logged in user, refer to my [Website Security Tutorials](../../older-versions-security/introduction/security-basics-and-asp-net-support-cs.md).</span></span>

> [!NOTE]
> <span data-ttu-id="2eb5c-179">El tutorial posterior explora un sistema de registro y la notificación de error alternativas denominado ELMAH.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-179">The subsequent tutorial explores an alternative error logging and notification system named ELMAH.</span></span> <span data-ttu-id="2eb5c-180">ELMAH incluye un mecanismo integrado para ver el registro de errores de página web y como una fuente RSS.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-180">ELMAH includes a built-in mechanism to view the error log from both a web page and as an RSS feed.</span></span>


## <a name="logging-events-to-email"></a><span data-ttu-id="2eb5c-181">Registro de eventos al correo electrónico</span><span class="sxs-lookup"><span data-stu-id="2eb5c-181">Logging Events to Email</span></span>

<span data-ttu-id="2eb5c-182">El estado del sistema de supervisión incluye un proveedor de origen de registro "registra" un evento en un mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-182">The health monitoring system includes a log source provider that "logs" an event to an email message.</span></span> <span data-ttu-id="2eb5c-183">El origen del registro incluye la misma información que se registra en la base de datos en el cuerpo del mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-183">The log source includes the same information that is logged to the database in the email message body.</span></span> <span data-ttu-id="2eb5c-184">Puede usar este origen de registro para notificar a un programador cuando se produce un determinado evento de supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-184">You can use this log source to notify a developer when a certain health monitoring event occurs.</span></span>

<span data-ttu-id="2eb5c-185">Vamos a actualizar la configuración del sitio Web para que se recibe un correo electrónico cada vez que una excepción se produce de reseñas de libros.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-185">Let's update the Book Reviews website's configuration so that we receive an email whenever an exception occurs.</span></span> <span data-ttu-id="2eb5c-186">Para lograr esto se debe realizar tres tareas:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-186">To accomplish this we need to perform three tasks:</span></span>

1. <span data-ttu-id="2eb5c-187">Configurar la aplicación web ASP.NET para enviar correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-187">Configure the ASP.NET web application to send email.</span></span> <span data-ttu-id="2eb5c-188">Esto se logra mediante la especificación de cómo se envían los mensajes de correo electrónico a través de la `<system.net>` elemento de configuración.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-188">This is accomplished by specifying how email messages are sent via the `<system.net>` configuration element.</span></span> <span data-ttu-id="2eb5c-189">Para obtener más información sobre el envío de correo electrónico Consulte mensajes en una aplicación ASP.NET [enviar correo electrónico en ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx) y [System.Net.Mail preguntas más frecuentes sobre](http://systemnetmail.com/).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-189">For more information on sending email messages in an ASP.NET application refer to [Sending Email in ASP.NET](http://aspnet.4guysfromrolla.com/articles/072606-1.aspx) and the [System.Net.Mail FAQ](http://systemnetmail.com/).</span></span>
2. <span data-ttu-id="2eb5c-190">Registrar el proveedor de origen del registro de correo electrónico en el `<providers>` elemento, y</span><span class="sxs-lookup"><span data-stu-id="2eb5c-190">Register the email log source provider in the `<providers>` element, and</span></span>
3. <span data-ttu-id="2eb5c-191">Agregar una entrada a la `<rules>` elemento que se asigna al evento de "Todos los errores" al proveedor del registro de origen que agregó en el paso (2).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-191">Add an entry to the `<rules>` element that maps the "All Errors" event to the log source provider added in step (2).</span></span>

<span data-ttu-id="2eb5c-192">El sistema de supervisión de estado incluye dos clases de proveedor de origen de registro de correo electrónico: `SimpleMailWebEventProvider` y `TemplatedMailWebEventProvider`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-192">The health monitoring system includes two email log source provider classes: `SimpleMailWebEventProvider` and `TemplatedMailWebEventProvider`.</span></span> <span data-ttu-id="2eb5c-193">El [ `SimpleMailWebEventProvider` clase](https://msdn.microsoft.com/library/system.web.management.simplemailwebeventprovider.aspx) envía un mensaje de correo electrónico de texto sin formato que incluya el evento detalla y ofrece personalización poco del cuerpo del correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-193">The [`SimpleMailWebEventProvider` class](https://msdn.microsoft.com/library/system.web.management.simplemailwebeventprovider.aspx) sends a plain-text email message that includes the event details and provides little customization of the email body.</span></span> <span data-ttu-id="2eb5c-194">Con el [ `TemplatedMailWebEventProvider` clase](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) especificar una página ASP.NET cuyo marcado representado se utiliza como el cuerpo del mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-194">With the [`TemplatedMailWebEventProvider` class](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) you specify an ASP.NET page whose rendered markup is used as the body for the email message.</span></span> <span data-ttu-id="2eb5c-195">El [ `TemplatedMailWebEventProvider` clase](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) ofrece mucho mayor control sobre el contenido y el formato de mensaje de correo electrónico, pero requiere un poco más trabajo por adelantado ya que tiene que crear la página ASP.NET que genera el cuerpo del mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-195">The [`TemplatedMailWebEventProvider` class](https://msdn.microsoft.com/library/system.web.management.templatedmailwebeventprovider.aspx) gives you much greater control over the contents and format of the email message, but requires a bit more upfront work as you have to create the ASP.NET page that generates the email message's body.</span></span> <span data-ttu-id="2eb5c-196">Este tutorial se centra en usar la `SimpleMailWebEventProvider` clase.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-196">This tutorial focuses on using the `SimpleMailWebEventProvider` class.</span></span>

<span data-ttu-id="2eb5c-197">Actualizar el estado sistema de supervisión `<providers>` elemento en el `Web.config` archivo para incluir un origen de registro para el `SimpleMailWebEventProvider` clase:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-197">Update the health monitoring system's `<providers>` element in the `Web.config` file to include a log source for the `SimpleMailWebEventProvider` class:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample3.xml)]

<span data-ttu-id="2eb5c-198">El marcado anterior utiliza la `SimpleMailWebEventProvider` clase como el proveedor de origen del registro y le asigna el nombre descriptivo "EmailWebEventProvider".</span><span class="sxs-lookup"><span data-stu-id="2eb5c-198">The above markup uses the `SimpleMailWebEventProvider` class as the log source provider, and assigns it the friendly name "EmailWebEventProvider".</span></span> <span data-ttu-id="2eb5c-199">Además, la `<add>` atributo incluye opciones de configuración adicionales, como el campo para y desde direcciones de mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-199">Moreover, the `<add>` attribute includes additional configuration options, such as the To and From addresses of the email message.</span></span>

<span data-ttu-id="2eb5c-200">Con el origen del registro de correo electrónico definido, todo lo que queda es indicar el sistema para que utilice este origen para "registrar" excepciones no controladas de supervisión de estado.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-200">With the email log source defined, all that remains is to instruct the health monitoring system to use this source to "log" unhandled exceptions.</span></span> <span data-ttu-id="2eb5c-201">Esto se logra mediante la adición de una regla nueva en la `<rules>` sección:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-201">This is accomplished by adding a new rule in the `<rules>` section:</span></span>

[!code-xml[Main](logging-error-details-with-asp-net-health-monitoring-vb/samples/sample4.xml)]

<span data-ttu-id="2eb5c-202">El `<rules>` sección ahora incluye dos reglas.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-202">The `<rules>` section now includes two rules.</span></span> <span data-ttu-id="2eb5c-203">La primera de ellas, con el nombre "Todos los errores a correo electrónico", envía todas las excepciones no controladas en el origen del registro "EmailWebEventProvider".</span><span class="sxs-lookup"><span data-stu-id="2eb5c-203">The first one, named "All Errors To Email", sends all unhandled exceptions to the "EmailWebEventProvider" log source.</span></span> <span data-ttu-id="2eb5c-204">Esta regla tiene el efecto de enviar los detalles sobre los errores en el sitio Web a los especificados para la dirección.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-204">This rule has the effect of sending details about errors on the website to the specified To address.</span></span> <span data-ttu-id="2eb5c-205">La regla de "Todos los errores a base de datos" registra los detalles del error en la base de datos del sitio.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-205">The "All Errors To Database" rule logs the error details to the site's database.</span></span> <span data-ttu-id="2eb5c-206">Por lo tanto, cada vez que produce una excepción no controlada en el sitio de los detalles están registrados en la base de datos y envía a la dirección de correo electrónico especificada.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-206">Consequently, whenever an unhandled exception occurs on the site its details are both logged to the database and sent to specified email address.</span></span>

<span data-ttu-id="2eb5c-207">**Figura 2** muestra el correo electrónico generado por el `SimpleMailWebEventProvider` clase al visitar `Genre.aspx?ID=foo`.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-207">**Figure 2** shows the email generated by the `SimpleMailWebEventProvider` class when visiting `Genre.aspx?ID=foo`.</span></span>

[![](logging-error-details-with-asp-net-health-monitoring-vb/_static/image5.png)](logging-error-details-with-asp-net-health-monitoring-vb/_static/image4.png)

<span data-ttu-id="2eb5c-208">**Figura 2**: los detalles del Error se envían en un mensaje de correo electrónico</span><span class="sxs-lookup"><span data-stu-id="2eb5c-208">**Figure 2**: The Error Details are Sent in an Email Message</span></span>  
<span data-ttu-id="2eb5c-209">([Haga clic aquí para ver la imagen a tamaño completo](logging-error-details-with-asp-net-health-monitoring-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2eb5c-209">([Click to view full-size image](logging-error-details-with-asp-net-health-monitoring-vb/_static/image6.png))</span></span>

## <a name="summary"></a><span data-ttu-id="2eb5c-210">Resumen</span><span class="sxs-lookup"><span data-stu-id="2eb5c-210">Summary</span></span>

<span data-ttu-id="2eb5c-211">El sistema de supervisión de estado ASP.NET está diseñado para permitir a los administradores a supervisar el estado de una aplicación web implementadas.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-211">The ASP.NET health monitoring system is designed to allow administrators to monitor the health of a deployed web application.</span></span> <span data-ttu-id="2eb5c-212">Eventos de supervisión de estado se generan cuando expandir determinadas acciones, como cuando se detiene la aplicación, cuando un usuario inicia sesión correctamente en el sitio, o cuando se produce una excepción no controlada.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-212">Health monitoring events are raised when certain actions unfold, such as when the application stops, when a user successfully logs onto the site, or when an unhandled exception occurs.</span></span> <span data-ttu-id="2eb5c-213">Estos eventos se pueden registrar a cualquier número de orígenes de registro.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-213">These events can be logged to any number of log sources.</span></span> <span data-ttu-id="2eb5c-214">Este tutorial se ha explicado cómo registrar los detalles de las excepciones no controladas en una base de datos y a través de un mensaje de correo electrónico.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-214">This tutorial showed how to log the details of unhandled exceptions to a database and through an email message.</span></span>

<span data-ttu-id="2eb5c-215">Este tutorial se centra en el uso para registrar excepciones no controladas, pero tenga en cuenta que la supervisión de estado está diseñada para medir el estado general de una aplicación ASP.NET implementada e incluye un gran número de eventos de supervisión de estado y no los orígenes de registro de seguimiento de estado explorar aquí.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-215">This tutorial focused on using health monitoring to log unhandled exceptions, but keep in mind that health monitoring is designed to measure the overall health of a deployed ASP.NET application and includes a wealth of health monitoring events and log sources not explored here.</span></span> <span data-ttu-id="2eb5c-216">¿Qué es más, puede crear su propios eventos y orígenes de registro de seguimiento de estado fuese necesario surgen.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-216">What's more, you can create your own health monitoring events and log sources, should the need arise.</span></span> <span data-ttu-id="2eb5c-217">Si está interesado en aprender más acerca de la supervisión de estado, es un buen primer paso leer [Erik Reitan](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx)del [preguntas más frecuentes de supervisión de estado](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-217">If you are interested in learning more about health monitoring, a good first step is to read through [Erik Reitan](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx)'s [health monitoring FAQ](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx).</span></span> <span data-ttu-id="2eb5c-218">A continuación, consulte [How To: Use supervisión de estado en ASP.NET 2.0](https://msdn.microsoft.com/library/ms998306.aspx).</span><span class="sxs-lookup"><span data-stu-id="2eb5c-218">Following that, consult [How To: Use Health Monitoring in ASP.NET 2.0](https://msdn.microsoft.com/library/ms998306.aspx).</span></span>

<span data-ttu-id="2eb5c-219">Feliz programación.</span><span class="sxs-lookup"><span data-stu-id="2eb5c-219">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="2eb5c-220">Información adicional</span><span class="sxs-lookup"><span data-stu-id="2eb5c-220">Further Reading</span></span>

<span data-ttu-id="2eb5c-221">Para obtener más información sobre los temas tratados en este tutorial, consulte los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="2eb5c-221">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="2eb5c-222">Información general de supervisión de estado de ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2eb5c-222">ASP.NET Health Monitoring Overview</span></span>](https://msdn.microsoft.com/library/bb398933.aspx)
- [<span data-ttu-id="2eb5c-223">Configurar y personalizar el sistema de ASP.NET de supervisión de estado</span><span class="sxs-lookup"><span data-stu-id="2eb5c-223">Configuring and Customizing the Health Monitoring System of ASP.NET</span></span>](http://dotnetslackers.com/articles/aspnet/ConfiguringAndCustomizingTheHealthMonitoringSystemOfASPNET.aspx)
- [<span data-ttu-id="2eb5c-224">Preguntas más frecuentes: estado de supervisión en ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="2eb5c-224">FAQ - Health Monitoring in ASP.NET 2.0</span></span>](https://blogs.msdn.com/erikreitan/archive/2006/05/22/603586.aspx)
- [<span data-ttu-id="2eb5c-225">Cómo: Enviar correo electrónico para las notificaciones de supervisión de estado</span><span class="sxs-lookup"><span data-stu-id="2eb5c-225">How To: Send E-Mail for Health Monitoring Notifications</span></span>](https://msdn.microsoft.com/library/ms227553.aspx)
- [<span data-ttu-id="2eb5c-226">Cómo: Usar la supervisión de estado en ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2eb5c-226">How To: Use Health Monitoring in ASP.NET</span></span>](https://msdn.microsoft.com/library/ms998306.aspx)
- [<span data-ttu-id="2eb5c-227">Estado de supervisión en ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2eb5c-227">Health Monitoring in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/031407-1.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="2eb5c-228">[Anterior](processing-unhandled-exceptions-vb.md)
> [Siguiente](logging-error-details-with-elmah-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2eb5c-228">[Previous](processing-unhandled-exceptions-vb.md)
[Next](logging-error-details-with-elmah-vb.md)</span></span>
