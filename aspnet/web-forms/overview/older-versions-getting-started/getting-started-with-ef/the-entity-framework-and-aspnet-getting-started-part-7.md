---
uid: web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
title: "Introducción a base de datos de Entity Framework 4.0 en primer lugar y 4 de ASP.NET Web Forms - parte 7 | Documentos de Microsoft"
author: tdykstra
description: "La aplicación web de ejemplo de la Universidad de Contoso muestra cómo crear aplicaciones de formularios Web Forms de ASP.NET mediante Entity Framework. Es la aplicación de ejemplo..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 12/03/2010
ms.topic: article
ms.assetid: f8afb245-b705-419c-8790-0b295e90d5e2
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/getting-started-with-ef/the-entity-framework-and-aspnet-getting-started-part-7
msc.type: authoredcontent
ms.openlocfilehash: aeea122636f5235364e6a40cb6e041b1fe221317
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/24/2018
---
<a name="getting-started-with-entity-framework-40-database-first-and-aspnet-4-web-forms---part-7"></a><span data-ttu-id="62c99-104">Introducción a la base de datos de Entity Framework 4.0 en primer lugar y ASP.NET 4 Web Forms - parte 7</span><span class="sxs-lookup"><span data-stu-id="62c99-104">Getting Started with Entity Framework 4.0 Database First and ASP.NET 4 Web Forms - Part 7</span></span>
====================
<span data-ttu-id="62c99-105">Por [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="62c99-105">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

> <span data-ttu-id="62c99-106">La aplicación web de ejemplo de la Universidad de Contoso muestra cómo crear aplicaciones de formularios Web Forms de ASP.NET con el Entity Framework 4.0 y Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="62c99-106">The Contoso University sample web application demonstrates how to create ASP.NET Web Forms applications using the Entity Framework 4.0 and Visual Studio 2010.</span></span> <span data-ttu-id="62c99-107">Para obtener información acerca de la serie de tutoriales, vea [el primer tutorial de la serie](the-entity-framework-and-aspnet-getting-started-part-1.md)</span><span class="sxs-lookup"><span data-stu-id="62c99-107">For information about the tutorial series, see [the first tutorial in the series](the-entity-framework-and-aspnet-getting-started-part-1.md)</span></span>


## <a name="using-stored-procedures"></a><span data-ttu-id="62c99-108">Utilizar procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="62c99-108">Using Stored Procedures</span></span>

<span data-ttu-id="62c99-109">En el tutorial anterior implementa un patrón de herencia de tabla por jerarquía.</span><span class="sxs-lookup"><span data-stu-id="62c99-109">In the previous tutorial you implemented a table-per-hierarchy inheritance pattern.</span></span> <span data-ttu-id="62c99-110">Este tutorial le mostrará cómo usar procedimientos almacenados para tener un mayor control sobre el acceso de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="62c99-110">This tutorial will show you how to use stored procedures to gain more control over database access.</span></span>

<span data-ttu-id="62c99-111">Entity Framework permite especificar que deben utilizar procedimientos almacenados para el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="62c99-111">The Entity Framework lets you specify that it should use stored procedures for database access.</span></span> <span data-ttu-id="62c99-112">Para cualquier tipo de entidad, puede especificar un procedimiento almacenado que se usará para la creación, actualización o eliminación de entidades de ese tipo.</span><span class="sxs-lookup"><span data-stu-id="62c99-112">For any entity type, you can specify a stored procedure to use for creating, updating, or deleting entities of that type.</span></span> <span data-ttu-id="62c99-113">A continuación, en el modelo de datos puede agregar referencias a los procedimientos almacenados que puede usar para realizar tareas como recuperar conjuntos de entidades.</span><span class="sxs-lookup"><span data-stu-id="62c99-113">Then in the data model you can add references to stored procedures that you can use to perform tasks such as retrieving sets of entities.</span></span>

<span data-ttu-id="62c99-114">Uso de procedimientos almacenados es un requisito común para el acceso a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="62c99-114">Using stored procedures is a common requirement for database access.</span></span> <span data-ttu-id="62c99-115">En algunos casos, un administrador de base de datos puede requerir que todos los accesos de base de datos atraviesan los procedimientos almacenados por motivos de seguridad.</span><span class="sxs-lookup"><span data-stu-id="62c99-115">In some cases a database administrator may require that all database access go through stored procedures for security reasons.</span></span> <span data-ttu-id="62c99-116">En otros casos puede que desee crear lógica de negocios en algunos de los procesos que Entity Framework utiliza cuando actualiza la base de datos.</span><span class="sxs-lookup"><span data-stu-id="62c99-116">In other cases you may want to build business logic into some of the processes that the Entity Framework uses when it updates the database.</span></span> <span data-ttu-id="62c99-117">Por ejemplo, cada vez que se elimina una entidad que desee copiar en una base de datos de archivo.</span><span class="sxs-lookup"><span data-stu-id="62c99-117">For example, whenever an entity is deleted you might want to copy it to an archive database.</span></span> <span data-ttu-id="62c99-118">O bien, cada vez que se actualiza una fila desea escribir una fila en una tabla de registro que registre quién realizó el cambio.</span><span class="sxs-lookup"><span data-stu-id="62c99-118">Or whenever a row is updated you might want to write a row to a logging table that records who made the change.</span></span> <span data-ttu-id="62c99-119">Puede realizar estos tipos de tareas en un procedimiento almacenado que se llama cada vez que elimina una entidad de Entity Framework o actualiza una entidad.</span><span class="sxs-lookup"><span data-stu-id="62c99-119">You can perform these kinds of tasks in a stored procedure that's called whenever the Entity Framework deletes an entity or updates an entity.</span></span>

<span data-ttu-id="62c99-120">Como se muestra en el tutorial anterior, no creará las nuevas páginas.</span><span class="sxs-lookup"><span data-stu-id="62c99-120">As in the previous tutorial, you'll not create any new pages.</span></span> <span data-ttu-id="62c99-121">En su lugar, va a cambiar la manera en que Entity Framework tiene acceso a la base de datos para algunas de las páginas que ya haya creado.</span><span class="sxs-lookup"><span data-stu-id="62c99-121">Instead, you'll change the way the Entity Framework accesses the database for some of the pages you already created.</span></span>

<span data-ttu-id="62c99-122">En este tutorial creará los procedimientos almacenados en la base de datos para insertar `Student` y `Instructor` entidades.</span><span class="sxs-lookup"><span data-stu-id="62c99-122">In this tutorial you'll create stored procedures in the database for inserting `Student` and `Instructor` entities.</span></span> <span data-ttu-id="62c99-123">Deberá agregarlas al modelo de datos, y especificará que Entity Framework deben usarlos para agregar `Student` y `Instructor` entidades a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="62c99-123">You'll add them to the data model, and you'll specify that the Entity Framework should use them for adding `Student` and `Instructor` entities to the database.</span></span> <span data-ttu-id="62c99-124">También podrá crear un procedimiento almacenado que se puede utilizar para recuperar `Course` entidades.</span><span class="sxs-lookup"><span data-stu-id="62c99-124">You'll also create a stored procedure that you can use to retrieve `Course` entities.</span></span>

## <a name="creating-stored-procedures-in-the-database"></a><span data-ttu-id="62c99-125">Crear procedimientos almacenados en la base de datos</span><span class="sxs-lookup"><span data-stu-id="62c99-125">Creating Stored Procedures in the Database</span></span>

<span data-ttu-id="62c99-126">(Si usa el *School.mdf* archivo del proyecto disponible para su descarga con este tutorial, puede omitir esta sección, dado que los procedimientos almacenados ya existen.)</span><span class="sxs-lookup"><span data-stu-id="62c99-126">(If you're using the *School.mdf* file from the project available for download with this tutorial, you can skip this section because the stored procedures already exist.)</span></span>

<span data-ttu-id="62c99-127">En **Explorador de servidores**, expanda *School.mdf*, haga clic en **procedimientos almacenados**y seleccione **Agregar nuevo procedimiento almacenado**.</span><span class="sxs-lookup"><span data-stu-id="62c99-127">In **Server Explorer**, expand *School.mdf*, right-click **Stored Procedures**, and select **Add New Stored Procedure**.</span></span>

<span data-ttu-id="62c99-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-128">[![image15](the-entity-framework-and-aspnet-getting-started-part-7/_static/image2.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image1.png)</span></span>

<span data-ttu-id="62c99-129">Copie las instrucciones SQL siguientes y péguelos en la ventana del procedimiento almacenado, reemplazando el procedimiento almacenado esqueleto.</span><span class="sxs-lookup"><span data-stu-id="62c99-129">Copy the following SQL statements and paste them into the stored procedure window, replacing the skeleton stored procedure.</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample1.sql)]

<span data-ttu-id="62c99-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-130">[![image14](the-entity-framework-and-aspnet-getting-started-part-7/_static/image4.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image3.png)</span></span>

<span data-ttu-id="62c99-131">`Student`las entidades tienen cuatro propiedades: `PersonID`, `LastName`, `FirstName`, y `EnrollmentDate`.</span><span class="sxs-lookup"><span data-stu-id="62c99-131">`Student` entities have four properties: `PersonID`, `LastName`, `FirstName`, and `EnrollmentDate`.</span></span> <span data-ttu-id="62c99-132">La base de datos genera el valor de identificador automáticamente y el procedimiento almacenado acepta parámetros para las otras tres.</span><span class="sxs-lookup"><span data-stu-id="62c99-132">The database generates the ID value automatically, and the stored procedure accepts parameters for the other three.</span></span> <span data-ttu-id="62c99-133">El procedimiento almacenado devuelve el valor de la clave de registro de la fila nueva para que Entity Framework puede realizar un seguimiento de en la versión de la entidad que mantiene en memoria.</span><span class="sxs-lookup"><span data-stu-id="62c99-133">The stored procedure returns the value of the new row's record key so that the Entity Framework can keep track of that in the version of the entity it keeps in memory.</span></span>

<span data-ttu-id="62c99-134">Guarde y cierre la ventana del procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="62c99-134">Save and close the stored procedure window.</span></span>

<span data-ttu-id="62c99-135">Crear un `InsertInstructor` procedimiento almacenado de la misma manera, mediante las siguientes instrucciones SQL:</span><span class="sxs-lookup"><span data-stu-id="62c99-135">Create an `InsertInstructor` stored procedure in the same manner, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample2.sql)]

<span data-ttu-id="62c99-136">Crear `Update` procedimientos almacenados para `Student` y `Instructor` entidades también.</span><span class="sxs-lookup"><span data-stu-id="62c99-136">Create `Update` stored procedures for `Student` and `Instructor` entities also.</span></span> <span data-ttu-id="62c99-137">(La base de datos ya tiene un `DeletePerson` procedimiento almacenado que funcionará para ambos `Instructor` y `Student` entidades.)</span><span class="sxs-lookup"><span data-stu-id="62c99-137">(The database already has a `DeletePerson` stored procedure which will work for both `Instructor` and `Student` entities.)</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample3.sql)]

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample4.sql)]

<span data-ttu-id="62c99-138">En este tutorial, asignará las tres funciones: insert, update y delete--para cada tipo de entidad.</span><span class="sxs-lookup"><span data-stu-id="62c99-138">In this tutorial you'll map all three functions -- insert, update, and delete -- for each entity type.</span></span> <span data-ttu-id="62c99-139">La versión 4 de Entity Framework permite asignar solo uno o dos de estas funciones a los procedimientos almacenados sin asignación de los demás, con una excepción: si asigna la función de actualización pero no la función de eliminación, Entity Framework se iniciará una excepción cuando se ha intentado eliminar una entidad.</span><span class="sxs-lookup"><span data-stu-id="62c99-139">The Entity Framework version 4 allows you to map just one or two of these functions to stored procedures without mapping the others, with one exception: if you map the update function but not the delete function, the Entity Framework will throw an exception when you attempt to delete an entity.</span></span> <span data-ttu-id="62c99-140">En la versión 3.5 de Entity Framework, no tenía tanta flexibilidad en la asignación de procedimientos almacenados: si se ha asignado una función se debe asignar las tres.</span><span class="sxs-lookup"><span data-stu-id="62c99-140">In the Entity Framework version 3.5, you did not have this much flexibility in mapping stored procedures: if you mapped one function you were required to map all three.</span></span>

<span data-ttu-id="62c99-141">Para crear un procedimiento almacenado que lee en lugar de las actualizaciones de datos, cree uno que todos los selecciona `Course` entidades, mediante las instrucciones SQL siguientes:</span><span class="sxs-lookup"><span data-stu-id="62c99-141">To create a stored procedure that reads rather than updates data, create one that selects all `Course` entities, using the following SQL statements:</span></span>

[!code-sql[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample5.sql)]

## <a name="adding-the-stored-procedures-to-the-data-model"></a><span data-ttu-id="62c99-142">Agregar los procedimientos almacenados para el modelo de datos</span><span class="sxs-lookup"><span data-stu-id="62c99-142">Adding the Stored Procedures to the Data Model</span></span>

<span data-ttu-id="62c99-143">Los procedimientos almacenados se definen ahora en la base de datos, pero se deben agregar al modelo de datos para que estén disponibles a Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="62c99-143">The stored procedures are now defined in the database, but they must be added to the data model to make them available to the Entity Framework.</span></span> <span data-ttu-id="62c99-144">Abra *SchoolModel.edmx*, haga clic en la superficie de diseño y seleccione **actualizar modelo desde base de datos**.</span><span class="sxs-lookup"><span data-stu-id="62c99-144">Open *SchoolModel.edmx*, right-click the design surface, and select **Update Model from Database**.</span></span> <span data-ttu-id="62c99-145">En el **agregar** pestaña de la **elija los objetos de base de datos** cuadro de diálogo, expanda **procedimientos almacenados**, seleccione los procedimientos almacenados recién creados y `DeletePerson` procedimiento almacenado y, a continuación, haga clic en **finalizar**.</span><span class="sxs-lookup"><span data-stu-id="62c99-145">In the **Add** tab of the **Choose Your Database Objects** dialog box, expand **Stored Procedures**, select the newly created stored procedures and the `DeletePerson` stored procedure, and then click **Finish**.</span></span>

<span data-ttu-id="62c99-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-146">[![image20](the-entity-framework-and-aspnet-getting-started-part-7/_static/image6.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image5.png)</span></span>

## <a name="mapping-the-stored-procedures"></a><span data-ttu-id="62c99-147">Asignación de los procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="62c99-147">Mapping the Stored Procedures</span></span>

<span data-ttu-id="62c99-148">En el Diseñador de modelos de datos, haga clic en el `Student` entidad y seleccione **Stored Procedure Mapping**.</span><span class="sxs-lookup"><span data-stu-id="62c99-148">In the data model designer, right-click the `Student` entity and select **Stored Procedure Mapping**.</span></span>

<span data-ttu-id="62c99-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-149">[![image21](the-entity-framework-and-aspnet-getting-started-part-7/_static/image8.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image7.png)</span></span>

<span data-ttu-id="62c99-150">El **detalles de la asignación** aparece la ventana, en el que puede especificar los procedimientos almacenados que Entity Framework deben usar para insertar, actualizar y eliminar entidades de este tipo.</span><span class="sxs-lookup"><span data-stu-id="62c99-150">The **Mapping Details** window appears, in which you can specify stored procedures that the Entity Framework should use for inserting, updating, and deleting entities of this type.</span></span>

<span data-ttu-id="62c99-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-151">[![image22](the-entity-framework-and-aspnet-getting-started-part-7/_static/image10.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image9.png)</span></span>

<span data-ttu-id="62c99-152">Establecer el **insertar** función **InsertStudent**.</span><span class="sxs-lookup"><span data-stu-id="62c99-152">Set the **Insert** function to **InsertStudent**.</span></span> <span data-ttu-id="62c99-153">La ventana muestra una lista de parámetros de procedimiento almacenado, cada uno de los cuales debe asignarse a una propiedad de entidad.</span><span class="sxs-lookup"><span data-stu-id="62c99-153">The window shows a list of stored procedure parameters, each of which must be mapped to an entity property.</span></span> <span data-ttu-id="62c99-154">Dos de estas se asignan automáticamente porque los nombres son los mismos.</span><span class="sxs-lookup"><span data-stu-id="62c99-154">Two of these are mapped automatically because the names are the same.</span></span> <span data-ttu-id="62c99-155">No hay ninguna propiedad de entidad denominada `FirstName`, por lo que debe seleccionar manualmente `FirstMidName` desde una lista desplegable que muestra las propiedades de entidad disponible.</span><span class="sxs-lookup"><span data-stu-id="62c99-155">There's no entity property named `FirstName`, so you must manually select `FirstMidName` from a drop-down list that shows available entity properties.</span></span> <span data-ttu-id="62c99-156">(Esto es porque ha cambiado el nombre de la `FirstName` propiedad `FirstMidName` en el primer tutorial.)</span><span class="sxs-lookup"><span data-stu-id="62c99-156">(This is because you changed the name of the `FirstName` property to `FirstMidName` in the first tutorial.)</span></span>

<span data-ttu-id="62c99-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-157">[![image23](the-entity-framework-and-aspnet-getting-started-part-7/_static/image12.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image11.png)</span></span>

<span data-ttu-id="62c99-158">En la misma **detalles de la asignación** ventana, asigne el `Update` función a la `UpdateStudent` procedimiento almacenado (asegúrese de especificar `FirstMidName` como el valor del parámetro `FirstName`, tal y como lo hizo el `Insert` procedimiento almacenado) y la `Delete` función a la `DeletePerson` procedimiento almacenado.</span><span class="sxs-lookup"><span data-stu-id="62c99-158">In the same **Mapping Details** window, map the `Update` function to the `UpdateStudent` stored procedure (make sure you specify `FirstMidName` as the parameter value for `FirstName`, as you did for the `Insert` stored procedure) and the `Delete` function to the `DeletePerson` stored procedure.</span></span>

<span data-ttu-id="62c99-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-159">[![image01](the-entity-framework-and-aspnet-getting-started-part-7/_static/image14.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image13.png)</span></span>

<span data-ttu-id="62c99-160">Siga el mismo procedimiento para asignar el insert, update y delete de procedimientos almacenados para instructores para el `Instructor` entidad.</span><span class="sxs-lookup"><span data-stu-id="62c99-160">Follow the same procedure to map the insert, update, and delete stored procedures for instructors to the `Instructor` entity.</span></span>

<span data-ttu-id="62c99-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-161">[![image02](the-entity-framework-and-aspnet-getting-started-part-7/_static/image16.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image15.png)</span></span>

<span data-ttu-id="62c99-162">Para los procedimientos almacenados que leen en lugar de actualizar los datos, use la **Explorador de modelos** escríbalo devuelve ventana para el procedimiento almacenado se asignan a la entidad.</span><span class="sxs-lookup"><span data-stu-id="62c99-162">For stored procedures that read rather than update data, you use the **Model Browser** window to map the stored procedure to the entity type it returns.</span></span> <span data-ttu-id="62c99-163">En el Diseñador de modelos de datos, haga clic en la superficie de diseño y seleccione **Explorador de modelos**.</span><span class="sxs-lookup"><span data-stu-id="62c99-163">In the data model designer, right-click the design surface and select **Model Browser**.</span></span> <span data-ttu-id="62c99-164">Abra la **SchoolModel.Store** nodo y, a continuación, abra el **procedimientos almacenados** nodo.</span><span class="sxs-lookup"><span data-stu-id="62c99-164">Open the **SchoolModel.Store** node and then open the **Stored Procedures** node.</span></span> <span data-ttu-id="62c99-165">A continuación, haga clic en el `GetCourses` procedimiento almacenado y seleccione **Agregar importación de funciones**.</span><span class="sxs-lookup"><span data-stu-id="62c99-165">Then right-click the `GetCourses` stored procedure and select **Add Function Import**.</span></span>

<span data-ttu-id="62c99-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-166">[![image24](the-entity-framework-and-aspnet-getting-started-part-7/_static/image18.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image17.png)</span></span>

<span data-ttu-id="62c99-167">En el **Agregar importación de funciones** cuadro de diálogo **devuelve una colección de** seleccione **entidades**y, a continuación, seleccione `Course` como el tipo de entidad devueltos.</span><span class="sxs-lookup"><span data-stu-id="62c99-167">In the **Add Function Import** dialog box, under **Returns a Collection Of** select **Entities**, and then select `Course` as the entity type returned.</span></span> <span data-ttu-id="62c99-168">Cuando haya terminado, haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="62c99-168">When you're done, click **OK**.</span></span> <span data-ttu-id="62c99-169">Guarde y cierre el *.edmx* archivo.</span><span class="sxs-lookup"><span data-stu-id="62c99-169">Save and close the *.edmx* file.</span></span>

<span data-ttu-id="62c99-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-170">[![image25](the-entity-framework-and-aspnet-getting-started-part-7/_static/image20.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image19.png)</span></span>

## <a name="using-insert-update-and-delete-stored-procedures"></a><span data-ttu-id="62c99-171">Usar Insert, Update y Delete procedimientos almacenados</span><span class="sxs-lookup"><span data-stu-id="62c99-171">Using Insert, Update, and Delete Stored Procedures</span></span>

<span data-ttu-id="62c99-172">Los procedimientos almacenados para insertar, actualizar y eliminar datos se usan por Entity Framework automáticamente cuando haya agregado al modelo de datos y les asigna a las entidades adecuadas.</span><span class="sxs-lookup"><span data-stu-id="62c99-172">Stored procedures to insert, update, and delete data are used by the Entity Framework automatically after you've added them to the data model and mapped them to the appropriate entities.</span></span> <span data-ttu-id="62c99-173">Ahora puede ejecutar la *StudentsAdd.aspx* página, y cada vez que cree un nuevo alumno, Entity Framework utilizará la `InsertStudent` procedimiento almacenado para agregar la nueva fila a la `Student` tabla.</span><span class="sxs-lookup"><span data-stu-id="62c99-173">You can now run the *StudentsAdd.aspx* page, and every time you create a new student, the Entity Framework will use the `InsertStudent` stored procedure to add the new row to the `Student` table.</span></span>

<span data-ttu-id="62c99-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-174">[![image03](the-entity-framework-and-aspnet-getting-started-part-7/_static/image22.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image21.png)</span></span>

<span data-ttu-id="62c99-175">Ejecute el *Students.aspx* página y el nuevo alumno aparece en la lista.</span><span class="sxs-lookup"><span data-stu-id="62c99-175">Run the *Students.aspx* page and the new student appears in the list.</span></span>

<span data-ttu-id="62c99-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-176">[![image04](the-entity-framework-and-aspnet-getting-started-part-7/_static/image24.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image23.png)</span></span>

<span data-ttu-id="62c99-177">Cambie el nombre para comprobar que funciona la función update y, a continuación, elimine los estudiantes para comprobar que funciona la función de eliminación.</span><span class="sxs-lookup"><span data-stu-id="62c99-177">Change the name to verify that the update function works, and then delete the student to verify that the delete function works.</span></span>

<span data-ttu-id="62c99-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="62c99-178">[![image05](the-entity-framework-and-aspnet-getting-started-part-7/_static/image26.png)](the-entity-framework-and-aspnet-getting-started-part-7/_static/image25.png)</span></span>

## <a name="using-select-stored-procedures"></a><span data-ttu-id="62c99-179">Usar procedimientos almacenados Select</span><span class="sxs-lookup"><span data-stu-id="62c99-179">Using Select Stored Procedures</span></span>

<span data-ttu-id="62c99-180">Entity Framework no se ejecuta automáticamente los procedimientos almacenados como `GetCourses`, y no se pueden usar con el `EntityDataSource` control.</span><span class="sxs-lookup"><span data-stu-id="62c99-180">The Entity Framework does not automatically run stored procedures such as `GetCourses`, and you cannot use them with the `EntityDataSource` control.</span></span> <span data-ttu-id="62c99-181">Para poder utilizarlos, llamarlos desde el código.</span><span class="sxs-lookup"><span data-stu-id="62c99-181">To use them, you call them from code.</span></span>

<span data-ttu-id="62c99-182">Abra la *InstructorsCourses.aspx.cs* archivo.</span><span class="sxs-lookup"><span data-stu-id="62c99-182">Open the *InstructorsCourses.aspx.cs* file.</span></span> <span data-ttu-id="62c99-183">El `PopulateDropDownLists` método usa una consulta de LINQ a Entities para recuperar todas las entidades de curso para que pueda recorrer la lista y determinar cuáles se asigna un instructor a y cuáles están sin asignar:</span><span class="sxs-lookup"><span data-stu-id="62c99-183">The `PopulateDropDownLists` method uses a LINQ-to-Entities query to retrieve all course entities so that it can loop through the list and determine which ones an instructor is assigned to and which ones are unassigned:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample6.cs)]

<span data-ttu-id="62c99-184">Reemplácelo por el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="62c99-184">Replace this with the following code:</span></span>

[!code-csharp[Main](the-entity-framework-and-aspnet-getting-started-part-7/samples/sample7.cs)]

<span data-ttu-id="62c99-185">La página ahora utiliza la `GetCourses` procedimiento almacenado para recuperar la lista de todos los cursos.</span><span class="sxs-lookup"><span data-stu-id="62c99-185">The page now uses the `GetCourses` stored procedure to retrieve the list of all courses.</span></span> <span data-ttu-id="62c99-186">Ejecute la página para comprobar que funciona igual que antes.</span><span class="sxs-lookup"><span data-stu-id="62c99-186">Run the page to verify that it works as it did before.</span></span>

<span data-ttu-id="62c99-187">(Propiedades de navegación de entidades que se recuperan mediante un procedimiento almacenado no se pueden llenar automáticamente con los datos relacionados con las entidades, dependiendo de `ObjectContext` configuración predeterminada.</span><span class="sxs-lookup"><span data-stu-id="62c99-187">(Navigation properties of entities retrieved by a stored procedure might not be automatically populated with the data related to those entities, depending on `ObjectContext` default settings.</span></span> <span data-ttu-id="62c99-188">Para obtener más información, consulte [cargar objetos relacionados](https://msdn.microsoft.com/library/bb896272.aspx) en MSDN Library.)</span><span class="sxs-lookup"><span data-stu-id="62c99-188">For more information, see [Loading Related Objects](https://msdn.microsoft.com/library/bb896272.aspx) in the MSDN Library.)</span></span>

<span data-ttu-id="62c99-189">En el siguiente tutorial, aprenderá cómo utilizar la funcionalidad de datos dinámicos para que resulten más fáciles de programa y probar reglas de formato y validación de datos.</span><span class="sxs-lookup"><span data-stu-id="62c99-189">In the next tutorial, you'll learn how to use Dynamic Data functionality to make it easier to program and test data formatting and validation rules.</span></span> <span data-ttu-id="62c99-190">En lugar de especificar en las reglas de cada página web como las cadenas de formato de datos y si no se requiere un campo, puede especificar estas reglas en los metadatos del modelo de datos y se aplican automáticamente en todas las páginas.</span><span class="sxs-lookup"><span data-stu-id="62c99-190">Instead of specifying on each web page rules such as data format strings and whether or not a field is required, you can specify such rules in data model metadata and they're automatically applied on every page.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="62c99-191">[Anterior](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Siguiente](the-entity-framework-and-aspnet-getting-started-part-8.md)</span><span class="sxs-lookup"><span data-stu-id="62c99-191">[Previous](the-entity-framework-and-aspnet-getting-started-part-6.md)
[Next](the-entity-framework-and-aspnet-getting-started-part-8.md)</span></span>
