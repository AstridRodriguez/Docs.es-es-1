---
uid: aspnet/overview/developing-apps-with-windows-azure/maintainable-azure-websites-managing-change-and-scale
title: "Laboratorio de prácticas: fácil de mantener sitios Web de Azure: administración de cambios y escala | Documentos de Microsoft"
author: rick-anderson
description: "Microsoft Azure facilita la compilar e implementar sitios Web en producción. Pero no ha terminado cuando la aplicación está activa, principiante! El programador..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/16/2014
ms.topic: article
ms.assetid: ecfd0eb4-c4ad-44e6-9db9-a2a66611ff6a
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/maintainable-azure-websites-managing-change-and-scale
msc.type: authoredcontent
ms.openlocfilehash: 1d6d9265d93fbd32e2d9c22e2ac3db9b5ffd9776
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
<a name="hands-on-lab-maintainable-azure-websites-managing-change-and-scale"></a><span data-ttu-id="d6dbf-105">Laboratorio de prácticas: fácil de mantener sitios Web de Azure: administración de cambios y la escala</span><span class="sxs-lookup"><span data-stu-id="d6dbf-105">Hands on Lab: Maintainable Azure Websites: Managing Change and Scale</span></span>
====================
<span data-ttu-id="d6dbf-106">por [Web colonias equipo](https://twitter.com/webcamps)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-106">by [Web Camps Team](https://twitter.com/webcamps)</span></span>

[<span data-ttu-id="d6dbf-107">Descargar el Kit de aprendizaje de colonias de Web</span><span class="sxs-lookup"><span data-stu-id="d6dbf-107">Download Web Camps Training Kit</span></span>](http://aka.ms/webcamps-training-kit)

> <span data-ttu-id="d6dbf-108">Microsoft Azure facilita la compilar e implementar sitios Web en producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-108">Microsoft Azure makes it easy to build and deploy websites to production.</span></span> <span data-ttu-id="d6dbf-109">Pero no ha terminado cuando la aplicación está activa, principiante!</span><span class="sxs-lookup"><span data-stu-id="d6dbf-109">But you're not done when your application is live, you're just getting started!</span></span> <span data-ttu-id="d6dbf-110">Debe controlar los cambiantes requisitos, las actualizaciones de base de datos, escala y mucho más.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-110">You'll need to handle changing requirements, database updates, scale, and more.</span></span> <span data-ttu-id="d6dbf-111">Afortunadamente, servicio de aplicaciones de Azure tiene cubierto, con una gran cantidad de características para ayudarle a mantener los sitios que se ejecutan sin problemas.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-111">Fortunately, Azure App Service has you covered, with plenty of features to help you keep your sites running smoothly.</span></span>
> 
> <span data-ttu-id="d6dbf-112">Azure ofrece seguro y flexible de desarrollo, implementación y opciones para cualquier aplicación web de tamaño de escala.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-112">Azure offers secure and flexible development, deployment and scaling options for any size web application.</span></span> <span data-ttu-id="d6dbf-113">Aproveche sus herramientas existentes para crear e implementar aplicaciones sin las complicaciones de administrar la infraestructura.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-113">Leverage your existing tools to create and deploy applications without the hassle of managing infrastructure.</span></span>
> 
> <span data-ttu-id="d6dbf-114">Aprovisionar una aplicación web de producción por sí mismo en minutos implementando fácilmente contenido creado mediante la herramienta de desarrollo que prefiera.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-114">Provision a production web application yourself in minutes by easily deploying content created using your favorite development tool.</span></span> <span data-ttu-id="d6dbf-115">Puede implementar un sitio existente directamente desde el control de código fuente con compatibilidad para **Git**, **GitHub**, **Bitbucket**, **TFS**y incluso **DropBox**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-115">You can deploy an existing site directly from source control with support for **Git**, **GitHub**, **Bitbucket**, **TFS**, and even **DropBox**.</span></span> <span data-ttu-id="d6dbf-116">Implementar directamente desde su IDE favorito o desde secuencias de comandos mediante **PowerShell** en Windows o **CLI** herramientas que se ejecutan en cualquier sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-116">Deploy directly from your favorite IDE or from scripts using **PowerShell** in Windows or **CLI** tools running on any OS.</span></span> <span data-ttu-id="d6dbf-117">Una vez implementado, mantenga los sitios constantemente actualizada con compatibilidad para la implementación continuada.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-117">Once deployed, keep your sites constantly up-to-date with support for continuous deployment.</span></span>
> 
> <span data-ttu-id="d6dbf-118">Azure proporciona almacenamiento escalable y duradero en la nube, copia de seguridad y las soluciones de recuperación de los datos, grande o pequeño.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-118">Azure provides scalable, durable cloud storage, backup, and recovery solutions for any data, big or small.</span></span> <span data-ttu-id="d6dbf-119">Al implementar aplicaciones en un entorno de producción, servicios de almacenamiento, como tablas, Blobs y bases de datos SQL, ayudarle a escalar la aplicación en la nube.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-119">When deploying applications to a production environment, storage services such as Tables, Blobs and SQL Databases, help you scale your application in the cloud.</span></span>
> 
> <span data-ttu-id="d6dbf-120">Con las bases de datos de SQL, es importante mantener actualizada la base de datos productivo al implementar nuevas versiones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-120">With SQL Databases, it is important to keep your productive database up-to-date when deploying new versions of your application.</span></span> <span data-ttu-id="d6dbf-121">Gracias a **Entity Framework Code First Migrations**, el desarrollo e implementación de su modelo de datos se ha simplificado para actualizar los entornos en minutos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-121">Thanks to **Entity Framework Code First Migrations**, the development and deployment of your data model has been simplified to update your environments in minutes.</span></span> <span data-ttu-id="d6dbf-122">Este laboratorio práctico le mostrará los temas diferentes que podrían surgir al implementar la aplicación web en entornos de producción en Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-122">This hands-on lab will show you the different topics you could encounter when deploying your web app to production environments in Microsoft Azure.</span></span>
> 
> <span data-ttu-id="d6dbf-123">Todo el código de ejemplo y fragmentos de código se incluyen en el Kit de aprendizaje de Web colonias, disponible en [http://aka.ms/webcamps-training-kit](http://aka.ms/webcamps-training-kit).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-123">All sample code and snippets are included in the Web Camps Training Kit, available at [http://aka.ms/webcamps-training-kit](http://aka.ms/webcamps-training-kit).</span></span>
> 
> <span data-ttu-id="d6dbf-124">Para obtener información más detallada de este tema, consulte el [creación de aplicaciones de nube reales con Azure de libros electrónicos](building-real-world-cloud-apps-with-windows-azure/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-124">For more in-depth coverage of this topic, see the [Building Real-World Cloud Apps with Azure e-book](building-real-world-cloud-apps-with-windows-azure/introduction.md).</span></span>


<a id="Overview"></a>
## <a name="overview"></a><span data-ttu-id="d6dbf-125">Información general</span><span class="sxs-lookup"><span data-stu-id="d6dbf-125">Overview</span></span>

<a id="Objectives"></a>
### <a name="objectives"></a><span data-ttu-id="d6dbf-126">Objetivos</span><span class="sxs-lookup"><span data-stu-id="d6dbf-126">Objectives</span></span>

<span data-ttu-id="d6dbf-127">En este laboratorio práctico, aprenderá cómo:</span><span class="sxs-lookup"><span data-stu-id="d6dbf-127">In this hands-on lab, you will learn how to:</span></span>

- <span data-ttu-id="d6dbf-128">Habilitar las migraciones de Entity Framework con un modelo existente</span><span class="sxs-lookup"><span data-stu-id="d6dbf-128">Enable Entity Framework Migrations with an existing model</span></span>
- <span data-ttu-id="d6dbf-129">Actualizar el modelo de objetos y la base de datos en consecuencia usando migraciones de Entity Framework</span><span class="sxs-lookup"><span data-stu-id="d6dbf-129">Update the object model and database accordingly using Entity Framework Migrations</span></span>
- <span data-ttu-id="d6dbf-130">Implementar en el servicio de aplicaciones de Azure mediante Git</span><span class="sxs-lookup"><span data-stu-id="d6dbf-130">Deploy to Azure App Service using Git</span></span>
- <span data-ttu-id="d6dbf-131">Revertir a una implementación anterior mediante el portal de administración de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-131">Rollback to a previous deployment using the Azure Management portal</span></span>
- <span data-ttu-id="d6dbf-132">Usar el almacenamiento de Azure para escalar una aplicación web</span><span class="sxs-lookup"><span data-stu-id="d6dbf-132">Use Azure Storage to scale a web app</span></span>
- <span data-ttu-id="d6dbf-133">Configurar la escala automática para una aplicación web mediante el Portal de administración de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-133">Configure auto-scaling for a web app using the Azure Management Portal</span></span>
- <span data-ttu-id="d6dbf-134">Crear y configurar un proyecto de prueba de carga en Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d6dbf-134">Create and configure a load test project in Visual Studio</span></span>

<a id="Prerequisites"></a>
### <a name="prerequisites"></a><span data-ttu-id="d6dbf-135">Requisitos previos</span><span class="sxs-lookup"><span data-stu-id="d6dbf-135">Prerequisites</span></span>

<span data-ttu-id="d6dbf-136">Para completar este laboratorio de prácticas, es necesario lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="d6dbf-136">The following is required to complete this hands-on lab:</span></span>

- <span data-ttu-id="d6dbf-137">[Visual Studio Express 2013 para Web](https://www.microsoft.com/visualstudio/) o superior</span><span class="sxs-lookup"><span data-stu-id="d6dbf-137">[Visual Studio Express 2013 for Web](https://www.microsoft.com/visualstudio/) or greater</span></span>
- [<span data-ttu-id="d6dbf-138">Azure SDK para .NET 2.2</span><span class="sxs-lookup"><span data-stu-id="d6dbf-138">Azure SDK for .NET 2.2</span></span>](https://www.microsoft.com/windowsazure/sdk/)
- [<span data-ttu-id="d6dbf-139">Sistema de Control de versiones GIT</span><span class="sxs-lookup"><span data-stu-id="d6dbf-139">GIT Version Control System</span></span>](http://git-scm.com/download)
- <span data-ttu-id="d6dbf-140">Una suscripción de Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-140">A Microsoft Azure subscription</span></span> 

    - <span data-ttu-id="d6dbf-141">Suscribirse a un [gratuita](http://aka.ms/watk-freetrial)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-141">Sign up for a [Free Trial](http://aka.ms/watk-freetrial)</span></span>
    - <span data-ttu-id="d6dbf-142">Si eres un Visual Studio Professional, Test Professional, Premium o Ultimate con los suscriptores MSDN o plataformas de MSDN, activar el [ventajas de MSDN](http://aka.ms/watk-msdn) ahora para empezar a desarrollar y prueban aplicaciones en Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-142">If you are a Visual Studio Professional, Test Professional, Premium or Ultimate with MSDN or MSDN Platforms subscriber, activate your [MSDN benefit](http://aka.ms/watk-msdn) now to start developing and testing on Azure</span></span>
    - <span data-ttu-id="d6dbf-143">[BizSpark](http://aka.ms/watk-bizspark) miembros recibirán automáticamente Azure ventaja a través de sus Visual Studio Ultimate suscripciones a MSDN</span><span class="sxs-lookup"><span data-stu-id="d6dbf-143">[BizSpark](http://aka.ms/watk-bizspark) members automatically receive the Azure benefit through their Visual Studio Ultimate with MSDN subscriptions</span></span>
    - <span data-ttu-id="d6dbf-144">Los miembros de la [Microsoft Partner Network](http://aka.ms/watk-mpn) programa Cloud Essentials recibir créditos mensuales de Azure sin coste adicional</span><span class="sxs-lookup"><span data-stu-id="d6dbf-144">Members of the [Microsoft Partner Network](http://aka.ms/watk-mpn) Cloud Essentials program receive monthly Azure credits at no charge</span></span>

<a id="Setup"></a>
### <a name="setup"></a><span data-ttu-id="d6dbf-145">Programa de instalación</span><span class="sxs-lookup"><span data-stu-id="d6dbf-145">Setup</span></span>

<span data-ttu-id="d6dbf-146">Para ejecutar los ejercicios en este laboratorio práctico, debe configurar primero el entorno.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-146">In order to run the exercises in this hands-on lab, you will need to set up your environment first.</span></span>

1. <span data-ttu-id="d6dbf-147">Abra el Explorador de Windows y vaya a la práctica **origen** carpeta.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-147">Open Windows Explorer and browse to the lab's **Source** folder.</span></span>
2. <span data-ttu-id="d6dbf-148">Haga doble clic en **Setup.cmd** y seleccione **ejecutar como administrador** para iniciar el proceso de instalación que configure el entorno e instalará los fragmentos de código de Visual Studio para este laboratorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-148">Right-click on **Setup.cmd** and select **Run as administrator** to launch the setup process that will configure your environment and install the Visual Studio code snippets for this lab.</span></span>
3. <span data-ttu-id="d6dbf-149">Si se muestra el cuadro de diálogo de Control de cuentas de usuario, confirme la acción para continuar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-149">If the User Account Control dialog is shown, confirm the action to proceed.</span></span>

> [!NOTE]
> <span data-ttu-id="d6dbf-150">Asegúrese de que ha activado todas las dependencias para este laboratorio antes de ejecutar el programa de instalación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-150">Make sure you have checked all the dependencies for this lab before running the setup.</span></span>


<a id="CodeSnippets"></a>
### <a name="using-the-code-snippets"></a><span data-ttu-id="d6dbf-151">Uso de los fragmentos de código</span><span class="sxs-lookup"><span data-stu-id="d6dbf-151">Using the Code Snippets</span></span>

<span data-ttu-id="d6dbf-152">En este documento de laboratorio, le indicará que insertar bloques de código.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-152">Throughout the lab document, you will be instructed to insert code blocks.</span></span> <span data-ttu-id="d6dbf-153">Para su comodidad, la mayor parte de este código se proporciona como fragmentos de código de Visual Studio, puede tener acceso desde dentro de Visual Studio 2013 para evitar tener que agregarla manualmente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-153">For your convenience, most of this code is provided as Visual Studio Code Snippets, which you can access from within Visual Studio 2013 to avoid having to add it manually.</span></span>

> [!NOTE]
> <span data-ttu-id="d6dbf-154">Cada ejercicio viene acompañado por una solución de inicia ubicada en el **comenzar** carpeta del ejercicio que le permite seguir cada ejercicio independientemente de las otras.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-154">Each exercise is accompanied by a starting solution located in the **Begin** folder of the exercise that allows you to follow each exercise independently of the others.</span></span> <span data-ttu-id="d6dbf-155">Ten en cuenta que los fragmentos de código que se agregan durante un ejercicio se encuentran desde estas a partir de soluciones y no pueden funcionar hasta que haya completado el ejercicio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-155">Please be aware that the code snippets that are added during an exercise are missing from these starting solutions and may not work until you have completed the exercise.</span></span> <span data-ttu-id="d6dbf-156">En el código fuente de un ejercicio, también encontrará un **final** carpeta que contiene una solución de Visual Studio con el código que se obtiene al completar los pasos en el ejercicio correspondiente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-156">Inside the source code for an exercise, you will also find an **End** folder containing a Visual Studio solution with the code that results from completing the steps in the corresponding exercise.</span></span> <span data-ttu-id="d6dbf-157">Puede usar estas soluciones como guía si necesita ayuda adicional cuando se trabaja a través de este laboratorio práctico.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-157">You can use these solutions as guidance if you need additional help as you work through this hands-on lab.</span></span>


* * *

<a id="Exercises"></a>
## <a name="exercises"></a><span data-ttu-id="d6dbf-158">Ejercicios</span><span class="sxs-lookup"><span data-stu-id="d6dbf-158">Exercises</span></span>

<span data-ttu-id="d6dbf-159">Este laboratorio de prácticas incluye los ejercicios siguientes:</span><span class="sxs-lookup"><span data-stu-id="d6dbf-159">This hands-on lab includes the following exercises:</span></span>

1. [<span data-ttu-id="d6dbf-160">Usar migraciones de Entity Framework</span><span class="sxs-lookup"><span data-stu-id="d6dbf-160">Using Entity Framework Migrations</span></span>](#Exercise1)
2. [<span data-ttu-id="d6dbf-161">Implementar una aplicación Web en almacenamiento provisional</span><span class="sxs-lookup"><span data-stu-id="d6dbf-161">Deploying a Web App to Staging</span></span>](#Exercise2)
3. [<span data-ttu-id="d6dbf-162">Realizar la reversión de la implementación en producción</span><span class="sxs-lookup"><span data-stu-id="d6dbf-162">Performing Deployment Rollback in Production</span></span>](#Exercise3)
4. [<span data-ttu-id="d6dbf-163">Ajuste de escala con el almacenamiento de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-163">Scaling Using Azure Storage</span></span>](#Exercise4)
5. <span data-ttu-id="d6dbf-164">[Usar el escalado automático para las aplicaciones Web](#Exercise5) (opcional para Visual Studio 2013 Ultimate edition)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-164">[Using Autoscale for Web Apps](#Exercise5) (Optional for Visual Studio 2013 Ultimate edition)</span></span>

<span data-ttu-id="d6dbf-165">Tiempo estimado para completar esta práctica: **75 minutos**</span><span class="sxs-lookup"><span data-stu-id="d6dbf-165">Estimated time to complete this lab: **75 minutes**</span></span>

> [!NOTE]
> <span data-ttu-id="d6dbf-166">Cuando se inicia Visual Studio por primera vez, debe seleccionar una de las colecciones de configuraciones predefinidas.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-166">When you first start Visual Studio, you must select one of the predefined settings collections.</span></span> <span data-ttu-id="d6dbf-167">Cada colección predefinida está diseñado para que coincida con un estilo de desarrollo determinado y determina los diseños de ventana, comportamiento del editor, fragmentos de código de IntelliSense y opciones del cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-167">Each predefined collection is designed to match a particular development style and determines window layouts, editor behavior, IntelliSense code snippets, and dialog box options.</span></span> <span data-ttu-id="d6dbf-168">Los procedimientos descritos en este laboratorio describen las acciones necesarias para realizar una tarea concreta en Visual Studio cuando se usa el **configuración General de desarrollo** colección.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-168">The procedures in this lab describe the actions necessary to accomplish a given task in Visual Studio when using the **General Development Settings** collection.</span></span> <span data-ttu-id="d6dbf-169">Si elige una colección de configuraciones diferentes para el entorno de desarrollo, puede haber diferencias en los pasos que debe tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-169">If you choose a different settings collection for your development environment, there may be differences in the steps that you should take into account.</span></span>


<a id="Exercise1"></a>
### <a name="exercise-1-using-entity-framework-migrations"></a><span data-ttu-id="d6dbf-170">Ejercicio 1: Usar migraciones de Entity Framework</span><span class="sxs-lookup"><span data-stu-id="d6dbf-170">Exercise 1: Using Entity Framework Migrations</span></span>

<span data-ttu-id="d6dbf-171">Cuando está desarrollando una aplicación, puede cambiar el modelo de datos con el tiempo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-171">When you are developing an application, your data model might change over time.</span></span> <span data-ttu-id="d6dbf-172">Estos cambios podrían afectar al modelo existente en la base de datos (si está creando una nueva versión) y es importante mantener actualizados para evitar errores de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-172">These changes could affect the existing model in your database (if you are creating a new version) and it is important to keep your database up-to-date to prevent errors.</span></span>

<span data-ttu-id="d6dbf-173">Para simplificar el seguimiento de estos cambios en el modelo de **Entity Framework Code First Migrations** automáticamente detectar cambios comparar el modelo con el esquema de base de datos y genera código específico para actualizar la base de datos crear nuevas *versiones* de la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-173">To simplify the tracking of these changes in your model, **Entity Framework Code First Migrations** automatically detect changes comparing your model with the database schema and generates specific code to update your database, creating new *versions* of your database.</span></span>

<span data-ttu-id="d6dbf-174">Este ejercicio muestra cómo habilitar **migraciones** para una aplicación y cómo puede detectar y generen cambios para actualizar las bases de datos fácilmente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-174">This exercise shows you how to enable **Migrations** for your application and how you can easily detect and generate changes to update your databases.</span></span>

<a id="Ex1Task1"></a>
#### <a name="task-1--enabling-migrations"></a><span data-ttu-id="d6dbf-175">Tarea 1: habilitar migraciones</span><span class="sxs-lookup"><span data-stu-id="d6dbf-175">Task 1 – Enabling Migrations</span></span>

<span data-ttu-id="d6dbf-176">En esta tarea, recorrerá los pasos necesarios para habilitar **Entity Framework Code First Migrations** a la **experto en cuestionario** base de datos, cambiar el modelo y entender cómo estos cambios se reflejan en el base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-176">In this task, you will go through the steps of enabling **Entity Framework Code First Migrations** to the **Geek Quiz** database, changing the model and understanding how those changes are reflected in the database.</span></span>

1. <span data-ttu-id="d6dbf-177">Abra Visual Studio y abra el **GeekQuiz.sln** archivo de solución de **Source\Ex1 UsingEntityFrameworkMigrations\Begin**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-177">Open Visual Studio and open the **GeekQuiz.sln** solution file from **Source\Ex1-UsingEntityFrameworkMigrations\Begin**.</span></span>
2. <span data-ttu-id="d6dbf-178">Compile la solución para descargar e instalar la **NuGet** dependencias del paquete.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-178">Build the solution in order to download and install the **NuGet** package dependencies.</span></span> <span data-ttu-id="d6dbf-179">Para ello, haga clic en la solución y haga clic en **generar solución** o presione **Ctrl + Mayús + B**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-179">To do this, right-click the solution and click **Build Solution** or press **Ctrl + Shift + B**.</span></span>
3. <span data-ttu-id="d6dbf-180">Desde el **herramientas** menú en Visual Studio, seleccione **Administrador de paquetes de biblioteca**y, a continuación, haga clic en **Package Manager Console**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-180">From the **Tools** menu in Visual Studio, select **Library Package Manager**, and then click **Package Manager Console**.</span></span>
4. <span data-ttu-id="d6dbf-181">En el **Package Manager Console**, escriba el siguiente comando y, a continuación, presione **ENTRAR**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-181">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span> <span data-ttu-id="d6dbf-182">Se creará una migración inicial basada en el modelo existente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-182">An initial migration based on the existing model will be created.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample1.ps1)]

    <span data-ttu-id="d6dbf-183">![Habilitar migraciones](maintainable-azure-websites-managing-change-and-scale/_static/image1.png "habilitar migraciones")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-183">![Enabling Migrations](maintainable-azure-websites-managing-change-and-scale/_static/image1.png "Enabling Migrations")</span></span>

    <span data-ttu-id="d6dbf-184">*Habilitar las migraciones*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-184">*Enabling Migrations*</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-185">Este comando agrega un **migraciones** carpeta al proyecto de prueba de experto en que contiene un archivo denominado **archivo Configuration.cs que**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-185">This command adds a **Migrations** folder to Geek Quiz project that contains a file called **Configuration.cs**.</span></span> <span data-ttu-id="d6dbf-186">El **configuración** clase le permite configurar el comportamiento de las migraciones para el contexto.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-186">The **Configuration** class allows you to configure how Migrations behaves for your context.</span></span>
5. <span data-ttu-id="d6dbf-187">Con las migraciones habilitadas, debe actualizar el **configuración** clase para rellenar la base de datos con los datos iniciales que **experto en cuestionario** requiere.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-187">With Migrations enabled, you need to update the **Configuration** class to populate the database with the initial data that **Geek Quiz** requires.</span></span> <span data-ttu-id="d6dbf-188">En **migraciones**, reemplace la **archivo Configuration.cs que** archivo con el que se encuentra en la **Source\Assets** carpeta de este laboratorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-188">Under **Migrations**, replace the **Configuration.cs** file with the one located in the **Source\Assets** folder of this lab.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-189">Puesto que **migraciones** llamará el **inicialización** método con todas las actualizaciones de base de datos, debe asegurarse de que los registros no estén duplicados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-189">Since **Migrations** will call the **Seed** method with every database update, you need to be sure that records are not duplicated in the database.</span></span> <span data-ttu-id="d6dbf-190">El **AddOrUpdate** método le ayudará a evitar datos duplicados.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-190">The **AddOrUpdate** method will help to prevent duplicate data.</span></span>
6. <span data-ttu-id="d6dbf-191">Para agregar una migración inicial, escriba el siguiente comando y, a continuación, presione **ENTRAR**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-191">To add an initial migration, enter the following command and then press **Enter**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-192">Asegúrese de que no hay ninguna base de datos denominada &quot;GeekQuizProd&quot; en la instancia de LocalDB.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-192">Make sure that there is no database named &quot;GeekQuizProd&quot; in your LocalDB instance.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample2.ps1)]

    <span data-ttu-id="d6dbf-193">![Adición de migración de esquema de base](maintainable-azure-websites-managing-change-and-scale/_static/image2.png "Agregar esquema base migración")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-193">![Adding base schema migration](maintainable-azure-websites-managing-change-and-scale/_static/image2.png "Adding base schema migration")</span></span>

    <span data-ttu-id="d6dbf-194">*Adición de migración de esquema de base*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-194">*Adding base schema migration*</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-195">**Migración agregar** se aplique la técnica scaffolding la siguiente migración según los cambios realizados en el modelo desde que se creó la última migración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-195">**Add-Migration** will scaffold the next migration based on changes you have made to your model since the last migration was created.</span></span> <span data-ttu-id="d6dbf-196">En este caso, ya que es la primera migración del proyecto, agregará las secuencias de comandos para crear todas las tablas definidas en el **TriviaContext** clase.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-196">In this case, as it is the first migration of the project, it will add the scripts to create all the tables defined in the **TriviaContext** class.</span></span>
7. <span data-ttu-id="d6dbf-197">Ejecutar la migración para actualizar la base de datos ejecutando el comando siguiente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-197">Execute the migration to update the database by running the following command.</span></span> <span data-ttu-id="d6dbf-198">Para este comando especificará el **detallado** marca para ver las instrucciones SQL que se va a aplicar a la base de datos de destino.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-198">For this command you will specify the **Verbose** flag to view the SQL statements being applied to the target database.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample3.ps1)]

    <span data-ttu-id="d6dbf-199">![Crear la base de datos inicial](maintainable-azure-websites-managing-change-and-scale/_static/image3.png "crear la base de datos inicial")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-199">![Creating initial database](maintainable-azure-websites-managing-change-and-scale/_static/image3.png "Creating initial database")</span></span>

    <span data-ttu-id="d6dbf-200">*Crear base de datos inicial*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-200">*Creating initial database*</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-201">**Actualizar base de datos** se aplicarán las migraciones pendientes a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-201">**Update-Database** will apply any pending migrations to the database.</span></span> <span data-ttu-id="d6dbf-202">En este caso, creará la base de datos mediante la cadena de conexión definida en el archivo web.config.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-202">In this case, it will create the database using the connection string defined in your web.config file.</span></span>
8. <span data-ttu-id="d6dbf-203">Vaya a **vista** menú y abra **Explorador de objetos de SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-203">Go to **View** menu and open **SQL Server Object Explorer**.</span></span>

    <span data-ttu-id="d6dbf-204">![Abrir en el Explorador de objetos SQL Server](maintainable-azure-websites-managing-change-and-scale/_static/image4.png "abierto en el Explorador de objetos SQL Server")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-204">![Open in SQL Server Object Explorer](maintainable-azure-websites-managing-change-and-scale/_static/image4.png "Open in SQL Server Object Explorer")</span></span>

    <span data-ttu-id="d6dbf-205">*Abrir en el Explorador de objetos SQL Server*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-205">*Open in SQL Server Object Explorer*</span></span>
9. <span data-ttu-id="d6dbf-206">En el **Explorador de objetos de SQL Server** ventana, conectarse a la instancia de LocalDB con el botón secundario del **SQL Server** nodo y seleccione **agregar SQL Server...**  opción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-206">In the **SQL Server Object Explorer** window, connect to your LocalDB instance by right-clicking the **SQL Server** node and selecting **Add SQL Server...** option.</span></span>

    <span data-ttu-id="d6dbf-207">![Agregar una instancia de SQL Server](maintainable-azure-websites-managing-change-and-scale/_static/image5.png "agregar una instancia de SQL Server")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-207">![Adding a SQL Server Instance](maintainable-azure-websites-managing-change-and-scale/_static/image5.png "Adding a SQL Server Instance")</span></span>

    <span data-ttu-id="d6dbf-208">*Agregar una instancia de SQL Server en el Explorador de objetos de SQL Server*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-208">*Adding a SQL Server instance to SQL Server Object Explorer*</span></span>
10. <span data-ttu-id="d6dbf-209">Establecer el **nombre del servidor** a *(localdb) \v11.0* y deje **autenticación de Windows** como el modo de autenticación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-209">Set the **server name** to *(localdb)\v11.0* and leave **Windows Authentication** as your authentication mode.</span></span> <span data-ttu-id="d6dbf-210">Haga clic en **conectar** para continuar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-210">Click **Connect** to continue.</span></span>

    <span data-ttu-id="d6dbf-211">![Conectarse a LocalDB](maintainable-azure-websites-managing-change-and-scale/_static/image6.png "conectarse a LocalDB")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-211">![Connecting to LocalDB](maintainable-azure-websites-managing-change-and-scale/_static/image6.png "Connecting to LocalDB")</span></span>

    <span data-ttu-id="d6dbf-212">*Conectarse a LocalDB*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-212">*Connecting to LocalDB*</span></span>
11. <span data-ttu-id="d6dbf-213">Abra la **GeekQuizProd** la base de datos y expanda el **tablas** nodo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-213">Open the **GeekQuizProd** database and expand the **Tables** node.</span></span> <span data-ttu-id="d6dbf-214">Como puede ver, el **Update-Database** comando genera todas las tablas definidas en el **TriviaContext** clase.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-214">As you can see, the **Update-Database** command generated all the tables defined in the **TriviaContext** class.</span></span> <span data-ttu-id="d6dbf-215">Busque la **dbo. TriviaQuestions** de tabla y abra el nodo de columnas.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-215">Locate the **dbo.TriviaQuestions** table and open the columns node.</span></span> <span data-ttu-id="d6dbf-216">En la siguiente tarea, agregará una nueva columna a esta tabla y actualizar la base de datos mediante **migraciones**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-216">In the next task, you will add a new column to this table and update the database using **Migrations**.</span></span>

    <span data-ttu-id="d6dbf-217">![Curiosidades preguntas columnas](maintainable-azure-websites-managing-change-and-scale/_static/image7.png "trivial de preguntas de columnas")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-217">![Trivia Questions Columns](maintainable-azure-websites-managing-change-and-scale/_static/image7.png "Trivia Questions Columns")</span></span>

    <span data-ttu-id="d6dbf-218">*Trivial de preguntas de columnas*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-218">*Trivia Questions Columns*</span></span>

<a id="Ex1Task2"></a>
#### <a name="task-2--updating-database-schema-using-migrations"></a><span data-ttu-id="d6dbf-219">Tarea 2: actualizar esquema de base de datos mediante las migraciones</span><span class="sxs-lookup"><span data-stu-id="d6dbf-219">Task 2 – Updating Database Schema Using Migrations</span></span>

<span data-ttu-id="d6dbf-220">En esta tarea, va a usar **Entity Framework Code First Migrations** para detectar un cambio en el modelo y generar el código necesario para actualizar la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-220">In this task, you will use **Entity Framework Code First Migrations** to detect a change in your model and generate the necessary code to update the database.</span></span> <span data-ttu-id="d6dbf-221">Actualizará el **TriviaQuestions** entidad agregando una nueva propiedad a él.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-221">You will update the **TriviaQuestions** entity by adding a new property to it.</span></span> <span data-ttu-id="d6dbf-222">A continuación, volverá a ejecutar comandos para crear una nueva migración para incluir la nueva columna en la tabla.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-222">Then you will run commands to create a new Migration to include the new column in the table.</span></span>

1. <span data-ttu-id="d6dbf-223">En **el Explorador de soluciones**, haga doble clic en el **TriviaQuestion.cs** archivo que se encuentra dentro de la **modelos** carpeta.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-223">In **Solution Explorer**, double-click the **TriviaQuestion.cs** file located inside the **Models** folder.</span></span>
2. <span data-ttu-id="d6dbf-224">Agregar una nueva propiedad denominada **sugerencia**, tal y como se muestra en el siguiente fragmento de código.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-224">Add a new property named **Hint**, as shown in the following code snippet.</span></span>

    [!code-csharp[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample4.cs)]
3. <span data-ttu-id="d6dbf-225">En el **Package Manager Console**, escriba el siguiente comando y, a continuación, presione **ENTRAR**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-225">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span> <span data-ttu-id="d6dbf-226">Se creará una nueva migración que refleja el cambio en nuestro modelo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-226">A new migration will be created reflecting the change in our model.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample5.ps1)]

    <span data-ttu-id="d6dbf-227">![Migración agregar](maintainable-azure-websites-managing-change-and-scale/_static/image8.png "agregar la migración")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-227">![Add-Migration](maintainable-azure-websites-managing-change-and-scale/_static/image8.png "Add-Migration")</span></span>

    <span data-ttu-id="d6dbf-228">*Agregar la migración*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-228">*Add-Migration*</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-229">Un archivo de migración se compone de dos métodos, **una** y **hacia abajo**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-229">A Migration file is composed of two methods, **Up** and **Down**.</span></span>
    > 
    > - <span data-ttu-id="d6dbf-230">El **seguridad** método se utilizará para especificar lo que cambia la versión actual de la necesidad de aplicación se aplican a la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-230">The **Up** method will be used to specify what changes the current version of our application need to apply to the database.</span></span>
    > - <span data-ttu-id="d6dbf-231">El **hacia abajo** se utiliza para revertir los cambios que hemos agregado a la **seguridad** método.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-231">The **Down** is used to reverse the changes we have added to the **Up** method.</span></span>
    > 
    > <span data-ttu-id="d6dbf-232">Cuando la migración de base de datos actualiza la base de datos, se ejecutará todas las migraciones en el orden de marca de tiempo y solo aquellos que no se ha usado desde la última actualización (el \_realiza un seguimiento de la tabla MigrationHistory se han aplicado las migraciones).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-232">When the Database Migration updates the database, it will run all migrations in the timestamp order, and only those that have not been used since the last update (The \_MigrationHistory table keeps track of which migrations have been applied).</span></span> <span data-ttu-id="d6dbf-233">El **seguridad** método de todas las migraciones se llamará y hará que los cambios especificados en la base de datos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-233">The **Up** method of all migrations will be called and will make the changes we have specified to the database.</span></span> <span data-ttu-id="d6dbf-234">Si se decide volver a una migración anterior, el **hacia abajo** método se llamará para rehacer los cambios en orden inverso.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-234">If we decide to go back to a previous migration, the **Down** method will be called to redo the changes in a reverse order.</span></span>
4. <span data-ttu-id="d6dbf-235">En el **Package Manager Console**, escriba el siguiente comando y, a continuación, presione **ENTRAR**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-235">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample6.ps1)]
5. <span data-ttu-id="d6dbf-236">El resultado de la **Update-Database** comando genera un **Alter Table** instrucción SQL para agregar una nueva columna a la **TriviaQuestions** de tabla, como se muestra en la imagen siguiente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-236">The output of the **Update-Database** command generated an **Alter Table** SQL statement to add a new column to the **TriviaQuestions** table, as shown in the image below.</span></span>

    <span data-ttu-id="d6dbf-237">![Agregue la instrucción SQL de columna generada](maintainable-azure-websites-managing-change-and-scale/_static/image9.png "agregar la instrucción SQL de columna generada")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-237">![Add column SQL statement generated](maintainable-azure-websites-managing-change-and-scale/_static/image9.png "Add column SQL statement generated")</span></span>

    <span data-ttu-id="d6dbf-238">*Agregue la instrucción SQL de columna generada*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-238">*Add column SQL statement generated*</span></span>
6. <span data-ttu-id="d6dbf-239">En **Explorador de objetos de SQL Server**, actualizar la **dbo. TriviaQuestions** de tabla y compruebe que la nueva **sugerencia** se muestra la columna.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-239">In **SQL Server Object Explorer**, refresh the **dbo.TriviaQuestions** table and check that the new **Hint** column is displayed.</span></span>

    <span data-ttu-id="d6dbf-240">![Mostrar la nueva columna de sugerencia](maintainable-azure-websites-managing-change-and-scale/_static/image10.png "que muestra la nueva columna de sugerencia")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-240">![Showing the new Hint Column](maintainable-azure-websites-managing-change-and-scale/_static/image10.png "Showing the new Hint Column")</span></span>

    <span data-ttu-id="d6dbf-241">*Mostrar la nueva columna de sugerencia*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-241">*Showing the new Hint Column*</span></span>
7. <span data-ttu-id="d6dbf-242">En el **TriviaQuestion.cs** editor, agregue un **StringLength** restricción a la *sugerencia* propiedad, como se muestra en el siguiente fragmento de código.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-242">Back in the **TriviaQuestion.cs** editor, add a **StringLength** constraint to the *Hint* property, as shown in the following code snippet.</span></span>

    [!code-csharp[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample7.cs)]
8. <span data-ttu-id="d6dbf-243">En el **Package Manager Console**, escriba el siguiente comando y, a continuación, presione **ENTRAR**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-243">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample8.ps1)]
9. <span data-ttu-id="d6dbf-244">En el **Package Manager Console**, escriba el siguiente comando y, a continuación, presione **ENTRAR**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-244">In the **Package Manager Console**, enter the following command and then press **Enter**.</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample9.ps1)]
10. <span data-ttu-id="d6dbf-245">El resultado de la **Update-Database** comando genera un **Alter Table** instrucción SQL para actualizar la *sugerencia* tipo de columna de la **TriviaQuestions** de tabla, como se muestra en la imagen siguiente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-245">The output of the **Update-Database** command generated an **Alter Table** SQL statement to update the *hint* column type of the **TriviaQuestions** table, as shown in the image below.</span></span>

    <span data-ttu-id="d6dbf-246">![Modificar la instrucción SQL de columna generada](maintainable-azure-websites-managing-change-and-scale/_static/image11.png "modificar la instrucción SQL de columna generada")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-246">![Alter column SQL statement generated](maintainable-azure-websites-managing-change-and-scale/_static/image11.png "Alter column SQL statement generated")</span></span>

    <span data-ttu-id="d6dbf-247">*Modificar la instrucción SQL de columna generada*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-247">*Alter column SQL statement generated*</span></span>
11. <span data-ttu-id="d6dbf-248">En **Explorador de objetos de SQL Server**, actualizar la **dbo. TriviaQuestions** de tabla y compruebe que la **sugerencia** tipo de columna es **nvarchar(150)**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-248">In **SQL Server Object Explorer**, refresh the **dbo.TriviaQuestions** table and check that the **Hint** column type is **nvarchar(150)**.</span></span>

    <span data-ttu-id="d6dbf-249">![Mostrar la nueva restricción](maintainable-azure-websites-managing-change-and-scale/_static/image12.png "que muestra la nueva restricción")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-249">![Showing the new constraint](maintainable-azure-websites-managing-change-and-scale/_static/image12.png "Showing the new constraint")</span></span>

    <span data-ttu-id="d6dbf-250">*Mostrar la nueva restricción*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-250">*Showing the new constraint*</span></span>

<a id="Exercise2"></a>
### <a name="exercise-2-deploying-a-web-app-to-staging"></a><span data-ttu-id="d6dbf-251">Ejercicio 2: Implementar una aplicación Web en almacenamiento provisional</span><span class="sxs-lookup"><span data-stu-id="d6dbf-251">Exercise 2: Deploying a Web App to Staging</span></span>

<span data-ttu-id="d6dbf-252">**Aplicaciones de servicio de aplicaciones de Azure Web** le permite realizar la publicación de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-252">**Web Apps in Azure App Service** enables you to perform staged publishing.</span></span> <span data-ttu-id="d6dbf-253">Publicación de ensayo crea una ranura de sitio de ensayo para cada sitio de producción de forma predeterminada y le permite intercambiar estas zonas sin tiempo de inactividad.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-253">Staged publishing creates a staging site slot for each default production site and enables you to swap these slots with no down time.</span></span> <span data-ttu-id="d6dbf-254">Esto es muy útil para validar los cambios antes de liberar al público, incrementalmente integrar el contenido del sitio y se revierte aunque cambios no funcionan según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-254">This is really useful to validate changes before releasing to the public, incrementally integrate site content, and roll back if changes are not working as expected.</span></span>

<span data-ttu-id="d6dbf-255">En este ejercicio, implementará la **experto en cuestionario** aplicación en el entorno de ensayo de la aplicación web mediante el control de código fuente de Git.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-255">In this exercise, you will deploy the **Geek Quiz** application to the staging environment of your web app using Git source control.</span></span> <span data-ttu-id="d6dbf-256">Para ello, se crea la aplicación web y aprovisionar los componentes necesarios en el portal de administración, configure un **Git** repositorio e inserte la aplicación el código fuente desde el equipo local para la zona de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-256">To do this, you will create the web app and provision the required components at the management portal, configure a **Git** repository and push the application source code from your local computer to the staging slot.</span></span> <span data-ttu-id="d6dbf-257">También se actualizará la base de datos de producción con el **migraciones de Code First** que creó en el ejercicio anterior.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-257">You will also update your production database with the **Code First Migrations** you created in the previous exercise.</span></span> <span data-ttu-id="d6dbf-258">A continuación, se ejecutará la aplicación en este entorno de prueba para comprobar su funcionamiento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-258">You will then execute the application in this test environment to verify its operation.</span></span> <span data-ttu-id="d6dbf-259">Cuando esté satisfecho que TI funciona según sus expectativas, promocionará la aplicación en producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-259">Once you are satisfied that it is working according to your expectations, you will promote the application to production.</span></span>

> [!NOTE]
> <span data-ttu-id="d6dbf-260">Para habilitar la publicación de ensayo, la aplicación web debe estar en **modo estándar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-260">To enable staged publishing, the web app must be in **Standard mode**.</span></span> <span data-ttu-id="d6dbf-261">Tenga en cuenta que se aplicarán cargos adicionales si su aplicación web se cambia al modo estándar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-261">Note that additional charges will be incurred if you change your web app to Standard mode.</span></span> <span data-ttu-id="d6dbf-262">Para obtener más información sobre los precios, consulte [precios del servicio de aplicación](https://azure.microsoft.com/en-us/pricing/details/app-service/).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-262">For more information about pricing, see [App Service Pricing](https://azure.microsoft.com/en-us/pricing/details/app-service/).</span></span>


<a id="Ex2Task1"></a>
#### <a name="task-1--creating-a-web-app-in-azure-app-service"></a><span data-ttu-id="d6dbf-263">Tarea 1: crear una aplicación Web en el servicio de aplicación de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-263">Task 1 – Creating a Web App in Azure App Service</span></span>

<span data-ttu-id="d6dbf-264">En esta tarea, creará una aplicación web en **servicio de aplicaciones de Azure** desde el portal de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-264">In this task, you will create a web app in **Azure App Service** from the management portal.</span></span> <span data-ttu-id="d6dbf-265">También tendrá que configurar un **base de datos SQL** para conservar los datos de aplicación y configurar un repositorio de Git local para el control de código fuente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-265">You will also configure a **SQL Database** to persist the application data, and configure a local Git repository for source control.</span></span>

1. <span data-ttu-id="d6dbf-266">Vaya a la [portal de administración de Azure](https://manage.windowsazure.com) e inicie sesión con la cuenta de Microsoft asociada con su suscripción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-266">Go to the [Azure management portal](https://manage.windowsazure.com) and sign in using the Microsoft account associated with your subscription.</span></span>

    ![Inicie sesión en el portal de administración de Azure](maintainable-azure-websites-managing-change-and-scale/_static/image13.png)

    <span data-ttu-id="d6dbf-268">*Inicie sesión en el portal de administración de Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-268">*Sign in to the Azure management portal*</span></span>
2. <span data-ttu-id="d6dbf-269">Haga clic en **New** en la barra de comandos en la parte inferior de la página.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-269">Click **New** in the command bar at the bottom of the page.</span></span>

    <span data-ttu-id="d6dbf-270">![Crear una nueva aplicación web](maintainable-azure-websites-managing-change-and-scale/_static/image14.png "crear una nueva aplicación web")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-270">![Creating a new web app](maintainable-azure-websites-managing-change-and-scale/_static/image14.png "Creating a new web app")</span></span>

    <span data-ttu-id="d6dbf-271">*Crear una nueva aplicación web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-271">*Creating a new web app*</span></span>
3. <span data-ttu-id="d6dbf-272">Haga clic en **proceso**, **sitio Web** y, a continuación, **creación personalizada**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-272">Click **Compute**, **Website** and then **Custom Create**.</span></span>

    <span data-ttu-id="d6dbf-273">![Crear una nueva aplicación web mediante la creación personalizada](maintainable-azure-websites-managing-change-and-scale/_static/image15.png "crear una nueva aplicación web mediante la creación personalizada")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-273">![Creating a new web app using Custom Create](maintainable-azure-websites-managing-change-and-scale/_static/image15.png "Creating a new web app using Custom Create")</span></span>

    <span data-ttu-id="d6dbf-274">*Crear una nueva aplicación web mediante la creación personalizada*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-274">*Creating a new web app using Custom Create*</span></span>
4. <span data-ttu-id="d6dbf-275">En el **nuevo sitio Web - Creación personalizada** diálogo cuadro, proporcione un **URL** (p. ej. *experto en prueba*), seleccione una ubicación en la **región** lista desplegable y seleccione **crear una nueva base de datos SQL** en el **base de datos** lista desplegable.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-275">In the **New Website - Custom Create** dialog box, provide an available **URL** (e.g. *geek-quiz*), select a location in the **Region** drop-down list, and select **Create a new SQL database** in the **Database** drop-down list.</span></span> <span data-ttu-id="d6dbf-276">Por último, seleccione la **publicar desde control de código fuente** casilla de verificación y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-276">Finally, select the **Publish from source control** check box and click **Next**.</span></span>

    ![Personalizar la nueva aplicación web](maintainable-azure-websites-managing-change-and-scale/_static/image16.png)

    <span data-ttu-id="d6dbf-278">*Personalizar la nueva aplicación web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-278">*Customizing the new web app*</span></span>
5. <span data-ttu-id="d6dbf-279">Especifique la siguiente información para la configuración de la base de datos:</span><span class="sxs-lookup"><span data-stu-id="d6dbf-279">Specify the following information for the database settings:</span></span>

    - <span data-ttu-id="d6dbf-280">En el **nombre** texto cuadro, escriba un nombre de base de datos (por ejemplo, *geekquiz\_db*)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-280">In the **Name** text box, enter a database name (e.g. *geekquiz\_db*)</span></span>
    - <span data-ttu-id="d6dbf-281">En el servidor **desplegable** lista, seleccione **servidor de base de datos SQL nueva**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-281">In the Server **drop-down** list, select **New SQL database server**.</span></span> <span data-ttu-id="d6dbf-282">Como alternativa, puede seleccionar un servidor existente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-282">Alternatively, you can select an existing server.</span></span>
    - <span data-ttu-id="d6dbf-283">En el **nombre de usuario de base de datos** y **contraseña de base de datos** cuadros, escriba el nombre de usuario de administrador y la contraseña para el servidor de base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-283">In the **Database username** and **Database password** boxes, enter the administrator username and password for the SQL database server.</span></span> <span data-ttu-id="d6dbf-284">Si selecciona un servidor que ya ha creado, se le pedirá la contraseña.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-284">If you select a server you have already created, you will be prompted for the password.</span></span>

    ![Especificar la configuración de la base de datos](maintainable-azure-websites-managing-change-and-scale/_static/image17.png)

    <span data-ttu-id="d6dbf-286">*Especificar la configuración de la base de datos*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-286">*Specifying the database settings*</span></span>
6. <span data-ttu-id="d6dbf-287">Haga clic en **siguiente** para continuar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-287">Click **Next** to continue.</span></span>
7. <span data-ttu-id="d6dbf-288">Seleccione **repositorio de Git Local** para el control de código fuente utilizar y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-288">Select **Local Git repository** for the source control to use and click **Next**.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-289">Puede se le pedirán las credenciales de implementación (un nombre de usuario y una contraseña).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-289">You may be prompted for the deployment credentials (a username and password).</span></span>

    ![Crear el repositorio de Git](maintainable-azure-websites-managing-change-and-scale/_static/image18.png)

    <span data-ttu-id="d6dbf-291">*Crear el repositorio de Git*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-291">*Creating the Git repository*</span></span>
8. <span data-ttu-id="d6dbf-292">Espere hasta que se crea la nueva aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-292">Wait until the new web app is created.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-293">De forma predeterminada, Azure proporciona dominios a *azurewebsites.net* , pero también ofrece la posibilidad de establecer dominios personalizados mediante el portal de administración de Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-293">By default, Azure provides domains at *azurewebsites.net* but also gives you the possibility to set custom domains using the Azure management portal.</span></span> <span data-ttu-id="d6dbf-294">Sin embargo, sólo se pueden administrar dominios personalizados si usas ciertos modos de servicio de aplicaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-294">However, you can only manage custom domains if you are using certain Azure App Service modes.</span></span>
    > 
    > <span data-ttu-id="d6dbf-295">Servicio de aplicaciones de Azure está disponible en ediciones gratuito, compartido, Basic, Standard y Premium.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-295">Azure App Service is available in Free, Shared, Basic, Standard, and Premium editions.</span></span> <span data-ttu-id="d6dbf-296">En el modo gratuito y compartido, todas las aplicaciones web ejecutan en un entorno de varios inquilinos y tienen cuotas para el uso de CPU, memoria y red.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-296">In Free and Shared mode, all web apps run in a multi-tenant environment and have quotas for CPU, Memory, and Network usage.</span></span> <span data-ttu-id="d6dbf-297">El número máximo de aplicaciones gratuitas puede variar con el plan.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-297">The maximum number of free apps may vary with your plan.</span></span> <span data-ttu-id="d6dbf-298">En modo estándar, debe elegir qué aplicaciones que se ejecutan en máquinas virtuales dedicadas que corresponden a Azure estándar los recursos informáticos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-298">In Standard mode, you choose which apps run on dedicated virtual machines that correspond to the standard Azure compute resources.</span></span> <span data-ttu-id="d6dbf-299">Puede encontrar la configuración del modo de aplicación web en el **escala** menú de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-299">You can find the web app mode configuration in the **Scale** menu of your web app.</span></span>
    > 
    > <span data-ttu-id="d6dbf-300">![Modos de servicio de aplicaciones de Azure](maintainable-azure-websites-managing-change-and-scale/_static/image19.png "modos de servicio de aplicaciones de Azure")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-300">![Azure App Service Modes](maintainable-azure-websites-managing-change-and-scale/_static/image19.png "Azure App Service Modes")</span></span>
    > 
    > <span data-ttu-id="d6dbf-301">Si utilizas **Shared** o **estándar** modo, podrá administrar dominios personalizados para su aplicación web, vaya a la aplicación **configurar** menú y haga clic en **Administrar dominios** en *nombres de dominio*.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-301">If you are using **Shared** or **Standard** mode, you will be able to manage custom domains for your web app by going to your app's **Configure** menu and clicking **Manage Domains** under *domain names*.</span></span>
    > 
    > <span data-ttu-id="d6dbf-302">![Administrar dominios](maintainable-azure-websites-managing-change-and-scale/_static/image20.png "administrar dominios")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-302">![Manage Domains](maintainable-azure-websites-managing-change-and-scale/_static/image20.png "Manage Domains")</span></span>
    > 
    > <span data-ttu-id="d6dbf-303">![Administrar dominios personalizados](maintainable-azure-websites-managing-change-and-scale/_static/image21.png "administrar dominios personalizados")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-303">![Manage Custom Domains](maintainable-azure-websites-managing-change-and-scale/_static/image21.png "Manage Custom Domains")</span></span>
9. <span data-ttu-id="d6dbf-304">Una vez creada la aplicación web, haga clic en el vínculo situado bajo el **URL** columna para comprobar que la nueva aplicación web se está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-304">Once the web app is created, click the link under the **URL** column to check that the new web app is running.</span></span>

    ![Vaya a la nueva aplicación web](maintainable-azure-websites-managing-change-and-scale/_static/image22.png)

    <span data-ttu-id="d6dbf-306">*Vaya a la nueva aplicación web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-306">*Browsing to the new web app*</span></span>

    ![ejecución de la aplicación Web](maintainable-azure-websites-managing-change-and-scale/_static/image23.png)

    <span data-ttu-id="d6dbf-308">*ejecución de la aplicación Web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-308">*web app running*</span></span>

<a id="Ex2Task2"></a>
#### <a name="task-2--creating-the-production-sql-database"></a><span data-ttu-id="d6dbf-309">Tarea 2: crear la base de datos SQL de producción</span><span class="sxs-lookup"><span data-stu-id="d6dbf-309">Task 2 – Creating the Production SQL Database</span></span>

<span data-ttu-id="d6dbf-310">En esta tarea, va a usar el **Entity Framework Code First Migrations** para crear la base de datos de destino la **base de datos de SQL Azure** instancia que ha creado en la tarea anterior.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-310">In this task, you will use the **Entity Framework Code First Migrations** to create the database targeting the **Azure SQL Database** instance you created in the previous task.</span></span>

1. <span data-ttu-id="d6dbf-311">En el Portal de administración, vaya a la aplicación web que creó en la tarea anterior y vaya a su **panel**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-311">In the Management Portal, navigate to the web app you created in the previous task and go to its **Dashboard**.</span></span>
2. <span data-ttu-id="d6dbf-312">En el **panel** página, haga clic en **ver cadenas de conexión** vincular en el **vista rápida** sección.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-312">In the **Dashboard** page, click **View connection strings** link under the **quick glance** section.</span></span>

    <span data-ttu-id="d6dbf-313">![Ver las cadenas de conexión](maintainable-azure-websites-managing-change-and-scale/_static/image24.png "ver cadenas de conexión")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-313">![View connection strings](maintainable-azure-websites-managing-change-and-scale/_static/image24.png "View connection strings")</span></span>

    <span data-ttu-id="d6dbf-314">*Ver las cadenas de conexión*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-314">*View connection strings*</span></span>
3. <span data-ttu-id="d6dbf-315">Copia la **cadena de conexión** valor y cerrar el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-315">Copy the **connection string** value and close the dialog box.</span></span>

    <span data-ttu-id="d6dbf-316">![Cadena de conexión en el Portal de administración de Azure](maintainable-azure-websites-managing-change-and-scale/_static/image25.png "cadena de conexión en el Portal de administración de Azure")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-316">![Connection String in Azure Management Portal](maintainable-azure-websites-managing-change-and-scale/_static/image25.png "Connection String in Azure Management Portal")</span></span>

    <span data-ttu-id="d6dbf-317">*Cadena de conexión en el Portal de administración de Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-317">*Connection String in Azure Management Portal*</span></span>
4. <span data-ttu-id="d6dbf-318">Haga clic en **bases de datos SQL** para ver la lista de bases de datos SQL de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-318">Click **SQL Databases** to see the list of SQL databases in Azure</span></span>

    <span data-ttu-id="d6dbf-319">![Menú de la base de datos SQL](maintainable-azure-websites-managing-change-and-scale/_static/image26.png "menú de la base de datos SQL")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-319">![SQL Database menu](maintainable-azure-websites-managing-change-and-scale/_static/image26.png "SQL Database menu")</span></span>

    <span data-ttu-id="d6dbf-320">*Menú de la base de datos SQL*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-320">*SQL Database menu*</span></span>
5. <span data-ttu-id="d6dbf-321">Busque la base de datos que creó en la tarea anterior y haga clic en el servidor.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-321">Locate the database you created in the previous task and click on the Server.</span></span>

    <span data-ttu-id="d6dbf-322">![Servidor de base de datos SQL](maintainable-azure-websites-managing-change-and-scale/_static/image27.png "servidor de base de datos SQL")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-322">![SQL Database server](maintainable-azure-websites-managing-change-and-scale/_static/image27.png "SQL Database server")</span></span>

    <span data-ttu-id="d6dbf-323">*Servidor de base de datos SQL*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-323">*SQL Database server*</span></span>
6. <span data-ttu-id="d6dbf-324">En el **inicio rápido** página del servidor, haga clic en **configurar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-324">In the **Quick Start** page of the server, click on **Configure**.</span></span>

    <span data-ttu-id="d6dbf-325">![Menú Configurar](maintainable-azure-websites-managing-change-and-scale/_static/image28.png "menú Configurar")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-325">![Configure menu](maintainable-azure-websites-managing-change-and-scale/_static/image28.png "Configure menu")</span></span>

    <span data-ttu-id="d6dbf-326">*Configurar menú*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-326">*Configure menu*</span></span>
7. <span data-ttu-id="d6dbf-327">En el **direcciones IP permite** sección, haga clic en **agregar a las direcciones IP permitidas** vínculo para habilitar la IP para conectarse al servidor de base de datos SQL.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-327">In the **Allowed IP addresses** section, click on **Add to the allowed IP addresses** link to enable your IP to connect to the SQL Database server.</span></span>

    <span data-ttu-id="d6dbf-328">![Direcciones IP permitidas](maintainable-azure-websites-managing-change-and-scale/_static/image29.png "direcciones IP permitido")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-328">![Allowed IP addresses](maintainable-azure-websites-managing-change-and-scale/_static/image29.png "Allowed IP addresses")</span></span>

    <span data-ttu-id="d6dbf-329">*Direcciones IP permitidas*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-329">*Allowed IP addresses*</span></span>
8. <span data-ttu-id="d6dbf-330">Haga clic en **guardar** en la parte inferior de la página para completar el paso.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-330">Click **Save** at the bottom of the page to complete the step.</span></span>
9. <span data-ttu-id="d6dbf-331">Cambie a Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-331">Switch back to Visual Studio.</span></span>
10. <span data-ttu-id="d6dbf-332">En el **Package Manager Console**, ejecute el comando siguiente reemplazando *[cadena de conexión de su]* marcador de posición con la cadena de conexión que se ha copiado desde Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-332">In the **Package Manager Console**, execute the following command replacing *[YOUR-CONNECTION-STRING]* placeholder with the connection string you copied from Azure</span></span>

    [!code-powershell[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample10.ps1)]

    <span data-ttu-id="d6dbf-333">![Actualizar base de datos como destino Windows Azure SQL Database](maintainable-azure-websites-managing-change-and-scale/_static/image30.png "Actualizar base de datos destino de la base de datos de SQL de Windows Azure")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-333">![Update database targeting Windows Azure SQL Database](maintainable-azure-websites-managing-change-and-scale/_static/image30.png "Update database targeting Windows Azure SQL Database")</span></span>

    <span data-ttu-id="d6dbf-334">*Actualizar base de datos que se dirige a la base de datos de SQL Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-334">*Update database targeting Azure SQL Database*</span></span>

<a id="Ex2Task3"></a>
#### <a name="task-3--deploying-geek-quiz-to-staging-using-git"></a><span data-ttu-id="d6dbf-335">Tarea 3: implementar cuestionario experto en le ayudará a ensayo mediante Git</span><span class="sxs-lookup"><span data-stu-id="d6dbf-335">Task 3 – Deploying Geek Quiz to Staging Using Git</span></span>

<span data-ttu-id="d6dbf-336">En esta tarea, habilitará la publicación de ensayo en la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-336">In this task, you will enable staged publishing in your web app.</span></span> <span data-ttu-id="d6dbf-337">A continuación, usará Git para publicar la aplicación experto en prueba directamente desde el equipo local en el entorno de ensayo de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-337">Then, you will use Git to publish the Geek Quiz application directly from your local computer to the staging environment of your web app.</span></span>

1. <span data-ttu-id="d6dbf-338">Vuelva al portal y haga clic en el nombre de la aplicación web en el **nombre** columna para mostrar las páginas de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-338">Go back to the portal and click the name of the web app under the **Name** column to display the management pages.</span></span>

    ![Abrir las páginas de administración de aplicaciones web](maintainable-azure-websites-managing-change-and-scale/_static/image31.png)

    <span data-ttu-id="d6dbf-340">*Abrir las páginas de administración de aplicaciones web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-340">*Opening the web app management pages*</span></span>
2. <span data-ttu-id="d6dbf-341">Navegue hasta la **escala** página.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-341">Navigate to the **Scale** page.</span></span> <span data-ttu-id="d6dbf-342">En el **general** sección, seleccione **estándar** para la configuración y haga clic en **guardar** en la barra de comandos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-342">Under the **general** section, select **Standard** for the configuration and click **Save** in the command bar.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-343">Para ejecutar todas las aplicaciones web en la región actual y la suscripción en **estándar** modo, deje el **seleccionar todo** casilla de verificación seleccionada en el **elegir sitios** configuración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-343">To run all web apps in the current region and subscription in **Standard** mode, leave the **Select All** check box selected in the **Choose Sites** configuration.</span></span> <span data-ttu-id="d6dbf-344">De lo contrario, desactive el **seleccionar todo** casilla de verificación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-344">Otherwise, clear the **Select All** check box.</span></span>

    <span data-ttu-id="d6dbf-345">![Actualizar la aplicación web al modo estándar](maintainable-azure-websites-managing-change-and-scale/_static/image32.png "actualizar la aplicación web al modo estándar")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-345">![Upgrading the web app to Standard mode](maintainable-azure-websites-managing-change-and-scale/_static/image32.png "Upgrading the web app to Standard mode")</span></span>

    <span data-ttu-id="d6dbf-346">*Actualizar la aplicación Web al modo estándar*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-346">*Upgrading the Web App to Standard mode*</span></span>
3. <span data-ttu-id="d6dbf-347">Haga clic en **Sí** para confirmar los cambios.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-347">Click **Yes** to confirm the changes.</span></span>

    <span data-ttu-id="d6dbf-348">![Confirmar el cambio al modo estándar](maintainable-azure-websites-managing-change-and-scale/_static/image33.png "continuar con los cambios en el modo de aplicación web")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-348">![Confirming the change to Standard mode](maintainable-azure-websites-managing-change-and-scale/_static/image33.png "Continuing with the changing of the web app mode")</span></span>

    <span data-ttu-id="d6dbf-349">*Confirmar el cambio al modo estándar*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-349">*Confirming the change to Standard mode*</span></span>
4. <span data-ttu-id="d6dbf-350">Vaya a la **panel** página y haga clic en **habilitar la publicación de ensayo** en el **vista rápida** sección.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-350">Go to the **Dashboard** page and click **Enable staged publishing** under the **quick glance** section.</span></span>

    <span data-ttu-id="d6dbf-351">![Habilitar la publicación de ensayo](maintainable-azure-websites-managing-change-and-scale/_static/image34.png "Si habilita la publicación de ensayo")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-351">![Enabling staged publishing](maintainable-azure-websites-managing-change-and-scale/_static/image34.png "Enabling staged publishing")</span></span>

    <span data-ttu-id="d6dbf-352">*Habilitar la publicación de ensayo*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-352">*Enabling staged publishing*</span></span>
5. <span data-ttu-id="d6dbf-353">Haga clic en **Sí** para habilitar la publicación de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-353">Click **Yes** to enable staged publishing.</span></span>

    <span data-ttu-id="d6dbf-354">![Confirmar provisionalmente publicación](maintainable-azure-websites-managing-change-and-scale/_static/image35.png "al hacer clic en Sí para habilitar la publicación de ensayo")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-354">![Confirming staged publishing](maintainable-azure-websites-managing-change-and-scale/_static/image35.png "Clicking Yes to enable staged publishing")</span></span>

    <span data-ttu-id="d6dbf-355">*Confirmar publicación de ensayo*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-355">*Confirming staged publishing*</span></span>
6. <span data-ttu-id="d6dbf-356">En la lista de aplicaciones web, expanda la marca a la izquierda de su nombre de la aplicación web para mostrar la zona del sitio de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-356">In the list of web apps, expand the mark to the left of your web app name to display the staging site slot.</span></span> <span data-ttu-id="d6dbf-357">Tiene el nombre de la aplicación web seguido de ***(ensayo)***.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-357">It has the name of your web app followed by ***(staging)***.</span></span> <span data-ttu-id="d6dbf-358">Haga clic en el sitio de ensayo para ir a la página de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-358">Click the staging site to go to the management page.</span></span>

    <span data-ttu-id="d6dbf-359">![Vaya a la aplicación web de ensayo](maintainable-azure-websites-managing-change-and-scale/_static/image36.png "navegar a la aplicación web de ensayo")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-359">![Navigating to the staging web app](maintainable-azure-websites-managing-change-and-scale/_static/image36.png "Navigating to the staging web app")</span></span>

    <span data-ttu-id="d6dbf-360">*Vaya a la aplicación de almacenamiento provisional*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-360">*Navigating to the staging app*</span></span>
7. <span data-ttu-id="d6dbf-361">Tenga en cuenta que esa página de administración de aspecto de la página de cualquier otra aplicación web administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-361">Notice that he management page looks like any other web app's management page.</span></span> <span data-ttu-id="d6dbf-362">Navegue hasta la **implementaciones** página y copiar el **dirección URL de Git** valor.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-362">Navigate to the **Deployments** page and copy the **Git URL** value.</span></span> <span data-ttu-id="d6dbf-363">Se usará más adelante en este ejercicio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-363">You will use it later in this exercise.</span></span>

    ![Copiar el valor de dirección URL de Git](maintainable-azure-websites-managing-change-and-scale/_static/image37.png)

    <span data-ttu-id="d6dbf-365">*Copiar el valor de dirección URL de Git*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-365">*Copying the Git URL value*</span></span>
8. <span data-ttu-id="d6dbf-366">Abra una nueva **Git Bash** consola y ejecute los comandos siguientes.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-366">Open a new **Git Bash** console and execute the following commands.</span></span> <span data-ttu-id="d6dbf-367">Actualización la *[ruta de la aplicación YOUR]* marcador de posición con la ruta de acceso a la **GeekQuiz** solución, que se encuentra en la **Source\Ex1 DeployingWebSiteToStaging\Begin** carpeta de Este laboratorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-367">Update the *[YOUR-APPLICATION-PATH]* placeholder with the path to the **GeekQuiz** solution, located in the **Source\Ex1-DeployingWebSiteToStaging\Begin** folder of this lab.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample11.cmd)]

    ![Inicialización de GIT y la primera confirmación](maintainable-azure-websites-managing-change-and-scale/_static/image38.png)

    <span data-ttu-id="d6dbf-369">*Inicialización de GIT y la primera confirmación*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-369">*Git initialization and first commit*</span></span>
9. <span data-ttu-id="d6dbf-370">Ejecute el siguiente comando para insertar la aplicación web en el servidor remoto **Git** repositorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-370">Run the following command to push your web app to the remote **Git** repository.</span></span> <span data-ttu-id="d6dbf-371">Reemplace el marcador de posición con la dirección URL que obtuvo en el portal de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-371">Replace the placeholder with the URL you obtained from the management portal.</span></span> <span data-ttu-id="d6dbf-372">Se le pedirá la contraseña de la implementación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-372">You will be prompted for your deployment password.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample12.cmd)]

    ![Insertar en Windows Azure](maintainable-azure-websites-managing-change-and-scale/_static/image39.png)

    <span data-ttu-id="d6dbf-374">*Insertar en Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-374">*Pushing to Azure*</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-375">Al implementar contenido en el host FTP o en el repositorio GIT de una aplicación web, debe autenticarse mediante el **las credenciales de implementación** que creó a partir de la aplicación web **inicio rápido** o **panel**  páginas de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-375">When you deploy content to the FTP host or GIT repository of a web app, you must authenticate using the **deployment credentials** that you created from the web app's **Quick Start** or **Dashboard** management pages.</span></span> <span data-ttu-id="d6dbf-376">Si no conoce las credenciales de implementación, puede fácilmente restablecerlos mediante el portal de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-376">If you do not know your deployment credentials you can easily reset them using the management portal.</span></span> <span data-ttu-id="d6dbf-377">Abra la aplicación web **panel** página y haga clic en el **restablezca sus credenciales de implementación** vínculo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-377">Open the web app **Dashboard** page and click the **Reset your deployment credentials** link.</span></span> <span data-ttu-id="d6dbf-378">Proporcione una contraseña nueva y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-378">Provide a new password and click **OK**.</span></span> <span data-ttu-id="d6dbf-379">Las credenciales de implementación son válidas para su uso con todas las aplicaciones web asociadas a la suscripción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-379">Deployment credentials are valid for use with all web apps associated with your subscription.</span></span>
10. <span data-ttu-id="d6dbf-380">Para comprobar la aplicación web se ha insertado correctamente en Azure, vuelva al portal de administración y haga clic en **sitios Web**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-380">In order to verify the web app was successfully pushed to Azure, go back to the management portal and click **Websites**.</span></span>
11. <span data-ttu-id="d6dbf-381">Busque la aplicación web y expanda la entrada para mostrar la zona del sitio de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-381">Locate your web app and expand the entry to display the staging site slot.</span></span> <span data-ttu-id="d6dbf-382">Haga clic en su **nombre** para ir a la página de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-382">Click its **Name** to go to the management page.</span></span>
12. <span data-ttu-id="d6dbf-383">Haga clic en **implementaciones** para ver el **historial de implementación**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-383">Click **Deployments** to see the **deployment history**.</span></span> <span data-ttu-id="d6dbf-384">Compruebe que existe una **implementación activa** con su  *&quot;confirmar inicial&quot;*.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-384">Verify that there is an **Active Deployment** with your *&quot;Initial Commit&quot;*.</span></span>

    ![Implementación activa](maintainable-azure-websites-managing-change-and-scale/_static/image40.png)

    <span data-ttu-id="d6dbf-386">*Implementación activa*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-386">*Active deployment*</span></span>
13. <span data-ttu-id="d6dbf-387">Por último, haga clic en **examinar** en la barra de comandos para ir a la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-387">Finally, click **Browse** in the command bar to go to the web app.</span></span>

    ![Examinar la aplicación web](maintainable-azure-websites-managing-change-and-scale/_static/image41.png)

    <span data-ttu-id="d6dbf-389">*Examinar la aplicación web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-389">*Browse web app*</span></span>
14. <span data-ttu-id="d6dbf-390">Si la aplicación se implementa correctamente, verá la página de inicio de sesión experto en prueba.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-390">If the application is successfully deployed, you will see the Geek Quiz login page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-391">La dirección URL de la aplicación implementada contiene el nombre de la aplicación web seguido de *-almacenamiento provisional*.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-391">The address URL of the deployed application contains the name of your web app followed by *-staging*.</span></span>

    ![Aplicación que se ejecuta en el entorno de ensayo](maintainable-azure-websites-managing-change-and-scale/_static/image42.png)

    <span data-ttu-id="d6dbf-393">*Aplicación que se ejecuta en el entorno de ensayo*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-393">*Application running in the staging environment*</span></span>
15. <span data-ttu-id="d6dbf-394">Si desea explorar la aplicación, haga clic en **registrar** para registrar un nuevo usuario.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-394">If you wish to explore the application, click **Register** to register a new user.</span></span> <span data-ttu-id="d6dbf-395">Complete los detalles de cuenta, escriba un nombre de usuario, dirección de correo electrónico y una contraseña.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-395">Complete the account details by entering a user name, email address and password.</span></span> <span data-ttu-id="d6dbf-396">A continuación, la aplicación muestra la primera pregunta de la prueba.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-396">Next, the application shows the first question of the quiz.</span></span> <span data-ttu-id="d6dbf-397">Responda a unas preguntas para asegurarse de que funciona según lo previsto.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-397">Answer a few questions to make sure it is working as expected.</span></span>

    ![Aplicación lista para usarse](maintainable-azure-websites-managing-change-and-scale/_static/image43.png)

    <span data-ttu-id="d6dbf-399">*Aplicación lista para usarse*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-399">*Application ready to be used*</span></span>

<a id="Ex2Task4"></a>
#### <a name="task-4--promoting-the-web-app-to-production"></a><span data-ttu-id="d6dbf-400">Tarea 4: promoción de la aplicación Web a producción</span><span class="sxs-lookup"><span data-stu-id="d6dbf-400">Task 4 – Promoting the Web App to Production</span></span>

<span data-ttu-id="d6dbf-401">Ahora que ha comprobado que la aplicación web funciona correctamente en el entorno de ensayo, está listo para promover a producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-401">Now that you have verified that the web app is working correctly in the staging environment, you are ready to promote it to production.</span></span> <span data-ttu-id="d6dbf-402">En esta tarea, se intercambiará el espacio del sitio de ensayo con la ranura de sitio de producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-402">In this task, you will swap the staging site slot with the production site slot.</span></span>

1. <span data-ttu-id="d6dbf-403">Vuelva al portal de administración y seleccione la ranura de sitio de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-403">Go back to the management portal and select the staging site slot.</span></span> <span data-ttu-id="d6dbf-404">Haga clic en **intercambiar** en la barra de comandos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-404">Click **Swap** in the command bar.</span></span>

    ![Intercambiar en producción](maintainable-azure-websites-managing-change-and-scale/_static/image44.png)

    <span data-ttu-id="d6dbf-406">*Intercambiar en producción*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-406">*Swap to production*</span></span>
2. <span data-ttu-id="d6dbf-407">Haga clic en **Sí** en el cuadro de diálogo de confirmación para continuar con la operación de intercambio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-407">Click **Yes** in the confirmation dialog box to proceed with the swap operation.</span></span> <span data-ttu-id="d6dbf-408">Azure inmediatamente intercambiará el contenido del sitio de producción con el contenido del sitio de ensayo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-408">Azure will immediately swap the content of the production site with the content of the staging site.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-409">Algunas opciones de configuración de la versión de ensayada se copiará automáticamente a la versión de producción (p. ej. cadena de conexión invalidaciones, asignaciones de controlador, etc.) pero no cambiarán otros valores de configuración (por ejemplo, los puntos de conexión DNS, enlaces SSL, etcetera).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-409">Some settings from the staged version will automatically be copied to the production version (e.g. connection string overrides, handler mappings, etc.) but other settings will not change (e.g. DNS endpoints, SSL bindings, etc.).</span></span>

    ![Confirmar la operación de intercambio](maintainable-azure-websites-managing-change-and-scale/_static/image45.png)

    <span data-ttu-id="d6dbf-411">*Confirmar la operación de intercambio*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-411">*Confirming swap operation*</span></span>
3. <span data-ttu-id="d6dbf-412">Una vez completado el intercambio, seleccione la ranura de producción y haga clic en **examinar** en la barra de comandos para abrir el sitio de producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-412">Once the swap is complete, select the production slot and click **Browse** in the command bar to open the production site.</span></span> <span data-ttu-id="d6dbf-413">Tenga en cuenta la dirección URL en la barra de direcciones.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-413">Notice the URL in the address bar.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-414">Debe actualizar el explorador para borrar la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-414">You might need to refresh your browser to clear cache.</span></span> <span data-ttu-id="d6dbf-415">En Internet Explorer, puede hacerlo presionando **CTRL+R**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-415">In Internet Explorer, you can do this by pressing **CTRL+R**.</span></span>

    ![Aplicación Web que se ejecuta en el entorno de producción](maintainable-azure-websites-managing-change-and-scale/_static/image46.png)
4. <span data-ttu-id="d6dbf-417">En el **GitBash** consola, actualice la dirección URL remota para el repositorio de Git local que tenga como destino la ranura de producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-417">In the **GitBash** console, update the remote URL for the local Git repository to target the production slot.</span></span> <span data-ttu-id="d6dbf-418">Para ello, ejecute el comando siguiente, reemplazando los marcadores de posición con el nombre de usuario de implementación y el nombre de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-418">To do this, run the following command replacing the placeholders with your deployment username and the name of your web app.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-419">En los ejercicios siguientes, se inserte los cambios en el sitio de producción en lugar de almacenamiento provisional para la sencillez del laboratorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-419">In the following exercises, you will push changes to the production site instead of staging just for the simplicity of the lab.</span></span> <span data-ttu-id="d6dbf-420">En un escenario real, se recomienda para comprobar los cambios en el entorno de ensayo antes de ascender a producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-420">In a real-world scenario, it is recommended to verify the changes in the staging environment before promoting to production.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample13.cmd)]

<a id="Exercise3"></a>
### <a name="exercise-3-performing-deployment-rollback-in-production"></a><span data-ttu-id="d6dbf-421">Ejercicio 3: Realizar la reversión de la implementación en producción</span><span class="sxs-lookup"><span data-stu-id="d6dbf-421">Exercise 3: Performing Deployment Rollback in Production</span></span>

<span data-ttu-id="d6dbf-422">Existen escenarios donde no haya una ranura de ensayo para realizar el intercambio entre ensayo y producción, por ejemplo, si está trabajando con **libre** o **Shared** modo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-422">There are scenarios where you do not have a staging slot to perform hot swap between staging and production, for example, if you are working with **Free** or **Shared** mode.</span></span> <span data-ttu-id="d6dbf-423">En esos escenarios, debe probar la aplicación en un entorno de prueba, ya sea localmente o en un sitio remoto: antes de implementarlo en producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-423">In those scenarios, you should test your application in a testing environment –either locally or in a remote site– before deploying to production.</span></span> <span data-ttu-id="d6dbf-424">Sin embargo, es posible que pueda surgir un problema no detectado durante la fase de pruebas en el sitio de producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-424">However, it is possible that an issue not detected during the testing phase may arise in the production site.</span></span> <span data-ttu-id="d6dbf-425">En este caso, es importante disponer de un mecanismo para pasar fácilmente a una versión anterior y es más estable de la aplicación, lo más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-425">In this case, it is important to have a mechanism to easily switch to a previous and more stable version of the application as quickly as possible.</span></span>

<span data-ttu-id="d6dbf-426">En **servicio de aplicaciones de Azure**, implementación continua desde el control de código fuente hace que esta posible gracias a la **volver a implementar** acción disponible en el portal de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-426">In **Azure App Service**, continuous deployment from source control makes this possible thanks to the **redeploy** action available in the management portal.</span></span> <span data-ttu-id="d6dbf-427">Azure realiza un seguimiento de las implementaciones asociadas a las confirmaciones que se envíe al repositorio y proporciona una opción para volver a implementar la aplicación usando alguna de las implementaciones anteriores, en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-427">Azure keeps track of the deployments associated with the commits pushed to the repository and provides an option to redeploy your application using any of your previous deployments, at any time.</span></span>

<span data-ttu-id="d6dbf-428">En este ejercicio se llevará a cabo un cambio en el código en el **cuestionario experto en** aplicación que inserta intencionadamente un *error*.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-428">In this exercise you will perform a change to the code in the **Geek Quiz** application that intentionally injects a *bug*.</span></span> <span data-ttu-id="d6dbf-429">Va a implementar la aplicación en producción para ver el error y, a continuación, se aprovecha de la característica de volver a implementar para volver al estado anterior.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-429">You will deploy the application to production to see the error, and then you will take advantage of the redeploy feature to go back to the previous state.</span></span>

<a id="Ex3Task1"></a>
#### <a name="task-1--updating-the-geek-quiz-application"></a><span data-ttu-id="d6dbf-430">Tarea 1: actualizar la aplicación de prueba de experto en</span><span class="sxs-lookup"><span data-stu-id="d6dbf-430">Task 1 – Updating the Geek Quiz Application</span></span>

<span data-ttu-id="d6dbf-431">En esta tarea, va a refactorizar una pequeña parte del código de la **TriviaController** clase para extraer la parte de la lógica que recupera la opción de prueba seleccionado de la base de datos en un nuevo método.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-431">In this task, you will refactor a small piece of code of the **TriviaController** class to extract part of the logic that retrieves the selected quiz option from the database into a new method.</span></span>

1. <span data-ttu-id="d6dbf-432">Cambie a la instancia de Visual Studio con la **GeekQuiz** solución desde el ejercicio anterior.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-432">Switch to the Visual Studio instance with the **GeekQuiz** solution from the previous exercise.</span></span>
2. <span data-ttu-id="d6dbf-433">En **el Explorador de soluciones**, abra el **TriviaController.cs** archivo dentro de la **controladores** carpeta.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-433">In **Solution Explorer**, open the **TriviaController.cs** file inside the **Controllers** folder.</span></span>
3. <span data-ttu-id="d6dbf-434">Busque la **StoreAsync** método y seleccione el código resaltado en la ilustración siguiente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-434">Locate the **StoreAsync** method and select the code highlighted in the following figure.</span></span>

    ![Si selecciona el código](maintainable-azure-websites-managing-change-and-scale/_static/image47.png)

    <span data-ttu-id="d6dbf-436">*Si selecciona el código*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-436">*Selecting the code*</span></span>
4. <span data-ttu-id="d6dbf-437">Haga clic en el código seleccionado, expanda la **refactorizar** menú y seleccione **Extraer método...** .</span><span class="sxs-lookup"><span data-stu-id="d6dbf-437">Right-click the selected code, expand the **Refactor** menu and select **Extract Method...**.</span></span>

    ![Extraer el código como un nuevo método](maintainable-azure-websites-managing-change-and-scale/_static/image48.png)

    <span data-ttu-id="d6dbf-439">*Seleccionar método de extracción*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-439">*Selecting Extract Method*</span></span>
5. <span data-ttu-id="d6dbf-440">En el **Extraer método** cuadro de diálogo, el nombre del nuevo método *MatchesOption* y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-440">In the **Extract Method** dialog box, name the new method *MatchesOption* and click **OK**.</span></span>

    ![Especifica el nombre del método](maintainable-azure-websites-managing-change-and-scale/_static/image49.png)

    <span data-ttu-id="d6dbf-442">*Especifica el nombre para el método extraído*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-442">*Specifying the name for the extracted method*</span></span>
6. <span data-ttu-id="d6dbf-443">El código seleccionado y, a continuación, se extrae en el **MatchesOption** método.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-443">The selected code is then extracted into the **MatchesOption** method.</span></span> <span data-ttu-id="d6dbf-444">El código resultante se muestra en el siguiente fragmento de código.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-444">The resulting code is shown in the following snippet.</span></span>

    [!code-csharp[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample14.cs)]
7. <span data-ttu-id="d6dbf-445">Presione **CTRL + S** para guardar los cambios.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-445">Press **CTRL + S** to save the changes.</span></span>

<a id="Ex3Task2"></a>
#### <a name="task-2--redeploying-the-geek-quiz-application"></a><span data-ttu-id="d6dbf-446">Tarea 2: volver a implementar la aplicación de prueba de experto en</span><span class="sxs-lookup"><span data-stu-id="d6dbf-446">Task 2 – Redeploying the Geek Quiz Application</span></span>

<span data-ttu-id="d6dbf-447">Ahora insertará los cambios realizados en la tarea anterior en el repositorio, lo que desencadenará una nueva implementación en el entorno de producción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-447">You will now push the changes you made in the previous task to the repository, which will trigger a new deployment to the production environment.</span></span> <span data-ttu-id="d6dbf-448">A continuación, se soluciona un problema usando la **herramientas de desarrollo F12** proporcionada por Internet Explorer y, a continuación, realizar una reversión a la implementación anterior desde el portal de administración de Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-448">Then, you will troubleshot an issue using the **F12 development tools** provided by Internet Explorer, and then perform a rollback to the previous deployment from the Azure management portal.</span></span>

1. <span data-ttu-id="d6dbf-449">Abra una nueva **Git Bash** consola para implementar la aplicación actualizada al servicio de aplicaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-449">Open a new **Git Bash** console to deploy the updated application to Azure App Service.</span></span>
2. <span data-ttu-id="d6dbf-450">Ejecute los siguientes comandos para insertar los cambios en Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-450">Execute the following commands to push the changes to Azure.</span></span> <span data-ttu-id="d6dbf-451">Actualización de la *[ruta de la aplicación YOUR]* marcador de posición con la ruta de acceso a la **GeekQuiz** solución.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-451">Update the *[YOUR-APPLICATION-PATH]* placeholder with the path to the **GeekQuiz** solution.</span></span> <span data-ttu-id="d6dbf-452">Se le pedirá la contraseña de la implementación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-452">You will be prompted for your deployment password.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample15.cmd)]

    ![Insertar código refactorizado en Azure](maintainable-azure-websites-managing-change-and-scale/_static/image50.png)

    <span data-ttu-id="d6dbf-454">*Insertar código refactorizado en Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-454">*Pushing refactored code to Azure*</span></span>
3. <span data-ttu-id="d6dbf-455">Abra Internet Explorer y vaya a la aplicación web (por ejemplo, `http://<your-web-site>.azurewebsites.net`).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-455">Open Internet Explorer and navigate to your web app (e.g. `http://<your-web-site>.azurewebsites.net`).</span></span> <span data-ttu-id="d6dbf-456">Inicie sesión con las credenciales creadas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-456">Log in using the previously created credentials.</span></span>
4. <span data-ttu-id="d6dbf-457">Presione **F12** para iniciar las herramientas de desarrollo, seleccione la **red** ficha y haga clic en el **reproducir** botón para iniciar la grabación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-457">Press **F12** to launch the development tools, select the **Network** tab and click the **Play** button to start recording.</span></span>

    <span data-ttu-id="d6dbf-458">![A partir de grabación de red](maintainable-azure-websites-managing-change-and-scale/_static/image51.png "a partir de grabación de red")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-458">![Starting network recording](maintainable-azure-websites-managing-change-and-scale/_static/image51.png "Starting network recording")</span></span>

    <span data-ttu-id="d6dbf-459">*Grabación de red inicial*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-459">*Starting network recording*</span></span>
5. <span data-ttu-id="d6dbf-460">Seleccione cualquier opción de la prueba.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-460">Select any option of the quiz.</span></span> <span data-ttu-id="d6dbf-461">Verá que no sucede nada.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-461">You will see that nothing happens.</span></span>
6. <span data-ttu-id="d6dbf-462">En el **F12** ventana, muestra la entrada correspondiente a la solicitud HTTP POST HTTP **500** resultado.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-462">In the **F12** window, the entry corresponding to the POST HTTP request shows an HTTP **500** result.</span></span>

    ![HTTP 500 error](maintainable-azure-websites-managing-change-and-scale/_static/image52.png)

    <span data-ttu-id="d6dbf-464">*HTTP 500 error*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-464">*HTTP 500 error*</span></span>
7. <span data-ttu-id="d6dbf-465">Seleccione el **consola** ficha. Se registra un error con los detalles de la causa.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-465">Select the **Console** tab. An error is logged with the details of the cause.</span></span>

    ![Error registrado](maintainable-azure-websites-managing-change-and-scale/_static/image53.png)

    <span data-ttu-id="d6dbf-467">*Error registrado*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-467">*Logged error*</span></span>
8. <span data-ttu-id="d6dbf-468">Busque la sección de detalles del error.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-468">Locate the details part of the error.</span></span> <span data-ttu-id="d6dbf-469">Claramente, este error se produce porque el código de refactorización se confirman en los pasos anteriores.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-469">Clearly, this error is caused by the code refactoring you committed in the previous steps.</span></span>

    <span data-ttu-id="d6dbf-470">`Details: LINQ to Entities does not recognize the method 'Boolean MatchesOption ...`.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-470">`Details: LINQ to Entities does not recognize the method 'Boolean MatchesOption ...`.</span></span>
9. <span data-ttu-id="d6dbf-471">No cierre el explorador.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-471">Do not close the browser.</span></span>
10. <span data-ttu-id="d6dbf-472">En una nueva instancia del explorador, navegue hasta la [portal de administración de Azure](https://manage.windowsazure.com) e inicie sesión con la cuenta de Microsoft asociada con su suscripción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-472">In a new browser instance, navigate to the [Azure management portal](https://manage.windowsazure.com) and sign in using the Microsoft account associated with your subscription.</span></span>
11. <span data-ttu-id="d6dbf-473">Seleccione **sitios Web** y haga clic en la aplicación web que creó en el ejercicio 2.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-473">Select **Websites** and click the web app you created in Exercise 2.</span></span>
12. <span data-ttu-id="d6dbf-474">Navegue hasta la **implementaciones** página.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-474">Navigate to the **Deployments** page.</span></span> <span data-ttu-id="d6dbf-475">Tenga en cuenta que realizan todas las confirmaciones se muestran en el historial de implementación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-475">Notice that all the commits performed are listed in the deployment history.</span></span>

    ![Lista de las implementaciones existentes](maintainable-azure-websites-managing-change-and-scale/_static/image54.png)

    <span data-ttu-id="d6dbf-477">*Lista de las implementaciones existentes*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-477">*List of existing deployments*</span></span>
13. <span data-ttu-id="d6dbf-478">Seleccione la confirmación anterior y haga clic en **volver a implementar** en la barra de comandos.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-478">Select the previous commit and click **Redeploy** on the command bar.</span></span>

    ![Volver a implementar la confirmación anterior](maintainable-azure-websites-managing-change-and-scale/_static/image55.png)

    <span data-ttu-id="d6dbf-480">*Volver a implementar la confirmación anterior*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-480">*Redeploying the previous commit*</span></span>
14. <span data-ttu-id="d6dbf-481">Cuando se le pida que confirme, haga clic en **Sí**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-481">When prompted to confirm, click **Yes**.</span></span>

    ![Confirmar la reimplementación](maintainable-azure-websites-managing-change-and-scale/_static/image56.png)
15. <span data-ttu-id="d6dbf-483">Cuando haya completado la implementación, vaya a la instancia del explorador con la aplicación web y presione **CTRL + F5**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-483">When the deployment completes, switch back to the browser instance with your web app and press **CTRL + F5**.</span></span>
16. <span data-ttu-id="d6dbf-484">Haga clic en cualquiera de las opciones.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-484">Click any of the options.</span></span> <span data-ttu-id="d6dbf-485">La animación voltear ahora tendrá lugar y el resultado (*correcta/incorrecta*) se mostrarán.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-485">The flip animation will now take place and the result (*correct/incorrect*) will be displayed.</span></span>
17. <span data-ttu-id="d6dbf-486">(Opcional) Cambie a la **Git Bash** consola y ejecutar los siguientes comandos para volver a la confirmación anterior.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-486">(Optional) Switch to the **Git Bash** console and execute the following commands to revert to the previous commit.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-487">Estos comandos crean una nueva confirmación que deshace todos los cambios en el repositorio Git que se realizaron en la confirmación incorrecta.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-487">These commands create a new commit that undoes all changes in the Git repository that were made in the bad commit.</span></span> <span data-ttu-id="d6dbf-488">Azure, a continuación, volverá a implementar la aplicación con la confirmación nuevo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-488">Azure will then redeploy the application using the new commit.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample16.cmd)]

<a id="Exercise4"></a>
### <a name="exercise-4-scaling-using-azure-storage"></a><span data-ttu-id="d6dbf-489">Ejercicio 4: Ajuste de escala con el almacenamiento de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-489">Exercise 4: Scaling Using Azure Storage</span></span>

<span data-ttu-id="d6dbf-490">**Blobs** son la manera más sencilla de almacenar grandes cantidades de texto no estructurado o datos binarios como vídeo, audio e imágenes.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-490">**Blobs** are the simplest way to store large amounts of unstructured text or binary data such as video, audio and images.</span></span> <span data-ttu-id="d6dbf-491">Mover el contenido estático de la aplicación para almacenamiento, ayuda a escalar la aplicación que sirven para imágenes o documentos directamente en el explorador.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-491">Moving the static content of your application to Storage, helps to scale your application by serving images or documents directly to the browser.</span></span>

<span data-ttu-id="d6dbf-492">En este ejercicio, se moverá el contenido estático de la aplicación en un contenedor de blobs.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-492">In this exercise, you will move the static content of your application to a Blob container.</span></span> <span data-ttu-id="d6dbf-493">A continuación, configurará la aplicación para agregar un **regla de reescritura de direcciones URL de ASP.NET** en el **Web.config** para redirigir el contenido para el contenedor de blobs.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-493">Then you will configure your application to add an **ASP.NET URL rewrite rule** in the **Web.config** to redirect your content to the Blob container.</span></span>

<a id="Ex4Task1"></a>
#### <a name="task-1--creating-an-azure-storage-account"></a><span data-ttu-id="d6dbf-494">Tarea 1: crear una cuenta de almacenamiento de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-494">Task 1 – Creating an Azure Storage Account</span></span>

<span data-ttu-id="d6dbf-495">En esta tarea, aprenderá cómo crear una nueva cuenta de almacenamiento mediante el portal de administración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-495">In this task you will learn how to create a new storage account using the management portal.</span></span>

1. <span data-ttu-id="d6dbf-496">Navegue hasta la [portal de administración de Azure](https://manage.windowsazure.com) e inicie sesión con la cuenta de Microsoft asociada con su suscripción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-496">Navigate to the [Azure management portal](https://manage.windowsazure.com) and sign in using the Microsoft account associated with your subscription.</span></span>
2. <span data-ttu-id="d6dbf-497">Seleccione **nuevos | Servicios de datos | Almacenamiento | Creación rápida** para comenzar a crear una nueva cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-497">Select **New | Data Services | Storage | Quick Create** to start creating a new storage account.</span></span> <span data-ttu-id="d6dbf-498">Escriba un nombre único para la cuenta y seleccione una **región** en la lista.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-498">Enter a unique name for the account and select a **Region** from the list.</span></span> <span data-ttu-id="d6dbf-499">Haga clic en **crear cuenta de almacenamiento** para continuar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-499">Click **Create Storage Account** to continue.</span></span>

    <span data-ttu-id="d6dbf-500">![Crear una nueva cuenta de almacenamiento](maintainable-azure-websites-managing-change-and-scale/_static/image57.png "crear una nueva cuenta de almacenamiento")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-500">![Creating a new Storage Account](maintainable-azure-websites-managing-change-and-scale/_static/image57.png "Creating a new Storage Account")</span></span>

    <span data-ttu-id="d6dbf-501">*Crear una nueva cuenta de almacenamiento*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-501">*Creating a new storage account*</span></span>
3. <span data-ttu-id="d6dbf-502">En el **almacenamiento** sección, espere a que el estado de la nueva cuenta de almacenamiento cambia a *Online* para poder continuar con el paso siguiente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-502">In the **Storage** section, wait until the status of the new storage account changes to *Online* in order to continue with the following step.</span></span>

    <span data-ttu-id="d6dbf-503">![Cuenta de almacenamiento creada](maintainable-azure-websites-managing-change-and-scale/_static/image58.png "cuenta de almacenamiento creada")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-503">![Storage Account created](maintainable-azure-websites-managing-change-and-scale/_static/image58.png "Storage Account created")</span></span>

    <span data-ttu-id="d6dbf-504">*Cuenta de almacenamiento creada*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-504">*Storage Account created*</span></span>
4. <span data-ttu-id="d6dbf-505">Haga clic en el nombre de cuenta de almacenamiento y, a continuación, haga clic en el **panel** vínculo en la parte superior de la página.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-505">Click on the storage account name and then click the **Dashboard** link at the top of the page.</span></span> <span data-ttu-id="d6dbf-506">El **panel** página proporciona información sobre el estado de la cuenta y los extremos de servicio que se pueden usar dentro de las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-506">The **Dashboard** page provides you with information about the status of the account and the service endpoints that can be used within your applications.</span></span>

    <span data-ttu-id="d6dbf-507">![Mostrar el panel de la cuenta de almacenamiento](maintainable-azure-websites-managing-change-and-scale/_static/image59.png "mostrar el panel de la cuenta de almacenamiento")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-507">![Displaying the Storage Account Dashboard](maintainable-azure-websites-managing-change-and-scale/_static/image59.png "Displaying the Storage Account Dashboard")</span></span>

    <span data-ttu-id="d6dbf-508">*Mostrar el panel de la cuenta de almacenamiento*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-508">*Displaying the Storage Account Dashboard*</span></span>
5. <span data-ttu-id="d6dbf-509">Haga clic en el **administrar claves de acceso** botón en la barra de navegación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-509">Click the **Manage Access Keys** button in the navigation bar.</span></span>

    <span data-ttu-id="d6dbf-510">![Botón de administrar claves de acceso](maintainable-azure-websites-managing-change-and-scale/_static/image60.png "botón administrar claves de acceso")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-510">![Manage Access Keys button](maintainable-azure-websites-managing-change-and-scale/_static/image60.png "Manage Access Keys button")</span></span>

    <span data-ttu-id="d6dbf-511">*Administrar claves de acceso*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-511">*Manage Access Keys button*</span></span>
6. <span data-ttu-id="d6dbf-512">En el **administrar claves de acceso** cuadro de diálogo, copie el **nombre de la cuenta de almacenamiento** y **clave de acceso principal** ya que lo necesitará en el siguiente ejercicio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-512">In the **Manage Access Keys** dialog box, copy the **Storage Account Name** and **Primary Access Key** as you will need them in the following exercise.</span></span> <span data-ttu-id="d6dbf-513">A continuación, cierre el cuadro de diálogo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-513">Then, close the dialog box.</span></span>

    <span data-ttu-id="d6dbf-514">![Cuadro de diálogo Administrar clave de acceso](maintainable-azure-websites-managing-change-and-scale/_static/image61.png "cuadro de diálogo Administrar clave de acceso")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-514">![Manage Access Key dialog box](maintainable-azure-websites-managing-change-and-scale/_static/image61.png "Manage Access Key dialog box")</span></span>

    <span data-ttu-id="d6dbf-515">*Administrar clave de acceso, cuadro de diálogo*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-515">*Manage Access Key dialog box*</span></span>

<a id="Ex4Task2"></a>
#### <a name="task-2--uploading-an-asset-to-azure-blob-storage"></a><span data-ttu-id="d6dbf-516">Tarea 2: cargar un recurso en el almacenamiento de blobs de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-516">Task 2 – Uploading an Asset to Azure Blob Storage</span></span>

<span data-ttu-id="d6dbf-517">En esta tarea, utilizará la ventana Explorador de servidores de Visual Studio para conectarse a su cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-517">In this task, you will use the Server Explorer window from Visual Studio to connect to your storage account.</span></span> <span data-ttu-id="d6dbf-518">A continuación, creará un contenedor de blobs y cargar un archivo con el logotipo de experto en prueba en el contenedor.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-518">You will then create a blob container and upload a file with the Geek Quiz logo to the container.</span></span>

1. <span data-ttu-id="d6dbf-519">Cambie a la instancia de Visual Studio con la **GeekQuiz** solución desde el ejercicio anterior.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-519">Switch to the Visual Studio instance with the **GeekQuiz** solution from the previous exercise.</span></span>
2. <span data-ttu-id="d6dbf-520">En la barra de menús, seleccione **vista** y, a continuación, haga clic en **Explorador de servidores**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-520">From the menu bar, select **View** and then click **Server Explorer**.</span></span>
3. <span data-ttu-id="d6dbf-521">En **Explorador de servidores**, haga clic en el **Azure** nodo y seleccione **conectar a Azure...** . Inicie sesión con la cuenta de Microsoft asociada con su suscripción.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-521">In **Server Explorer**, right-click the **Azure** node and select **Connect to Azure...**. Sign in using the Microsoft account associated with your subscription.</span></span>

    ![Conectarse a Windows Azure](maintainable-azure-websites-managing-change-and-scale/_static/image62.png)

    <span data-ttu-id="d6dbf-523">*Conectarse a Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-523">*Connect to Azure*</span></span>
4. <span data-ttu-id="d6dbf-524">Expanda el **Azure** nodo, haga clic en **almacenamiento** y seleccione **adjuntar almacenamiento externo...** .</span><span class="sxs-lookup"><span data-stu-id="d6dbf-524">Expand the **Azure** node, right-click **Storage** and select **Attach External Storage...**.</span></span>
5. <span data-ttu-id="d6dbf-525">En el **agregar una nueva cuenta de almacenamiento** diálogo cuadro, escriba la **nombre de la cuenta** y **clave de cuenta** obtenido en la tarea anterior y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-525">In the **Add New Storage Account** dialog box, enter the **Account name** and **Account key** you obtained in the previous task and click **OK**.</span></span>

    ![Agregar cuadro de diálogo nueva cuenta de almacenamiento](maintainable-azure-websites-managing-change-and-scale/_static/image63.png)

    <span data-ttu-id="d6dbf-527">*Agregar cuadro de diálogo nueva cuenta de almacenamiento*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-527">*Add New Storage Account dialog box*</span></span>
6. <span data-ttu-id="d6dbf-528">La cuenta de almacenamiento debería aparecer bajo el **almacenamiento** nodo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-528">Your storage account should appear under the **Storage** node.</span></span> <span data-ttu-id="d6dbf-529">Expanda la cuenta de almacenamiento, haga clic en **Blobs** y seleccione **crear contenedor de Blob...** .</span><span class="sxs-lookup"><span data-stu-id="d6dbf-529">Expand your storage account, right-click **Blobs** and select **Create Blob Container...**.</span></span>

    <span data-ttu-id="d6dbf-530">![Crear contenedor de blobs](maintainable-azure-websites-managing-change-and-scale/_static/image64.png "crear contenedor de blobs")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-530">![Create Blob Container](maintainable-azure-websites-managing-change-and-scale/_static/image64.png "Create Blob Container")</span></span>

    <span data-ttu-id="d6dbf-531">*Crear contenedor de blobs*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-531">*Create Blob Container*</span></span>
7. <span data-ttu-id="d6dbf-532">En el **crear contenedor de blobs** diálogo cuadro, escriba un nombre para el contenedor de blobs y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-532">In the **Create Blob Container** dialog box, enter a name for the blob container and click **OK**.</span></span>

    <span data-ttu-id="d6dbf-533">![Cuadro de diálogo Crear contenedor de blobs](maintainable-azure-websites-managing-change-and-scale/_static/image65.png "cuadro de diálogo Crear contenedor de blobs")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-533">![Create Blob Container dialog box](maintainable-azure-websites-managing-change-and-scale/_static/image65.png "Create Blob Container dialog box")</span></span>

    <span data-ttu-id="d6dbf-534">*Crear contenedor de blobs, cuadro de diálogo*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-534">*Create Blob Container dialog box*</span></span>
8. <span data-ttu-id="d6dbf-535">El nuevo contenedor de blob debe agregarse a la **Blobs** nodo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-535">The new blob container should be added to the **Blobs** node.</span></span> <span data-ttu-id="d6dbf-536">Cambiar los permisos de acceso en el contenedor para hacer público el contenedor.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-536">Change the access permissions in the container to make the container public.</span></span> <span data-ttu-id="d6dbf-537">Para ello, haga clic en el **imágenes** contenedor y seleccione **propiedades**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-537">To do this, right-click the **images** container and select **Properties**.</span></span>

    <span data-ttu-id="d6dbf-538">![propiedades del contenedor de imágenes](maintainable-azure-websites-managing-change-and-scale/_static/image66.png "imágenes propiedades del contenedor")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-538">![images container properties](maintainable-azure-websites-managing-change-and-scale/_static/image66.png "images container properties")</span></span>

    <span data-ttu-id="d6dbf-539">*Propiedades de contenedor de imágenes*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-539">*Images container properties*</span></span>
9. <span data-ttu-id="d6dbf-540">En el **propiedades** ventana, establezca el **acceso de lectura público** a **contenedor**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-540">In the **Properties** window, set the **Public Read Access** to **Container**.</span></span>

    <span data-ttu-id="d6dbf-541">![Cambio de propiedad de acceso de lectura público](maintainable-azure-websites-managing-change-and-scale/_static/image67.png "cambio de propiedad de acceso público de lectura")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-541">![Changing public read access property](maintainable-azure-websites-managing-change-and-scale/_static/image67.png "Changing public read access property")</span></span>

    <span data-ttu-id="d6dbf-542">*Cambio de propiedad de acceso público de lectura*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-542">*Changing public read access property*</span></span>
10. <span data-ttu-id="d6dbf-543">Cuando se le pregunte si está seguro de que desea cambiar la propiedad de acceso público, haga clic en **Sí**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-543">When prompted if you are sure you want to change the public access property, click **Yes**.</span></span>

    <span data-ttu-id="d6dbf-544">![Advertencia de Microsoft Visual Studio](maintainable-azure-websites-managing-change-and-scale/_static/image68.png "advertencia de Microsoft Visual Studio")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-544">![Microsoft Visual Studio warning](maintainable-azure-websites-managing-change-and-scale/_static/image68.png "Microsoft Visual Studio warning")</span></span>

    <span data-ttu-id="d6dbf-545">*Advertencia de Microsoft Visual Studio*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-545">*Microsoft Visual Studio warning*</span></span>
11. <span data-ttu-id="d6dbf-546">En **Explorador de servidores**, pulse el botón derecho en el **imágenes** contenedor de blobs y seleccione **ver contenedor de Blob**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-546">In **Server Explorer**, right-click in the **images** blob container and select **View Blob Container**.</span></span>

    <span data-ttu-id="d6dbf-547">![Ver el contenedor de blobs](maintainable-azure-websites-managing-change-and-scale/_static/image69.png "ver contenedor de blobs")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-547">![View Blob Container](maintainable-azure-websites-managing-change-and-scale/_static/image69.png "View Blob Container")</span></span>

    <span data-ttu-id="d6dbf-548">*Contenedor de blobs de vista*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-548">*View Blob Container*</span></span>
12. <span data-ttu-id="d6dbf-549">Debe abrir el contenedor de imágenes en una nueva ventana y se debe mostrar una leyenda sin entradas.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-549">The images container should open in a new window and a legend with no entries should be shown.</span></span> <span data-ttu-id="d6dbf-550">Haga clic en el **cargar** icono para cargar un archivo en el contenedor de blobs.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-550">Click the **upload** icon to upload a file to the blob container.</span></span>

    <span data-ttu-id="d6dbf-551">![El contenedor de imágenes sin entradas](maintainable-azure-websites-managing-change-and-scale/_static/image70.png "el contenedor de imágenes sin entradas")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-551">![Images container with no entries](maintainable-azure-websites-managing-change-and-scale/_static/image70.png "Images container with no entries")</span></span>

    <span data-ttu-id="d6dbf-552">*Contenedor de imágenes sin entradas*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-552">*Images container with no entries*</span></span>
13. <span data-ttu-id="d6dbf-553">En el **cargar Blob** diálogo cuadro, vaya a la **activos** carpeta del laboratorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-553">In the **Upload Blob** dialog box, navigate to the **Assets** folder of the lab.</span></span> <span data-ttu-id="d6dbf-554">Seleccione el **logotipo big.png** de archivo y haga clic en **abiertos**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-554">Select the **logo-big.png** file and click **Open**.</span></span>
14. <span data-ttu-id="d6dbf-555">Espere hasta que se carga el archivo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-555">Wait until the file is uploaded.</span></span> <span data-ttu-id="d6dbf-556">Cuando finalice la carga, el archivo debe aparecer en el contenedor de imágenes.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-556">When the upload completes, the file should be listed in the images container.</span></span> <span data-ttu-id="d6dbf-557">Haga clic en la entrada del archivo y seleccione **Copiar dirección URL**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-557">Right-click the file entry and select **Copy URL**.</span></span>

    <span data-ttu-id="d6dbf-558">![Copiar dirección URL del blob](maintainable-azure-websites-managing-change-and-scale/_static/image71.png "Copiar dirección URL del archivo de blob")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-558">![Copy blob URL](maintainable-azure-websites-managing-change-and-scale/_static/image71.png "Copy blob file URL")</span></span>

    <span data-ttu-id="d6dbf-559">*Copiar dirección URL de blob*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-559">*Copy blob URL*</span></span>
15. <span data-ttu-id="d6dbf-560">Abra Internet Explorer y pegue la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-560">Open Internet Explorer and paste the URL.</span></span> <span data-ttu-id="d6dbf-561">La siguiente imagen se debería mostrar en el explorador.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-561">The following image should be shown in the browser.</span></span>

    <span data-ttu-id="d6dbf-562">![imagen de logotipo big.png desde el almacenamiento de blobs de Microsoft](maintainable-azure-websites-managing-change-and-scale/_static/image72.png "imagen de logotipo big.png de almacenamiento")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-562">![logo-big.png image from Windows Blob Storage](maintainable-azure-websites-managing-change-and-scale/_static/image72.png "logo-big.png image from storage")</span></span>

    <span data-ttu-id="d6dbf-563">*imagen de logotipo big.png desde el almacenamiento de blobs de Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-563">*logo-big.png image from Azure Blob Storage*</span></span>

<a id="Ex4Task3"></a>
#### <a name="task-3--updating-the-solution-to-consume-static-content-from-azure-blob-storage"></a><span data-ttu-id="d6dbf-564">Tarea 3: actualizar la solución para consumir contenido estático desde el almacenamiento de blobs de Azure</span><span class="sxs-lookup"><span data-stu-id="d6dbf-564">Task 3 – Updating the Solution to Consume Static Content from Azure Blob Storage</span></span>

<span data-ttu-id="d6dbf-565">En esta tarea, configurará la **GeekQuiz** solución para consumir la imagen cargado al almacenamiento de blobs de Azure (en lugar de la imagen que se encuentra en la aplicación web) mediante la adición de una regla de reescritura de direcciones URL de ASP.NET en el **web.config**archivo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-565">In this task, you will configure the **GeekQuiz** solution to consume the image uploaded to Azure Blob Storage (instead of the image located in the web app) by adding an ASP.NET URL rewrite rule in the **web.config** file.</span></span>

1. <span data-ttu-id="d6dbf-566">En Visual Studio, abra el **Web.config** archivo dentro de la **GeekQuiz** del proyecto y busque el  **&lt;system.webServer&gt;**  elemento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-566">In Visual Studio, open the **Web.config** file inside the **GeekQuiz** project and locate the **&lt;system.webServer&gt;** element.</span></span>
2. <span data-ttu-id="d6dbf-567">Agregue el código siguiente para agregar una URL rewrite regla, para actualizar el marcador de posición con el nombre de cuenta de almacenamiento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-567">Add the following code to add an URL rewrite rule, updating the placeholder with your storage account name.</span></span>

    <span data-ttu-id="d6dbf-568">(Código de fragmento de código: *UrlRewriteRule WebSitesInProduction - Ex4 -*)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-568">(Code Snippet - *WebSitesInProduction - Ex4 - UrlRewriteRule*)</span></span>

    [!code-xml[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample17.xml)]

    > [!NOTE]
    > <span data-ttu-id="d6dbf-569">Reescritura de direcciones URL es el proceso de interceptar una solicitud Web de entrada y redirigir la solicitud a otro recurso.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-569">URL rewriting is the process of intercepting an incoming Web request and redirecting the request to a different resource.</span></span> <span data-ttu-id="d6dbf-570">La dirección URL de volver a escribir reglas indica al motor de reescritura cuando se necesita una solicitud de redirección y que se deben redirigir.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-570">The URL rewriting rules tells the rewriting engine when a request needs to be redirected, and where should they be redirected.</span></span> <span data-ttu-id="d6dbf-571">Una regla de reescritura se compone de dos cadenas: el modelo se debe buscar en la dirección URL solicitada (normalmente, mediante expresiones regulares), y la cadena para reemplazar el patrón, si se encuentra.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-571">A rewriting rule is composed of two strings: the pattern to look for in the requested URL (usually, using regular expressions), and the string to replace the pattern with, if found.</span></span> <span data-ttu-id="d6dbf-572">Para obtener más información, consulte [reescritura de direcciones URL en ASP.NET](https://msdn.microsoft.com/en-us/library/ms972974.aspx).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-572">For more information, see [URL Rewriting in ASP.NET](https://msdn.microsoft.com/en-us/library/ms972974.aspx).</span></span>
3. <span data-ttu-id="d6dbf-573">Presione **CTRL + S** para guardar los cambios.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-573">Press **CTRL + S** to save the changes.</span></span>
4. <span data-ttu-id="d6dbf-574">Abra una nueva **Git Bash** consola para implementar la aplicación actualizada al servicio de aplicaciones de Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-574">Open a new **Git Bash** console to deploy the updated application to Azure App Service.</span></span>
5. <span data-ttu-id="d6dbf-575">Ejecute los siguientes comandos para insertar los cambios en Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-575">Execute the following commands to push the changes to Azure.</span></span> <span data-ttu-id="d6dbf-576">Actualización de la *[ruta de la aplicación YOUR]* marcador de posición con la ruta de acceso a la **GeekQuiz** solución.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-576">Update the *[YOUR-APPLICATION-PATH]* placeholder with the path to the **GeekQuiz** solution.</span></span> <span data-ttu-id="d6dbf-577">Se le pedirá la contraseña de la implementación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-577">You will be prompted for your deployment password.</span></span>

    [!code-console[Main](maintainable-azure-websites-managing-change-and-scale/samples/sample18.cmd)]

    ![Implementación de actualización en Azure](maintainable-azure-websites-managing-change-and-scale/_static/image73.png)

    <span data-ttu-id="d6dbf-579">*Implementación de actualización en Azure*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-579">*Deploying update to Azure*</span></span>

<a id="Ex4Task4"></a>
#### <a name="task-4--verification"></a><span data-ttu-id="d6dbf-580">Tarea 4: comprobación</span><span class="sxs-lookup"><span data-stu-id="d6dbf-580">Task 4 – Verification</span></span>

<span data-ttu-id="d6dbf-581">En esta tarea usará **Internet Explorer** para examinar el **cuestionario experto en** aplicación y compruebe que la dirección URL vuelva a escribir la regla para el funcionamiento de las imágenes y se redirigen a la imagen que se hospedan en **blobs de Azure Almacenamiento**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-581">In this task you will use **Internet Explorer** to browse the **Geek Quiz** application and check that the URL rewrite rule for images works and you are redirected to the image hosted on **Azure Blob Storage**.</span></span>

1. <span data-ttu-id="d6dbf-582">Abra Internet Explorer y vaya a la aplicación web (por ejemplo, `http://<your-web-site>.azurewebsites.net`).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-582">Open Internet Explorer and navigate to your web app (e.g. `http://<your-web-site>.azurewebsites.net`).</span></span> <span data-ttu-id="d6dbf-583">Inicie sesión con las credenciales creadas anteriormente.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-583">Log in using the previously created credentials.</span></span>

    <span data-ttu-id="d6dbf-584">![Que muestra el web cuestionario experto en la aplicación con la imagen](maintainable-azure-websites-managing-change-and-scale/_static/image74.png "que muestra la web cuestionario experto en la aplicación con la imagen")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-584">![Showing the Geek Quiz web app with the image](maintainable-azure-websites-managing-change-and-scale/_static/image74.png "Showing the Geek Quiz web app with the image")</span></span>

    <span data-ttu-id="d6dbf-585">*Que muestra el web cuestionario experto en la aplicación con la imagen*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-585">*Showing the Geek Quiz web app with the image*</span></span>
2. <span data-ttu-id="d6dbf-586">Presione **F12** para iniciar las herramientas de desarrollo, seleccione la **red** pestaña e iniciar la grabación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-586">Press **F12** to launch the development tools, select the **Network** tab and start recording.</span></span>

    <span data-ttu-id="d6dbf-587">![A partir de grabación de red](maintainable-azure-websites-managing-change-and-scale/_static/image75.png "a partir de grabación de red")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-587">![Starting network recording](maintainable-azure-websites-managing-change-and-scale/_static/image75.png "Starting network recording")</span></span>

    <span data-ttu-id="d6dbf-588">*Grabación de red inicial*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-588">*Starting network recording*</span></span>
3. <span data-ttu-id="d6dbf-589">Presione **CTRL + F5** para actualizar la página web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-589">Press **CTRL + F5** to refresh the web page.</span></span>
4. <span data-ttu-id="d6dbf-590">Una vez que la página ha terminado de cargarse, debería ver una solicitud HTTP para la **/img/logo-big.png** dirección URL con un HTTP **301** resultado (redirección) y otra solicitud de `http://[YOUR-STORAGE-ACCOUNT].blob.core.windows.net/images/logo-big.png` dirección URL con un HTTP **200** resultado.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-590">Once the page has finished loading, you should see an HTTP request for the **/img/logo-big.png** URL with an HTTP **301** result (redirect) and another request for `http://[YOUR-STORAGE-ACCOUNT].blob.core.windows.net/images/logo-big.png` URL with a HTTP **200** result.</span></span>

    <span data-ttu-id="d6dbf-591">![Comprobar redireccionar la dirección URL](maintainable-azure-websites-managing-change-and-scale/_static/image76.png "que muestra la redirección de las herramientas de desarrollo")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-591">![Verifying the URL redirect](maintainable-azure-websites-managing-change-and-scale/_static/image76.png "Showing the redirect in Dev Tools")</span></span>

    <span data-ttu-id="d6dbf-592">*Comprobar redireccionar la dirección URL*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-592">*Verifying the URL redirect*</span></span>

<a id="Exercise5"></a>
### <a name="exercise-5-using-autoscale-for-web-apps"></a><span data-ttu-id="d6dbf-593">Ejercicio 5: Usar el escalado automático para las aplicaciones Web</span><span class="sxs-lookup"><span data-stu-id="d6dbf-593">Exercise 5: Using Autoscale for Web Apps</span></span>

> [!NOTE]
> <span data-ttu-id="d6dbf-594">Este ejercicio es opcional, ya que requiere compatibilidad carga Web &amp; que solo está disponible para las pruebas de rendimiento **Visual Studio 2013 Ultimate Edition**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-594">This exercise is optional, since it requires support for Web Load &amp; Performance Testing which is only available for **Visual Studio 2013 Ultimate Edition**.</span></span> <span data-ttu-id="d6dbf-595">Para obtener más información sobre características específicas de Visual Studio 2013, comparar versiones [aquí](https://www.microsoft.com/visualstudio/eng/products/compare).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-595">For more information on specific Visual Studio 2013 features, compare versions [here](https://www.microsoft.com/visualstudio/eng/products/compare).</span></span>


<span data-ttu-id="d6dbf-596">**Aplicaciones Web del servicio de Azure aplicación** proporciona la característica de escalado automático para aplicaciones web que se ejecutan **modo estándar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-596">**Azure App Service Web Apps** provides the Autoscale feature for web apps running in **Standard Mode**.</span></span> <span data-ttu-id="d6dbf-597">Escalado automático permite que Azure escale automáticamente el recuento de instancias de la aplicación web según la carga.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-597">Autoscale lets Azure automatically scale the instance count of your web app depending on the load.</span></span> <span data-ttu-id="d6dbf-598">Cuando se habilita escalado automático, Azure comprueba la CPU de la aplicación web una vez cada cinco minutos y agrega instancias según sea necesario en ese momento en el tiempo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-598">When Autoscale is enabled, Azure checks the CPU of your web app once every five minutes and adds instances as needed at that point in time.</span></span> <span data-ttu-id="d6dbf-599">Si el uso de CPU es bajo, Azure quitará instancias una vez cada dos horas para asegurarse de que no se degrada el rendimiento de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-599">If the CPU usage is low, Azure will remove instances once every two hours to ensure that the performance of your web app is not degraded.</span></span>

<span data-ttu-id="d6dbf-600">En este ejercicio recorrerá los pasos necesarios para configurar el **escalado automático** características de la **experto en cuestionario** aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-600">In this exercise you will go through the steps required to configure the **Autoscale** feature for the **Geek Quiz** web app.</span></span> <span data-ttu-id="d6dbf-601">Esta característica se comprobará mediante la ejecución de una prueba de carga de Visual Studio para generar la carga de CPU necesaria en la aplicación para desencadenar una actualización de la instancia.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-601">You will verify this feature by running a Visual Studio load test to generate enough CPU load on the application to trigger an instance upgrade.</span></span>

<a id="Ex5Task1"></a>
#### <a name="task-1--configuring-autoscale-based-on-the-cpu-metric"></a><span data-ttu-id="d6dbf-602">Tarea 1: configuración de escalado automático basado en la métrica de CPU</span><span class="sxs-lookup"><span data-stu-id="d6dbf-602">Task 1 – Configuring Autoscale Based on the CPU Metric</span></span>

<span data-ttu-id="d6dbf-603">En esta tarea va a usar el portal de administración de Azure para habilitar la característica de escalado automático de la aplicación web que creó en el ejercicio 2.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-603">In this task you will use the Azure management portal to enable the Autoscale feature for the web app you created in Exercise 2.</span></span>

1. <span data-ttu-id="d6dbf-604">En el [portal de administración de Azure](https://manage.windowsazure.com/), seleccione **sitios Web** y haga clic en la aplicación web que creó en el ejercicio 2.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-604">In the [Azure management portal](https://manage.windowsazure.com/), select **Websites** and click the web app you created in Exercise 2.</span></span>
2. <span data-ttu-id="d6dbf-605">Navegue hasta la **escala** página.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-605">Navigate to the **Scale** page.</span></span> <span data-ttu-id="d6dbf-606">En el **capacidad** sección, seleccione **CPU** para el **escalar por métrica** configuración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-606">Under the **capacity** section, select **CPU** for the **Scale by Metric** configuration.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-607">Al escalar por CPU, Azure ajusta dinámicamente el número de instancias que usa la aplicación si cambia el uso de CPU.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-607">When scaling by CPU, Azure dynamically adjusts the number of instances that the app uses if the CPU usage changes.</span></span>

    <span data-ttu-id="d6dbf-608">![Seleccionar la opción para escalar por CPU](maintainable-azure-websites-managing-change-and-scale/_static/image77.png "al seleccionar la métrica de CPU para el escalado automático")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-608">![Selecting to scale by CPU](maintainable-azure-websites-managing-change-and-scale/_static/image77.png "Selecting the CPU metric for auto scaling")</span></span>

    <span data-ttu-id="d6dbf-609">*Seleccionar la opción para escalar por CPU*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-609">*Selecting to scale by CPU*</span></span>
3. <span data-ttu-id="d6dbf-610">Cambiar el **CPU de destino** configuración **20**-**40** por ciento.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-610">Change the **Target CPU** configuration to **20**-**40** percent.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-611">Este intervalo representa el uso medio de CPU de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-611">This range represents the average CPU usage for your web app.</span></span> <span data-ttu-id="d6dbf-612">Azure agregará o quitará instancias para mantener la aplicación web en este intervalo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-612">Azure will add or remove instances to keep your web app in this range.</span></span> <span data-ttu-id="d6dbf-613">El número mínimo y máximo de instancias que se usarán para el escalado se especifica en el **recuento de instancias** configuración.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-613">The minimum and maximum number of instances used for scaling is specified in the **Instance Count** configuration.</span></span> <span data-ttu-id="d6dbf-614">Azure nunca superará más allá de ese límite.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-614">Azure will never go above or beyond that limit.</span></span>
    > 
    > <span data-ttu-id="d6dbf-615">El valor predeterminado **CPU de destino** se modifican los valores solo para los fines de este laboratorio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-615">The default **Target CPU** values are modified just for the purposes of this lab.</span></span> <span data-ttu-id="d6dbf-616">Al configurar el intervalo de CPU con valores pequeños, va a aumentar las posibilidades de desencadenador de escalado automático cuando se coloca una carga moderada en la aplicación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-616">By configuring the CPU range with small values, you are increasing the chances to trigger Autoscale when a moderate load is placed on the application.</span></span>

    <span data-ttu-id="d6dbf-617">![Cambiar el destino de la CPU está comprendido entre 20 y 40 por ciento](maintainable-azure-websites-managing-change-and-scale/_static/image78.png "cambiar el destino de la CPU para que esté entre 20 y 40 por ciento")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-617">![Changing the target CPU to be between 20 and 40 percent](maintainable-azure-websites-managing-change-and-scale/_static/image78.png "Changing the target CPU to be between 20 and 40 percent")</span></span>

    <span data-ttu-id="d6dbf-618">*Cambio de la CPU de destino para que esté entre 20 y 40 por ciento*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-618">*Changing the Target CPU to be between 20 and 40 percent*</span></span>
4. <span data-ttu-id="d6dbf-619">Haga clic en **guardar** en la barra de comandos para guardar los cambios.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-619">Click **Save** in the command bar to save the changes.</span></span>

<a id="Ex5Task2"></a>
#### <a name="task-2--load-testing-with-visual-studio"></a><span data-ttu-id="d6dbf-620">Tarea 2: pruebas con Visual Studio de carga</span><span class="sxs-lookup"><span data-stu-id="d6dbf-620">Task 2 – Load Testing with Visual Studio</span></span>

<span data-ttu-id="d6dbf-621">Ahora que **escalado automático** ha sido configurado, se creará un **proyecto de prueba de carga y rendimiento Web** en Visual Studio para generar la carga de la CPU en la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-621">Now that **Autoscale** has been configured, you will create a **Web Performance and Load Test Project** in Visual Studio to generate some CPU load on your web app.</span></span>

1. <span data-ttu-id="d6dbf-622">Abra **Visual Studio Ultimate 2013** y seleccione **archivo | Nuevos | Proyecto...**  para iniciar una nueva solución.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-622">Open **Visual Studio Ultimate 2013** and select **File | New | Project...** to start a new solution.</span></span>

    <span data-ttu-id="d6dbf-623">![Crear un nuevo proyecto](maintainable-azure-websites-managing-change-and-scale/_static/image79.png "crear un nuevo proyecto")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-623">![Creating a new project](maintainable-azure-websites-managing-change-and-scale/_static/image79.png "Creating a new project")</span></span>

    <span data-ttu-id="d6dbf-624">*Crear un nuevo proyecto*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-624">*Creating a new project*</span></span>
2. <span data-ttu-id="d6dbf-625">En el **nuevo proyecto** cuadro de diálogo, seleccione **proyecto de prueba de carga y rendimiento Web** en el **Visual C# | Prueba** ficha. Asegúrese de que **.NET Framework 4.5** está seleccionado, denomine el proyecto *WebAndLoadTestProject*, elija un **ubicación** y haga clic en **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-625">In the **New Project** dialog box, select **Web Performance and Load Test Project** under the **Visual C# | Test** tab. Make sure **.NET Framework 4.5** is selected, name the project *WebAndLoadTestProject*, choose a **Location** and click **OK**.</span></span>

    <span data-ttu-id="d6dbf-626">![Crear un nuevo proyecto de prueba de carga y Web](maintainable-azure-websites-managing-change-and-scale/_static/image80.png "crear un nuevo proyecto de prueba de carga y Web")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-626">![Creating a new Web and Load Test project](maintainable-azure-websites-managing-change-and-scale/_static/image80.png "Creating a new Web and Load Test project")</span></span>

    <span data-ttu-id="d6dbf-627">*Crear un nuevo proyecto de prueba de carga y Web*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-627">*Creating a new Web and Load Test project*</span></span>
3. <span data-ttu-id="d6dbf-628">En el **WebTest1.webtest** haga clic en el **WebTest1** nodo y haga clic en **Agregar solicitud**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-628">In the **WebTest1.webtest** Right-click the **WebTest1** node and click **Add Request**.</span></span>

    <span data-ttu-id="d6dbf-629">![Agregar una solicitud a WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image81.png "agregar una solicitud a WebTest1")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-629">![Adding a request to WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image81.png "Adding a request to WebTest1")</span></span>

    <span data-ttu-id="d6dbf-630">*Agregar una solicitud a WebTest1*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-630">*Adding a request to WebTest1*</span></span>
4. <span data-ttu-id="d6dbf-631">En el **propiedades** ventana del nuevo nodo de solicitud, actualizar el **Url** propiedad para señalar a la dirección URL de la aplicación web (por ejemplo,  *[http://geek-quiz.azurewebsites.net/](http://geek-quiz.azurewebsites.net/)* ).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-631">In the **Properties** window of the new request node, update the **Url** property to point to the URL of your web app (e.g. *[http://geek-quiz.azurewebsites.net/](http://geek-quiz.azurewebsites.net/)*).</span></span>

    <span data-ttu-id="d6dbf-632">![Cambiar la propiedad de dirección Url](maintainable-azure-websites-managing-change-and-scale/_static/image82.png "cambiar la propiedad de dirección Url")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-632">![Changing the Url property](maintainable-azure-websites-managing-change-and-scale/_static/image82.png "Changing the Url property")</span></span>

    <span data-ttu-id="d6dbf-633">*Cambiar la propiedad de dirección Url*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-633">*Changing the Url property*</span></span>
5. <span data-ttu-id="d6dbf-634">En el **WebTest1.webtest** ventana, haga clic en **WebTest1** y haga clic en **bucle agregar...** .</span><span class="sxs-lookup"><span data-stu-id="d6dbf-634">In the **WebTest1.webtest** window, right-click **WebTest1** and click **Add Loop...**.</span></span>

    <span data-ttu-id="d6dbf-635">![Agregar un bucle a WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image83.png "agregar un bucle a WebTest1")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-635">![Adding a loop to WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image83.png "Adding a loop to WebTest1")</span></span>

    <span data-ttu-id="d6dbf-636">*Agregar un bucle a WebTest1*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-636">*Adding a loop to WebTest1*</span></span>
6. <span data-ttu-id="d6dbf-637">En el **Agregar regla condicional y elementos al bucle** cuadro de diálogo, seleccione la **de bucles for** de regla y modificar las siguientes propiedades.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-637">In the **Add Conditional Rule and Items to Loop** dialog box, select the **For Loop** rule and modify the following properties.</span></span>

    1. <span data-ttu-id="d6dbf-638">**Valor de finalización:** 1000</span><span class="sxs-lookup"><span data-stu-id="d6dbf-638">**Terminating value:** 1000</span></span>
    2. <span data-ttu-id="d6dbf-639">**Nombre del parámetro de contexto:** iterador</span><span class="sxs-lookup"><span data-stu-id="d6dbf-639">**Context Parameter Name:** Iterator</span></span>
    3. <span data-ttu-id="d6dbf-640">**Valor de incremento:** 1</span><span class="sxs-lookup"><span data-stu-id="d6dbf-640">**Increment Value:** 1</span></span>

    <span data-ttu-id="d6dbf-641">![Seleccione la regla de bucles for y actualización de las propiedades](maintainable-azure-websites-managing-change-and-scale/_static/image84.png "seleccionando la regla de bucles for y actualizar las propiedades")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-641">![Selecting the For Loop rule and updating the properties](maintainable-azure-websites-managing-change-and-scale/_static/image84.png "Selecting the For Loop rule and updating the properties")</span></span>

    <span data-ttu-id="d6dbf-642">*Seleccione la regla de bucles for y actualizar las propiedades*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-642">*Selecting the For Loop rule and updating the properties*</span></span>
7. <span data-ttu-id="d6dbf-643">En el **elementos en bucle** sección, seleccione la solicitud que creó anteriormente para que sea el primer y último elemento para el bucle.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-643">Under the **Items in loop** section, select the request you created previously to be the first and last item for the loop.</span></span> <span data-ttu-id="d6dbf-644">Haga clic en **Aceptar** para continuar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-644">Click **OK** to continue.</span></span>

    <span data-ttu-id="d6dbf-645">![Seleccionar el primer y último elemento para el bucle](maintainable-azure-websites-managing-change-and-scale/_static/image85.png "al seleccionar el primer y último elemento del bucle")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-645">![Selecting the first and last items for the loop](maintainable-azure-websites-managing-change-and-scale/_static/image85.png "Selecting the first and last items for the loop")</span></span>

    <span data-ttu-id="d6dbf-646">*Seleccionar el primer y último elemento del bucle*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-646">*Selecting the first and last items for the loop*</span></span>
8. <span data-ttu-id="d6dbf-647">En **el Explorador de soluciones**, haga clic en el **WebAndLoadTestProject** proyecto de equipo y expanda el **agregar** menú y seleccione **prueba de carga...** .</span><span class="sxs-lookup"><span data-stu-id="d6dbf-647">In **Solution Explorer**, right-click the **WebAndLoadTestProject** project, expand the **Add** menu and select **Load Test...**.</span></span>

    <span data-ttu-id="d6dbf-648">![Agregar una prueba de carga al proyecto WebAndLoadTestProject](maintainable-azure-websites-managing-change-and-scale/_static/image86.png "agregar una prueba de carga al proyecto WebAndLoadTestProject")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-648">![Adding a Load Test to the WebAndLoadTestProject project](maintainable-azure-websites-managing-change-and-scale/_static/image86.png "Adding a Load Test to the WebAndLoadTestProject project")</span></span>

    <span data-ttu-id="d6dbf-649">*Agregar una prueba de carga al proyecto WebAndLoadTestProject*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-649">*Adding a Load Test to the WebAndLoadTestProject project*</span></span>
9. <span data-ttu-id="d6dbf-650">En el **Asistente para nueva prueba de carga** cuadro de diálogo, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-650">In the **New Load Test Wizard** dialog box, click **Next**.</span></span>

    <span data-ttu-id="d6dbf-651">![Asistente para nueva prueba de carga](maintainable-azure-websites-managing-change-and-scale/_static/image87.png "Asistente para nueva prueba de carga")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-651">![New Load Test Wizard](maintainable-azure-websites-managing-change-and-scale/_static/image87.png "New Load Test Wizard")</span></span>

    <span data-ttu-id="d6dbf-652">*Asistente para nueva prueba de carga*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-652">*New Load Test Wizard*</span></span>
10. <span data-ttu-id="d6dbf-653">En el **escenario** página, seleccione **no utilizar tiempos de reflexión** y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-653">In the **Scenario** page, select **Do not use think times** and click **Next**.</span></span>

    <span data-ttu-id="d6dbf-654">![Si selecciona no se debe utilizar tiempos de reflexión](maintainable-azure-websites-managing-change-and-scale/_static/image88.png "si selecciona no se debe utilizar tiempos de reflexión")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-654">![Selecting not to use think times](maintainable-azure-websites-managing-change-and-scale/_static/image88.png "Selecting not to use think times")</span></span>

    <span data-ttu-id="d6dbf-655">*Seleccionar para que no use los tiempos de reflexión*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-655">*Selecting not to use think times*</span></span>
11. <span data-ttu-id="d6dbf-656">En el **modelo de carga** página, asegúrese de que el **carga constante** opción está seleccionada.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-656">In the **Load Pattern** page, make sure that the **Constant Load** option is selected.</span></span> <span data-ttu-id="d6dbf-657">Cambiar el **recuento de usuarios** si se establece en **250** a los usuarios y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-657">Change the **User Count** setting to **250** users and click **Next**.</span></span>

    <span data-ttu-id="d6dbf-658">![Cambiar el recuento de usuarios a 250](maintainable-azure-websites-managing-change-and-scale/_static/image89.png "cambiar el recuento de usuarios a 250")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-658">![Changing the user count to 250](maintainable-azure-websites-managing-change-and-scale/_static/image89.png "Changing the user count to 250")</span></span>

    <span data-ttu-id="d6dbf-659">*Cambiar el recuento de usuarios a 250*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-659">*Changing the user count to 250*</span></span>
12. <span data-ttu-id="d6dbf-660">En el **modelo de combinación de pruebas** página, seleccione **basada en el orden de pruebas secuencial** y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-660">In the **Test Mix Model** page, select **Based on sequential test order** and click **Next**.</span></span>

    <span data-ttu-id="d6dbf-661">![Seleccionar el modelo de combinación de pruebas](maintainable-azure-websites-managing-change-and-scale/_static/image90.png "seleccionando el modelo de combinación de pruebas")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-661">![Selecting the test mix model](maintainable-azure-websites-managing-change-and-scale/_static/image90.png "Selecting the test mix model")</span></span>

    <span data-ttu-id="d6dbf-662">*Seleccionar el modelo de combinación de pruebas*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-662">*Selecting the test mix model*</span></span>
13. <span data-ttu-id="d6dbf-663">En el **modelo de combinación de pruebas** página, haga clic en **agregar...**  para agregar una prueba a la combinación.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-663">In the **Test Mix Model** page, click **Add...** to add a test to the mix.</span></span>

    <span data-ttu-id="d6dbf-664">![Agregar una prueba a la combinación de pruebas](maintainable-azure-websites-managing-change-and-scale/_static/image91.png "agregar una prueba a la combinación de pruebas")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-664">![Adding a test to the test mix](maintainable-azure-websites-managing-change-and-scale/_static/image91.png "Adding a test to the test mix")</span></span>

    <span data-ttu-id="d6dbf-665">*Agregar una prueba a la combinación de pruebas*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-665">*Adding a test to the test mix*</span></span>
14. <span data-ttu-id="d6dbf-666">En el **agregar pruebas** cuadro de diálogo, haga doble clic en **WebTest1** para agregar la prueba a la **pruebas seleccionadas** lista.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-666">In the **Add Tests** dialog box, double-click **WebTest1** to add the test to the **Selected tests** list.</span></span> <span data-ttu-id="d6dbf-667">Haga clic en **Aceptar** para continuar.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-667">Click **OK** to continue.</span></span>

    <span data-ttu-id="d6dbf-668">![Agregar la prueba WebTest1](maintainable-azure-websites-managing-change-and-scale/_static/image92.png "agregar la prueba WebTest1")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-668">![Adding the WebTest1 test](maintainable-azure-websites-managing-change-and-scale/_static/image92.png "Adding the WebTest1 test")</span></span>

    <span data-ttu-id="d6dbf-669">*Agregar la prueba WebTest1*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-669">*Adding the WebTest1 test*</span></span>
15. <span data-ttu-id="d6dbf-670">En el **combinación de pruebas** página, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-670">Back in the **Test Mix** page, click **Next**.</span></span>

    <span data-ttu-id="d6dbf-671">![Completar la página de la combinación de pruebas](maintainable-azure-websites-managing-change-and-scale/_static/image93.png "completar la página de la combinación de pruebas")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-671">![Completing the Test Mix page](maintainable-azure-websites-managing-change-and-scale/_static/image93.png "Completing the Test Mix page")</span></span>

    <span data-ttu-id="d6dbf-672">*Completar la página de la combinación de pruebas*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-672">*Completing the Test Mix page*</span></span>
16. <span data-ttu-id="d6dbf-673">En el **combinación de redes** página, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-673">In the **Network Mix** page, click **Next**.</span></span>

    <span data-ttu-id="d6dbf-674">![Al hacer clic en siguiente en la página de la combinación de redes](maintainable-azure-websites-managing-change-and-scale/_static/image94.png "al hacer clic en siguiente en la página de la combinación de redes")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-674">![Clicking next in the Network Mix page](maintainable-azure-websites-managing-change-and-scale/_static/image94.png "Clicking next in the Network Mix page")</span></span>

    <span data-ttu-id="d6dbf-675">*Haga clic en siguiente en la página de la combinación de redes*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-675">*Clicking next in the Network Mix page*</span></span>
17. <span data-ttu-id="d6dbf-676">En el **combinación de exploradores** página, seleccione **Internet Explorer 10.0** como el tipo de explorador y haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-676">In the **Browser Mix** page, select **Internet Explorer 10.0** as the browser type and click **Next**.</span></span>

    <span data-ttu-id="d6dbf-677">![Seleccionar el tipo de explorador](maintainable-azure-websites-managing-change-and-scale/_static/image95.png "seleccionando el tipo de explorador")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-677">![Selecting the browser type](maintainable-azure-websites-managing-change-and-scale/_static/image95.png "Selecting the browser type")</span></span>

    <span data-ttu-id="d6dbf-678">*Seleccionar el tipo de explorador*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-678">*Selecting the browser type*</span></span>
18. <span data-ttu-id="d6dbf-679">En el **conjuntos de contadores** página, haga clic en **siguiente**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-679">In the **Counter Sets** page, click **Next**.</span></span>

    <span data-ttu-id="d6dbf-680">![Haga clic en siguiente en la página de conjuntos de contadores](maintainable-azure-websites-managing-change-and-scale/_static/image96.png "al hacer clic en siguiente en la página de conjuntos de contadores")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-680">![Clicking Next in the Counter Sets page](maintainable-azure-websites-managing-change-and-scale/_static/image96.png "Clicking Next in the Counter Sets page")</span></span>

    <span data-ttu-id="d6dbf-681">*Haga clic en siguiente en la página de conjuntos de contadores*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-681">*Clicking Next in the Counter Sets page*</span></span>
19. <span data-ttu-id="d6dbf-682">En el **parámetros de ejecución** , establezca el **duración de la prueba de carga** a **5 minutos** y haga clic en **finalizar**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-682">In the **Run Settings** page, set the **Load test duration** to **5 minutes** and click **Finish**.</span></span>

    <span data-ttu-id="d6dbf-683">![Si la duración de la prueba de carga se establece en 5 minutos](maintainable-azure-websites-managing-change-and-scale/_static/image97.png "si la duración de la prueba de carga se establece en 5 minutos")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-683">![Setting the load test duration to 5 minutes](maintainable-azure-websites-managing-change-and-scale/_static/image97.png "Setting the load test duration to 5 minutes")</span></span>

    <span data-ttu-id="d6dbf-684">*Si la duración de la prueba de carga se establece en 5 minutos*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-684">*Setting the load test duration to 5 minutes*</span></span>
20. <span data-ttu-id="d6dbf-685">En **el Explorador de soluciones**, haga doble clic en el **Local.settings** archivo para explorar la configuración de pruebas.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-685">In **Solution Explorer**, double-click the **Local.settings** file to explore the test settings.</span></span> <span data-ttu-id="d6dbf-686">De forma predeterminada, Visual Studio usa el equipo local para ejecutar las pruebas.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-686">By default, Visual Studio uses your local computer to run the tests.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-687">Como alternativa, puede configurar el proyecto de prueba para ejecutar las pruebas de carga en la nube con **Visual Studio Online (VSO)**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-687">Alternatively, you can configure your test project to run the load tests in the cloud using **Visual Studio Online (VSO)**.</span></span> <span data-ttu-id="d6dbf-688">VSO proporciona una carga en la nube probar servicio que simula una carga más realista, evitando las restricciones del entorno local como la capacidad de CPU, memoria disponible y el ancho de banda de red.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-688">VSO provides a cloud-based load testing service that simulates a more realistic load, avoiding local environment constraints like CPU capacity, available memory and network bandwidth.</span></span> <span data-ttu-id="d6dbf-689">Para obtener más información acerca del uso de VSO para ejecutar pruebas de carga, consulte [este artículo](https://www.visualstudio.com/get-started/load-test-your-app-vs).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-689">For more information about using VSO to run load tests, see [this article](https://www.visualstudio.com/get-started/load-test-your-app-vs).</span></span>

    ![Configuración de pruebas](maintainable-azure-websites-managing-change-and-scale/_static/image98.png)

<a id="Ex5Task3"></a>
#### <a name="task-3--autoscale-verification"></a><span data-ttu-id="d6dbf-691">Tarea 3: comprobación de escalado automático</span><span class="sxs-lookup"><span data-stu-id="d6dbf-691">Task 3 – Autoscale Verification</span></span>

<span data-ttu-id="d6dbf-692">Ahora podrá ejecutar la prueba de carga que creó en la tarea anterior y ver cómo se comporta la aplicación web bajo carga.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-692">You will now execute the load test you created in the previous task and see how your web app behaves under load.</span></span>

1. <span data-ttu-id="d6dbf-693">En **el Explorador de soluciones**, haga doble clic en **LoadTest1.loadtest** para abrir la prueba de carga.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-693">In **Solution Explorer**, double-click **LoadTest1.loadtest** to open the load test.</span></span>

    <span data-ttu-id="d6dbf-694">![Abrir LoadTest1.loadtest](maintainable-azure-websites-managing-change-and-scale/_static/image99.png "abrir LoadTest1.loadtest")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-694">![Opening LoadTest1.loadtest](maintainable-azure-websites-managing-change-and-scale/_static/image99.png "Opening LoadTest1.loadtest")</span></span>

    <span data-ttu-id="d6dbf-695">*LoadTest1.loadtest de apertura*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-695">*Opening LoadTest1.loadtest*</span></span>
2. <span data-ttu-id="d6dbf-696">En el **LoadTest1.loadtest** ventana, haga clic en el primer botón en el cuadro de herramientas para ejecutar la prueba de carga.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-696">In the **LoadTest1.loadtest** window, click the first button in the toolbox to run the load test.</span></span>

    <span data-ttu-id="d6dbf-697">![Ejecuta la prueba de carga](maintainable-azure-websites-managing-change-and-scale/_static/image100.png "ejecuta la prueba de carga")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-697">![Running the load test](maintainable-azure-websites-managing-change-and-scale/_static/image100.png "Running the load test")</span></span>

    <span data-ttu-id="d6dbf-698">*Ejecuta la prueba de carga*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-698">*Running the load test*</span></span>
3. <span data-ttu-id="d6dbf-699">Espere a que finalice la prueba de carga.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-699">Wait until the load test completes.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-700">La prueba de carga simula varios usuarios que envían solicitudes a la aplicación web al mismo tiempo.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-700">The load test simulates multiple users that send requests to the web app simultaneously.</span></span> <span data-ttu-id="d6dbf-701">Cuando se ejecuta la prueba, puede supervisar los contadores disponibles para detectar los errores, advertencias u otra información relacionada con la ejecución de pruebas de carga.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-701">When the test is running, you can monitor the available counters to detect any errors, warnings or other information related to your load test run.</span></span>

    <span data-ttu-id="d6dbf-702">![Ejecución de prueba de carga](maintainable-azure-websites-managing-change-and-scale/_static/image101.png "espera hasta que se complete la prueba de carga")</span><span class="sxs-lookup"><span data-stu-id="d6dbf-702">![Load test running](maintainable-azure-websites-managing-change-and-scale/_static/image101.png "Waiting until the load test completes")</span></span>

    <span data-ttu-id="d6dbf-703">*Ejecuta la prueba de carga*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-703">*Load test running*</span></span>
4. <span data-ttu-id="d6dbf-704">Una vez finalizada la prueba, vuelva al portal de administración y navegue hasta la **escala** página de la aplicación web.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-704">Once the test completes, go back to the management portal and navigate to the **Scale** page of your web app.</span></span> <span data-ttu-id="d6dbf-705">En el **capacidad** sección, debería aparecer en el gráfico que automáticamente se implementó una nueva instancia.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-705">Under the **capacity** section, you should see in the graph that a new instance was automatically deployed.</span></span>

    ![Nueva instancia que se implementan de forma automática](maintainable-azure-websites-managing-change-and-scale/_static/image102.png)

    <span data-ttu-id="d6dbf-707">*Nueva instancia que se implementan de forma automática*</span><span class="sxs-lookup"><span data-stu-id="d6dbf-707">*New instance automatically deployed*</span></span>

    > [!NOTE]
    > <span data-ttu-id="d6dbf-708">Puede tardar varios minutos para que aparezcan en el gráfico de los cambios (presione **CTRL + F5** periódicamente para actualizar la página).</span><span class="sxs-lookup"><span data-stu-id="d6dbf-708">It may take several minutes for the changes to appear in the graph (press **CTRL + F5** periodically to refresh the page).</span></span> <span data-ttu-id="d6dbf-709">Si no ve los cambios, puede intentar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="d6dbf-709">If you do not see any changes, you can try the following:</span></span>
    > 
    > - <span data-ttu-id="d6dbf-710">Aumente la duración de la prueba de carga (por ejemplo, para **10 minutos**)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-710">Increase the duration of the load test (e.g. to **10 minutes**)</span></span>
    > - <span data-ttu-id="d6dbf-711">Reducir los valores máximos y mínimo de la **CPU de destino** intervalo en la configuración de escalado automático de la aplicación web</span><span class="sxs-lookup"><span data-stu-id="d6dbf-711">Reduce the maximum and minimum values of the **Target CPU** range in the Autoscale configuration of your web app</span></span>
    > - <span data-ttu-id="d6dbf-712">Ejecutar la prueba de carga en la nube con **Visual Studio Online**.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-712">Run the load test in the cloud with **Visual Studio Online**.</span></span> <span data-ttu-id="d6dbf-713">Obtener más información [aquí](https://www.visualstudio.com/en-us/get-started/load-test-your-app-vs.aspx)</span><span class="sxs-lookup"><span data-stu-id="d6dbf-713">More information [here](https://www.visualstudio.com/en-us/get-started/load-test-your-app-vs.aspx)</span></span>

* * *

<a id="Summary"></a>
## <a name="summary"></a><span data-ttu-id="d6dbf-714">Resumen</span><span class="sxs-lookup"><span data-stu-id="d6dbf-714">Summary</span></span>

<span data-ttu-id="d6dbf-715">En este laboratorio práctico, aprendió a configurar e implementar la aplicación para aplicaciones web de producción en Azure.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-715">In this hands-on lab, you learned how to set up and deploy your application to production web apps in Azure.</span></span> <span data-ttu-id="d6dbf-716">Se inició mediante la detección y actualizar las bases de datos mediante **Entity Framework Code First Migrations**, a continuación, se sigue implementando las nuevas versiones de su sitio con **Git** y realizar reversiones a la versión estable más reciente del sitio.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-716">You started by detecting and updating your databases using **Entity Framework Code First Migrations**, then continued by deploying new versions of your site using **Git** and performing rollbacks to the latest stable version of your site.</span></span> <span data-ttu-id="d6dbf-717">Además, aprendió cómo escalar una aplicación que use almacenamiento para mover el contenido estático a un contenedor de blobs.</span><span class="sxs-lookup"><span data-stu-id="d6dbf-717">Additionally, you learned how to scale your app using Storage to move your static content to a Blob container.</span></span>
