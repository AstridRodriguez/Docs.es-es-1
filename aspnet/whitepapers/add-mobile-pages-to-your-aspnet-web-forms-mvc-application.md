---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: 'Cómo: Agregar páginas de dispositivos móviles a los formularios de ASP.NET Web / aplicación MVC | Documentos de Microsoft'
author: rick-anderson
description: Este procedimiento se describe varias maneras de servir páginas optimizadas para dispositivos móviles desde los formularios Web Forms de ASP.NET / aplicación de MVC y sugiere arquitectónicos y...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/20/2011
ms.topic: article
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: a8358b91ca424f4f3e576057ab43d850081dda60
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/10/2018
---
<a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="06ca7-103">Cómo: Agregar páginas de dispositivos móviles a los formularios de ASP.NET Web / aplicación de MVC</span><span class="sxs-lookup"><span data-stu-id="06ca7-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>
====================
> <span data-ttu-id="06ca7-104">**Se aplica a**</span><span class="sxs-lookup"><span data-stu-id="06ca7-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="06ca7-105">Versión de formularios Web Forms ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="06ca7-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="06ca7-106">ASP.NET MVC versión 3.0</span><span class="sxs-lookup"><span data-stu-id="06ca7-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="06ca7-107">**Resumen**</span><span class="sxs-lookup"><span data-stu-id="06ca7-107">**Summary**</span></span>
> 
> <span data-ttu-id="06ca7-108">Este procedimiento se describe varias maneras de servir páginas optimizadas para dispositivos móviles desde los formularios Web Forms de ASP.NET / aplicación de MVC y se sugieren arquitectura y diseño cuestiones a considerar cuando se destinan a una amplia gama de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="06ca7-109">Este documento también explica por qué los controles de ASP.NET Mobile de ASP.NET 2.0 a la versión 3.5 están obsoletos y se tratan algunas alternativas modernas.</span><span class="sxs-lookup"><span data-stu-id="06ca7-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>


## <a name="contents"></a><span data-ttu-id="06ca7-110">Contenido</span><span class="sxs-lookup"><span data-stu-id="06ca7-110">Contents</span></span>

- <span data-ttu-id="06ca7-111">Información general</span><span class="sxs-lookup"><span data-stu-id="06ca7-111">Overview</span></span>
- <span data-ttu-id="06ca7-112">Opciones de arquitectura</span><span class="sxs-lookup"><span data-stu-id="06ca7-112">Architectural options</span></span>
- <span data-ttu-id="06ca7-113">Detección de explorador y del dispositivo</span><span class="sxs-lookup"><span data-stu-id="06ca7-113">Browser and device detection</span></span>
- <span data-ttu-id="06ca7-114">Cómo las aplicaciones de formularios Web Forms de ASP.NET pueden presentar páginas específicas de mobile</span><span class="sxs-lookup"><span data-stu-id="06ca7-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="06ca7-115">Cómo las aplicaciones de ASP.NET MVC pueden presentar páginas específicas de mobile</span><span class="sxs-lookup"><span data-stu-id="06ca7-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="06ca7-116">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="06ca7-116">Additional resources</span></span>

<span data-ttu-id="06ca7-117">Para obtener ejemplos de código descargables que muestra las técnicas de este documento para ASP.NET Web Forms y MVC, vea [sitios con ASP.NET y aplicaciones móviles](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="06ca7-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="06ca7-118">Información general</span><span class="sxs-lookup"><span data-stu-id="06ca7-118">Overview</span></span>

<span data-ttu-id="06ca7-119">Dispositivos móviles – smartphones, característica teléfonos y tabletas – continuarán aumentando en popularidad a fin de obtener acceso a la Web.</span><span class="sxs-lookup"><span data-stu-id="06ca7-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="06ca7-120">Para muchos desarrolladores de web y las empresas orientados a web, esto significa que es cada vez más importante proporcionar una buena experiencia de exploración para los visitantes que utilizan los dispositivos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="06ca7-121">Cómo anteriores versiones de exploradores móviles compatibles con ASP.NET</span><span class="sxs-lookup"><span data-stu-id="06ca7-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="06ca7-122">Versiones ASP.NET 2.0 a 3.5 incluye *controles de ASP.NET Mobile*: un conjunto de controles de servidor para dispositivos móviles en el *System.Web.Mobile.dll* ensamblado y el  *En System.Web.UI.MobileControls* espacio de nombres.</span><span class="sxs-lookup"><span data-stu-id="06ca7-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="06ca7-123">El ensamblado aún se incluye en ASP.NET 4, pero está en desuso.</span><span class="sxs-lookup"><span data-stu-id="06ca7-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="06ca7-124">Se recomienda a los desarrolladores para migrar a los enfoques más modernos, tales como los descritos en este documento.</span><span class="sxs-lookup"><span data-stu-id="06ca7-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="06ca7-125">El motivo por qué controles de ASP.NET Mobile se han marcado como obsoleto es que su diseño está orientada a servicios alrededor de los teléfonos móviles que son comunes en 2005 y versiones anteriores.</span><span class="sxs-lookup"><span data-stu-id="06ca7-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="06ca7-126">Los controles están diseñados principalmente para representar el marcado WML o cHTML (en lugar de HTML regular) para los exploradores WAP de ese era.</span><span class="sxs-lookup"><span data-stu-id="06ca7-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="06ca7-127">Pero WAP, WML y cHTML ya no son relevantes para la mayoría de los proyectos, porque HTML se ha convertido en el lenguaje de marcado generalizado para los exploradores de escritorio y móviles similares.</span><span class="sxs-lookup"><span data-stu-id="06ca7-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="06ca7-128">Los desafíos de admitir dispositivos móviles de hoy en día</span><span class="sxs-lookup"><span data-stu-id="06ca7-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="06ca7-129">Aunque los exploradores móviles ahora casi universalmente compatible con HTML, todavía se enfrentará muchos desafíos cuando el objetivo sea para crear excelentes experiencias de exploración móviles:</span><span class="sxs-lookup"><span data-stu-id="06ca7-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="06ca7-130">***Tamaño de la pantalla*** : los dispositivos móviles varían considerablemente en el formulario y sus pantallas suelen ser mucho menor que los monitores de escritorio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="06ca7-131">Por lo tanto, necesitará crear diseños de página completamente distinta para ellos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="06ca7-132">***Métodos de entrada*** : algunos dispositivos tienen teclados, algunas tienen fonocaptores, otros usuarios usan un toque.</span><span class="sxs-lookup"><span data-stu-id="06ca7-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="06ca7-133">Debe tener en cuenta varios casos de navegación de datos y mecanismos de métodos de entrada.</span><span class="sxs-lookup"><span data-stu-id="06ca7-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="06ca7-134">***Cumplimiento de estándares*** – muchos exploradores móviles no son compatibles con los estándares más recientes de HTML, CSS o JavaScript.</span><span class="sxs-lookup"><span data-stu-id="06ca7-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="06ca7-135">***Ancho de banda*** : rendimiento de la red de datos móviles varía significativamente y algunos usuarios finales son en tarifas que cobran según en megabytes.</span><span class="sxs-lookup"><span data-stu-id="06ca7-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="06ca7-136">No hay ninguna solución única; la aplicación tendrá que buscar y comportarse de forma diferente según el dispositivo de tener acceso a ella.</span><span class="sxs-lookup"><span data-stu-id="06ca7-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="06ca7-137">Dependiendo de qué nivel de compatibilidad con dispositivos móvil desea, puede ser un desafío mucho mayor para los desarrolladores web que alguna vez era el escritorio "guerras explorador".</span><span class="sxs-lookup"><span data-stu-id="06ca7-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="06ca7-138">Los desarrolladores llegando al soporte técnico de explorador móvil por primera vez a menudo inicialmente pensar solo es importante admitir los smartphones más sofisticados y más recientes (p. ej., Windows Phone 7, iPhone o Android), quizás porque los programadores a menudo personal poseen como dispositivos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="06ca7-139">Sin embargo, teléfonos más baratos siguen siendo muy populares y sus propietarios usarlos para navegar por la red, especialmente en los países donde teléfonos móviles son más fáciles obtener acceso a una conexión de banda ancha.</span><span class="sxs-lookup"><span data-stu-id="06ca7-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="06ca7-140">Deberá decidir qué variedad de dispositivos para admitir teniendo en cuenta sus clientes es probable que su negocio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="06ca7-141">Si va a compilar un folleto en línea para un spa de mantenimiento de lujo, podría tomar una decisión de negocio solo como destino avanzadas smartphones, mientras que si está creando un sistema de vales de reserva para un cine, probablemente necesitará tener en cuenta para los visitantes con menos eficaz característica teléfonos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="06ca7-142">Opciones de arquitectura</span><span class="sxs-lookup"><span data-stu-id="06ca7-142">Architectural options</span></span>

<span data-ttu-id="06ca7-143">Antes de entrar en los detalles técnicos específicos de formularios Web Forms de ASP.NET o MVC, tenga en cuenta que los desarrolladores web por lo general tienen tres opciones posibles principales para admitir exploradores móviles:</span><span class="sxs-lookup"><span data-stu-id="06ca7-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="06ca7-144">***No hacer nada:*** simplemente puede crear una aplicación web estándar, orientada a servicios de escritorio y se basan en exploradores móviles para representar un rendimiento aceptable.</span><span class="sxs-lookup"><span data-stu-id="06ca7-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="06ca7-145">**Ventaja**: es la opción más barata para implementar y mantener: extra ya no funcionan</span><span class="sxs-lookup"><span data-stu-id="06ca7-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="06ca7-146">**Desventaja**: proporciona la experiencia del usuario final peor:</span><span class="sxs-lookup"><span data-stu-id="06ca7-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="06ca7-147">Los smartphones más recientes puede provocar que el código HTML tan válido como un explorador de escritorio, pero todavía se verán obligados a los usuarios para aplicar zoom y desplazarse horizontalmente y verticalmente para consumir el contenido Web en una pantalla pequeña.</span><span class="sxs-lookup"><span data-stu-id="06ca7-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="06ca7-148">Esto está muy alejado del óptimo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-148">This is far from optimal.</span></span>
        - <span data-ttu-id="06ca7-149">Los dispositivos más antiguos y los teléfonos de función pueden producir un error al representar el marcado de forma satisfactoria.</span><span class="sxs-lookup"><span data-stu-id="06ca7-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="06ca7-150">Incluso en los dispositivos de tableta más recientes (cuyas pantallas pueden ser tan grandes como las pantallas de portátil), se aplican reglas diferentes interacción.</span><span class="sxs-lookup"><span data-stu-id="06ca7-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="06ca7-151">Entrada basada en táctil funciona mejor con botones más grandes y vincula spread más alejado, y no hay ninguna manera de mantener un cursor del mouse sobre un menú emergente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="06ca7-152">***Resolver el problema en el cliente* :** con cuidado de uso de CSS y [mejora progresiva](http://en.wikipedia.org/wiki/Progressive_enhancement) puede crear marcado, estilos y scripts que se adapten a cualquier explorador está ejecutando.</span><span class="sxs-lookup"><span data-stu-id="06ca7-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="06ca7-153">Por ejemplo, con [consultas de medios de CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), puede crear un diseño de varias columna que se convertirá en un diseño de columna única en los dispositivos cuyas pantallas son más estrechas que un umbral seleccionado.</span><span class="sxs-lookup"><span data-stu-id="06ca7-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="06ca7-154">**Ventaja**: optimiza la representación para el dispositivo específico en uso, incluso para futuros dispositivos desconocidos según cualquier pantalla y los datos de entrada características tienen</span><span class="sxs-lookup"><span data-stu-id="06ca7-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="06ca7-155">**Ventaja**: fácilmente le permite compartir la lógica de servidor a través de todos los tipos de dispositivo mínima duplicación de código o el esfuerzo</span><span class="sxs-lookup"><span data-stu-id="06ca7-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="06ca7-156">**Desventaja**: los dispositivos móviles son tan diferentes de dispositivos de escritorio que realmente puede desea que las páginas móviles sea completamente diferente de las páginas de escritorio, que muestra una información diferente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="06ca7-157">Estas variaciones pueden ser ineficaces o imposibles de conseguir Fortalezca de forma a través de CSS por sí sola, especialmente teniendo en cuenta cómo forma incoherente los dispositivos más antiguos interpretan las reglas de CSS.</span><span class="sxs-lookup"><span data-stu-id="06ca7-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="06ca7-158">Esto es especialmente cierto de atributos CSS 3.</span><span class="sxs-lookup"><span data-stu-id="06ca7-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="06ca7-159">**Desventaja**: no proporciona compatibilidad con distintos lógica de servidor y los flujos de trabajo para diferentes dispositivos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="06ca7-160">Por ejemplo, no es posible, implementar una simplificada compra carro desprotección flujo de trabajo de usuarios móviles por medio de CSS por sí sola.</span><span class="sxs-lookup"><span data-stu-id="06ca7-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="06ca7-161">**Desventaja**: uso de ancho de banda ineficaz.</span><span class="sxs-lookup"><span data-stu-id="06ca7-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="06ca7-162">Es posible que el servidor deba transmitir el marcado y los estilos que se aplican a todos los dispositivos posibles, aunque el dispositivo de destino sólo utilizará un subconjunto de dicha información.</span><span class="sxs-lookup"><span data-stu-id="06ca7-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="06ca7-163">***Solucionar el problema en el servidor* :** si el servidor sabe cuál es el dispositivo tiene acceso a ella, o al menos las características de dichos dispositivos, como el tamaño de la pantalla y el método de entrada, y si es un dispositivo móvil: se puede ejecutar una lógica diferente y marcado HTML diferente de salida.</span><span class="sxs-lookup"><span data-stu-id="06ca7-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="06ca7-164">**Ventaja:** flexibilidad máxima.</span><span class="sxs-lookup"><span data-stu-id="06ca7-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="06ca7-165">No hay ningún límite en cuanto al cuánto puede variar la lógica del lado del servidor para dispositivos móviles u optimizar el marcado para el diseño deseado, específicos del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="06ca7-166">**Ventaja:** uso eficaz del ancho de banda.</span><span class="sxs-lookup"><span data-stu-id="06ca7-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="06ca7-167">Solo necesita transmitir el marcado y la información de estilo que el dispositivo de destino se va a usar.</span><span class="sxs-lookup"><span data-stu-id="06ca7-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="06ca7-168">**Inconvenientes:** en ocasiones fuerza la repetición del trabajo o el código (por ejemplo, lo que crea copias similares pero ligeramente distintos de las páginas de formularios Web Forms o las vistas MVC).</span><span class="sxs-lookup"><span data-stu-id="06ca7-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="06ca7-169">Donde sea posible que repercutirán comunes lógica de cierre en una capa subyacente o servicio, pero aún así, algunas partes del código de interfaz de usuario o de marcado puede tener duplicados y, a continuación, se mantiene en paralelo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="06ca7-170">**Inconvenientes:** detección del dispositivo no es trivial.</span><span class="sxs-lookup"><span data-stu-id="06ca7-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="06ca7-171">Se requiere una lista o una base de datos de tipos de dispositivos conocidos y sus características (que no sea siempre perfectamente actualizadas) y garantiza que no coincidan exactamente con cada solicitud entrante.</span><span class="sxs-lookup"><span data-stu-id="06ca7-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="06ca7-172">Este documento describe algunas opciones y los riesgos más adelante.</span><span class="sxs-lookup"><span data-stu-id="06ca7-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="06ca7-173">Para obtener los mejores resultados, la mayoría de los desarrolladores encuentran que necesitan para combinar opciones (2) y (3).</span><span class="sxs-lookup"><span data-stu-id="06ca7-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="06ca7-174">Pequeñas diferencias de estilos se implementan mejor en el cliente mediante CSS o JavaScript incluso, mientras que las principales diferencias en datos, flujo de trabajo o marcado más eficazmente se implementa en el código de servidor.</span><span class="sxs-lookup"><span data-stu-id="06ca7-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="06ca7-175">Este documento se centra en las técnicas de servidor</span><span class="sxs-lookup"><span data-stu-id="06ca7-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="06ca7-176">Puesto que ASP.NET Web Forms y MVC son ambas tecnologías principalmente en el servidor, estas notas del producto se centrarán en las técnicas de servidor que le permiten generar un marcado diferente y la lógica para los exploradores móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="06ca7-177">Por supuesto, también puede combinar esto con cualquier técnica de cliente (p. ej., CSS 3 consultas de medios, mejora progresiva JavaScript), pero es más una cuestión de diseño web de desarrollo de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="06ca7-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="06ca7-178">Detección de explorador y del dispositivo</span><span class="sxs-lookup"><span data-stu-id="06ca7-178">Browser and device detection</span></span>

<span data-ttu-id="06ca7-179">El requisito previo de clave para todas las técnicas de servidor para admitir dispositivos móviles consiste en conocer cuál es el dispositivo está usando el visitante.</span><span class="sxs-lookup"><span data-stu-id="06ca7-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="06ca7-180">De hecho, incluso mejor que conocer el número de fabricante y modelo de dichos dispositivos es saber la *características* del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="06ca7-181">Pueden incluir características:</span><span class="sxs-lookup"><span data-stu-id="06ca7-181">Characteristics may include:</span></span>

- <span data-ttu-id="06ca7-182">¿Es un dispositivo móvil?</span><span class="sxs-lookup"><span data-stu-id="06ca7-182">Is it a mobile device?</span></span>
- <span data-ttu-id="06ca7-183">Método de entrada (mouse, teclado, táctil, teclado, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="06ca7-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="06ca7-184">Tamaño de la pantalla (físicamente y en píxeles)</span><span class="sxs-lookup"><span data-stu-id="06ca7-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="06ca7-185">Formatos admitidos de medios y los datos</span><span class="sxs-lookup"><span data-stu-id="06ca7-185">Supported media and data formats</span></span>
- <span data-ttu-id="06ca7-186">Etc.</span><span class="sxs-lookup"><span data-stu-id="06ca7-186">Etc.</span></span>

<span data-ttu-id="06ca7-187">Es mejor tomar decisiones basadas en características que el número de modelo, ya que, a continuación, estará mejor preparado para controlar futuros dispositivos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="06ca7-188">Uso de ASP. Compatibilidad con la detección de red explorador integrado</span><span class="sxs-lookup"><span data-stu-id="06ca7-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="06ca7-189">Los desarrolladores de formularios Web Forms ASP.NET y MVC inmediatamente pueden detectar características importantes de un explorador visitando mediante la inspección de propiedades de la *Request.Browser* objeto.</span><span class="sxs-lookup"><span data-stu-id="06ca7-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="06ca7-190">Por ejemplo, vea</span><span class="sxs-lookup"><span data-stu-id="06ca7-190">For example, see</span></span>

- <span data-ttu-id="06ca7-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="06ca7-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="06ca7-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="06ca7-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="06ca7-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="06ca7-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="06ca7-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="06ca7-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="06ca7-195">...y muchos otros</span><span class="sxs-lookup"><span data-stu-id="06ca7-195">…and many others</span></span>

<span data-ttu-id="06ca7-196">En segundo plano, la plataforma ASP.NET coincide con la entrada *User-Agent* encabezado HTTP (UAC) con expresiones regulares en un conjunto de archivos XML de definición de explorador.</span><span class="sxs-lookup"><span data-stu-id="06ca7-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="06ca7-197">De forma predeterminada, la plataforma incluye definiciones para varios dispositivos móviles comunes, y puede agregar archivos de definición de explorador personalizados para que otros usuarios que se va a reconocer.</span><span class="sxs-lookup"><span data-stu-id="06ca7-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="06ca7-198">Para obtener más información, vea la página MSDN [controles de servidor Web de ASP.NET y las funciones del explorador](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="06ca7-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="06ca7-199">Uso de la base de datos del dispositivo WURFL a través de 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="06ca7-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="06ca7-200">Mientras que ASP. Compatibilidad con la detección de explorador integrado del NET será suficiente para muchas aplicaciones, hay dos casos principales que quizás no sea suficiente:</span><span class="sxs-lookup"><span data-stu-id="06ca7-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="06ca7-201">***Desea reconocer los dispositivos más recientes***(sin necesidad de crear manualmente los archivos de definición de explorador para ellos).</span><span class="sxs-lookup"><span data-stu-id="06ca7-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="06ca7-202">Tenga en cuenta que los archivos de definición de explorador del 4 de .NET no son suficientemente recientes como para reconocer iPad de Apple, teléfonos Android, exploradores Opera Mobile o Windows Phone 7.</span><span class="sxs-lookup"><span data-stu-id="06ca7-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="06ca7-203">***Se necesita información más detallada sobre las capacidades del dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="06ca7-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="06ca7-204">Puede que necesite saber acerca de métodos de entrada de un dispositivo (por ejemplo, el teclado de vs táctil) o el audio formatea el explorador admite.</span><span class="sxs-lookup"><span data-stu-id="06ca7-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="06ca7-205">Esta información no está disponible en los archivos de definición de explorador estándar.</span><span class="sxs-lookup"><span data-stu-id="06ca7-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="06ca7-206">El [ *archivo de recursos Universal Wireless* proyecto (WURFL)](http://wurfl.sourceforge.net/) mantiene mucho más actualizada y detallada información sobre dispositivos móviles en uso actualmente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="06ca7-207">Lo bueno para los desarrolladores de .NET es que ASP. Característica de detección de explorador del NET es extensible, por lo que es posible mejorar para solucionar estos problemas.</span><span class="sxs-lookup"><span data-stu-id="06ca7-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="06ca7-208">Por ejemplo, puede agregar el código abierto [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) biblioteca al proyecto.</span><span class="sxs-lookup"><span data-stu-id="06ca7-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="06ca7-209">Es un IHttpModule de ASP.NET o un explorador capacidades de proveedor (se puede usar en aplicaciones de formularios Web Forms y MVC), que lee los datos WURFL directamente y lo enlaza en ASP. Mecanismo de detección de explorador integrado del NET.</span><span class="sxs-lookup"><span data-stu-id="06ca7-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="06ca7-210">Una vez haya instalado el módulo, *Request.Browser* repentinamente contendrá información mucho más precisa y detallada: correctamente reconocerá muchos de los dispositivos que se ha mencionado previamente y se lista sus capacidades (incluidos funcionalidades adicionales como método de entrada).</span><span class="sxs-lookup"><span data-stu-id="06ca7-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="06ca7-211">Consulte la documentación del proyecto para obtener más detalles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="06ca7-212">Cómo las aplicaciones de formularios Web Forms pueden presentar páginas específicas de mobile</span><span class="sxs-lookup"><span data-stu-id="06ca7-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="06ca7-213">De forma predeterminada, mostramos cómo muestra una nueva aplicación de formularios Web Forms en dispositivos móviles comunes:</span><span class="sxs-lookup"><span data-stu-id="06ca7-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="06ca7-214">Claramente, ni diseño parece muy preparado para dispositivos móviles: esta página se diseñó para un monitor grande, orientados a horizontal, no para una pantalla pequeña orientación vertical.</span><span class="sxs-lookup"><span data-stu-id="06ca7-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="06ca7-215">¿Qué puede hacer sobre él?</span><span class="sxs-lookup"><span data-stu-id="06ca7-215">So what can you do about it?</span></span>

<span data-ttu-id="06ca7-216">Según lo descrito anteriormente en este documento, hay muchas maneras de personalizar las páginas para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="06ca7-217">Algunas técnicas se basan en el servidor, otros ejecutan en el cliente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="06ca7-218">Crear una página maestra específica para equipos móviles</span><span class="sxs-lookup"><span data-stu-id="06ca7-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="06ca7-219">Según sus requisitos, es posible que pueda usar los mismos formularios Web para todos los visitantes, pero tener instalados dos páginas maestras: uno para los visitantes del escritorio y otro para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="06ca7-220">Esto le da la flexibilidad de cambiar el nivel superior marcado HTML para adaptarlo a dispositivos móviles, sin necesidad de duplicar cualquier lógica de la página o la hoja de estilos CSS.</span><span class="sxs-lookup"><span data-stu-id="06ca7-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="06ca7-221">Esto es muy fácil de hacer.</span><span class="sxs-lookup"><span data-stu-id="06ca7-221">This is easy to do.</span></span> <span data-ttu-id="06ca7-222">Por ejemplo, puede agregar un controlador de PreInit como el siguiente a un formulario Web:</span><span class="sxs-lookup"><span data-stu-id="06ca7-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="06ca7-223">Ahora, cree una página maestra denominada Mobile.Master en la carpeta de nivel superior de la aplicación y se usará cuando se detecta un dispositivo móvil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="06ca7-224">La página maestra móvil puede hacer referencia a una hoja de estilos CSS específica para equipos móviles si es necesario.</span><span class="sxs-lookup"><span data-stu-id="06ca7-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="06ca7-225">Los visitantes del escritorio seguirán viendo la página maestra predeterminada, no lo móvil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="06ca7-226">Crear independientes de formularios Web Forms móviles específica</span><span class="sxs-lookup"><span data-stu-id="06ca7-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="06ca7-227">Para obtener la máxima flexibilidad, puede ir mucho más allá del hecho de tener diferentes páginas maestras para distintos tipos de dispositivos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="06ca7-228">Puede implementar dos *totalmente separar conjuntos de páginas de formularios Web Forms* : uno establecido para los exploradores de escritorio, otro conjunto para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="06ca7-229">Esto funciona mejor si desea presentar información muy diferente o flujos de trabajo a los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="06ca7-230">El resto de esta sección describe este enfoque en detalle.</span><span class="sxs-lookup"><span data-stu-id="06ca7-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="06ca7-231">Suponiendo que ya tenga una aplicación de formularios Web Forms diseñada para los exploradores de escritorio, la manera más fácil para continuar es crear una subcarpeta denominada "Móvil" dentro del proyecto y crear páginas móviles no existe.</span><span class="sxs-lookup"><span data-stu-id="06ca7-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="06ca7-232">Puede crear todo un sitio secundario, con su propio páginas maestras, las hojas de estilos y páginas, utilizando las mismas técnicas que le gustaría usar para ninguna otra aplicación de formularios Web Forms.</span><span class="sxs-lookup"><span data-stu-id="06ca7-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="06ca7-233">No es necesario generar un equivalente para móviles *cada* página en el sitio de escritorio; puede elegir qué subconjunto de funcionalidad que tenga sentido para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="06ca7-234">Las páginas móviles pueden compartir recursos estáticos comunes (como imágenes, JavaScript o CSS archivos) con las páginas normales si lo desea.</span><span class="sxs-lookup"><span data-stu-id="06ca7-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="06ca7-235">Puesto que la carpeta "Móvil" le *no* marcarse como una aplicación independiente cuando se hospeda en IIS (es simplemente una subcarpeta simple de páginas de formularios Web Forms), también compartirán las mismas configuración, los datos de sesión y otras infraestructuras como los páginas de escritorio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="06ca7-236">Puesto que este enfoque normalmente implica algunos duplicación de código (páginas de dispositivos móviles están probable que comparten algunas similitudes con páginas de escritorio), es importante factor cualquier comunes business lógica o datos de acceso a código en una capa subyacente compartida o un servicio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="06ca7-237">En caso contrario, deberá doble el esfuerzo de la creación y mantenimiento de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="06ca7-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>


#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="06ca7-238">Redireccionar a los visitantes móviles a las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="06ca7-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="06ca7-239">A menudo resulta cómodo redirigir los visitantes móviles a las páginas móviles sólo en el *primer* en su sesión de exploración (y no en todas las solicitudes en su sesión), una solicitud porque:</span><span class="sxs-lookup"><span data-stu-id="06ca7-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="06ca7-240">Fácilmente, a continuación, puede permitir que los visitantes móviles tener acceso a las páginas de escritorio si lo desean, simplemente ha colocado un vínculo en la página maestra que se va a "Versión de escritorio".</span><span class="sxs-lookup"><span data-stu-id="06ca7-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="06ca7-241">El visitante no se redirige a una página móvil, porque ya no es la primera solicitud en su sesión.</span><span class="sxs-lookup"><span data-stu-id="06ca7-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="06ca7-242">Evita el riesgo de interferir con las solicitudes para cualquier recurso dinámico compartido entre las partes de escritorio y móviles de su sitio (por ejemplo, si tiene un formulario Web Forms comunes que partes de escritorio y móviles de su sitio se muestran en un IFRAME, así como ciertos controladores de Ajax)</span><span class="sxs-lookup"><span data-stu-id="06ca7-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="06ca7-243">Para ello, puede colocar la lógica de redirección en una **sesión\_iniciar** método.</span><span class="sxs-lookup"><span data-stu-id="06ca7-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="06ca7-244">Por ejemplo, agregue el método siguiente al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="06ca7-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="06ca7-245">Configurar la autenticación de formularios para respetar las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="06ca7-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="06ca7-246">Tenga en cuenta que la autenticación de formularios hace ciertas suposiciones sobre dónde puede redirigir a los visitantes durante y después del proceso de autenticación:</span><span class="sxs-lookup"><span data-stu-id="06ca7-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="06ca7-247">Cuando un usuario necesita autenticarse, autenticación de formularios se redirigirá a la página de inicio de sesión de escritorio, independientemente de si un usuario de escritorio o portátil (porque solo tiene un concepto de *una* dirección URL de inicio de sesión).</span><span class="sxs-lookup"><span data-stu-id="06ca7-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="06ca7-248">Suponiendo que desea aplicar el estilo de la página de inicio de sesión móvil diferente, debe mejorar su página de inicio de sesión de escritorio para que los usuarios móviles redirige a una página de inicio de sesión móvil independiente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="06ca7-249">Por ejemplo, agregue el código siguiente a su **desktop** código de página de inicio de sesión en segundo plano:</span><span class="sxs-lookup"><span data-stu-id="06ca7-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="06ca7-250">Después de que un usuario inicia sesión correctamente, la autenticación de formularios de forma predeterminada redirigirá a la página principal del escritorio (porque solo tiene un concepto de *una* página predeterminada).</span><span class="sxs-lookup"><span data-stu-id="06ca7-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="06ca7-251">Necesario mejorar su página de inicio de sesión móvil para que redirige a la página principal de mobile después de un registro correcto.</span><span class="sxs-lookup"><span data-stu-id="06ca7-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="06ca7-252">Por ejemplo, agregue el código siguiente a su **móvil** código de página de inicio de sesión en segundo plano:</span><span class="sxs-lookup"><span data-stu-id="06ca7-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="06ca7-253">Este código supone que la página tiene un control de servidor de inicio de sesión llamado LoginUser, como se muestra en la plantilla de proyecto de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="06ca7-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="06ca7-254">Trabajar con la caché de resultados</span><span class="sxs-lookup"><span data-stu-id="06ca7-254">Working with Output Caching</span></span>

<span data-ttu-id="06ca7-255">Si está usando la caché de resultados, tenga en cuenta que de forma predeterminada, es posible que un usuario de escritorio visitar una ciertas URL (lo que provoca la salida se almacene en caché), seguido por un usuario móvil que, a continuación, recibe la salida almacenada en caché de escritorio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="06ca7-256">Esta advertencia se aplica si solo está varía la página maestra por tipo de dispositivo, o implementar totalmente independiente formularios Web Forms por tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="06ca7-257">Para evitar el problema, puede indicar a ASP.NET para modificar la entrada de caché según si el visitante usa un dispositivo móvil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="06ca7-258">Agregue un parámetro VaryByCustom a la declaración de directiva OutputCache de la página de la manera siguiente:</span><span class="sxs-lookup"><span data-stu-id="06ca7-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="06ca7-259">A continuación, defina *isMobileDevice* como una memoria caché personalizada invalidar parámetro agregando el siguiente método al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="06ca7-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="06ca7-260">Esto garantizará que los visitantes móviles a la página no reciben el resultado guardado previamente en la memoria caché un visitante de escritorio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="06ca7-261">Obtener un ejemplo funcional</span><span class="sxs-lookup"><span data-stu-id="06ca7-261">A working example</span></span>

<span data-ttu-id="06ca7-262">Para ver estas técnicas en acción, descargue [ejemplos de código del este documento](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="06ca7-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="06ca7-263">La aplicación de ejemplo de formularios Web Forms redirige automáticamente los usuarios móviles a un conjunto de páginas móviles específicos en una subcarpeta denominada Mobile.</span><span class="sxs-lookup"><span data-stu-id="06ca7-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="06ca7-264">El marcado y un estilo de esas páginas se optimizan mejor para los exploradores móviles, como puede ver en las siguientes capturas de pantalla:</span><span class="sxs-lookup"><span data-stu-id="06ca7-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="06ca7-265">Para obtener más sugerencias sobre cómo optimizar el marcado y CSS para los exploradores móviles, consulte la sección "Aplicación de estilos móviles páginas para los exploradores móviles" más adelante en este documento.</span><span class="sxs-lookup"><span data-stu-id="06ca7-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="06ca7-266">Cómo las aplicaciones de ASP.NET MVC pueden presentar páginas específicas de mobile</span><span class="sxs-lookup"><span data-stu-id="06ca7-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="06ca7-267">Puesto que el modelo Model-View-Controller separa la lógica de la aplicación (en los controladores) desde la lógica de presentación (en las vistas), puede elegir desde cualquiera de los métodos siguientes para controlar la compatibilidad con dispositivos móvil en el código de servidor:</span><span class="sxs-lookup"><span data-stu-id="06ca7-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="06ca7-268">***Usar los mismos controladores y vistas para los exploradores de escritorio y móviles, pero representar las vistas con distintos diseños de Razor según el tipo de dispositivo *.**</span><span class="sxs-lookup"><span data-stu-id="06ca7-268">***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type*.**</span></span> <span data-ttu-id="06ca7-269">Esta opción funciona mejor si muestra datos idénticos en todos los dispositivos, pero simplemente desee proporcionar diferentes hojas de estilos CSS o cambiar algunos elementos HTML de nivel superior para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="06ca7-270">***Usar los mismos controladores para los exploradores de escritorio y móviles, pero presentar vistas distintas según el tipo de dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="06ca7-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="06ca7-271">Esta opción funciona mejor si se está mostrando aproximadamente los mismos datos y proporcionar los mismos flujos de trabajo para los usuarios finales, pero desea presentar HTML muy diferente para satisfacer el dispositivo que se va a usar.</span><span class="sxs-lookup"><span data-stu-id="06ca7-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="06ca7-272">***Crear áreas bien diferenciadas para los exploradores de escritorio y móviles, implementar controladores independientes y vistas para cada *.**</span><span class="sxs-lookup"><span data-stu-id="06ca7-272">***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each*.**</span></span> <span data-ttu-id="06ca7-273">Esta opción funciona mejor si está mostrar pantallas muy diferentes, que contiene información diferente y a la izquierda al usuario a través de diferentes flujos de trabajo optimizada para su tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="06ca7-274">Puede significar algunos repetición del código, pero puede minimizarlo factorización lógica común en una capa o un servicio subyacente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="06ca7-275">Si desea trasladar el **primer** opción y variar el diseño de Razor sólo por tipo de dispositivo, es muy fácil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="06ca7-276">Sólo tiene que modificar su \_ViewStart.cshtml de archivos como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="06ca7-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="06ca7-277">Ahora puede crear un diseño específico de mobile denominado \_LayoutMobile.cshtml con una estructura de página y CSS reglas optimizada para dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="06ca7-278">Si desea trasladar el **segundo** opción totalmente diferentes vistas de presentación según el tipo de dispositivo del visitante, consulte [entrada de blog de Scott Hanselman](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="06ca7-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="06ca7-279">El resto de este documento se centra en la **tercer** opción: crear controladores separados *y* vistas para dispositivos móviles: para poder controlar exactamente qué subconjunto de funcionalidad se ofrece para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="06ca7-280">Configuración de un área móvil dentro de la aplicación de ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="06ca7-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="06ca7-281">Puede agregar un área denominada "Móvil" para una aplicación de MVC de ASP.NET existente en la forma normal: haga doble clic en el nombre del proyecto en el Explorador de soluciones y después elija Agregar à área.</span><span class="sxs-lookup"><span data-stu-id="06ca7-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="06ca7-282">A continuación, puede agregar controladores y vistas como lo haría con cualquier otra área dentro de una aplicación de ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="06ca7-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="06ca7-283">Por ejemplo, agregar a su área móvil un nuevo controlador denominado HomeController para actuar como una página de inicio para los visitantes móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="06ca7-284">Garantizar la dirección URL /Mobile llega a la página principal de mobile</span><span class="sxs-lookup"><span data-stu-id="06ca7-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="06ca7-285">Si desea que la dirección URL /Mobile para llegar a la acción del índice en HomeController dentro de su área móvil, debe realizar dos pequeños cambios en la configuración de enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="06ca7-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="06ca7-286">En primer lugar, actualice la clase MobileAreaRegistration para que HomeController el controlador predeterminado en el área de dispositivos móvil, como se muestra en el código siguiente:</span><span class="sxs-lookup"><span data-stu-id="06ca7-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="06ca7-287">Esto significa la página principal de mobile ahora se ubicarán en /Mobile, en lugar de/Mobile/principal, ya que "Inicio" es ahora la implícitamente predeterminado nombre del controlador de páginas de dispositivos móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="06ca7-288">A continuación, tenga en cuenta que al agregar un segundo HomeController a su aplicación (es decir, la móviles, además de escritorio uno existente), habrá divide la página principal del escritorio normal.</span><span class="sxs-lookup"><span data-stu-id="06ca7-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="06ca7-289">Se producirá un error con el error "*se han encontrado varios tipos que coinciden con el controlador denominado 'Inicio'*".</span><span class="sxs-lookup"><span data-stu-id="06ca7-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="06ca7-290">Para resolver este problema, actualice la configuración de enrutamiento de nivel superior (en Global.asax.cs) para especificar que el escritorio HomeController debería tener prioridad cuando hay ambigüedad:</span><span class="sxs-lookup"><span data-stu-id="06ca7-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="06ca7-291">Ahora el error irá ubicación y la dirección URL http://<em>su sitio</em>/ llegará a la página principal de escritorio y http://<em>su sitio</em>/mobile/ llegará a la página principal de mobile.</span><span class="sxs-lookup"><span data-stu-id="06ca7-291">Now the error will go away, and the URL http://<em>yoursite</em>/ will reach the desktop homepage, and http://<em>yoursite</em>/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="06ca7-292">Redireccionar a los visitantes móviles a su área móvil</span><span class="sxs-lookup"><span data-stu-id="06ca7-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="06ca7-293">Hay muchos puntos de extensibilidad distintas en ASP.NET MVC, por lo que hay muchas maneras posibles de inyectar lógica de redirección.</span><span class="sxs-lookup"><span data-stu-id="06ca7-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="06ca7-294">Una opción ordenada consiste en crear un atributo de filtro, [RedirectMobileDevicesToMobileArea], que realiza un redireccionamiento si se cumplen las condiciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="06ca7-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="06ca7-295">Es la primera solicitud en la sesión del usuario (es decir, Session.IsNewSession es igual a true)</span><span class="sxs-lookup"><span data-stu-id="06ca7-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="06ca7-296">La solicitud proviene de un explorador móvil (por ejemplo, Request.Browser.IsMobileDevice es igual a true)</span><span class="sxs-lookup"><span data-stu-id="06ca7-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="06ca7-297">El usuario ya no solicita un recurso en el área de dispositivos móvil (es decir, el *ruta de acceso* parte de la dirección URL no comienza con /Mobile)</span><span class="sxs-lookup"><span data-stu-id="06ca7-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="06ca7-298">El ejemplo descargable incluido con este documento incluye una implementación de esta lógica.</span><span class="sxs-lookup"><span data-stu-id="06ca7-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="06ca7-299">Se implementa como un filtro de autorización, derivado de AuthorizeAttribute, lo que significa que pueda funcionar correctamente incluso si está utilizando el almacenamiento en caché de salida (en caso contrario, si un visitante escritorio primera accede a una determinada dirección URL, la salida de escritorio podría se almacena en caché y, a continuación, se envía al visitantes móviles posteriores).</span><span class="sxs-lookup"><span data-stu-id="06ca7-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="06ca7-300">Ya que es un filtro, puede elegir cualquiera para aplicarlo a determinados controladores y acciones, por ejemplo,</span><span class="sxs-lookup"><span data-stu-id="06ca7-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="06ca7-301">…</span><span class="sxs-lookup"><span data-stu-id="06ca7-301">…</span></span> <span data-ttu-id="06ca7-302">o puede aplicarla a todos los controladores y acciones como un MVC 3 *filtros globales* en el archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="06ca7-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="06ca7-303">El ejemplo descargable muestra también cómo puede crear subclases de este atributo que redirección a ubicaciones concretas dentro del área objeto móvil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="06ca7-304">Esto significa, por ejemplo, que puede:</span><span class="sxs-lookup"><span data-stu-id="06ca7-304">This means, for example, you can:</span></span>

- <span data-ttu-id="06ca7-305">Registrar un filtro global tal como se muestra arriba que envía los visitantes móviles a la página principal móvil de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="06ca7-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="06ca7-306">Aplicar un filtro [RedirectMobileDevicesToMobileProductPage] especial a una acción de "producto vista" que toma los visitantes móviles a la versión móvil de cualquier página del producto que haya solicitado.</span><span class="sxs-lookup"><span data-stu-id="06ca7-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="06ca7-307">También se aplican otras subclases especial del filtro para realizar determinadas acciones, redirigir los visitantes móviles a la página móvil equivalente</span><span class="sxs-lookup"><span data-stu-id="06ca7-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="06ca7-308">Configurar la autenticación de formularios para respetar las páginas móviles</span><span class="sxs-lookup"><span data-stu-id="06ca7-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="06ca7-309">Si utiliza la autenticación de formularios, debe tener en cuenta que cuando un usuario necesita iniciar sesión, redirige automáticamente al usuario a una sola "iniciar sesión" dirección URL específica, cuyo valor predeterminado es **/Account/inicio de sesión**.</span><span class="sxs-lookup"><span data-stu-id="06ca7-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="06ca7-310">Esto significa que los usuarios móviles se le redirige a la acción de escritorio "iniciar sesión".</span><span class="sxs-lookup"><span data-stu-id="06ca7-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="06ca7-311">Para evitar este problema, agregue lógica a la acción "iniciar sesión" del escritorio para que los usuarios móviles redirige de nuevo a una acción de "iniciar sesión" móviles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="06ca7-312">Si usa el valor predeterminado de plantilla de aplicación de ASP.NET MVC, actualice acción de inicio de sesión del AccountController como sigue:</span><span class="sxs-lookup"><span data-stu-id="06ca7-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="06ca7-313">…</span><span class="sxs-lookup"><span data-stu-id="06ca7-313">…</span></span> <span data-ttu-id="06ca7-314">y, a continuación, implementar una acción de "iniciar sesión" específica para equipos móviles adecuado en un controlador denominado AccountController en su área móvil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="06ca7-315">Trabajar con la caché de resultados</span><span class="sxs-lookup"><span data-stu-id="06ca7-315">Working with Output Caching</span></span>

<span data-ttu-id="06ca7-316">Si usa el filtro [OutputCache], debe forzar la entrada de caché que varían según el tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="06ca7-317">Por ejemplo, escriba:</span><span class="sxs-lookup"><span data-stu-id="06ca7-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="06ca7-318">A continuación, agregue el método siguiente al archivo Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="06ca7-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="06ca7-319">Esto garantizará que los visitantes móviles a la página no reciben el resultado guardado previamente en la memoria caché un visitante de escritorio.</span><span class="sxs-lookup"><span data-stu-id="06ca7-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="06ca7-320">Obtener un ejemplo funcional</span><span class="sxs-lookup"><span data-stu-id="06ca7-320">A working example</span></span>

<span data-ttu-id="06ca7-321">Para ver estas técnicas en acción, descargue [código del este documento asociado ejemplos](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="06ca7-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="06ca7-322">El ejemplo incluye una aplicación de ASP.NET MVC 3 (Release Candidate) ha mejorado para admitir dispositivos móviles mediante los métodos descritos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="06ca7-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="06ca7-323">Obtener más orientación y sugerencias</span><span class="sxs-lookup"><span data-stu-id="06ca7-323">Further guidance and suggestions</span></span>

<span data-ttu-id="06ca7-324">La explicación siguiente se aplica tanto a los formularios Web Forms y los desarrolladores MVC que están utilizando las técnicas descritas en este documento.</span><span class="sxs-lookup"><span data-stu-id="06ca7-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="06ca7-325">Mejorar su lógica de redirección mediante 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="06ca7-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="06ca7-326">La lógica de redirección que se muestra en este documento puede ser perfectamente suficiente para la aplicación, pero no funcionará si tiene que deshabilitar las sesiones, o con los exploradores móviles que rechazan cookies (estos no pueden tener las sesiones), ya que no sabe si una solicitud determinada es la primera de ellas desde ese visitante.</span><span class="sxs-lookup"><span data-stu-id="06ca7-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="06ca7-327">Ya ha aprendido cómo el 51Degrees.mobi de código abierto Foundation puede mejorar la precisión de ASP. Detección del explorador de NET.</span><span class="sxs-lookup"><span data-stu-id="06ca7-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="06ca7-328">También tiene una capacidad integrada para redirigir los visitantes móviles a ubicaciones específicas configurados en el archivo Web.config. Puede funcionar sin dependiendo de las sesiones de ASP.NET (y, por tanto, las cookies) mediante el almacenamiento temporal de registro de los valores hash de los encabezados HTTP y direcciones IP de los visitantes, de modo que sepa si es o no cada solicitud de la primera de ellas desde un vistor determinado.</span><span class="sxs-lookup"><span data-stu-id="06ca7-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="06ca7-329">El siguiente elemento agregado a la sección fiftyOne del archivo web.config redirigirá la primera solicitud desde un dispositivo móvil detectado a la página ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="06ca7-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="06ca7-330">Las solicitudes a las páginas bajo la carpeta móvil le *no* redirigido, independientemente del tipo de dispositivo.</span><span class="sxs-lookup"><span data-stu-id="06ca7-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="06ca7-331">Si el dispositivo móvil ha estado inactivo durante un período de 20 minutos o más el dispositivo se olvide de y las solicitudes posteriores se tratará como nuevos para los fines de la redirección.</span><span class="sxs-lookup"><span data-stu-id="06ca7-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="06ca7-332">Para obtener más información, consulte [51degrees.mobi documentación Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="06ca7-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="06ca7-333">Se *puede* característica de redirección del uso 51Degrees.mobi Foundation en las aplicaciones de ASP.NET MVC, pero tendrá que definir la configuración de redirección en cuanto a direcciones URL sin formato, no en cuanto a los parámetros de enrutamientos o colocar filtros MVC en acciones.</span><span class="sxs-lookup"><span data-stu-id="06ca7-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="06ca7-334">Esto es porque (en el momento de escribir) 51Degrees.mobi Foundation no reconoce los filtros o enrutamiento.</span><span class="sxs-lookup"><span data-stu-id="06ca7-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>


### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="06ca7-335">Deshabilitar transcodificadores y servidores Proxy</span><span class="sxs-lookup"><span data-stu-id="06ca7-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="06ca7-336">Operadores de red móvil tienen dos objetivos generales en su enfoque a internet móvil:</span><span class="sxs-lookup"><span data-stu-id="06ca7-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="06ca7-337">Proporcionar como contenido relevante mucho como sea posible</span><span class="sxs-lookup"><span data-stu-id="06ca7-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="06ca7-338">Maximizar el número de clientes que pueden compartir el ancho de banda de red limitado de radio</span><span class="sxs-lookup"><span data-stu-id="06ca7-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="06ca7-339">Puesto que la mayoría de las páginas web diseñados para las pantallas grandes de tamaño de escritorio y conexiones de banda ancha de línea rápida fijo, muchos operadores usar *transcodificadores* o *servidores proxy* que modifican dinámicamente el contenido web.</span><span class="sxs-lookup"><span data-stu-id="06ca7-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="06ca7-340">Puede modificar el código HTML o CSS para adaptarlo a pantallas más pequeñas (especialmente para la "función teléfonos" que no tienen la capacidad de procesamiento para controlar diseños complejos), y pueden volver a comprimir las imágenes (lo que reduce considerablemente su calidad) para mejorar la velocidad de entrega de página.</span><span class="sxs-lookup"><span data-stu-id="06ca7-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="06ca7-341">Pero si ha realizado el esfuerzo necesario para generar una versión optimizada de móviles de su sitio, probablemente no desee interferir con cualquier aún más el operador de red.</span><span class="sxs-lookup"><span data-stu-id="06ca7-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="06ca7-342">Puede agregar la siguiente línea a la página\_eventos de carga en cualquier formulario Web de ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="06ca7-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="06ca7-343">O bien, para un controlador de MVC de ASP.NET, puede agregar la invalidación del método siguiente para que se aplique a todas las acciones en ese controlador:</span><span class="sxs-lookup"><span data-stu-id="06ca7-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="06ca7-344">El mensaje HTTP resultante informa a transcodificadores conforme W3C y servidores proxy de no alterar el contenido.</span><span class="sxs-lookup"><span data-stu-id="06ca7-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="06ca7-345">Por supuesto, no hay ninguna garantía de que los operadores de red móvil respetará este mensaje.</span><span class="sxs-lookup"><span data-stu-id="06ca7-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="06ca7-346">Aplicar un estilo a las páginas de dispositivos móviles para los exploradores móviles</span><span class="sxs-lookup"><span data-stu-id="06ca7-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="06ca7-347">Queda fuera del ámbito de este documento se describen con gran detalle qué tipos de trabajos de marcado HTML correctamente o qué técnicas de diseño web maximizar la facilidad de uso de dispositivos específicos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="06ca7-348">Ha seguridad para buscar un diseño lo suficientemente sencillo, optimizado para una pantalla mobile tamaño, sin usar no confiable HTML o CSS de posición trucos.</span><span class="sxs-lookup"><span data-stu-id="06ca7-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="06ca7-349">Sin embargo, es una técnica importante cabe mencionar, la *ventanilla meta etiqueta*.</span><span class="sxs-lookup"><span data-stu-id="06ca7-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="06ca7-350">Algunos exploradores móviles modernos, en un esfuerzo mostrar las páginas web destinado a monitores de escritorio, presentar la página en un lienzo virtual, también denominado "ventanilla" (p. ej., la ventanilla virtual es 980 píxeles de ancho en iPhone y 850 píxeles de ancho en Opera Mobile de forma predeterminada) y, a continuación, reducir el resultado que se ajuste a píxeles físicos de la pantalla.</span><span class="sxs-lookup"><span data-stu-id="06ca7-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="06ca7-351">El usuario puede, a continuación, usar el zoom y panorámica dicha ventanilla.</span><span class="sxs-lookup"><span data-stu-id="06ca7-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="06ca7-352">Esto tiene la ventaja de que permite que el explorador muestre la página en su diseño previsto, pero también tiene la desventaja que obliga al aplicar zoom y panorámica, que no es apto para el usuario.</span><span class="sxs-lookup"><span data-stu-id="06ca7-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="06ca7-353">Si está diseñando para dispositivos móviles, es mejor diseño para una pantalla limitada para que no sea necesaria ninguna zoom o desplazamiento horizontal.</span><span class="sxs-lookup"><span data-stu-id="06ca7-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="06ca7-354">Una manera de indicar al explorador móvil el ancho debe ser la ventanilla es a través de la no estándar *ventanilla* meta etiqueta.</span><span class="sxs-lookup"><span data-stu-id="06ca7-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="06ca7-355">Por ejemplo, si agrega lo siguiente a la sección de encabezado de la página,</span><span class="sxs-lookup"><span data-stu-id="06ca7-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="06ca7-356">…</span><span class="sxs-lookup"><span data-stu-id="06ca7-356">…</span></span> <span data-ttu-id="06ca7-357">a continuación, compatibilidad con exploradores de smartphone se estructurará la página en un lienzo virtual a nivel de 480 píxeles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="06ca7-358">Esto significa que, si los elementos HTML definen el ancho en términos de porcentaje, se interpretará los porcentajes en relación con este ancho de 480 píxeles, no el ancho de la ventanilla de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="06ca7-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="06ca7-359">Como resultado, el usuario es menos probable que deba aplicar zoom y desplazar horizontalmente: considerablemente mejora de la experiencia de exploración móvil.</span><span class="sxs-lookup"><span data-stu-id="06ca7-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="06ca7-360">Si desea que el ancho de la ventanilla para que coincida con los píxeles físicos del dispositivo, puede especificar lo siguiente:</span><span class="sxs-lookup"><span data-stu-id="06ca7-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="06ca7-361">Para que funcione correctamente, no debe explícitamente obligar a elementos que se va a superar ese ancho (por ejemplo, mediante un *ancho* atributo o propiedad CSS), en caso contrario, el explorador se verán obligado a utilizar una ventanilla más grande sin tener en cuenta.</span><span class="sxs-lookup"><span data-stu-id="06ca7-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="06ca7-362">Vea también: [más detalles sobre la etiqueta de la ventanilla no estándar](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="06ca7-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="06ca7-363">Smartphones más modernos admiten *orientación dual*: se pueden guardar en modo vertical u horizontal.</span><span class="sxs-lookup"><span data-stu-id="06ca7-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="06ca7-364">Por lo tanto, es importante no haga suposiciones sobre el ancho de pantalla en píxeles.</span><span class="sxs-lookup"><span data-stu-id="06ca7-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="06ca7-365">No incluso se supone que se ha corregido el ancho de pantalla, ya que el usuario puede reorientar su dispositivo mientras están en la página.</span><span class="sxs-lookup"><span data-stu-id="06ca7-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="06ca7-366">Los dispositivos Windows Mobile y Blackberry más antiguos también pueden aceptar las siguientes etiquetas meta en el encabezado de página para informarles de contenido se ha optimizado para dispositivos móviles y, por tanto, no deben transformarse.</span><span class="sxs-lookup"><span data-stu-id="06ca7-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="06ca7-367">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="06ca7-367">Additional Resources</span></span>

<span data-ttu-id="06ca7-368">Para obtener una lista de los emuladores de dispositivos móviles y los simuladores puede usar para probar la aplicación web ASP.NET mobile, consulte la página [simular dispositivos móviles más conocidos para la prueba](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="06ca7-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="06ca7-369">Créditos</span><span class="sxs-lookup"><span data-stu-id="06ca7-369">Credits</span></span>

- <span data-ttu-id="06ca7-370">Autor principal: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="06ca7-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="06ca7-371">Los revisores / adicionales escritores de contenido: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="06ca7-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>
