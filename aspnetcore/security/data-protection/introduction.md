---
title: "Introducción a la protección de datos"
author: rick-anderson
description: "Este documento presenta el concepto de protección de datos y describe los principios de diseño de la API de núcleo de ASP.NET asociadas."
keywords: "Núcleo de ASP.NET, protección de datos"
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.assetid: 4542cd37-b47c-454c-be19-d1b5810d67fe
ms.technology: aspnet
ms.prod: asp.net-core
uid: security/data-protection/introduction
ms.openlocfilehash: dd34f2e69ea0f6427ee5f446d6440dfab17a42c4
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 11/10/2017
---
# <a name="introduction-to-data-protection"></a><span data-ttu-id="ad971-104">Introducción a la protección de datos</span><span class="sxs-lookup"><span data-stu-id="ad971-104">Introduction to Data Protection</span></span>

<span data-ttu-id="ad971-105">Las aplicaciones Web a menudo se necesitan almacenar datos confidenciales de seguridad.</span><span class="sxs-lookup"><span data-stu-id="ad971-105">Web applications often need to store security-sensitive data.</span></span> <span data-ttu-id="ad971-106">Windows proporciona DPAPI para aplicaciones de escritorio, pero esto no es apropiada para las aplicaciones web.</span><span class="sxs-lookup"><span data-stu-id="ad971-106">Windows provides DPAPI for desktop applications but this is unsuitable for web applications.</span></span> <span data-ttu-id="ad971-107">La pila de protección de datos de ASP.NET Core proporcionan una API cifrada sencilla y fácil de usar un programador puede utilizar para proteger los datos, incluida la rotación y la administración de claves.</span><span class="sxs-lookup"><span data-stu-id="ad971-107">The ASP.NET Core data protection stack provide a simple, easy to use cryptographic API a developer can use to protect data, including key management and rotation.</span></span>

<span data-ttu-id="ad971-108">La pila de protección de datos de ASP.NET Core está diseñada para que actúe como la sustituirá a largo plazo para el <machineKey> elemento en ASP.NET 1.x - 4.x.</span><span class="sxs-lookup"><span data-stu-id="ad971-108">The ASP.NET Core data protection stack is designed to serve as the long-term replacement for the <machineKey> element in ASP.NET 1.x - 4.x.</span></span> <span data-ttu-id="ad971-109">Se diseñó para solucionar muchos de los defectos de la pila cifrado anterior al proporcionar una solución para la mayoría de los casos de uso de aplicaciones modernas están probables que encuentre.</span><span class="sxs-lookup"><span data-stu-id="ad971-109">It was designed to address many of the shortcomings of the old cryptographic stack while providing an out-of-the-box solution for the majority of use cases modern applications are likely to encounter.</span></span>

## <a name="problem-statement"></a><span data-ttu-id="ad971-110">Declaración del problema</span><span class="sxs-lookup"><span data-stu-id="ad971-110">Problem statement</span></span>

<span data-ttu-id="ad971-111">En pocas palabras la declaración del problema general en una sola frase: se necesita para conservar información de confianza para su recuperación posterior, pero no confiar en el mecanismo de persistencia.</span><span class="sxs-lookup"><span data-stu-id="ad971-111">The overall problem statement can be succinctly stated in a single sentence: I need to persist trusted information for later retrieval, but I do not trust the persistence mechanism.</span></span> <span data-ttu-id="ad971-112">En términos de web, esto puede escribirse como "Necesito al estado de confianza de ida y vuelta a través de un cliente no es de confianza".</span><span class="sxs-lookup"><span data-stu-id="ad971-112">In web terms, this might be written as "I need to round-trip trusted state via an untrusted client."</span></span>

<span data-ttu-id="ad971-113">El ejemplo canónico de esto es una cookie de autenticación o portador símbolo (token).</span><span class="sxs-lookup"><span data-stu-id="ad971-113">The canonical example of this is an authentication cookie or bearer token.</span></span> <span data-ttu-id="ad971-114">El servidor genera un "Estoy Groot y tiene permisos de xyz" símbolo (token) y los entrega al cliente.</span><span class="sxs-lookup"><span data-stu-id="ad971-114">The server generates an "I am Groot and have xyz permissions" token and hands it to the client.</span></span> <span data-ttu-id="ad971-115">En una fecha futura, el cliente presentará ese token en el servidor, pero el servidor necesita algún tipo de garantía de que el cliente no ha falsificado el token.</span><span class="sxs-lookup"><span data-stu-id="ad971-115">At some future date the client will present that token back to the server, but the server needs some kind of assurance that the client hasn't forged the token.</span></span> <span data-ttu-id="ad971-116">Por lo tanto, el primer requisito: autenticidad (conocido como)</span><span class="sxs-lookup"><span data-stu-id="ad971-116">Thus the first requirement: authenticity (a.k.a.</span></span> <span data-ttu-id="ad971-117">integridad, alteración de corrección).</span><span class="sxs-lookup"><span data-stu-id="ad971-117">integrity, tamper-proofing).</span></span>

<span data-ttu-id="ad971-118">Puesto que el estado persistente es de confianza para el servidor, prevemos que este estado podría contener información específica para el entorno operativo.</span><span class="sxs-lookup"><span data-stu-id="ad971-118">Since the persisted state is trusted by the server, we anticipate that this state might contain information that is specific to the operating environment.</span></span> <span data-ttu-id="ad971-119">Podría tratarse con el formato de una ruta de acceso de archivo, un permiso, un identificador u otra referencia indirecta o alguna otra parte de los datos específicos del servidor.</span><span class="sxs-lookup"><span data-stu-id="ad971-119">This could be in the form of a file path, a permission, a handle or other indirect reference, or some other piece of server-specific data.</span></span> <span data-ttu-id="ad971-120">Esta información normalmente no debe divulgarse a un cliente no es de confianza.</span><span class="sxs-lookup"><span data-stu-id="ad971-120">Such information should generally not be disclosed to an untrusted client.</span></span> <span data-ttu-id="ad971-121">Por lo tanto, el segundo requisito: confidencialidad.</span><span class="sxs-lookup"><span data-stu-id="ad971-121">Thus the second requirement: confidentiality.</span></span>

<span data-ttu-id="ad971-122">Por último, puesto que están dividida en componentes de aplicaciones modernas, lo que hemos visto es que los componentes individuales desea aprovechar las ventajas de este sistema sin tener en cuenta otros componentes en el sistema.</span><span class="sxs-lookup"><span data-stu-id="ad971-122">Finally, since modern applications are componentized, what we've seen is that individual components will want to take advantage of this system without regard to other components in the system.</span></span> <span data-ttu-id="ad971-123">Por ejemplo, si un componente de token de portador está usando esta pila, debe funcionar sin la interferencia de un mecanismo de anti-CSRF que también puedan estar usando la misma pila.</span><span class="sxs-lookup"><span data-stu-id="ad971-123">For instance, if a bearer token component is using this stack, it should operate without interference from an anti-CSRF mechanism that might also be using the same stack.</span></span> <span data-ttu-id="ad971-124">Por lo tanto, el requisito final: aislamiento.</span><span class="sxs-lookup"><span data-stu-id="ad971-124">Thus the final requirement: isolation.</span></span>

<span data-ttu-id="ad971-125">Podemos proporcionar más restricciones con el fin de restringir el ámbito de los requisitos.</span><span class="sxs-lookup"><span data-stu-id="ad971-125">We can provide further constraints in order to narrow the scope of our requirements.</span></span> <span data-ttu-id="ad971-126">Se supone que todos los servicios que funcionan en el sistema de cifrado se confía por igual y que los datos no es necesario que se genera o consume fuera de los servicios en nuestro control directo.</span><span class="sxs-lookup"><span data-stu-id="ad971-126">We assume that all services operating within the cryptosystem are equally trusted and that the data does not need to be generated or consumed outside of the services under our direct control.</span></span> <span data-ttu-id="ad971-127">Además, es necesario que las operaciones son lo más rápidas posible, ya que cada solicitud al servicio web puede pasar por el sistema de cifrado una o varias veces.</span><span class="sxs-lookup"><span data-stu-id="ad971-127">Furthermore, we require that operations are as fast as possible since each request to the web service might go through the cryptosystem one or more times.</span></span> <span data-ttu-id="ad971-128">Esto hace que la criptografía simétrica ideal para nuestro escenario y se podemos descuentos criptografía asimétrica hasta como uno que sea necesario.</span><span class="sxs-lookup"><span data-stu-id="ad971-128">This makes symmetric cryptography ideal for our scenario, and we can discount asymmetric cryptography until such a time that it is needed.</span></span>

## <a name="design-philosophy"></a><span data-ttu-id="ad971-129">Filosofía de diseño</span><span class="sxs-lookup"><span data-stu-id="ad971-129">Design philosophy</span></span>

<span data-ttu-id="ad971-130">Hemos iniciado mediante la identificación de problemas con la pila del existente.</span><span class="sxs-lookup"><span data-stu-id="ad971-130">We started by identifying problems with the existing stack.</span></span> <span data-ttu-id="ad971-131">Una vez que tuvimos, hemos evaluar el panorama de las soluciones existentes y concluye que no hay ninguna solución existente bastante tuvieron las capacidades que se busca.</span><span class="sxs-lookup"><span data-stu-id="ad971-131">Once we had that, we surveyed the landscape of existing solutions and concluded that no existing solution quite had the capabilities we sought.</span></span> <span data-ttu-id="ad971-132">A continuación, diseñamos una solución basada en varias orientaciones.</span><span class="sxs-lookup"><span data-stu-id="ad971-132">We then engineered a solution based on several guiding principles.</span></span>

* <span data-ttu-id="ad971-133">El sistema debe ofrecer la sencillez de configuración.</span><span class="sxs-lookup"><span data-stu-id="ad971-133">The system should offer simplicity of configuration.</span></span> <span data-ttu-id="ad971-134">Lo ideal es que el sistema sería sin configuración y los desarrolladores podrían llegar a cero que se ejecuta.</span><span class="sxs-lookup"><span data-stu-id="ad971-134">Ideally the system would be zero-configuration and developers could hit the ground running.</span></span> <span data-ttu-id="ad971-135">En situaciones donde los desarrolladores deben configurar un aspecto concreto (por ejemplo, el repositorio de claves), se debe prestar atención especial a hacer que esas configuraciones específicas simple.</span><span class="sxs-lookup"><span data-stu-id="ad971-135">In situations where developers need to configure a specific aspect (such as the key repository), consideration should be given to making those specific configurations simple.</span></span>

* <span data-ttu-id="ad971-136">Ofrecen una API sencilla de consumo.</span><span class="sxs-lookup"><span data-stu-id="ad971-136">Offer a simple consumer-facing API.</span></span> <span data-ttu-id="ad971-137">Las API deben ser fáciles de usar correctamente y difíciles de usar de forma incorrecta.</span><span class="sxs-lookup"><span data-stu-id="ad971-137">The APIs should be easy to use correctly and difficult to use incorrectly.</span></span>

* <span data-ttu-id="ad971-138">Los desarrolladores deben aprender los principios de administración de claves.</span><span class="sxs-lookup"><span data-stu-id="ad971-138">Developers should not learn key management principles.</span></span> <span data-ttu-id="ad971-139">El sistema debe controlar la selección de algoritmo y la vigencia de la clave en nombre del desarrollador.</span><span class="sxs-lookup"><span data-stu-id="ad971-139">The system should handle algorithm selection and key lifetime on the developer's behalf.</span></span> <span data-ttu-id="ad971-140">Lo ideal es que el programador ni siquiera debe tener acceso a material de la clave sin formato.</span><span class="sxs-lookup"><span data-stu-id="ad971-140">Ideally the developer should never even have access to the raw key material.</span></span>

* <span data-ttu-id="ad971-141">Las claves deben estar protegidas en reposo cuando sea posible.</span><span class="sxs-lookup"><span data-stu-id="ad971-141">Keys should be protected at rest when possible.</span></span> <span data-ttu-id="ad971-142">El sistema debe determinar un mecanismo de protección predeterminado adecuado y lo aplicará automáticamente.</span><span class="sxs-lookup"><span data-stu-id="ad971-142">The system should figure out an appropriate default protection mechanism and apply it automatically.</span></span>

<span data-ttu-id="ad971-143">Con estos principios en cuenta que desarrollamos una sencilla [fácil de usar](using-data-protection.md) pila de protección de datos.</span><span class="sxs-lookup"><span data-stu-id="ad971-143">With these principles in mind we developed a simple, [easy to use](using-data-protection.md) data protection stack.</span></span>

<span data-ttu-id="ad971-144">La API de protección de datos de ASP.NET Core no están pensados principalmente para la persistencia indefinido de cargas confidenciales.</span><span class="sxs-lookup"><span data-stu-id="ad971-144">The ASP.NET Core data protection APIs are not primarily intended for indefinite persistence of confidential payloads.</span></span> <span data-ttu-id="ad971-145">Otras tecnologías, como [Windows CNG DPAPI](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) y [Azure Rights Management](https://docs.microsoft.com/rights-management/) son más adecuados para el escenario de almacenamiento indefinido, y tienen capacidades de administración de claves seguro según corresponda.</span><span class="sxs-lookup"><span data-stu-id="ad971-145">Other technologies like [Windows CNG DPAPI](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) and [Azure Rights Management](https://docs.microsoft.com/rights-management/) are more suited to the scenario of indefinite storage, and they have correspondingly strong key management capabilities.</span></span> <span data-ttu-id="ad971-146">Es decir, no hay nada prohibir a un desarrollador usa las API de protección de datos de ASP.NET Core para la protección a largo plazo de información confidencial.</span><span class="sxs-lookup"><span data-stu-id="ad971-146">That said, there is nothing prohibiting a developer from using the ASP.NET Core data protection APIs for long-term protection of confidential data.</span></span>

## <a name="audience"></a><span data-ttu-id="ad971-147">Audiencia</span><span class="sxs-lookup"><span data-stu-id="ad971-147">Audience</span></span>

<span data-ttu-id="ad971-148">El sistema de protección de datos se divide en cinco paquetes principales.</span><span class="sxs-lookup"><span data-stu-id="ad971-148">The data protection system is divided into five main packages.</span></span> <span data-ttu-id="ad971-149">Destino de distintos aspectos de estas API tres audiencias principales;</span><span class="sxs-lookup"><span data-stu-id="ad971-149">Various aspects of these APIs target three main audiences;</span></span>

1. <span data-ttu-id="ad971-150">El [información general de las API de consumidor](consumer-apis/overview.md) a los desarrolladores de aplicaciones y un marco de destino.</span><span class="sxs-lookup"><span data-stu-id="ad971-150">The [Consumer APIs Overview](consumer-apis/overview.md) target application and framework developers.</span></span>

   <span data-ttu-id="ad971-151">"No desea obtener información acerca de cómo funciona la pila o acerca de cómo esté configurada.</span><span class="sxs-lookup"><span data-stu-id="ad971-151">"I don't want to learn about how the stack operates or about how it is configured.</span></span> <span data-ttu-id="ad971-152">Simplemente desea realizar alguna operación como simple forma como sea posible con una probabilidad alta de usar las API correctamente."</span><span class="sxs-lookup"><span data-stu-id="ad971-152">I simply want to perform some operation in as simple a manner as possible with high probability of using the APIs successfully."</span></span>

2. <span data-ttu-id="ad971-153">El [API de configuración](configuration/overview.md) dirigidas a los desarrolladores de aplicaciones y los administradores del sistema.</span><span class="sxs-lookup"><span data-stu-id="ad971-153">The [configuration APIs](configuration/overview.md) target application developers and system administrators.</span></span>

   <span data-ttu-id="ad971-154">"Necesito indicar que el sistema de protección de datos que mi entorno requiere configuración o las rutas de acceso no predeterminada".</span><span class="sxs-lookup"><span data-stu-id="ad971-154">"I need to tell the data protection system that my environment requires non-default paths or settings."</span></span>

3. <span data-ttu-id="ad971-155">Desarrolladores de destino de las API de extensibilidad responsable de implementar la directiva personalizada.</span><span class="sxs-lookup"><span data-stu-id="ad971-155">The extensibility APIs target developers in charge of implementing custom policy.</span></span> <span data-ttu-id="ad971-156">Uso de estas API se usaría limitarse a situaciones excepcionales y experimentado, los desarrolladores de cuenta de seguridad.</span><span class="sxs-lookup"><span data-stu-id="ad971-156">Usage of these APIs would be limited to rare situations and experienced, security aware developers.</span></span>

   <span data-ttu-id="ad971-157">"Necesito reemplazar un componente completo dentro del sistema porque tienen requisitos de comportamiento verdaderamente únicos.</span><span class="sxs-lookup"><span data-stu-id="ad971-157">"I need to replace an entire component within the system because I have truly unique behavioral requirements.</span></span> <span data-ttu-id="ad971-158">Estoy dispuesto a aprender uncommonly utiliza partes de la superficie de API para compilar un complemento que cumple los requisitos de mi."</span><span class="sxs-lookup"><span data-stu-id="ad971-158">I am willing to learn uncommonly-used parts of the API surface in order to build a plugin that fulfills my requirements."</span></span>

## <a name="package-layout"></a><span data-ttu-id="ad971-159">Diseño del paquete</span><span class="sxs-lookup"><span data-stu-id="ad971-159">Package Layout</span></span>

<span data-ttu-id="ad971-160">La pila de protección de datos consta de cinco paquetes.</span><span class="sxs-lookup"><span data-stu-id="ad971-160">The data protection stack consists of five packages.</span></span>

* <span data-ttu-id="ad971-161">Microsoft.AspNetCore.DataProtection.Abstractions contiene las interfaces básicas de IDataProtectionProvider y IDataProtector.</span><span class="sxs-lookup"><span data-stu-id="ad971-161">Microsoft.AspNetCore.DataProtection.Abstractions contains the basic IDataProtectionProvider and IDataProtector interfaces.</span></span> <span data-ttu-id="ad971-162">También contiene métodos de extensión útil que pueden ayudar a trabajar con estos tipos (p. ej., las sobrecargas de IDataProtector.Protect).</span><span class="sxs-lookup"><span data-stu-id="ad971-162">It also contains useful extension methods that can assist working with these types (e.g., overloads of IDataProtector.Protect).</span></span> <span data-ttu-id="ad971-163">Vea la sección de interfaces de consumidor para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="ad971-163">See the consumer interfaces section for more information.</span></span> <span data-ttu-id="ad971-164">Si otra persona es responsable de crear una instancia del sistema de protección de datos y simplemente están utilizando las API, deseará referencia Microsoft.AspNetCore.DataProtection.Abstractions.</span><span class="sxs-lookup"><span data-stu-id="ad971-164">If somebody else is responsible for instantiating the data protection system and you are simply consuming the APIs, you'll want to reference Microsoft.AspNetCore.DataProtection.Abstractions.</span></span>

* <span data-ttu-id="ad971-165">Microsoft.AspNetCore.DataProtection contiene la implementación básica del sistema de protección de datos, incluida la administración de claves, configuración, extensibilidad y las operaciones criptográficas de núcleo.</span><span class="sxs-lookup"><span data-stu-id="ad971-165">Microsoft.AspNetCore.DataProtection contains the core implementation of the data protection system, including the core cryptographic operations, key management, configuration, and extensibility.</span></span> <span data-ttu-id="ad971-166">Si eres responsable de crear una instancia del sistema de protección de datos (p. ej., éste se agrega a un IServiceCollection) o modificar o extender su comportamiento, deseará referencia Microsoft.AspNetCore.DataProtection.</span><span class="sxs-lookup"><span data-stu-id="ad971-166">If you're responsible for instantiating the data protection system (e.g., adding it to an IServiceCollection) or modifying or extending its behavior, you'll want to reference Microsoft.AspNetCore.DataProtection.</span></span>

* <span data-ttu-id="ad971-167">Microsoft.AspNetCore.DataProtection.Extensions contiene algunas API adicionales que los desarrolladores que resulte útiles, pero no en el paquete de núcleo que pertenecen.</span><span class="sxs-lookup"><span data-stu-id="ad971-167">Microsoft.AspNetCore.DataProtection.Extensions contains additional APIs which developers might find useful but which don't belong in the core package.</span></span> <span data-ttu-id="ad971-168">Por ejemplo, este paquete contiene una API sencilla "crear una instancia del sistema que señala a un directorio de almacenamiento de claves específico con ninguna instalación de inyección de dependencia" (más información).</span><span class="sxs-lookup"><span data-stu-id="ad971-168">For instance, this package contains a simple "instantiate the system pointing at a specific key storage directory with no dependency injection setup" API (more info).</span></span> <span data-ttu-id="ad971-169">También contiene métodos de extensión para limitar la duración de cargas protegidos (más información).</span><span class="sxs-lookup"><span data-stu-id="ad971-169">It also contains extension methods for limiting the lifetime of protected payloads (more info).</span></span>

* <span data-ttu-id="ad971-170">Microsoft.AspNetCore.DataProtection.SystemWeb puede instalarse en una aplicación existente de 4.x ASP.NET para redirigir su <machineKey> operaciones usar en su lugar la nueva pila de protección de datos.</span><span class="sxs-lookup"><span data-stu-id="ad971-170">Microsoft.AspNetCore.DataProtection.SystemWeb can be installed into an existing ASP.NET 4.x application to redirect its <machineKey> operations to instead use the new data protection stack.</span></span> <span data-ttu-id="ad971-171">Vea [compatibilidad](compatibility/replacing-machinekey.md#compatibility-replacing-machinekey) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="ad971-171">See [compatibility](compatibility/replacing-machinekey.md#compatibility-replacing-machinekey) for more information.</span></span>

* <span data-ttu-id="ad971-172">Microsoft.AspNetCore.Cryptography.KeyDerivation proporciona una implementación de la contraseña PBKDF2 hash rutina y puede usarse en sistemas que necesitan para administrar las contraseñas de usuario de forma segura.</span><span class="sxs-lookup"><span data-stu-id="ad971-172">Microsoft.AspNetCore.Cryptography.KeyDerivation provides an implementation of the PBKDF2 password hashing routine and can be used by systems which need to handle user passwords securely.</span></span> <span data-ttu-id="ad971-173">Vea [hash de contraseña](consumer-apis/password-hashing.md) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="ad971-173">See [Password Hashing](consumer-apis/password-hashing.md) for more information.</span></span>
