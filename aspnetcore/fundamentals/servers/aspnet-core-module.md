---
title: "Módulo ASP.NET Core"
author: tdykstra
description: "En este artículo se presenta el módulo ASP.NET Core (ANCM), un módulo de IIS que permite que el servidor web Kestrel use IIS o IIS Express como un servidor proxy inverso."
manager: wpickett
ms.author: tdykstra
ms.custom: H1Hack27Feb2017
ms.date: 08/03/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: fundamentals/servers/aspnet-core-module
ms.openlocfilehash: 4337bc42c5454d6a9634a396d9c89f3518af148b
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 01/30/2018
---
# <a name="introduction-to-aspnet-core-module"></a><span data-ttu-id="c489c-103">Introducción al módulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="c489c-103">Introduction to ASP.NET Core Module</span></span>

<span data-ttu-id="c489c-104">Por [Tom Dykstra](https://github.com/tdykstra), [Rick Strahl](https://github.com/RickStrahl) y [Chris Ross](https://github.com/Tratcher)</span><span class="sxs-lookup"><span data-stu-id="c489c-104">By [Tom Dykstra](https://github.com/tdykstra), [Rick Strahl](https://github.com/RickStrahl), and [Chris Ross](https://github.com/Tratcher)</span></span> 

<span data-ttu-id="c489c-105">El módulo ASP.NET Core (ANCM) permite ejecutar aplicaciones ASP.NET Core por detrás de IIS: usa IIS por sus puntos fuertes (seguridad, facilidad de uso y mucho más) y usa [Kestrel](kestrel.md) por sus puntos fuertes (agiliza mucho los procesos), logrando así reunir las ventajas de las dos tecnologías en una sola.</span><span class="sxs-lookup"><span data-stu-id="c489c-105">ASP.NET Core Module (ANCM) lets you run ASP.NET Core applications behind IIS, using IIS for what it's good at (security, manageability, and lots more) and using [Kestrel](kestrel.md) for what it's good at (being really fast), and getting the benefits from both technologies at once.</span></span> <span data-ttu-id="c489c-106">**ANCM solo funciona con Kestrel; no es compatible con WebListener (en ASP.NET Core 1.x) ni HTTP.sys (en 2.x).**</span><span class="sxs-lookup"><span data-stu-id="c489c-106">**ANCM works only with Kestrel; it isn't compatible with WebListener (in ASP.NET Core 1.x) or HTTP.sys (in 2.x).**</span></span> 

<span data-ttu-id="c489c-107">Versiones de Windows compatibles:</span><span class="sxs-lookup"><span data-stu-id="c489c-107">Supported Windows versions:</span></span>

* <span data-ttu-id="c489c-108">Windows 7 y Windows Server 2008 R2 y versiones posteriores</span><span class="sxs-lookup"><span data-stu-id="c489c-108">Windows 7 and Windows Server 2008 R2 and later</span></span>

<span data-ttu-id="c489c-109">[Vea o descargue el código de ejemplo](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample) ([cómo descargarlo](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="c489c-109">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-aspnet-core-module-does"></a><span data-ttu-id="c489c-110">Qué hace el módulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="c489c-110">What ASP.NET Core Module does</span></span>

<span data-ttu-id="c489c-111">ANCM es un módulo de IIS nativo que se enlaza a la canalización IIS y redirige el tráfico a la aplicación back-end de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c489c-111">ANCM is a native IIS module that hooks into the IIS pipeline and redirects traffic to the backend ASP.NET Core application.</span></span> <span data-ttu-id="c489c-112">La mayoría de los demás módulos, como Autenticación de Windows, siguen teniendo una oportunidad de ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="c489c-112">Most other modules, such as windows authentication, still get a chance to run.</span></span> <span data-ttu-id="c489c-113">ANCM solo toma el control cuando se selecciona un controlador para la solicitud y se define la asignación del controlador en el archivo *web.config* de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c489c-113">ANCM only takes control when a handler is selected for the request, and handler mapping is defined in the application *web.config* file.</span></span>

<span data-ttu-id="c489c-114">Dado que las aplicaciones ASP.NET Core se ejecutan en un proceso independiente del proceso de trabajo de IIS, ANCM también realiza la administración de procesos.</span><span class="sxs-lookup"><span data-stu-id="c489c-114">Because ASP.NET Core applications run in a process separate from the IIS worker process, ANCM also does process management.</span></span> <span data-ttu-id="c489c-115">ANCM inicia el proceso de la aplicación ASP.NET Core cuando entra la primera solicitud y lo reinicia cuando se bloquea.</span><span class="sxs-lookup"><span data-stu-id="c489c-115">ANCM starts the process for the ASP.NET Core application when the first request comes in and restarts it when it crashes.</span></span> <span data-ttu-id="c489c-116">Este comportamiento es básicamente el mismo que el de las aplicaciones ASP.NET clásicas que se ejecutan en el proceso en IIS y se administran mediante el servicio WAS (Windows Activation Service).</span><span class="sxs-lookup"><span data-stu-id="c489c-116">This is essentially the same behavior as classic ASP.NET applications that run in-process in IIS and are managed by WAS (Windows Activation Service).</span></span>

<span data-ttu-id="c489c-117">En este diagrama se muestra la relación entre las aplicaciones IIS, ANCM y ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c489c-117">Here's a diagram that illustrates the relationship between IIS, ANCM, and ASP.NET Core applications.</span></span>

![Módulo ASP.NET Core](aspnet-core-module/_static/ancm.png)

<span data-ttu-id="c489c-119">Las solicitudes proceden de la web y alcanzan al controlador Http.Sys en modo kernel, que las enruta en IIS en el puerto principal (80) o el puerto SSL (443).</span><span class="sxs-lookup"><span data-stu-id="c489c-119">Requests come in from the Web and hit the kernel mode Http.Sys driver which routes them into IIS on the primary port (80) or SSL port (443).</span></span> <span data-ttu-id="c489c-120">ANCM reenvía las solicitudes a la aplicación ASP.NET Core en el puerto HTTP configurado para la aplicación, que no es el puerto 80 o 443.</span><span class="sxs-lookup"><span data-stu-id="c489c-120">ANCM forwards the requests to the ASP.NET Core application on the HTTP port configured for the application, which isn't port 80/443.</span></span>

<span data-ttu-id="c489c-121">Kestrel escucha el tráfico procedente de ANCM.</span><span class="sxs-lookup"><span data-stu-id="c489c-121">Kestrel listens for traffic coming from ANCM.</span></span>  <span data-ttu-id="c489c-122">ANCM especifica el puerto a través de la variable de entorno en el inicio y el método [UseIISIntegration](#call-useiisintegration) configura el servidor para que escuche en `http://localhost:{port}`.</span><span class="sxs-lookup"><span data-stu-id="c489c-122">ANCM specifies the port via environment variable at startup, and the [UseIISIntegration](#call-useiisintegration) method configures the server to listen on `http://localhost:{port}`.</span></span> <span data-ttu-id="c489c-123">Existen comprobaciones adicionales para rechazar las solicitudes que no procedan de ANCM.</span><span class="sxs-lookup"><span data-stu-id="c489c-123">There are additional checks to reject requests not from ANCM.</span></span> <span data-ttu-id="c489c-124">(ANCM no admite el reenvío de HTTPS, por lo que las solicitudes se reenvían a través de HTTP, aunque IIS las reciba a través de HTTPS).</span><span class="sxs-lookup"><span data-stu-id="c489c-124">(ANCM doesn't support HTTPS forwarding, so requests are forwarded over HTTP even if received by IIS over HTTPS.)</span></span>

<span data-ttu-id="c489c-125">Kestrel toma las solicitudes de ANCM y las envía a la canalización de middleware de ASP.NET Core que, a su vez, las administra y las pasa como instancias de `HttpContext` a la lógica de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c489c-125">Kestrel picks up requests from ANCM and pushes them into the ASP.NET Core middleware pipeline, which then handles them and passes them on as `HttpContext` instances to application logic.</span></span> <span data-ttu-id="c489c-126">Después, las respuestas de la aplicación se pasan de nuevo a IIS, que las envía de nuevo al cliente HTTP que inició las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="c489c-126">The application's responses are then passed back to IIS, which pushes them back out to the HTTP client that initiated the requests.</span></span>

<span data-ttu-id="c489c-127">ANCM tiene también otras funciones:</span><span class="sxs-lookup"><span data-stu-id="c489c-127">ANCM has a few other functions as well:</span></span>

* <span data-ttu-id="c489c-128">Establece las variables de entorno.</span><span class="sxs-lookup"><span data-stu-id="c489c-128">Sets environment variables.</span></span>
* <span data-ttu-id="c489c-129">Registra los resultados de `stdout` en el almacenamiento de archivos.</span><span class="sxs-lookup"><span data-stu-id="c489c-129">Logs `stdout` output to file storage.</span></span>
* <span data-ttu-id="c489c-130">Reenvía tokens de autenticación de Windows.</span><span class="sxs-lookup"><span data-stu-id="c489c-130">Forwards Windows authentication tokens.</span></span>

## <a name="how-to-use-ancm-in-aspnet-core-apps"></a><span data-ttu-id="c489c-131">Cómo usar ANCM en aplicaciones ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="c489c-131">How to use ANCM in ASP.NET Core apps</span></span>

<span data-ttu-id="c489c-132">En esta sección se ofrece información general sobre el proceso de configuración de un servidor IIS y la aplicación ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c489c-132">This section provides an overview of the process for setting up an IIS server and ASP.NET Core application.</span></span> <span data-ttu-id="c489c-133">Para instrucciones más detalladas, vea [Hospedaje de ASP.NET Core en Windows con IIS](xref:host-and-deploy/iis/index).</span><span class="sxs-lookup"><span data-stu-id="c489c-133">For detailed instructions, see [Host on Windows with IIS](xref:host-and-deploy/iis/index).</span></span>

### <a name="install-ancm"></a><span data-ttu-id="c489c-134">Instalar ANCM</span><span class="sxs-lookup"><span data-stu-id="c489c-134">Install ANCM</span></span>


<span data-ttu-id="c489c-135">El módulo ASP.NET Core debe instalarse en IIS para los servidores y en IIS Express para las máquinas de desarrollo.</span><span class="sxs-lookup"><span data-stu-id="c489c-135">The ASP.NET Core Module has to be installed in IIS on your servers and in IIS Express on your development machines.</span></span> <span data-ttu-id="c489c-136">Para los servidores, ANCM se incluye en el [conjunto de hospedaje de Windows Server de .NET Core](https://aka.ms/dotnetcore-2-windowshosting).</span><span class="sxs-lookup"><span data-stu-id="c489c-136">For servers, ANCM is included in the [.NET Core Windows Server Hosting bundle](https://aka.ms/dotnetcore-2-windowshosting).</span></span> <span data-ttu-id="c489c-137">Para las máquinas de desarrollo, Visual Studio instala automáticamente ANCM en IIS Express o en IIS si este ya está instalado en la máquina.</span><span class="sxs-lookup"><span data-stu-id="c489c-137">For development machines, Visual Studio automatically installs ANCM in IIS Express, and in IIS if it's already installed on the machine.</span></span>

### <a name="install-the-iisintegration-nuget-package"></a><span data-ttu-id="c489c-138">Instale el paquete NuGet IISIntegration</span><span class="sxs-lookup"><span data-stu-id="c489c-138">Install the IISIntegration NuGet package</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="c489c-139">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="c489c-139">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="c489c-140">El paquete [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) se incluye en los metapaquetes de ASP.NET Core ([Microsoft.AspNetCore](https://www.nuget.org/packages/Microsoft.AspNetCore/) y [Microsoft.AspNetCore.All](xref:fundamentals/metapackage)).</span><span class="sxs-lookup"><span data-stu-id="c489c-140">The [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) package is included in the ASP.NET Core metapackages ([Microsoft.AspNetCore](https://www.nuget.org/packages/Microsoft.AspNetCore/) and [Microsoft.AspNetCore.All](xref:fundamentals/metapackage)).</span></span> <span data-ttu-id="c489c-141">Si no usa uno de los metapaquetes, instale `Microsoft.AspNetCore.Server.IISIntegration` por separado.</span><span class="sxs-lookup"><span data-stu-id="c489c-141">If you don't use one of the metapackages, install `Microsoft.AspNetCore.Server.IISIntegration` separately.</span></span> <span data-ttu-id="c489c-142">El paquete `IISIntegration` es un paquete de interoperabilidad que lee las variables de entorno difundidas por ANCM para configurar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c489c-142">The `IISIntegration` package is an interoperability pack that reads environment variables broadcast by ANCM to set up your app.</span></span> <span data-ttu-id="c489c-143">Las variables de entorno proporcionan información sobre la configuración, como el puerto donde escuchar.</span><span class="sxs-lookup"><span data-stu-id="c489c-143">The environment variables provide configuration information, such as the port to listen on.</span></span> 

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="c489c-144">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="c489c-144">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="c489c-145">En la aplicación, instale [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/).</span><span class="sxs-lookup"><span data-stu-id="c489c-145">In your application, install [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/).</span></span> <span data-ttu-id="c489c-146">El paquete `IISIntegration` es un paquete de interoperabilidad que lee las variables de entorno difundidas por ANCM para configurar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c489c-146">The `IISIntegration` package  is an interoperability pack that reads environment variables broadcast by ANCM to set up your app.</span></span> <span data-ttu-id="c489c-147">Las variables de entorno proporcionan información sobre la configuración, como el puerto donde escuchar.</span><span class="sxs-lookup"><span data-stu-id="c489c-147">The environment variables provide configuration information, such as the port to listen on.</span></span> 

---

### <a name="call-useiisintegration"></a><span data-ttu-id="c489c-148">Llamar a UseIISIntegration</span><span class="sxs-lookup"><span data-stu-id="c489c-148">Call UseIISIntegration</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="c489c-149">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="c489c-149">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="c489c-150">Cuando se ejecuta con IIS se llama automáticamente al método de extensión `UseIISIntegration` en [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder).</span><span class="sxs-lookup"><span data-stu-id="c489c-150">The `UseIISIntegration` extension method on [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder) is called automatically when you run with IIS.</span></span>

<span data-ttu-id="c489c-151">Si no está usando uno de los metapaquetes de ASP.NET Core y no ha instalado el paquete `Microsoft.AspNetCore.Server.IISIntegration`, obtendrá un error de tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="c489c-151">If you aren't using one of the ASP.NET Core metapackages and haven't installed the  `Microsoft.AspNetCore.Server.IISIntegration` package, you get a runtime error.</span></span> <span data-ttu-id="c489c-152">Si llama expresamente a `UseIISIntegration`, obtendrá un error en tiempo de compilación si el paquete no está instalado.</span><span class="sxs-lookup"><span data-stu-id="c489c-152">If you call `UseIISIntegration` explicitly, you get a compile time error if the package isn't installed.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="c489c-153">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="c489c-153">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="c489c-154">En el método `Main` de la aplicación, llame al método de extensión `UseIISIntegration` en [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder).</span><span class="sxs-lookup"><span data-stu-id="c489c-154">In your application's `Main` method, call the `UseIISIntegration` extension method on [`WebHostBuilder`](https://docs.microsoft.com/aspnet/core/api/microsoft.aspnetcore.hosting.webhostbuilder).</span></span> 

[!code-csharp[](aspnet-core-module/sample/Program.cs?name=snippet_Main&highlight=12)]

---

<span data-ttu-id="c489c-155">El método `UseIISIntegration` busca variables de entorno establecidas por ANCM y no realiza ninguna operación si no las encuentra.</span><span class="sxs-lookup"><span data-stu-id="c489c-155">The `UseIISIntegration` method looks for environment variables that ANCM sets, and it no-ops if they aren't found.</span></span> <span data-ttu-id="c489c-156">Este comportamiento facilita escenarios, como el de desarrollo y prueba en macOS o Linux, y el de implementación en un servidor que ejecuta IIS.</span><span class="sxs-lookup"><span data-stu-id="c489c-156">This behavior facilitates scenarios like developing and testing on macOS or Linux and deploying to a server that runs IIS.</span></span> <span data-ttu-id="c489c-157">Mientras se ejecuta en MacOS o Linux, Kestrel actúa como el servidor web; pero cuando la aplicación se implementa en el entorno de IIS, usa automáticamente ANCM e IIS.</span><span class="sxs-lookup"><span data-stu-id="c489c-157">While running on macOS or Linux, Kestrel acts as the web server; but when the app is deployed to the IIS environment, it automatically uses ANCM and IIS.</span></span>

### <a name="ancm-port-binding-overrides-other-port-bindings"></a><span data-ttu-id="c489c-158">El enlace de puerto de ANCM invalida otros enlaces de puerto</span><span class="sxs-lookup"><span data-stu-id="c489c-158">ANCM port binding overrides other port bindings</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="c489c-159">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="c489c-159">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="c489c-160">ANCM genera un puerto dinámico que se asigna al proceso back-end.</span><span class="sxs-lookup"><span data-stu-id="c489c-160">ANCM generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="c489c-161">El método `UseIISIntegration` toma este puerto dinámico y configura Kestrel para que escuche en `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="c489c-161">The `UseIISIntegration` method picks up this dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="c489c-162">Esto invalida otras configuraciones de URL, como las llamadas a `UseUrls` o a la [API Listen de Kestrel](xref:fundamentals/servers/kestrel?tabs=aspnetcore2x#endpoint-configuration).</span><span class="sxs-lookup"><span data-stu-id="c489c-162">This overrides other URL configurations, such as calls to `UseUrls` or [Kestrel's Listen API](xref:fundamentals/servers/kestrel?tabs=aspnetcore2x#endpoint-configuration).</span></span> <span data-ttu-id="c489c-163">Por tanto, no es necesario llamar a `UseUrls` o a la API `Listen` de Kestrel cuando se usa ANCM.</span><span class="sxs-lookup"><span data-stu-id="c489c-163">Therefore, you don't need to call `UseUrls` or Kestrel's `Listen` API when you use ANCM.</span></span> <span data-ttu-id="c489c-164">Si se llama a `UseUrls` o `Listen`, Kestrel escucha en el puerto que especificó al ejecutar la aplicación sin IIS.</span><span class="sxs-lookup"><span data-stu-id="c489c-164">If you do call `UseUrls` or `Listen`, Kestrel listens on the port you specify when you run the app without IIS.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="c489c-165">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="c489c-165">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="c489c-166">ANCM genera un puerto dinámico que se asigna al proceso back-end.</span><span class="sxs-lookup"><span data-stu-id="c489c-166">ANCM generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="c489c-167">El método `UseIISIntegration` toma este puerto dinámico y configura Kestrel para que escuche en `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="c489c-167">The `UseIISIntegration` method picks up this dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="c489c-168">Esto invalida otras configuraciones de URL, como las llamadas a `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="c489c-168">This overrides other URL configurations, such as calls to `UseUrls`.</span></span> <span data-ttu-id="c489c-169">Por tanto, no es necesario llamar a `UseUrls` cuando usa ANCM.</span><span class="sxs-lookup"><span data-stu-id="c489c-169">Therefore, you don't need to call `UseUrls` when you use ANCM.</span></span> <span data-ttu-id="c489c-170">Si se llama a `UseUrls`, Kestrel escucha en el puerto que especificó al ejecutar la aplicación sin IIS.</span><span class="sxs-lookup"><span data-stu-id="c489c-170">If you do call `UseUrls`, Kestrel listens on the port you specify when you run the app without IIS.</span></span>

<span data-ttu-id="c489c-171">En ASP.NET Core 1.0, si llama a `UseUrls`, hágalo **antes** de llamar a `UseIISIntegration` para que el puerto configurado de ANCM no se sobrescriba.</span><span class="sxs-lookup"><span data-stu-id="c489c-171">In ASP.NET Core 1.0, if you call `UseUrls`, call it **before** you call `UseIISIntegration` so that the ANCM-configured port doesn't get overwritten.</span></span> <span data-ttu-id="c489c-172">Este orden de llamada no es necesario en ASP.NET Core 1.1, ya que la configuración de ANCM reemplaza `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="c489c-172">This calling order isn't required in ASP.NET Core 1.1, because the ANCM setting overrides `UseUrls`.</span></span>

---

### <a name="configure-ancm-options-in-webconfig"></a><span data-ttu-id="c489c-173">Configurar opciones de ANCM en web.config</span><span class="sxs-lookup"><span data-stu-id="c489c-173">Configure ANCM options in Web.config</span></span>

<span data-ttu-id="c489c-174">La configuración para el módulo ASP.NET Core se almacena en el archivo *web.config* que se encuentra en la carpeta raíz de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="c489c-174">Configuration for the ASP.NET Core Module is stored in the *web.config* file that's located in the application's root folder.</span></span> <span data-ttu-id="c489c-175">La configuración de este archivo señala el comando de inicio y los argumentos que inician la aplicación ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c489c-175">Settings in this file point to the startup command and arguments that start your ASP.NET Core app.</span></span> <span data-ttu-id="c489c-176">Para obtener código de ejemplo de *web.config* e instrucciones para las opciones de configuración, vea [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module) (Referencia de configuración del módulo ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="c489c-176">For sample *web.config* code and guidance on configuration options, see [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module).</span></span>

### <a name="run-with-iis-express-in-development"></a><span data-ttu-id="c489c-177">Ejecutar con IIS Express en el desarrollo</span><span class="sxs-lookup"><span data-stu-id="c489c-177">Run with IIS Express in development</span></span>

<span data-ttu-id="c489c-178">Visual Studio puede iniciar IIS Express usando el perfil predeterminado definido por las plantillas de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="c489c-178">IIS Express can be launched by Visual Studio using the default profile defined by the ASP.NET Core templates.</span></span>

## <a name="proxy-configuration-uses-http-protocol-and-a-pairing-token"></a><span data-ttu-id="c489c-179">La configuración de proxy usa el protocolo HTTP y un token de emparejamiento</span><span class="sxs-lookup"><span data-stu-id="c489c-179">Proxy configuration uses HTTP protocol and a pairing token</span></span>

<span data-ttu-id="c489c-180">El proxy creado entre ANCM y Kestrel usa el protocolo HTTP.</span><span class="sxs-lookup"><span data-stu-id="c489c-180">The proxy created between the ANCM and Kestrel uses the HTTP protocol.</span></span> <span data-ttu-id="c489c-181">Al usar HTTP se optimiza el rendimiento, ya que el tráfico entre ANCM y Kestrel se realiza en una dirección de bucle invertido fuera de la interfaz de red.</span><span class="sxs-lookup"><span data-stu-id="c489c-181">Using HTTP is a performance optimization where the traffic between the ANCM and Kestrel takes place on a loopback address off of the network interface.</span></span> <span data-ttu-id="c489c-182">No hay ningún riesgo de interceptación del tráfico entre ANCM y Kestrel desde una ubicación fuera del servidor.</span><span class="sxs-lookup"><span data-stu-id="c489c-182">There's no risk of eavesdropping the traffic between the ANCM and Kestrel from a location off of the server.</span></span>

<span data-ttu-id="c489c-183">Un token de emparejamiento sirve para garantizar que las solicitudes recibidas por Kestrel se redirigieron mediante proxy por IIS y no procedieron de otra fuente.</span><span class="sxs-lookup"><span data-stu-id="c489c-183">A pairing token is used to guarantee that the requests received by Kestrel were proxied by IIS and didn't come from some other source.</span></span> <span data-ttu-id="c489c-184">ANCM crea el token de emparejamiento y lo establece en una variable de entorno (`ASPNETCORE_TOKEN`).</span><span class="sxs-lookup"><span data-stu-id="c489c-184">The pairing token is created and set into an environment variable (`ASPNETCORE_TOKEN`) by the ANCM.</span></span> <span data-ttu-id="c489c-185">El token de emparejamiento también se establece en un encabezado (`MSAspNetCoreToken`) en cada solicitud redirigida mediante proxy.</span><span class="sxs-lookup"><span data-stu-id="c489c-185">The pairing token is also set into a header (`MSAspNetCoreToken`) on every proxied request.</span></span> <span data-ttu-id="c489c-186">El middleware de IIS comprueba cada solicitud recibida para confirmar que el valor del encabezado del token de emparejamiento coincida con el valor de la variable de entorno.</span><span class="sxs-lookup"><span data-stu-id="c489c-186">IIS Middleware checks each request it receives to confirm that the pairing token header value matches the environment variable value.</span></span> <span data-ttu-id="c489c-187">Si los valores del token no coinciden, la solicitud se registra y se rechaza.</span><span class="sxs-lookup"><span data-stu-id="c489c-187">If the token values are mismatched, the request is logged and rejected.</span></span> <span data-ttu-id="c489c-188">No se puede acceder a la variable de entorno del token de emparejamiento y al tráfico entre ANCM y Kestrel desde una ubicación fuera del servidor.</span><span class="sxs-lookup"><span data-stu-id="c489c-188">The pairing token environment variable and the traffic between the ANCM and Kestrel aren't accessible from a location off of the server.</span></span> <span data-ttu-id="c489c-189">Sin conocer el valor del token de emparejamiento, un atacante no puede enviar solicitudes que omitan la comprobación en el middleware de IIS.</span><span class="sxs-lookup"><span data-stu-id="c489c-189">Without knowing the pairing token value, an attacker can't submit requests that bypass the check in the IIS Middleware.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c489c-190">Pasos siguientes</span><span class="sxs-lookup"><span data-stu-id="c489c-190">Next steps</span></span>

<span data-ttu-id="c489c-191">Para obtener más información, vea los siguientes recursos:</span><span class="sxs-lookup"><span data-stu-id="c489c-191">For more information, see the following resources:</span></span>

* [<span data-ttu-id="c489c-192">Aplicación de ejemplo para este artículo</span><span class="sxs-lookup"><span data-stu-id="c489c-192">Sample app for this article</span></span>](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/servers/aspnet-core-module/sample)
* [<span data-ttu-id="c489c-193">Código de origen del módulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="c489c-193">ASP.NET Core Module source code</span></span>](https://github.com/aspnet/AspNetCoreModule)
* [<span data-ttu-id="c489c-194">Referencia de configuración del módulo de ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="c489c-194">ASP.NET Core Module Configuration Reference</span></span>](xref:host-and-deploy/aspnet-core-module)
* [<span data-ttu-id="c489c-195">Hospedaje en Windows con IIS</span><span class="sxs-lookup"><span data-stu-id="c489c-195">Host on Windows with IIS</span></span>](xref:host-and-deploy/iis/index)
