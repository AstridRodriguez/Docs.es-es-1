---
title: "Dirección URL de reescritura de Middleware en ASP.NET Core"
author: guardrex
description: "Introducción a la dirección URL de reescritura y la redirección con instrucciones sobre cómo usar el Middleware de reescritura de dirección URL en las aplicaciones de ASP.NET Core."
keywords: "Núcleo de ASP.NET, volver a escribir, dirección URL de reescritura de direcciones URL, dirección URL de redirección, redirección de la dirección URL, middleware, apache_mod"
ms.author: riande
manager: wpickett
ms.date: 08/17/2017
ms.topic: article
ms.assetid: e6130638-c410-4161-9921-b658ce988bd1
ms.technology: aspnet
ms.prod: asp.net-core
uid: fundamentals/url-rewriting
ms.openlocfilehash: 735c53ab8a01d995c4945a95705ee9adb2fcdf02
ms.sourcegitcommit: 74e22e08e3b08cb576e5184d16f4af5656c13c0c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 08/25/2017
---
# <a name="url-rewriting-middleware-in-aspnet-core"></a><span data-ttu-id="b5c6a-104">Dirección URL de reescritura de Middleware en ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="b5c6a-104">URL Rewriting Middleware in ASP.NET Core</span></span>

<span data-ttu-id="b5c6a-105">Por [Luke Latham](https://github.com/GuardRex) y [Mikael Mengistu](https://github.com/mikaelm12)</span><span class="sxs-lookup"><span data-stu-id="b5c6a-105">By [Luke Latham](https://github.com/GuardRex) and [Mikael Mengistu](https://github.com/mikaelm12)</span></span>

[<span data-ttu-id="b5c6a-106">Ver o descargar el código de ejemplo</span><span class="sxs-lookup"><span data-stu-id="b5c6a-106">View or download sample code</span></span>](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/url-rewriting/samples/)

<span data-ttu-id="b5c6a-107">Reescritura de direcciones URL es el acto de modificar la solicitud las direcciones URL que se basan en una o varias reglas predefinidas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-107">URL rewriting is the act of modifying request URLs based on one or more predefined rules.</span></span> <span data-ttu-id="b5c6a-108">Reescritura de direcciones URL, crea una abstracción entre ubicaciones de los recursos y sus direcciones para que las ubicaciones y direcciones no están estrechamente vinculadas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-108">URL rewriting creates an abstraction between resource locations and their addresses so that the locations and addresses are not tightly linked.</span></span> <span data-ttu-id="b5c6a-109">Hay varios escenarios donde la reescritura de direcciones URL es útil:</span><span class="sxs-lookup"><span data-stu-id="b5c6a-109">There are several scenarios where URL rewriting is valuable:</span></span>
* <span data-ttu-id="b5c6a-110">Mover o reemplazar los recursos de servidor temporal o permanentemente mientras se mantiene estables localizadores para esos recursos</span><span class="sxs-lookup"><span data-stu-id="b5c6a-110">Moving or replacing server resources temporarily or permanently while maintaining stable locators for those resources</span></span>
* <span data-ttu-id="b5c6a-111">División entre las diferentes aplicaciones o entre áreas de una aplicación de procesamiento de solicitudes</span><span class="sxs-lookup"><span data-stu-id="b5c6a-111">Splitting request processing across different apps or across areas of one app</span></span>
* <span data-ttu-id="b5c6a-112">Quitar, agregar o reorganizar los segmentos de dirección URL en las solicitudes entrantes</span><span class="sxs-lookup"><span data-stu-id="b5c6a-112">Removing, adding, or reorganizing URL segments on incoming requests</span></span>
* <span data-ttu-id="b5c6a-113">Optimizar direcciones URL públicas para la optimización de motor de búsqueda (SEO)</span><span class="sxs-lookup"><span data-stu-id="b5c6a-113">Optimizing public URLs for Search Engine Optimization (SEO)</span></span>
* <span data-ttu-id="b5c6a-114">Permitir el uso de URL públicas preparadas para ayudar a los usuarios a predecir el contenido que se encuentran disponibles mediante el vínculo</span><span class="sxs-lookup"><span data-stu-id="b5c6a-114">Permitting the use of friendly public URLs to help people predict the content they will find by following a link</span></span>
* <span data-ttu-id="b5c6a-115">Redirigir solicitudes no seguras para proteger los puntos de conexión</span><span class="sxs-lookup"><span data-stu-id="b5c6a-115">Redirecting insecure requests to secure endpoints</span></span>
* <span data-ttu-id="b5c6a-116">Evitar hotlinking de imagen</span><span class="sxs-lookup"><span data-stu-id="b5c6a-116">Preventing image hotlinking</span></span>

<span data-ttu-id="b5c6a-117">Puede definir reglas para cambiar la dirección URL de varias maneras, incluido regex, reglas de módulo de Apache mod_rewrite, las reglas del módulo de Rewrite para IIS y usar lógica de la regla personalizada.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-117">You can define rules for changing the URL in several ways, including regex, Apache mod_rewrite module rules, IIS Rewrite Module rules, and using custom rule logic.</span></span> <span data-ttu-id="b5c6a-118">Este documento presenta la reescritura de direcciones URL con instrucciones sobre cómo usar el Middleware de reescritura de dirección URL en las aplicaciones de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-118">This document introduces URL rewriting with instructions on how to use URL Rewriting Middleware in ASP.NET Core apps.</span></span>

> [!NOTE]
> <span data-ttu-id="b5c6a-119">Reescritura de direcciones URL, puede reducir el rendimiento de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-119">URL rewriting can reduce the performance of an app.</span></span> <span data-ttu-id="b5c6a-120">Cuando sea factible, debe limitar el número y la complejidad de las reglas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-120">Where feasible, you should limit the number and complexity of rules.</span></span>

## <a name="url-redirect-and-url-rewrite"></a><span data-ttu-id="b5c6a-121">Vuelva a escribir el redireccionamiento de dirección URL y la dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-121">URL redirect and URL rewrite</span></span>
<span data-ttu-id="b5c6a-122">La diferencia en texto entre *redirección de la dirección URL* y *URL rewrite* puede parecer sutiles en primer pero tiene importantes implicaciones para proporcionar recursos a los clientes.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-122">The difference in wording between *URL redirect* and *URL rewrite* may seem subtle at first but has important implications for providing resources to clients.</span></span> <span data-ttu-id="b5c6a-123">Middleware de volver a escribir de dirección URL de ASP.NET Core es capaz de satisfacer la necesidad de ambos.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-123">ASP.NET Core's URL Rewriting Middleware is capable of meeting the need for both.</span></span>

<span data-ttu-id="b5c6a-124">A *redirección de la dirección URL* es una operación de cliente, donde se indica el cliente para tener acceso a un recurso en otra dirección.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-124">A *URL redirect* is a client-side operation, where the client is instructed to access a resource at another address.</span></span> <span data-ttu-id="b5c6a-125">Esto requiere una ida y vuelta al servidor, y la dirección URL de redireccionamiento devuelve al cliente aparece en la barra de direcciones del explorador cuando el cliente realiza una solicitud nueva para el recurso.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-125">This requires a round-trip to the server, and the redirect URL returned to the client appears in the browser's address bar when the client makes a new request for the resource.</span></span> <span data-ttu-id="b5c6a-126">Si `/resource` es *redirigido* a `/different-resource`, las solicitudes del cliente `/resource`, y el servidor responde que el cliente debe obtener el recurso en `/different-resource` con un código de estado que indica que la redirección es puede ser temporal o permanente.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-126">If `/resource` is *redirected* to `/different-resource`, the client requests `/resource`, and the server responds that the client should obtain the resource at `/different-resource` with a status code indicating that the redirect is either temporary or permanent.</span></span> <span data-ttu-id="b5c6a-127">El cliente ejecuta una nueva solicitud para el recurso en la dirección URL de redireccionamiento.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-127">The client executes a new request for the resource at the redirect URL.</span></span>

![Un punto de conexión de servicio de WebAPI se ha cambiado temporalmente de la versión 1 (v1) a la versión 2 (v2) en el servidor.](url-rewriting/_static/url_redirect.png)

<span data-ttu-id="b5c6a-133">Al redirigir las solicitudes a una dirección URL diferente, se indica si la redirección se permanentes o temporales.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-133">When redirecting requests to a different URL, you indicate whether the redirect is permanent or temporary.</span></span> <span data-ttu-id="b5c6a-134">El código de estado (movida permanentemente) 301 sirve para indicar al cliente que todas las solicitudes futuras para el recurso deben usar la nueva dirección URL donde el recurso tiene una dirección URL nueva, permanente y desea.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-134">The 301 (Moved Permanently) status code is used where the resource has a new, permanent URL and you wish to instruct the client that all future requests for the resource should use the new URL.</span></span> <span data-ttu-id="b5c6a-135">*El cliente puede almacenar en caché la respuesta cuando se recibe un código de 301 estado.*</span><span class="sxs-lookup"><span data-stu-id="b5c6a-135">*The client may cache the response when a 301 status code is received.*</span></span> <span data-ttu-id="b5c6a-136">Se utiliza el código de estado 302 (encontrado) donde la redirección es temporal o generalmente sujeto para cambiar, por ejemplo, que el cliente no debe almacenar y reutilizar la dirección URL de redireccionamiento en el futuro.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-136">The 302 (Found) status code is used where the redirection is temporary or generally subject to change, such that the client shouldn't store and reuse the redirect URL in the future.</span></span> <span data-ttu-id="b5c6a-137">Para obtener más información, consulte [RFC 2616: definiciones de código de estado](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-137">For more information, see [RFC 2616: Status Code Definitions](https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html).</span></span>

<span data-ttu-id="b5c6a-138">A *URL rewrite* es una operación de servidor para proporcionar un recurso desde una dirección de recursos distinto.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-138">A *URL rewrite* is a server-side operation to provide a resource from a different resource address.</span></span> <span data-ttu-id="b5c6a-139">Volver a escribir una dirección URL no requiere una ida y vuelta al servidor.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-139">Rewriting a URL doesn't require a round-trip to the server.</span></span> <span data-ttu-id="b5c6a-140">La dirección URL reescrita no se devuelve al cliente y no aparecerá en la barra de direcciones del explorador.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-140">The rewritten URL isn't returned to the client and won't appear in the browser's address bar.</span></span> <span data-ttu-id="b5c6a-141">Cuando `/resource` es *reescrito* a `/different-resource`, las solicitudes del cliente `/resource`y el servidor de *internamente* captura el recurso en `/different-resource`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-141">When `/resource` is *rewritten* to `/different-resource`, the client requests `/resource`, and the server *internally* fetches the resource at `/different-resource`.</span></span> <span data-ttu-id="b5c6a-142">Aunque el cliente podría ser capaz de recuperar el recurso en la dirección URL ha vuelto a escribir, el cliente no informará de que el recurso existe en la dirección URL reescrita cuando realiza su solicitud y recibe la respuesta.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-142">Although the client might be able to retrieve the resource at the rewritten URL, the client won't be informed that the resource exists at the rewritten URL when it makes its request and receives the response.</span></span>

![Se cambió un extremo de servicio de WebAPI de la versión 1 (v1) a la versión 2 (v2) en el servidor.](url-rewriting/_static/url_rewrite.png)

## <a name="url-rewriting-sample-app"></a><span data-ttu-id="b5c6a-147">Aplicación de ejemplo de reescritura de dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-147">URL rewriting sample app</span></span>
<span data-ttu-id="b5c6a-148">Puede explorar las características de Middleware de reescritura de dirección URL con el [aplicación de ejemplo de reescritura de dirección URL](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/url-rewriting/samples/).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-148">You can explore the features of the URL Rewriting Middleware with the [URL rewriting sample app](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/url-rewriting/samples/).</span></span> <span data-ttu-id="b5c6a-149">La aplicación aplica reescritura y reglas de redirección y muestra la dirección URL redirigida o ha vuelto a escribir.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-149">The app applies rewrite and redirect rules and shows the rewritten or redirected URL.</span></span>

## <a name="when-to-use-url-rewriting-middleware"></a><span data-ttu-id="b5c6a-150">Cuándo usar el Middleware de reescritura de dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-150">When to use URL Rewriting Middleware</span></span>
<span data-ttu-id="b5c6a-151">Usar el Middleware de reescritura de dirección URL cuando no se puede usar el [módulo URL Rewrite](https://www.iis.net/downloads/microsoft/url-rewrite) con IIS en Windows Server, el [módulo de Apache mod_rewrite](https://httpd.apache.org/docs/2.4/rewrite/) en el servidor Apache, [reescritura de direcciones URL en Nginx](https://www.nginx.com/blog/creating-nginx-rewrite-rules/), o la aplicación se hospeda en [servidor HTTP.sys](xref:fundamentals/servers/httpsys) (anteriormente denominados [WebListener](xref:fundamentals/servers/weblistener)).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-151">Use URL Rewriting Middleware when you are unable to use the [URL Rewrite module](https://www.iis.net/downloads/microsoft/url-rewrite) with IIS on Windows Server, the [Apache mod_rewrite module](https://httpd.apache.org/docs/2.4/rewrite/) on Apache Server, [URL rewriting on Nginx](https://www.nginx.com/blog/creating-nginx-rewrite-rules/), or your app is hosted on [HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called [WebListener](xref:fundamentals/servers/weblistener)).</span></span> <span data-ttu-id="b5c6a-152">Las principales razones para usar el servidor URL reescritura tecnologías basadas en IIS, Apache o Nginx son que el middleware no es compatible con todas las características de estos módulos y el rendimiento del middleware de probablemente no coincide con el de los módulos.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-152">The main reasons to use the server-based URL rewriting technologies in IIS, Apache, or Nginx are that the middleware doesn't support the full features of these modules and the performance of the middleware probably won't match that of the modules.</span></span> <span data-ttu-id="b5c6a-153">Sin embargo, hay algunas características de los módulos de servidor que no funcionan con proyectos de ASP.NET Core, como el `IsFile` y `IsDirectory` restricciones del módulo Rewrite para IIS.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-153">However, there are some features of the server modules that don't work with ASP.NET Core projects, such as the `IsFile` and `IsDirectory` constraints of the IIS Rewrite module.</span></span> <span data-ttu-id="b5c6a-154">En estos casos, utilice en su lugar el middleware.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-154">In these scenarios, use the middleware instead.</span></span>

## <a name="package"></a><span data-ttu-id="b5c6a-155">Package</span><span class="sxs-lookup"><span data-stu-id="b5c6a-155">Package</span></span>
<span data-ttu-id="b5c6a-156">Para incluir el software intermedio en el proyecto, agregue una referencia a la [ `Microsoft.AspNetCore.Rewrite` ](https://www.nuget.org/packages/Microsoft.AspNetCore.Rewrite/) paquete.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-156">To include the middleware in your project, add a reference to the [`Microsoft.AspNetCore.Rewrite`](https://www.nuget.org/packages/Microsoft.AspNetCore.Rewrite/) package.</span></span> <span data-ttu-id="b5c6a-157">Esta característica está disponible para las aplicaciones que tienen como destino ASP.NET Core 1.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-157">This feature is available for apps that target ASP.NET Core 1.1 or later.</span></span>

## <a name="extension-and-options"></a><span data-ttu-id="b5c6a-158">Extensión y opciones</span><span class="sxs-lookup"><span data-stu-id="b5c6a-158">Extension and options</span></span>
<span data-ttu-id="b5c6a-159">Establecer la reescritura de dirección URL y redirigir las reglas mediante la creación de una instancia de la `RewriteOptions` clase con métodos de extensión para cada una de las reglas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-159">Establish your URL rewrite and redirect rules by creating an instance of the `RewriteOptions` class with extension methods for each of your rules.</span></span> <span data-ttu-id="b5c6a-160">Encadenar varias reglas en el orden que desea procesar.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-160">Chain multiple rules in the order that you would like them processed.</span></span> <span data-ttu-id="b5c6a-161">El `RewriteOptions` se pasan en el Middleware de reescritura de dirección URL cuando se agrega a la canalización de solicitud con `app.UseRewriter(options);`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-161">The `RewriteOptions` are passed into the URL Rewriting Middleware as it's added to the request pipeline with `app.UseRewriter(options);`.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-162">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-162">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-163">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-163">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-164">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-164">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-165">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-165">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1)]</span></span>

---

### <a name="url-redirect"></a><span data-ttu-id="b5c6a-166">Redirección de la dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-166">URL redirect</span></span>
<span data-ttu-id="b5c6a-167">Use `AddRedirect` para redirigir las solicitudes.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-167">Use `AddRedirect` to redirect requests.</span></span> <span data-ttu-id="b5c6a-168">El primer parámetro contiene la expresión regular de coincidencia en la ruta de acceso de la dirección URL entrante.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-168">The first parameter contains your regex for matching on the path of the incoming URL.</span></span> <span data-ttu-id="b5c6a-169">El segundo parámetro es la cadena de reemplazo.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-169">The second parameter is the replacement string.</span></span> <span data-ttu-id="b5c6a-170">El tercer parámetro, si está presente, especifica el código de estado.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-170">The third parameter, if present, specifies the status code.</span></span> <span data-ttu-id="b5c6a-171">Si no se especifica el código de estado, el valor predeterminado es a 302 (encontrado), lo que indica que el recurso está temporalmente movido o reemplazado.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-171">If you don't specify the status code, it defaults to 302 (Found), which indicates that the resource is temporarily moved or replaced.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-172">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-172">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-173">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=5)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-173">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=5)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-174">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-174">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-175">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=2)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-175">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=2)]</span></span>

---

<span data-ttu-id="b5c6a-176">En un explorador con herramientas de desarrollo habilitado, realizar una solicitud a la aplicación de ejemplo con la ruta de acceso `/redirect-rule/1234/5678`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-176">In a browser with developer tools enabled, make a request to the sample app with the path `/redirect-rule/1234/5678`.</span></span> <span data-ttu-id="b5c6a-177">La expresión regular coincide con la ruta de acceso de solicitud de `redirect-rule/(.*)`, y la ruta de acceso se reemplaza con `/redirected/1234/5678`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-177">The regex matches the request path on `redirect-rule/(.*)`, and the path is replaced with `/redirected/1234/5678`.</span></span> <span data-ttu-id="b5c6a-178">La redirección de la dirección URL se envía al cliente con un código de estado 302 (encontrado).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-178">The redirect URL is sent back to the client with a 302 (Found) status code.</span></span> <span data-ttu-id="b5c6a-179">El explorador realiza una solicitud nueva en la dirección URL de redireccionamiento, que aparece en la barra de direcciones del explorador.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-179">The browser makes a new request at the redirect URL, which appears in the browser's address bar.</span></span> <span data-ttu-id="b5c6a-180">Puesto que coincide con ninguna regla en la aplicación de ejemplo en la dirección URL de redireccionamiento, la segunda solicitud recibe una respuesta de 200 (OK) de la aplicación y el cuerpo de la respuesta muestra la dirección URL de redireccionamiento.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-180">Since no rules in the sample app match on the redirect URL, the second request receives a 200 (OK) response from the app and the body of the response shows the redirect URL.</span></span> <span data-ttu-id="b5c6a-181">Se realiza un ida y vuelta al servidor cuando una dirección URL es *redirigido*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-181">A roundtrip is made to the server when a URL is *redirected*.</span></span>

> [!WARNING]
> <span data-ttu-id="b5c6a-182">Tenga cuidado al establecer las reglas de redirección.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-182">Be cautious when establishing your redirect rules.</span></span> <span data-ttu-id="b5c6a-183">Las reglas de redirección se evalúan en cada solicitud a la aplicación, incluso después de una redirección.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-183">Your redirect rules are evaluated on each request to the app, including after a redirect.</span></span> <span data-ttu-id="b5c6a-184">Es fácil accidentalmente creará un bucle de redirecciones infinitos.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-184">It's easy to accidently create a loop of infinite redirects.</span></span>

<span data-ttu-id="b5c6a-185">Solicitud original:`/redirect-rule/1234/5678`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-185">Original Request: `/redirect-rule/1234/5678`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas](url-rewriting/_static/add_redirect.png)

<span data-ttu-id="b5c6a-187">La parte de la expresión contenida entre paréntesis se denomina un *grupo de capturas*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-187">The part of the expression contained within parentheses is called a *capture group*.</span></span> <span data-ttu-id="b5c6a-188">El punto (`.`) de la expresión significa *coincide con cualquier carácter*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-188">The dot (`.`) of the expression means *match any character*.</span></span> <span data-ttu-id="b5c6a-189">El asterisco (`*`) indica *coincide con el carácter anterior cero o más veces*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-189">The asterisk (`*`) indicates *match the preceding character zero or more times*.</span></span> <span data-ttu-id="b5c6a-190">Por lo tanto, los dos últimos segmentos de la dirección URL, `1234/5678`, se capturan por grupo de captura `(.*)`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-190">Therefore, the last two path segments of the URL, `1234/5678`, are captured by capture group `(.*)`.</span></span> <span data-ttu-id="b5c6a-191">Cualquier valor que se proporciona en la dirección URL de solicitud después `redirect-rule/` capturada por este grupo de captura único.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-191">Any value you provide in the request URL after `redirect-rule/` is captured by this single capture group.</span></span>

<span data-ttu-id="b5c6a-192">En la cadena de reemplazo, se insertan los grupos capturados en la cadena con el signo de dólar (`$`) seguido del número de secuencia de la captura.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-192">In the replacement string, captured groups are injected into the string with the dollar sign (`$`) followed by the sequence number of the capture.</span></span> <span data-ttu-id="b5c6a-193">Se obtiene el valor del primer grupo de captura con `$1`, el segundo con `$2`, que siguen en secuencia para los grupos de captura en la expresión regular.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-193">The first capture group value is obtained with `$1`, the second with `$2`, and they continue in sequence for the capture groups in your regex.</span></span> <span data-ttu-id="b5c6a-194">Hay solo un grupo capturado en la expresión regular regla de redirección de la aplicación de ejemplo, por lo que hay solo un grupo insertado en la cadena de reemplazo, que es `$1`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-194">There's only one captured group in the redirect rule regex in the sample app, so there's only one injected group in the replacement string, which is `$1`.</span></span> <span data-ttu-id="b5c6a-195">Cuando se aplica la regla, se convierte en la dirección URL `/redirected/1234/5678`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-195">When the rule is applied, the URL becomes `/redirected/1234/5678`.</span></span>

<a name=url-redirect-to-secure-endpoint></a>
### <a name="url-redirect-to-a-secure-endpoint"></a><span data-ttu-id="b5c6a-196">Redireccionamiento de la dirección URL para un punto de conexión segura</span><span class="sxs-lookup"><span data-stu-id="b5c6a-196">URL redirect to a secure endpoint</span></span>
<span data-ttu-id="b5c6a-197">Use `AddRedirectToHttps` para redirigir las solicitudes HTTP en el mismo host y la ruta de acceso con HTTPS (`https://`).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-197">Use `AddRedirectToHttps` to redirect HTTP requests to the same host and path using HTTPS (`https://`).</span></span> <span data-ttu-id="b5c6a-198">Si no se proporciona el código de estado, el middleware predeterminado 302 (encontrado).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-198">If the status code isn't supplied, the middleware defaults to 302 (Found).</span></span> <span data-ttu-id="b5c6a-199">Si no se especifica el puerto, el middleware tiene como valor predeterminado `null`, lo que significa que el protocolo cambia a `https://` y el cliente tiene acceso al recurso en el puerto 443.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-199">If the port isn't supplied, the middleware defaults to `null`, which means the protocol changes to `https://` and the client accesses the resource on port 443.</span></span> <span data-ttu-id="b5c6a-200">En el ejemplo se muestra cómo establecer el código de estado para 301 (movida permanentemente) y cambie el puerto a 5001.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-200">The example shows how to set the status code to 301 (Moved Permanently) and change the port to 5001.</span></span>
```csharp
var options = new RewriteOptions()
    .AddRedirectToHttps(301, 5001);

app.UseRewriter(options);
```
<span data-ttu-id="b5c6a-201">Use `AddRedirectToHttpsPermanent` para redirigir las solicitudes poco en el mismo host y la ruta de acceso mediante el protocolo HTTPS seguro (`https://` en el puerto 443).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-201">Use `AddRedirectToHttpsPermanent` to redirect insecure requests to the same host and path with secure HTTPS protocol (`https://` on port 443).</span></span> <span data-ttu-id="b5c6a-202">El middleware establece el código de estado en 301 (movida permanentemente).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-202">The middleware sets the status code to 301 (Moved Permanently).</span></span>

<span data-ttu-id="b5c6a-203">La aplicación de ejemplo es capaz de mostrar cómo usar `AddRedirectToHttps` o `AddRedirectToHttpsPermanent`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-203">The sample app is capable of demonstrating how to use `AddRedirectToHttps` or `AddRedirectToHttpsPermanent`.</span></span> <span data-ttu-id="b5c6a-204">Agregue el método de extensión a la `RewriteOptions`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-204">Add the extension method to the `RewriteOptions`.</span></span> <span data-ttu-id="b5c6a-205">Realizar una solicitud poco a la aplicación en cualquier dirección URL.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-205">Make an insecure request to the app at any URL.</span></span> <span data-ttu-id="b5c6a-206">Descartar la advertencia de que el certificado autofirmado no es de confianza de seguridad de explorador.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-206">Dismiss the browser security warning that the self-signed certificate is untrusted.</span></span>

<span data-ttu-id="b5c6a-207">Solicitud original mediante `AddRedirectToHttps(301, 5001)`:`/secure`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-207">Original Request using `AddRedirectToHttps(301, 5001)`: `/secure`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas](url-rewriting/_static/add_redirect_to_https.png)

<span data-ttu-id="b5c6a-209">Solicitud original mediante `AddRedirectToHttpsPermanent`:`/secure`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-209">Original Request using `AddRedirectToHttpsPermanent`: `/secure`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas](url-rewriting/_static/add_redirect_to_https_permanent.png)

### <a name="url-rewrite"></a><span data-ttu-id="b5c6a-211">Reescritura de dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-211">URL rewrite</span></span>
<span data-ttu-id="b5c6a-212">Use `AddRewrite` para crear un reglas para volver a escribir las direcciones URL.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-212">Use `AddRewrite` to create a rules for rewriting URLs.</span></span> <span data-ttu-id="b5c6a-213">El primer parámetro contiene la expresión regular de coincidencia en la ruta de acceso de dirección URL entrante.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-213">The first parameter contains your regex for matching on the incoming URL path.</span></span> <span data-ttu-id="b5c6a-214">El segundo parámetro es la cadena de reemplazo.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-214">The second parameter is the replacement string.</span></span> <span data-ttu-id="b5c6a-215">El tercer parámetro, `skipRemainingRules: {true|false}`, indica el middleware de reglas de reescritura adicionales deben omitirse si se aplica la regla actual o no.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-215">The third parameter, `skipRemainingRules: {true|false}`, indicates to the middleware whether or not to skip additional rewrite rules if the current rule is applied.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-216">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-216">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-217">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=6)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-217">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=6)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-218">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-218">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-219">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=3)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-219">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=3)]</span></span>

---

<span data-ttu-id="b5c6a-220">Solicitud original:`/rewrite-rule/1234/5678`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-220">Original Request: `/rewrite-rule/1234/5678`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de la solicitud y respuesta](url-rewriting/_static/add_rewrite.png)

<span data-ttu-id="b5c6a-222">Lo primero que observa en la expresión regular es el acento circunflejo (`^`) al principio de la expresión.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-222">The first thing you notice in the regex is the carat (`^`) at the beginning of the expression.</span></span> <span data-ttu-id="b5c6a-223">Esto significa que búsqueda de coincidencias comienza al principio de la ruta de acceso de dirección URL.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-223">This means that matching starts at the beginning of the URL path.</span></span>

<span data-ttu-id="b5c6a-224">En el ejemplo anterior con la regla de redirección, `redirect-rule/(.*)`, no hay ningún acento circunflejo al principio de la expresión regular; por lo tanto, puede preceder cualquier carácter `redirect-rule/` en la ruta de acceso para una coincidencia correcta.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-224">In the earlier example with the redirect rule, `redirect-rule/(.*)`, there's no carat at the start of the regex; therefore, any characters may precede `redirect-rule/` in the path for a successful match.</span></span>

| <span data-ttu-id="b5c6a-225">Ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="b5c6a-225">Path</span></span>                               | <span data-ttu-id="b5c6a-226">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="b5c6a-226">Match</span></span> |
| ---------------------------------- | :---: |
| `/redirect-rule/1234/5678`         | <span data-ttu-id="b5c6a-227">Sí</span><span class="sxs-lookup"><span data-stu-id="b5c6a-227">Yes</span></span>   |
| `/my-cool-redirect-rule/1234/5678` | <span data-ttu-id="b5c6a-228">Sí</span><span class="sxs-lookup"><span data-stu-id="b5c6a-228">Yes</span></span>   |
| `/anotherredirect-rule/1234/5678`  | <span data-ttu-id="b5c6a-229">Sí</span><span class="sxs-lookup"><span data-stu-id="b5c6a-229">Yes</span></span>   |

<span data-ttu-id="b5c6a-230">La regla de reescritura, `^rewrite-rule/(\d+)/(\d+)`, solo coincide con las rutas de acceso si se inician con `rewrite-rule/`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-230">The rewrite rule, `^rewrite-rule/(\d+)/(\d+)`, only matches paths if they start with `rewrite-rule/`.</span></span> <span data-ttu-id="b5c6a-231">Observe la diferencia en la coincidencia entre la siguiente regla de reescritura y la regla de redirección anteriormente.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-231">Notice the difference in matching between the rewrite rule below and the redirect rule above.</span></span>

| <span data-ttu-id="b5c6a-232">Ruta de acceso</span><span class="sxs-lookup"><span data-stu-id="b5c6a-232">Path</span></span>                              | <span data-ttu-id="b5c6a-233">Coincidir con</span><span class="sxs-lookup"><span data-stu-id="b5c6a-233">Match</span></span> |
| --------------------------------- | :---: |
| `/rewrite-rule/1234/5678`         | <span data-ttu-id="b5c6a-234">Sí</span><span class="sxs-lookup"><span data-stu-id="b5c6a-234">Yes</span></span>   |
| `/my-cool-rewrite-rule/1234/5678` | <span data-ttu-id="b5c6a-235">No</span><span class="sxs-lookup"><span data-stu-id="b5c6a-235">No</span></span>    |
| `/anotherrewrite-rule/1234/5678`  | <span data-ttu-id="b5c6a-236">No</span><span class="sxs-lookup"><span data-stu-id="b5c6a-236">No</span></span>    |

<span data-ttu-id="b5c6a-237">Después de la `^rewrite-rule/` parte de la expresión, hay dos grupos de captura, `(\d+)/(\d+)`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-237">Following the `^rewrite-rule/` portion of the expression, there are two capture groups, `(\d+)/(\d+)`.</span></span> <span data-ttu-id="b5c6a-238">El `\d` significa *coincide con un dígito (número)*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-238">The `\d` signifies *match a digit (number)*.</span></span> <span data-ttu-id="b5c6a-239">El signo más (`+`) significa *coincide con uno o varios de los caracteres anteriores*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-239">The plus sign (`+`) means *match one or more of the preceding character*.</span></span> <span data-ttu-id="b5c6a-240">Por lo tanto, la dirección URL debe contener un número seguido de una diagonal seguida por otro número.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-240">Therefore, the URL must contain a number followed by a forward-slash followed by another number.</span></span> <span data-ttu-id="b5c6a-241">Captura de estos grupos se insertan en la dirección URL ha vuelto a escribir como `$1` y `$2`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-241">These capture groups are injected into the rewritten URL as `$1` and `$2`.</span></span> <span data-ttu-id="b5c6a-242">La cadena de reemplazo de la regla de reescritura coloca los grupos capturados en la cadena de consulta.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-242">The rewrite rule replacement string places the captured groups into the querystring.</span></span> <span data-ttu-id="b5c6a-243">La ruta de acceso solicitada de `/rewrite-rule/1234/5678` se ha reescrito para obtener el recurso en `/rewritten?var1=1234&var2=5678`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-243">The requested path of `/rewrite-rule/1234/5678` is rewritten to obtain the resource at `/rewritten?var1=1234&var2=5678`.</span></span> <span data-ttu-id="b5c6a-244">Si una cadena de consulta está presente en la solicitud original, se conservan cuando se vuelve a escribir la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-244">If a querystring is present on the original request, it's preserved when the URL is rewritten.</span></span>

<span data-ttu-id="b5c6a-245">No hay ningún ida y vuelta al servidor para obtener el recurso.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-245">There's no roundtrip to the server to obtain the resource.</span></span> <span data-ttu-id="b5c6a-246">Si el recurso existe, se capturan y se devuelve al cliente con un código de 200 estado (Aceptar).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-246">If the resource exists, it's fetched and returned to the client with a 200 (OK) status code.</span></span> <span data-ttu-id="b5c6a-247">Dado que el cliente no está redirigido, no cambia la dirección URL en la barra de direcciones del explorador.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-247">Because the client isn't redirected, the URL in the browser address bar doesn't change.</span></span> <span data-ttu-id="b5c6a-248">En lo que el cliente se refiere, la operación de reescritura de dirección URL nunca se ha producido.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-248">As far as the client is concerned, the URL rewrite operation never occurred.</span></span>

> [!NOTE]
> <span data-ttu-id="b5c6a-249">Use `skipRemainingRules: true` siempre que sea posible, ya que las reglas de coincidencia es un proceso costoso y reduce el tiempo de respuesta de aplicación.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-249">Use `skipRemainingRules: true` whenever possible, because matching rules is an expensive process and reduces app response time.</span></span> <span data-ttu-id="b5c6a-250">Para la respuesta más rápida de la aplicación:</span><span class="sxs-lookup"><span data-stu-id="b5c6a-250">For the fastest app response:</span></span>
> * <span data-ttu-id="b5c6a-251">Ordene las reglas de reescritura de la regla coincidente con más frecuencia a la regla coincidente con menor frecuencia.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-251">Order your rewrite rules from the most frequently matched rule to the least frequently matched rule.</span></span>
> * <span data-ttu-id="b5c6a-252">Omitir el procesamiento de las reglas restantes cuando se produce una coincidencia y no es necesario ningún procesamiento de reglas adicionales.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-252">Skip the processing of the remaining rules when a match occurs and no additional rule processing is required.</span></span>

### <a name="apache-modrewrite"></a><span data-ttu-id="b5c6a-253">Apache mod_rewrite</span><span class="sxs-lookup"><span data-stu-id="b5c6a-253">Apache mod_rewrite</span></span>
<span data-ttu-id="b5c6a-254">Aplicar reglas de Apache mod_rewrite con `AddApacheModRewrite`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-254">Apply Apache mod_rewrite rules with `AddApacheModRewrite`.</span></span> <span data-ttu-id="b5c6a-255">Asegúrese de que el archivo de reglas se implementa con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-255">Make sure that the rules file is deployed with the app.</span></span> <span data-ttu-id="b5c6a-256">Para obtener más información y ejemplos de reglas de mod_rewrite, consulte [Apache mod_rewrite](https://httpd.apache.org/docs/2.4/rewrite/).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-256">For more information and examples of mod_rewrite rules, see [Apache mod_rewrite](https://httpd.apache.org/docs/2.4/rewrite/).</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-257">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-257">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-258">A `StreamReader` se utiliza para leer las reglas de la *ApacheModRewrite.txt* archivo de reglas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-258">A `StreamReader` is used to read the rules from the *ApacheModRewrite.txt* rules file.</span></span>

<span data-ttu-id="b5c6a-259">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=1,7)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-259">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=1,7)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-260">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-260">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-261">El primer parámetro tiene un `IFileProvider`, que se proporciona a través de [inyección de dependencia](dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-261">The first parameter takes an `IFileProvider`, which is provided via [Dependency Injection](dependency-injection.md).</span></span> <span data-ttu-id="b5c6a-262">El `IHostingEnvironment` se inyecta para proporcionar la `ContentRootFileProvider`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-262">The `IHostingEnvironment` is injected to provide the `ContentRootFileProvider`.</span></span> <span data-ttu-id="b5c6a-263">El segundo parámetro es la ruta de acceso al archivo de reglas, que es *ApacheModRewrite.txt* en la aplicación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-263">The second parameter is the path to your rules file, which is *ApacheModRewrite.txt* in the sample app.</span></span>

<span data-ttu-id="b5c6a-264">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=4)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-264">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=4)]</span></span>

---

<span data-ttu-id="b5c6a-265">La aplicación de ejemplo redirige las solicitudes de `/apache-mod-rules-redirect/(.\*)` a `/redirected?id=$1`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-265">The sample app redirects requests from `/apache-mod-rules-redirect/(.\*)` to `/redirected?id=$1`.</span></span> <span data-ttu-id="b5c6a-266">El código de estado de respuesta es 302 (encontrado).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-266">The response status code is 302 (Found).</span></span>

[!code[Main](url-rewriting/samples/2.x/ApacheModRewrite.txt)]

<span data-ttu-id="b5c6a-267">Solicitud original:`/apache-mod-rules-redirect/1234`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-267">Original Request: `/apache-mod-rules-redirect/1234`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas](url-rewriting/_static/add_apache_mod_redirect.png)

##### <a name="supported-server-variables"></a><span data-ttu-id="b5c6a-269">Variables de servidor compatibles</span><span class="sxs-lookup"><span data-stu-id="b5c6a-269">Supported server variables</span></span>
<span data-ttu-id="b5c6a-270">El middleware admite las siguientes variables de servidor de Apache mod_rewrite:</span><span class="sxs-lookup"><span data-stu-id="b5c6a-270">The middleware supports the following Apache mod_rewrite server variables:</span></span>
* <span data-ttu-id="b5c6a-271">CONN_REMOTE_ADDR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-271">CONN_REMOTE_ADDR</span></span>
* <span data-ttu-id="b5c6a-272">HTTP_ACCEPT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-272">HTTP_ACCEPT</span></span>
* <span data-ttu-id="b5c6a-273">HTTP_CONNECTION</span><span class="sxs-lookup"><span data-stu-id="b5c6a-273">HTTP_CONNECTION</span></span>
* <span data-ttu-id="b5c6a-274">HTTP_COOKIE</span><span class="sxs-lookup"><span data-stu-id="b5c6a-274">HTTP_COOKIE</span></span>
* <span data-ttu-id="b5c6a-275">HTTP_FORWARDED</span><span class="sxs-lookup"><span data-stu-id="b5c6a-275">HTTP_FORWARDED</span></span>
* <span data-ttu-id="b5c6a-276">HTTP_HOST</span><span class="sxs-lookup"><span data-stu-id="b5c6a-276">HTTP_HOST</span></span>
* <span data-ttu-id="b5c6a-277">HTTP_REFERER</span><span class="sxs-lookup"><span data-stu-id="b5c6a-277">HTTP_REFERER</span></span>
* <span data-ttu-id="b5c6a-278">HTTP_USER_AGENT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-278">HTTP_USER_AGENT</span></span>
* <span data-ttu-id="b5c6a-279">HTTPS</span><span class="sxs-lookup"><span data-stu-id="b5c6a-279">HTTPS</span></span>
* <span data-ttu-id="b5c6a-280">IPV6</span><span class="sxs-lookup"><span data-stu-id="b5c6a-280">IPV6</span></span>
* <span data-ttu-id="b5c6a-281">QUERY_STRING</span><span class="sxs-lookup"><span data-stu-id="b5c6a-281">QUERY_STRING</span></span>
* <span data-ttu-id="b5c6a-282">REMOTE_ADDR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-282">REMOTE_ADDR</span></span>
* <span data-ttu-id="b5c6a-283">REMOTE_PORT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-283">REMOTE_PORT</span></span>
* <span data-ttu-id="b5c6a-284">REQUEST_FILENAME</span><span class="sxs-lookup"><span data-stu-id="b5c6a-284">REQUEST_FILENAME</span></span>
* <span data-ttu-id="b5c6a-285">REQUEST_METHOD</span><span class="sxs-lookup"><span data-stu-id="b5c6a-285">REQUEST_METHOD</span></span>
* <span data-ttu-id="b5c6a-286">REQUEST_SCHEME</span><span class="sxs-lookup"><span data-stu-id="b5c6a-286">REQUEST_SCHEME</span></span>
* <span data-ttu-id="b5c6a-287">REQUEST_URI</span><span class="sxs-lookup"><span data-stu-id="b5c6a-287">REQUEST_URI</span></span>
* <span data-ttu-id="b5c6a-288">SCRIPT_FILENAME</span><span class="sxs-lookup"><span data-stu-id="b5c6a-288">SCRIPT_FILENAME</span></span>
* <span data-ttu-id="b5c6a-289">SERVER_ADDR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-289">SERVER_ADDR</span></span>
* <span data-ttu-id="b5c6a-290">SERVER_PORT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-290">SERVER_PORT</span></span>
* <span data-ttu-id="b5c6a-291">SERVER_PROTOCOL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-291">SERVER_PROTOCOL</span></span>
* <span data-ttu-id="b5c6a-292">TIEMPO</span><span class="sxs-lookup"><span data-stu-id="b5c6a-292">TIME</span></span>
* <span data-ttu-id="b5c6a-293">TIME_DAY</span><span class="sxs-lookup"><span data-stu-id="b5c6a-293">TIME_DAY</span></span>
* <span data-ttu-id="b5c6a-294">TIME_HOUR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-294">TIME_HOUR</span></span>
* <span data-ttu-id="b5c6a-295">TIME_MIN</span><span class="sxs-lookup"><span data-stu-id="b5c6a-295">TIME_MIN</span></span>
* <span data-ttu-id="b5c6a-296">TIME_MON</span><span class="sxs-lookup"><span data-stu-id="b5c6a-296">TIME_MON</span></span>
* <span data-ttu-id="b5c6a-297">TIME_SEC</span><span class="sxs-lookup"><span data-stu-id="b5c6a-297">TIME_SEC</span></span>
* <span data-ttu-id="b5c6a-298">TIME_WDAY</span><span class="sxs-lookup"><span data-stu-id="b5c6a-298">TIME_WDAY</span></span>
* <span data-ttu-id="b5c6a-299">TIME_YEAR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-299">TIME_YEAR</span></span>

### <a name="iis-url-rewrite-module-rules"></a><span data-ttu-id="b5c6a-300">Reglas del módulo URL Rewrite de IIS</span><span class="sxs-lookup"><span data-stu-id="b5c6a-300">IIS URL Rewrite Module rules</span></span>
<span data-ttu-id="b5c6a-301">Para utilizar reglas que se aplican en el módulo URL Rewrite de IIS, utilice `AddIISUrlRewrite`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-301">To use rules that apply to the IIS URL Rewrite Module, use `AddIISUrlRewrite`.</span></span> <span data-ttu-id="b5c6a-302">Asegúrese de que el archivo de reglas se implementa con la aplicación.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-302">Make sure that the rules file is deployed with the app.</span></span> <span data-ttu-id="b5c6a-303">No dirigir el middleware para usar su *web.config* archivo cuando se ejecuta en Windows Server IIS.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-303">Don't direct the middleware to use your *web.config* file when running on Windows Server IIS.</span></span> <span data-ttu-id="b5c6a-304">Con IIS, estas reglas deben estar almacenadas fuera de su *web.config* para evitar conflictos con el módulo Rewrite para IIS.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-304">With IIS, these rules should be stored outside of your *web.config* to avoid conflicts with the IIS Rewrite module.</span></span> <span data-ttu-id="b5c6a-305">Para obtener más información y ejemplos de reglas de módulo URL Rewrite de IIS, consulte [utilizando Url Rewriter 2.0 módulo](https://www.iis.net/learn/extensions/url-rewrite-module/using-url-rewrite-module-20) y [referencia de configuración del módulo de volver a escribir dirección URL](https://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-configuration-reference).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-305">For more information and examples of IIS URL Rewrite Module rules, see [Using Url Rewrite Module 2.0](https://www.iis.net/learn/extensions/url-rewrite-module/using-url-rewrite-module-20) and [URL Rewrite Module Configuration Reference](https://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-configuration-reference).</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-306">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-306">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-307">A `StreamReader` se utiliza para leer las reglas de la *IISUrlRewrite.xml* archivo de reglas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-307">A `StreamReader` is used to read the rules from the *IISUrlRewrite.xml* rules file.</span></span>

<span data-ttu-id="b5c6a-308">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=2,8)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-308">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=2,8)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-309">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-309">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-310">El primer parámetro tiene un `IFileProvider`, mientras que el segundo parámetro es la ruta de acceso al archivo de reglas XML, que es *IISUrlRewrite.xml* en la aplicación de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-310">The first parameter takes an `IFileProvider`, while the second parameter is the path to your XML rules file, which is *IISUrlRewrite.xml* in the sample app.</span></span>

<span data-ttu-id="b5c6a-311">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=5)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-311">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=5)]</span></span>

---

<span data-ttu-id="b5c6a-312">La aplicación de ejemplo vuelve a escribir las solicitudes de `/iis-rules-rewrite/(.*)` a `/rewritten?id=$1`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-312">The sample app rewrites requests from `/iis-rules-rewrite/(.*)` to `/rewritten?id=$1`.</span></span> <span data-ttu-id="b5c6a-313">La respuesta se envía al cliente con un código de estado 200 (OK).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-313">The response is sent to the client with a 200 (OK) status code.</span></span>

<span data-ttu-id="b5c6a-314">[!code-xml[Main](url-rewriting/samples/2.x/IISUrlRewrite.xml)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-314">[!code-xml[Main](url-rewriting/samples/2.x/IISUrlRewrite.xml)]</span></span>

<span data-ttu-id="b5c6a-315">Solicitud original:`/iis-rules-rewrite/1234`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-315">Original Request: `/iis-rules-rewrite/1234`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de la solicitud y respuesta](url-rewriting/_static/add_iis_url_rewrite.png)

<span data-ttu-id="b5c6a-317">Si tiene un módulo de reescritura de IIS activo con reglas de nivel de servidor configuradas que pudieran afectar a la aplicación de maneras no deseados, puede deshabilitar el módulo de reescritura de IIS para una aplicación.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-317">If you have an active IIS Rewrite Module with server-level rules configured that would impact your app in undesirable ways, you can disable the IIS Rewrite Module for an app.</span></span> <span data-ttu-id="b5c6a-318">Para obtener más información, consulte [módulos IIS deshabilitar](xref:hosting/iis-modules#disabling-iis-modules).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-318">For more information, see [Disabling IIS modules](xref:hosting/iis-modules#disabling-iis-modules).</span></span>

#### <a name="unsupported-features"></a><span data-ttu-id="b5c6a-319">Características no admitidas</span><span class="sxs-lookup"><span data-stu-id="b5c6a-319">Unsupported features</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-320">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-320">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-321">El middleware publicado con ASP.NET Core 2.x no es compatible con las siguientes características de módulo URL Rewrite de IIS:</span><span class="sxs-lookup"><span data-stu-id="b5c6a-321">The middleware released with ASP.NET Core 2.x doesn't support the following IIS URL Rewrite Module features:</span></span>
* <span data-ttu-id="b5c6a-322">Reglas de salida</span><span class="sxs-lookup"><span data-stu-id="b5c6a-322">Outbound Rules</span></span>
* <span data-ttu-id="b5c6a-323">Variables de servidor personalizado</span><span class="sxs-lookup"><span data-stu-id="b5c6a-323">Custom Server Variables</span></span>
* <span data-ttu-id="b5c6a-324">Caracteres comodín</span><span class="sxs-lookup"><span data-stu-id="b5c6a-324">Wildcards</span></span>
* <span data-ttu-id="b5c6a-325">LogRewrittenUrl</span><span class="sxs-lookup"><span data-stu-id="b5c6a-325">LogRewrittenUrl</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-326">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-326">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-327">El middleware publicado con ASP.NET Core 1.x no es compatible con las siguientes características de módulo URL Rewrite de IIS:</span><span class="sxs-lookup"><span data-stu-id="b5c6a-327">The middleware released with ASP.NET Core 1.x doesn't support the following IIS URL Rewrite Module features:</span></span>
* <span data-ttu-id="b5c6a-328">Reglas globales</span><span class="sxs-lookup"><span data-stu-id="b5c6a-328">Global Rules</span></span>
* <span data-ttu-id="b5c6a-329">Reglas de salida</span><span class="sxs-lookup"><span data-stu-id="b5c6a-329">Outbound Rules</span></span>
* <span data-ttu-id="b5c6a-330">Mapas de reescritura</span><span class="sxs-lookup"><span data-stu-id="b5c6a-330">Rewrite Maps</span></span>
* <span data-ttu-id="b5c6a-331">Acción CustomResponse</span><span class="sxs-lookup"><span data-stu-id="b5c6a-331">CustomResponse Action</span></span>
* <span data-ttu-id="b5c6a-332">Variables de servidor personalizado</span><span class="sxs-lookup"><span data-stu-id="b5c6a-332">Custom Server Variables</span></span>
* <span data-ttu-id="b5c6a-333">Caracteres comodín</span><span class="sxs-lookup"><span data-stu-id="b5c6a-333">Wildcards</span></span>
* <span data-ttu-id="b5c6a-334">Acción: CustomResponse</span><span class="sxs-lookup"><span data-stu-id="b5c6a-334">Action:CustomResponse</span></span>
* <span data-ttu-id="b5c6a-335">LogRewrittenUrl</span><span class="sxs-lookup"><span data-stu-id="b5c6a-335">LogRewrittenUrl</span></span>

---

#### <a name="supported-server-variables"></a><span data-ttu-id="b5c6a-336">Variables de servidor compatibles</span><span class="sxs-lookup"><span data-stu-id="b5c6a-336">Supported server variables</span></span>
<span data-ttu-id="b5c6a-337">El middleware admite las siguientes variables de servidor de módulo URL Rewrite de IIS:</span><span class="sxs-lookup"><span data-stu-id="b5c6a-337">The middleware supports the following IIS URL Rewrite Module server variables:</span></span>
* <span data-ttu-id="b5c6a-338">CONTENT_LENGTH</span><span class="sxs-lookup"><span data-stu-id="b5c6a-338">CONTENT_LENGTH</span></span>
* <span data-ttu-id="b5c6a-339">CONTENT_TYPE</span><span class="sxs-lookup"><span data-stu-id="b5c6a-339">CONTENT_TYPE</span></span>
* <span data-ttu-id="b5c6a-340">HTTP_ACCEPT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-340">HTTP_ACCEPT</span></span>
* <span data-ttu-id="b5c6a-341">HTTP_CONNECTION</span><span class="sxs-lookup"><span data-stu-id="b5c6a-341">HTTP_CONNECTION</span></span>
* <span data-ttu-id="b5c6a-342">HTTP_COOKIE</span><span class="sxs-lookup"><span data-stu-id="b5c6a-342">HTTP_COOKIE</span></span>
* <span data-ttu-id="b5c6a-343">HTTP_HOST</span><span class="sxs-lookup"><span data-stu-id="b5c6a-343">HTTP_HOST</span></span>
* <span data-ttu-id="b5c6a-344">HTTP_REFERER</span><span class="sxs-lookup"><span data-stu-id="b5c6a-344">HTTP_REFERER</span></span>
* <span data-ttu-id="b5c6a-345">HTTP_URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-345">HTTP_URL</span></span>
* <span data-ttu-id="b5c6a-346">HTTP_USER_AGENT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-346">HTTP_USER_AGENT</span></span>
* <span data-ttu-id="b5c6a-347">HTTPS</span><span class="sxs-lookup"><span data-stu-id="b5c6a-347">HTTPS</span></span>
* <span data-ttu-id="b5c6a-348">LOCAL_ADDR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-348">LOCAL_ADDR</span></span>
* <span data-ttu-id="b5c6a-349">QUERY_STRING</span><span class="sxs-lookup"><span data-stu-id="b5c6a-349">QUERY_STRING</span></span>
* <span data-ttu-id="b5c6a-350">REMOTE_ADDR</span><span class="sxs-lookup"><span data-stu-id="b5c6a-350">REMOTE_ADDR</span></span>
* <span data-ttu-id="b5c6a-351">REMOTE_PORT</span><span class="sxs-lookup"><span data-stu-id="b5c6a-351">REMOTE_PORT</span></span>
* <span data-ttu-id="b5c6a-352">REQUEST_FILENAME</span><span class="sxs-lookup"><span data-stu-id="b5c6a-352">REQUEST_FILENAME</span></span>
* <span data-ttu-id="b5c6a-353">REQUEST_URI</span><span class="sxs-lookup"><span data-stu-id="b5c6a-353">REQUEST_URI</span></span>

> [!NOTE]
> <span data-ttu-id="b5c6a-354">También puede obtener un `IFileProvider` a través de un `PhysicalFileProvider`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-354">You can also obtain an `IFileProvider` via a `PhysicalFileProvider`.</span></span> <span data-ttu-id="b5c6a-355">Este enfoque puede proporcionar una mayor flexibilidad para la ubicación de la reescritura de archivos de reglas.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-355">This approach may provide greater flexibility for the location of your rewrite rules files.</span></span> <span data-ttu-id="b5c6a-356">Asegúrese de que los archivos de reglas de reescritura se implementan en el servidor en la ruta de acceso que proporcione.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-356">Make sure that your rewrite rules files are deployed to the server at the path you provide.</span></span>
> ```csharp
> PhysicalFileProvider fileProvider = new PhysicalFileProvider(Directory.GetCurrentDirectory());
> ```

### <a name="method-based-rule"></a><span data-ttu-id="b5c6a-357">Regla de recopilación (método)</span><span class="sxs-lookup"><span data-stu-id="b5c6a-357">Method-based rule</span></span>
<span data-ttu-id="b5c6a-358">Use `Add(Action<RewriteContext> applyRule)` para implementar su propia lógica de la regla en un método.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-358">Use `Add(Action<RewriteContext> applyRule)` to implement your own rule logic in a method.</span></span> <span data-ttu-id="b5c6a-359">El `RewriteContext` expone el `HttpContext` para su uso en el método.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-359">The `RewriteContext` exposes the `HttpContext` for use in your method.</span></span> <span data-ttu-id="b5c6a-360">El `context.Result` determina cómo adicional canalización controla el procesamiento.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-360">The `context.Result` determines how additional pipeline processing is handled.</span></span>

| <span data-ttu-id="b5c6a-361">contexto. Resultado</span><span class="sxs-lookup"><span data-stu-id="b5c6a-361">context.Result</span></span>                       | <span data-ttu-id="b5c6a-362">Acción</span><span class="sxs-lookup"><span data-stu-id="b5c6a-362">Action</span></span>                                                          |
| ------------------------------------ | --------------------------------------------------------------- |
| <span data-ttu-id="b5c6a-363">`RuleResult.ContinueRules` (valor predeterminado)</span><span class="sxs-lookup"><span data-stu-id="b5c6a-363">`RuleResult.ContinueRules` (default)</span></span> | <span data-ttu-id="b5c6a-364">Continúe aplicando reglas</span><span class="sxs-lookup"><span data-stu-id="b5c6a-364">Continue applying rules</span></span>                                         |
| `RuleResult.EndResponse`             | <span data-ttu-id="b5c6a-365">Dejar de aplicar las reglas y enviar la respuesta</span><span class="sxs-lookup"><span data-stu-id="b5c6a-365">Stop applying rules and send the response</span></span>                       |
| `RuleResult.SkipRemainingRules`      | <span data-ttu-id="b5c6a-366">Dejar de aplicar las reglas y enviar el contexto al siguiente middleware</span><span class="sxs-lookup"><span data-stu-id="b5c6a-366">Stop applying rules and send the context to the next middleware</span></span> |

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-367">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-367">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-368">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=9)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-368">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=9)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-369">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-369">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-370">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=6)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-370">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=6)]</span></span>

---

<span data-ttu-id="b5c6a-371">La aplicación de ejemplo muestra un método que redirige las solicitudes para las rutas de acceso que terminen con *.xml*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-371">The sample app demonstrates a method that redirects requests for paths that end with *.xml*.</span></span> <span data-ttu-id="b5c6a-372">Si se realiza una solicitud `/file.xml`, se redirige a `/xmlfiles/file.xml`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-372">If you make a request for `/file.xml`, it's redirected to `/xmlfiles/file.xml`.</span></span> <span data-ttu-id="b5c6a-373">El código de estado se establece en 301 (movida permanentemente).</span><span class="sxs-lookup"><span data-stu-id="b5c6a-373">The status code is set to 301 (Moved Permanently).</span></span> <span data-ttu-id="b5c6a-374">Para una redirección, debe establecer explícitamente el código de estado de la respuesta; en caso contrario, se devuelve un código de estado 200 (OK) y no se produzca la redirección en el cliente.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-374">For a redirect, you must explicitly set the status code of the response; otherwise, a 200 (OK) status code is returned and the redirect won't occur on the client.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-375">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-375">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-376">[!code-csharp[Main](url-rewriting/samples/2.x/RewriteRules.cs?name=snippet1)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-376">[!code-csharp[Main](url-rewriting/samples/2.x/RewriteRules.cs?name=snippet1)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-377">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-377">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-378">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet2)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-378">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet2)]</span></span>

---

<span data-ttu-id="b5c6a-379">Solicitud original:`/file.xml`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-379">Original Request: `/file.xml`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas para file.xml](url-rewriting/_static/add_redirect_xml_requests.png)

### <a name="irule-based-rule"></a><span data-ttu-id="b5c6a-381">Regla de recopilación IRule</span><span class="sxs-lookup"><span data-stu-id="b5c6a-381">IRule-based rule</span></span>
<span data-ttu-id="b5c6a-382">Use `Add(IRule)` para implementar su propia lógica de la regla en una clase que deriva de `IRule`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-382">Use `Add(IRule)` to implement your own rule logic in a class that derives from `IRule`.</span></span> <span data-ttu-id="b5c6a-383">Mediante una `IRule` proporciona mayor flexibilidad en comparación con el enfoque de reglas basadas en métodos.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-383">Using an `IRule` provides greater flexibility over using the method-based rule approach.</span></span> <span data-ttu-id="b5c6a-384">La clase derivada puede incluir un constructor, donde puede pasar parámetros para el `ApplyRule` método.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-384">Your derived class may include a constructor, where you can pass in parameters for the `ApplyRule` method.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-385">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-385">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-386">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=10-11)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-386">[!code-csharp[Main](url-rewriting/samples/2.x/Program.cs?name=snippet1&highlight=10-11)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-387">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-387">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-388">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=7-8)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-388">[!code-csharp[Main](url-rewriting/samples/1.x/Startup.cs?name=snippet1&highlight=7-8)]</span></span>

---

<span data-ttu-id="b5c6a-389">Los valores de los parámetros en la aplicación de ejemplo para la `extension` y `newPath` se comprueban para cumplir varias condiciones.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-389">The values of the parameters in the sample app for the `extension` and the `newPath` are checked to meet several conditions.</span></span> <span data-ttu-id="b5c6a-390">El `extension` debe contener un valor, y el valor debe ser *.png*, *.jpg*, o *.gif*.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-390">The `extension` must contain a value, and the value must be *.png*, *.jpg*, or *.gif*.</span></span> <span data-ttu-id="b5c6a-391">Si el `newPath` no es válido, un `ArgumentException` se produce.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-391">If the `newPath` isn't valid, an `ArgumentException` is thrown.</span></span> <span data-ttu-id="b5c6a-392">Si se realiza una solicitud *image.png*, se redirige a `/png-images/image.png`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-392">If you make a request for *image.png*, it's redirected to `/png-images/image.png`.</span></span> <span data-ttu-id="b5c6a-393">Si se realiza una solicitud *image.jpg*, se redirige a `/jpg-images/image.jpg`.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-393">If you make a request for *image.jpg*, it's redirected to `/jpg-images/image.jpg`.</span></span> <span data-ttu-id="b5c6a-394">El código de estado se establece en 301 (movida permanentemente) y el `context.Result` se establece para detener el procesamiento de las reglas y enviar la respuesta.</span><span class="sxs-lookup"><span data-stu-id="b5c6a-394">The status code is set to 301 (Moved Permanently), and the `context.Result` is set to stop processing rules and send the response.</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="b5c6a-395">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-395">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="b5c6a-396">[!code-csharp[Main](url-rewriting/samples/2.x/RewriteRules.cs?name=snippet2)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-396">[!code-csharp[Main](url-rewriting/samples/2.x/RewriteRules.cs?name=snippet2)]</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="b5c6a-397">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="b5c6a-397">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="b5c6a-398">[!code-csharp[Main](url-rewriting/samples/1.x/RewriteRule.cs?name=snippet1)]</span><span class="sxs-lookup"><span data-stu-id="b5c6a-398">[!code-csharp[Main](url-rewriting/samples/1.x/RewriteRule.cs?name=snippet1)]</span></span>

---

<span data-ttu-id="b5c6a-399">Solicitud original:`/image.png`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-399">Original Request: `/image.png`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas para image.png](url-rewriting/_static/add_redirect_png_requests.png)

<span data-ttu-id="b5c6a-401">Solicitud original:`/image.jpg`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-401">Original Request: `/image.jpg`</span></span>

![Ventana del explorador con herramientas de desarrollo de seguimiento de las solicitudes y respuestas para image.jpg](url-rewriting/_static/add_redirect_jpg_requests.png)

## <a name="regex-examples"></a><span data-ttu-id="b5c6a-403">Ejemplos de expresión regular</span><span class="sxs-lookup"><span data-stu-id="b5c6a-403">Regex examples</span></span>

| <span data-ttu-id="b5c6a-404">Objetivo</span><span class="sxs-lookup"><span data-stu-id="b5c6a-404">Goal</span></span> | <span data-ttu-id="b5c6a-405">Cadena de expresión regular &</span><span class="sxs-lookup"><span data-stu-id="b5c6a-405">Regex String &</span></span><br><span data-ttu-id="b5c6a-406">Ejemplo de coincidencia</span><span class="sxs-lookup"><span data-stu-id="b5c6a-406">Match Example</span></span> | <span data-ttu-id="b5c6a-407">Cadena de reemplazo &</span><span class="sxs-lookup"><span data-stu-id="b5c6a-407">Replacement String &</span></span><br><span data-ttu-id="b5c6a-408">Ejemplo de salida</span><span class="sxs-lookup"><span data-stu-id="b5c6a-408">Output Example</span></span> |
| ---- | :-----------------------------: | :------------------------------------: |
| <span data-ttu-id="b5c6a-409">Ruta de acceso de reescritura en la cadena de consulta</span><span class="sxs-lookup"><span data-stu-id="b5c6a-409">Rewrite path into querystring</span></span> | `^path/(.*)/(.*)`<br>`/path/abc/123` | `path?var1=$1&var2=$2`<br>`/path?var1=abc&var2=123` |
| <span data-ttu-id="b5c6a-410">Quitar la barra diagonal final</span><span class="sxs-lookup"><span data-stu-id="b5c6a-410">Strip trailing slash</span></span> | `(.*)/$`<br>`/path/` | `$1`<br>`/path` |
| <span data-ttu-id="b5c6a-411">Exigir la barra diagonal final</span><span class="sxs-lookup"><span data-stu-id="b5c6a-411">Enforce trailing slash</span></span> | `(.*[^/])$`<br>`/path` | `$1/`<br>`/path/` |
| <span data-ttu-id="b5c6a-412">Evitar tener que escribir solicitudes específicas</span><span class="sxs-lookup"><span data-stu-id="b5c6a-412">Avoid rewriting specific requests</span></span> | `(.*[^(\.axd)])$`<br><span data-ttu-id="b5c6a-413">Sí:`/resource.htm`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-413">Yes: `/resource.htm`</span></span><br><span data-ttu-id="b5c6a-414">No:`/resource.axd`</span><span class="sxs-lookup"><span data-stu-id="b5c6a-414">No: `/resource.axd`</span></span> | `rewritten/$1`<br>`/rewritten/resource.htm`<br>`/resource.axd` |
| <span data-ttu-id="b5c6a-415">Reorganizar los segmentos de dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-415">Rearrange URL segments</span></span> | `path/(.*)/(.*)/(.*)`<br>`path/1/2/3` | `path/$3/$2/$1`<br>`path/3/2/1` |
| <span data-ttu-id="b5c6a-416">Reemplazar un segmento de dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-416">Replace a URL segment</span></span> | `^(.*)/segment2/(.*)`<br>`/segment1/segment2/segment3` | `$1/replaced/$2`<br>`/segment1/replaced/segment3` |

## <a name="additional-resources"></a><span data-ttu-id="b5c6a-417">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="b5c6a-417">Additional resources</span></span>
* [<span data-ttu-id="b5c6a-418">Inicio de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="b5c6a-418">Application Startup</span></span>](startup.md)
* [<span data-ttu-id="b5c6a-419">Software intermedio</span><span class="sxs-lookup"><span data-stu-id="b5c6a-419">Middleware</span></span>](middleware.md)
* [<span data-ttu-id="b5c6a-420">Expresiones regulares en .NET</span><span class="sxs-lookup"><span data-stu-id="b5c6a-420">Regular expressions in .NET</span></span>](/dotnet/articles/standard/base-types/regular-expressions)
* [<span data-ttu-id="b5c6a-421">Lenguaje de expresiones regulares: referencia rápida</span><span class="sxs-lookup"><span data-stu-id="b5c6a-421">Regular expression language - quick reference</span></span>](/dotnet/articles/standard/base-types/quick-ref)
* [<span data-ttu-id="b5c6a-422">Apache mod_rewrite</span><span class="sxs-lookup"><span data-stu-id="b5c6a-422">Apache mod_rewrite</span></span>](https://httpd.apache.org/docs/2.4/rewrite/)
* [<span data-ttu-id="b5c6a-423">Usar módulo Url Rewrite 2.0 (para IIS)</span><span class="sxs-lookup"><span data-stu-id="b5c6a-423">Using Url Rewrite Module 2.0 (for IIS)</span></span>](https://www.iis.net/learn/extensions/url-rewrite-module/using-url-rewrite-module-20)
* [<span data-ttu-id="b5c6a-424">Referencia de configuración del módulo de reescritura de dirección URL</span><span class="sxs-lookup"><span data-stu-id="b5c6a-424">URL Rewrite Module Configuration Reference</span></span>](https://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-configuration-reference)
* [<span data-ttu-id="b5c6a-425">Foro de módulo de reescritura de dirección URL de IIS</span><span class="sxs-lookup"><span data-stu-id="b5c6a-425">IIS URL Rewrite Module Forum</span></span>](https://forums.iis.net/1152.aspx)
* [<span data-ttu-id="b5c6a-426">Mantener una estructura de dirección URL simple</span><span class="sxs-lookup"><span data-stu-id="b5c6a-426">Keep a simple URL structure</span></span>](https://support.google.com/webmasters/answer/76329?hl=en)
* [<span data-ttu-id="b5c6a-427">Reescritura de direcciones URL en 10 sugerencias y trucos</span><span class="sxs-lookup"><span data-stu-id="b5c6a-427">10 URL Rewriting Tips and Tricks</span></span>](http://ruslany.net/2009/04/10-url-rewriting-tips-and-tricks/)
* [<span data-ttu-id="b5c6a-428">Barra diagonal o no barra diagonal</span><span class="sxs-lookup"><span data-stu-id="b5c6a-428">To slash or not to slash</span></span>](https://webmasters.googleblog.com/2010/04/to-slash-or-not-to-slash.html)
