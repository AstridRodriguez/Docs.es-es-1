## <a name="call-the-web-api-with-jquery"></a><span data-ttu-id="92db7-101">Llamar a Web API con jQuery</span><span class="sxs-lookup"><span data-stu-id="92db7-101">Call the Web API with jQuery</span></span>

<span data-ttu-id="92db7-102">En esta sección, se agrega una página HTML que usa jQuery para llamar a Web API.</span><span class="sxs-lookup"><span data-stu-id="92db7-102">In this section, an HTML page is added that uses jQuery to call the Web API.</span></span> <span data-ttu-id="92db7-103">jQuery inicia la solicitud y actualiza la página con los detalles de la respuesta de la API.</span><span class="sxs-lookup"><span data-stu-id="92db7-103">jQuery initiates the request and updates the page with the details from the API's response.</span></span>

<span data-ttu-id="92db7-104">Configure el proyecto para atender archivos estáticos y para permitir la asignación de archivos predeterminada.</span><span class="sxs-lookup"><span data-stu-id="92db7-104">Configure the project to serve static files and to enable default file mapping.</span></span> <span data-ttu-id="92db7-105">Esto se logra invocando los métodos de extensión [UseStaticFiles](/dotnet/api/microsoft.aspnetcore.builder.staticfileextensions.usestaticfiles#Microsoft_AspNetCore_Builder_StaticFileExtensions_UseStaticFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) y [UseDefaultFiles](/dotnet/api/microsoft.aspnetcore.builder.defaultfilesextensions.usedefaultfiles#Microsoft_AspNetCore_Builder_DefaultFilesExtensions_UseDefaultFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) en *Startup.Configure*.</span><span class="sxs-lookup"><span data-stu-id="92db7-105">This is accomplished by invoking the [UseStaticFiles](/dotnet/api/microsoft.aspnetcore.builder.staticfileextensions.usestaticfiles#Microsoft_AspNetCore_Builder_StaticFileExtensions_UseStaticFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) and [UseDefaultFiles](/dotnet/api/microsoft.aspnetcore.builder.defaultfilesextensions.usedefaultfiles#Microsoft_AspNetCore_Builder_DefaultFilesExtensions_UseDefaultFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) extension methods in *Startup.Configure*.</span></span> <span data-ttu-id="92db7-106">Para obtener más información, consulte [Archivos estáticos](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="92db7-106">For more information, see [Static files](xref:fundamentals/static-files).</span></span>

[!code-csharp[](../../tutorials/first-web-api/samples/2.0/TodoApi/Startup2.cs?name=snippet_Configure&highlight=3-4)]

<span data-ttu-id="92db7-107">Agregue un archivo HTML denominado *index.html* al directorio *wwwroot* del proyecto.</span><span class="sxs-lookup"><span data-stu-id="92db7-107">Add an HTML file, named *index.html*, to the project's *wwwroot* directory.</span></span> <span data-ttu-id="92db7-108">Reemplace el contenido por el siguiente marcado:</span><span class="sxs-lookup"><span data-stu-id="92db7-108">Replace its contents with the following markup:</span></span>

[!code-html[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/index.html)]

<span data-ttu-id="92db7-109">Agregue un archivo JavaScript denominado *site.js* al directorio *wwwroot* del proyecto.</span><span class="sxs-lookup"><span data-stu-id="92db7-109">Add a JavaScript file, named *site.js*, to the project's *wwwroot* directory.</span></span> <span data-ttu-id="92db7-110">Reemplace el contenido por el siguiente código:</span><span class="sxs-lookup"><span data-stu-id="92db7-110">Replace its contents with the following code:</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_SiteJs)]

<span data-ttu-id="92db7-111">Puede que sea necesario realizar un cambio en la configuración de inicio del proyecto de ASP.NET Core para comprobar la página HTML localmente.</span><span class="sxs-lookup"><span data-stu-id="92db7-111">A change to the ASP.NET Core project's launch settings may be required to test the HTML page locally.</span></span> <span data-ttu-id="92db7-112">Abra *launchSettings.json* en el directorio *Properties* del proyecto.</span><span class="sxs-lookup"><span data-stu-id="92db7-112">Open *launchSettings.json* in the *Properties* directory of the project.</span></span> <span data-ttu-id="92db7-113">Quite la propiedad `launchUrl` para forzar a la aplicación a abrirse en *index.html*, esto es, el archivo predeterminado del proyecto.</span><span class="sxs-lookup"><span data-stu-id="92db7-113">Remove the `launchUrl` property to force the app to open at *index.html*&mdash;the project's default file.</span></span>

<span data-ttu-id="92db7-114">Existen varias formas de obtener jQuery.</span><span class="sxs-lookup"><span data-stu-id="92db7-114">There are several ways to get jQuery.</span></span> <span data-ttu-id="92db7-115">En el fragmento de código anterior, la biblioteca se carga desde una red CDN.</span><span class="sxs-lookup"><span data-stu-id="92db7-115">In the preceding snippet, the library is loaded from a CDN.</span></span> <span data-ttu-id="92db7-116">Este ejemplo es un ejemplo de CRUD completo de llamada a la API de jQuery.</span><span class="sxs-lookup"><span data-stu-id="92db7-116">This sample is a complete CRUD example of calling the API with jQuery.</span></span> <span data-ttu-id="92db7-117">Existen más características en este ejemplo para hacer que la experiencia sea más completa.</span><span class="sxs-lookup"><span data-stu-id="92db7-117">There are additional features in this sample to make the experience richer.</span></span> <span data-ttu-id="92db7-118">Aquí verá algunas explicaciones sobre las llamadas a la API.</span><span class="sxs-lookup"><span data-stu-id="92db7-118">Below are explanations around the calls to the API.</span></span>

### <a name="get-a-list-of-to-do-items"></a><span data-ttu-id="92db7-119">Obtener una lista de tareas pendientes</span><span class="sxs-lookup"><span data-stu-id="92db7-119">Get a list of to-do items</span></span>

<span data-ttu-id="92db7-120">Para obtener una lista de tareas pendientes, envíe una solicitud HTTP GET a */api/todo*.</span><span class="sxs-lookup"><span data-stu-id="92db7-120">To get a list of to-do items, send an HTTP GET request to */api/todo*.</span></span>

<span data-ttu-id="92db7-121">La función de JQuery [ajax](https://api.jquery.com/jquery.ajax/) envía una solicitud AJAX a la API, que devuelve código JSON que representa un objeto o una matriz.</span><span class="sxs-lookup"><span data-stu-id="92db7-121">The jQuery [ajax](https://api.jquery.com/jquery.ajax/) function sends an AJAX request to the API, which returns JSON representing an object or array.</span></span> <span data-ttu-id="92db7-122">Esta función puede controlar todas las formas de interacción de HTTP enviando una solicitud HTTP a la `url` especificada.</span><span class="sxs-lookup"><span data-stu-id="92db7-122">This function can handle all forms of HTTP interaction, sending an HTTP request to the specified `url`.</span></span> <span data-ttu-id="92db7-123">`GET` se emite como `type`.</span><span class="sxs-lookup"><span data-stu-id="92db7-123">`GET` is used as the `type`.</span></span> <span data-ttu-id="92db7-124">La función de devolución de llamada `success` se invoca si la solicitud se realiza correctamente.</span><span class="sxs-lookup"><span data-stu-id="92db7-124">The `success` callback function is invoked if the request succeeds.</span></span> <span data-ttu-id="92db7-125">En la devolución de llamada, el DOM se actualiza con la información de la tarea pendiente.</span><span class="sxs-lookup"><span data-stu-id="92db7-125">In the callback, the DOM is updated with the to-do information.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_GetData)]

### <a name="add-a-to-do-item"></a><span data-ttu-id="92db7-126">Agregar una tarea pendiente</span><span class="sxs-lookup"><span data-stu-id="92db7-126">Add a to-do item</span></span>

<span data-ttu-id="92db7-127">Para agregar una tarea pendiente, envíe una solicitud HTTP POST a */api/todo*.</span><span class="sxs-lookup"><span data-stu-id="92db7-127">To add a to-do item, send an HTTP POST request to */api/todo/*.</span></span> <span data-ttu-id="92db7-128">El cuerpo de la solicitud debe contener un objeto de tarea pendiente.</span><span class="sxs-lookup"><span data-stu-id="92db7-128">The request body should contain a to-do object.</span></span> <span data-ttu-id="92db7-129">La función [ajax](https://api.jquery.com/jquery.ajax/) usa `POST` para llamar a la API.</span><span class="sxs-lookup"><span data-stu-id="92db7-129">The [ajax](https://api.jquery.com/jquery.ajax/) function is using `POST` to call the API.</span></span> <span data-ttu-id="92db7-130">En las solicitudes `POST` y `PUT`, el cuerpo de la solicitud representa los datos enviados a la API.</span><span class="sxs-lookup"><span data-stu-id="92db7-130">For `POST` and `PUT` requests, the request body represents the data sent to the API.</span></span> <span data-ttu-id="92db7-131">La API espera un cuerpo de solicitud con formato JSON.</span><span class="sxs-lookup"><span data-stu-id="92db7-131">The API is expecting a JSON request body.</span></span> <span data-ttu-id="92db7-132">Las opciones `accepts` y `contentType` se establecen en `application/json` para clasificar el tipo de medio que se va a recibir y a enviar respectivamente.</span><span class="sxs-lookup"><span data-stu-id="92db7-132">The `accepts` and `contentType` options are set to `application/json` to classify the media type being received and sent, respectively.</span></span> <span data-ttu-id="92db7-133">Los datos se convierten en un objeto JSON usando [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).</span><span class="sxs-lookup"><span data-stu-id="92db7-133">The data is converted to a JSON object using [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).</span></span> <span data-ttu-id="92db7-134">Cuando la API devuelve un código de estado correcto, se invoca la función `getData` para actualizar la tabla HTML.</span><span class="sxs-lookup"><span data-stu-id="92db7-134">When the API returns a successful status code, the `getData` function is invoked to update the HTML table.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AddItem)]

### <a name="update-a-to-do-item"></a><span data-ttu-id="92db7-135">Actualizar una tarea pendiente</span><span class="sxs-lookup"><span data-stu-id="92db7-135">Update a to-do item</span></span>

<span data-ttu-id="92db7-136">Actualizar una tarea pendiente es muy parecido a agregarla, ya que ambos procesos se basan en el cuerpo de solicitud.</span><span class="sxs-lookup"><span data-stu-id="92db7-136">Updating a to-do item is very similar to adding one, since both rely on a request body.</span></span> <span data-ttu-id="92db7-137">En este caso, la única diferencia real entre ambos es que `url` cambia para reflejar el identificador único del elemento, y `type` es `PUT`.</span><span class="sxs-lookup"><span data-stu-id="92db7-137">The only real difference between the two in this case is that the `url` changes to add the unique identifier of the item, and the `type` is `PUT`.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AjaxPut)]

### <a name="delete-a-to-do-item"></a><span data-ttu-id="92db7-138">Eliminar una tarea pendiente</span><span class="sxs-lookup"><span data-stu-id="92db7-138">Delete a to-do item</span></span>

<span data-ttu-id="92db7-139">Para eliminar una tarea pendiente, hay que establecer `type` de la llamada de AJAX en `DELETE` y especificar el identificador único de la tarea en la dirección URL.</span><span class="sxs-lookup"><span data-stu-id="92db7-139">Deleting a to-do item is accomplished by setting the `type` on the AJAX call to `DELETE` and specifing the item's unique identifier in the URL.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AjaxDelete)]
