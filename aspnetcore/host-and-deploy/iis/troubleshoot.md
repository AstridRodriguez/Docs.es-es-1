---
title: "Solucionar problemas de núcleo de ASP.NET en IIS"
author: guardrex
description: "Obtenga información acerca de cómo diagnosticar problemas con las implementaciones de IIS de las aplicaciones de ASP.NET Core."
manager: wpickett
ms.author: riande
ms.custom: mvc
ms.date: 03/13/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: host-and-deploy/iis/troubleshoot
ms.openlocfilehash: c68070a9cba5667504d1ad4927b02b73f83e6573
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 01/30/2018
---
# <a name="troubleshoot-aspnet-core-on-iis"></a><span data-ttu-id="de071-103">Solucionar problemas de núcleo de ASP.NET en IIS</span><span class="sxs-lookup"><span data-stu-id="de071-103">Troubleshoot ASP.NET Core on IIS</span></span>

<span data-ttu-id="de071-104">Por [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="de071-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="de071-105">Para diagnosticar problemas con las implementaciones de IIS:</span><span class="sxs-lookup"><span data-stu-id="de071-105">To diagnose issues with IIS deployments:</span></span>

* <span data-ttu-id="de071-106">Estudie la salida del explorador.</span><span class="sxs-lookup"><span data-stu-id="de071-106">Study browser output.</span></span>
* <span data-ttu-id="de071-107">Examine el registro de **aplicaciones** del sistema mediante el **Visor de eventos**.</span><span class="sxs-lookup"><span data-stu-id="de071-107">Examine the system's **Application** log through **Event Viewer**.</span></span>
* <span data-ttu-id="de071-108">Habilite el registro `stdout`.</span><span class="sxs-lookup"><span data-stu-id="de071-108">Enable `stdout` logging.</span></span> <span data-ttu-id="de071-109">El registro del **módulo ASP.NET Core** se encuentra en la ruta de acceso proporcionada en el atributo *stdoutLogFile* del elemento `<aspNetCore>` de *web.config*. Las carpetas de la ruta de acceso proporcionada en el valor del atributo deben existir en la implementación.</span><span class="sxs-lookup"><span data-stu-id="de071-109">The **ASP.NET Core Module** log is found on the path provided in the *stdoutLogFile* attribute of the `<aspNetCore>` element in *web.config*. Any folders on the path provided in the attribute value must exist in the deployment.</span></span> <span data-ttu-id="de071-110">Establecer *stdoutLogEnabled* a `true`.</span><span class="sxs-lookup"><span data-stu-id="de071-110">Set *stdoutLogEnabled* to `true`.</span></span> <span data-ttu-id="de071-111">Aplicaciones que usan el el `Microsoft.NET.Sdk.Web` SDK para crear el *web.config* archivos de forma predeterminada el *stdoutLogEnabled* si se establece en `false`, manualmente proporcionan la *web.config* de archivos o modificar el archivo con el fin de habilitar `stdout` registro.</span><span class="sxs-lookup"><span data-stu-id="de071-111">Apps that use the the `Microsoft.NET.Sdk.Web` SDK to create the *web.config* file default the *stdoutLogEnabled* setting to `false`, so manually provide the *web.config* file or modify the file in order to enable `stdout` logging.</span></span>

<span data-ttu-id="de071-112">Utilizar la información de los tres orígenes con el [tema de referencia de errores comunes](xref:host-and-deploy/azure-iis-errors-reference) para determinar el problema.</span><span class="sxs-lookup"><span data-stu-id="de071-112">Use information from those three sources with the [common errors reference topic](xref:host-and-deploy/azure-iis-errors-reference) to determine the problem.</span></span> <span data-ttu-id="de071-113">Siga los consejos para solucionar problemas que se proporciona para resolver el problema.</span><span class="sxs-lookup"><span data-stu-id="de071-113">Follow the troubleshooting advice provided to resolve the issue.</span></span>

<span data-ttu-id="de071-114">Algunos de los errores comunes no aparecen en el explorador, el registro de aplicaciones ni el registro del módulo ASP.NET Core hasta que se ha pasado el módulo *startupTimeLimit* (valor predeterminado: 120 segundos) y *startupRetryCount* (valor predeterminado: 2).</span><span class="sxs-lookup"><span data-stu-id="de071-114">Several of the common errors don't appear in the browser, Application Log, and ASP.NET Core Module Log until the module *startupTimeLimit* (default: 120 seconds) and *startupRetryCount* (default: 2) have passed.</span></span> <span data-ttu-id="de071-115">Por lo tanto, espere seis minutos completos antes de deducir que el módulo no ha iniciado un proceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de071-115">Therefore, wait a full six minutes before deducing that the module has failed to start a process for the app.</span></span>

<span data-ttu-id="de071-116">Una manera rápida de determinar si la aplicación funciona correctamente es ejecutarla directamente en Kestrel.</span><span class="sxs-lookup"><span data-stu-id="de071-116">One quick way to determine if the app is working properly is to run the app directly on Kestrel.</span></span> <span data-ttu-id="de071-117">Si la aplicación se publicó como un [framework dependiente implementación](/dotnet/core/deploying/#framework-dependent-deployments-fdd), ejecute `dotnet <assembly_name>.dll` en la carpeta de implementación, que es la ruta de acceso física de IIS para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de071-117">If the app was published as a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), execute `dotnet <assembly_name>.dll` in the deployment folder, which is the IIS physical path to the app.</span></span> <span data-ttu-id="de071-118">Si la aplicación se publicó como un [implementación independiente](/dotnet/core/deploying/#self-contained-deployments-scd), ejecute la aplicación del ejecutable directamente desde un símbolo del sistema, `<assembly_name>.exe`, en la carpeta de implementación.</span><span class="sxs-lookup"><span data-stu-id="de071-118">If the app was published as a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), run the app's executable directly from a command prompt, `<assembly_name>.exe`, in the deployment folder.</span></span> <span data-ttu-id="de071-119">Si Kestrel está escuchando en el puerto 5000 de forma predeterminada, la aplicación debe estar disponible en `http://localhost:5000/`.</span><span class="sxs-lookup"><span data-stu-id="de071-119">If Kestrel is listening on default port 5000, the app should be available at `http://localhost:5000/`.</span></span> <span data-ttu-id="de071-120">Si la aplicación responde normalmente en la dirección del extremo Kestrel, el problema es más probable relacionadas con la configuración de proxy inverso y menos probable que dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de071-120">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the reverse proxy configuration and less likely within the app.</span></span>

<span data-ttu-id="de071-121">Una manera de determinar si el proxy inverso funciona correctamente es realizar una solicitud de archivo estático simple para una hoja de estilos, script o imagen de archivos estáticos de la aplicación en *wwwroot* con [Middleware de archivos estáticos](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="de071-121">One way to determine if the reverse proxy is working properly is to perform a simple static file request for a stylesheet, script, or image from the app's static files in *wwwroot* using [Static File Middleware](xref:fundamentals/static-files).</span></span> <span data-ttu-id="de071-122">Si la aplicación puede servir archivos estáticos, pero se producen errores en las vistas de MVC y otros puntos de conexión, el problema es más probable que dentro de la aplicación (por ejemplo, el enrutamiento MVC o 500 Error interno del servidor) y menos probable que relacionados con la configuración de proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="de071-122">If the app can serve static files but MVC Views and other endpoints are failing, the problem is less likely related to the reverse proxy configuration and more likely within the app (for example, MVC routing or 500 Internal Server Error).</span></span>

<span data-ttu-id="de071-123">Cuando Kestrel inicia normalmente detrás de IIS, pero la aplicación no se ejecutará en el sistema después de ejecutar satisfactoriamente localmente, se puede agregar una variable de entorno temporalmente a *web.config* para establecer el `ASPNETCORE_ENVIRONMENT` a `Development`.</span><span class="sxs-lookup"><span data-stu-id="de071-123">When Kestrel starts normally behind IIS but the app won't run on the system after successfully running locally, an environment variable can be temporarily added to *web.config* to set the `ASPNETCORE_ENVIRONMENT` to `Development`.</span></span> <span data-ttu-id="de071-124">Siempre y cuando el entorno no se reemplaza en el inicio de la aplicación, establecer la variable de entorno permite la [página de excepción para desarrolladores](xref:fundamentals/error-handling) aparecen cuando la aplicación se ejecute.</span><span class="sxs-lookup"><span data-stu-id="de071-124">As long as the environment isn't overridden in app startup, setting the environment variable allows the [developer exception page](xref:fundamentals/error-handling) to appear when the app is run.</span></span> <span data-ttu-id="de071-125">Establecer la variable de entorno para `ASPNETCORE_ENVIRONMENT` de este modo se recomienda únicamente para servidores de ensayo o pruebas que no están expuestos a Internet.</span><span class="sxs-lookup"><span data-stu-id="de071-125">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` in this way is only recommended for staging/testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="de071-126">No olvide quitar la variable de entorno desde el *web.config* cuando termine de archivos.</span><span class="sxs-lookup"><span data-stu-id="de071-126">Be sure to remove the environment variable from the *web.config* file when finished.</span></span> <span data-ttu-id="de071-127">Para obtener información acerca de cómo establecer variables de entorno mediante *web.config*, consulte [environmentVariables elemento secundario aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="de071-127">For information on setting environment variables via *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

<span data-ttu-id="de071-128">En la mayoría de los casos, la habilitación del registro de la aplicación ayuda a solucionar problemas con el proxy inverso o la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de071-128">In most cases, enabling application logging assists in troubleshooting problems with the app or the reverse proxy.</span></span> <span data-ttu-id="de071-129">Vea [Logging](xref:fundamentals/logging/index) (Registro) para más información.</span><span class="sxs-lookup"><span data-stu-id="de071-129">See [Logging](xref:fundamentals/logging/index) for more information.</span></span>

<span data-ttu-id="de071-130">La última sugerencia de solución de problemas pertenece a las aplicaciones que no se ejecutan después de actualizar el SDK de .NET Core en las versiones de paquete o la máquina de desarrollo dentro de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de071-130">The last troubleshooting tip pertains to apps that fail to run after upgrading either the .NET Core SDK on the development machine or package versions within the app.</span></span> <span data-ttu-id="de071-131">En algunos casos, los paquetes incoherentes pueden interrumpir una aplicación al realizar actualizaciones importantes.</span><span class="sxs-lookup"><span data-stu-id="de071-131">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="de071-132">La mayoría de estos problemas se puede corregir con:</span><span class="sxs-lookup"><span data-stu-id="de071-132">Most of these issues can be fixed by:</span></span>

* <span data-ttu-id="de071-133">Eliminar el `bin` y `obj` carpetas en el proyecto.</span><span class="sxs-lookup"><span data-stu-id="de071-133">Deleting the `bin` and `obj` folders in the project.</span></span>
* <span data-ttu-id="de071-134">Paquete de borrar almacena en caché en `%UserProfile%\.nuget\packages\` y `%LocalAppData%\Nuget\v3-cache`.</span><span class="sxs-lookup"><span data-stu-id="de071-134">Clearing package caches at `%UserProfile%\.nuget\packages\` and `%LocalAppData%\Nuget\v3-cache`.</span></span>
* <span data-ttu-id="de071-135">La restauración y volver a generar el proyecto.</span><span class="sxs-lookup"><span data-stu-id="de071-135">Restoring and rebuilding the project.</span></span>
* <span data-ttu-id="de071-136">Confirmar que la implementación anterior en el servidor se ha eliminado por completo antes de volver a implementar la aplicación.</span><span class="sxs-lookup"><span data-stu-id="de071-136">Confirming that the prior deployment on the server has been completely deleted prior to re-deploying the app.</span></span>

> [!TIP]
> <span data-ttu-id="de071-137">Una manera cómoda para borrar las cachés del paquete es ejecutar `dotnet nuget locals all --clear` desde un símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="de071-137">A convenient way to clear package caches is to execute `dotnet nuget locals all --clear` from a command prompt.</span></span>
> 
> <span data-ttu-id="de071-138">Borrar las memorias caché del paquete también se puede lograr mediante el uso de la [nuget.exe](https://www.nuget.org/downloads) herramienta y ejecutar el comando `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="de071-138">Clearing package caches can also be accomplished by using the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="de071-139">*NuGet.exe* no es una instalación incluida con Windows 10 y debe obtenerse por separado desde el sitio Web de NuGet.</span><span class="sxs-lookup"><span data-stu-id="de071-139">*nuget.exe* isn't a bundled install with Windows 10 and must be obtained separately from the NuGet website.</span></span>
<!--
> [!TIP]
> A convenient way to clear package caches is to:
>
> * Obtain the *NuGet.exe* tool from [NuGet.org](https://www.nuget.org/).
> * Add the path to *NuGet.exe* to the system PATH.
> * Execute `nuget locals all -clear` from a command prompt.
>
> Alternatively, execute `dotnet nuget locals all --clear` from a command prompt without obtaining *NuGet.exe*. -->

## <a name="additional-resources"></a><span data-ttu-id="de071-140">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="de071-140">Additional resources</span></span>

* [<span data-ttu-id="de071-141">Referencia de errores comunes de Azure App Service e IIS con ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="de071-141">Common errors reference for Azure App Service and IIS with ASP.NET Core</span></span>](xref:host-and-deploy/azure-iis-errors-reference)
* [<span data-ttu-id="de071-142">Referencia de configuración del módulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="de071-142">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)
