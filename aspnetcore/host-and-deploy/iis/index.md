---
title: Hospedaje de ASP.NET Core en Windows con IIS
author: guardrex
description: Obtenga información sobre cómo hospedar aplicaciones de ASP.NET Core en Windows Server Internet Information Services (IIS).
manager: wpickett
ms.author: riande
ms.custom: mvc
ms.date: 03/13/2018
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: host-and-deploy/iis/index
ms.openlocfilehash: 64eb85f75a6c2e10bf8c39f32eeda5311744f2a2
ms.sourcegitcommit: 7d02ca5f5ddc2ca3eb0258fdd6996fbf538c129a
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/03/2018
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="3db6a-103">Hospedaje de ASP.NET Core en Windows con IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-103">Host ASP.NET Core on Windows with IIS</span></span>

<span data-ttu-id="3db6a-104">Por [Luke Latham](https://github.com/guardrex) y [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="3db6a-104">By [Luke Latham](https://github.com/guardrex) and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

## <a name="supported-operating-systems"></a><span data-ttu-id="3db6a-105">Sistemas operativos admitidos</span><span class="sxs-lookup"><span data-stu-id="3db6a-105">Supported operating systems</span></span>

<span data-ttu-id="3db6a-106">Los siguientes sistemas operativos son compatibles:</span><span class="sxs-lookup"><span data-stu-id="3db6a-106">The following operating systems are supported:</span></span>

* <span data-ttu-id="3db6a-107">Windows 7 o posterior</span><span class="sxs-lookup"><span data-stu-id="3db6a-107">Windows 7 or later</span></span>
* <span data-ttu-id="3db6a-108">Windows Server 2008 R2 o posterior&#8224;</span><span class="sxs-lookup"><span data-stu-id="3db6a-108">Windows Server 2008 R2 or later&#8224;</span></span>

<span data-ttu-id="3db6a-109">&#8224;Conceptualmente, la configuración de IIS que se describe en este documento también se aplica al hospedaje de aplicaciones ASP.NET Core en IIS de Nano Server.</span><span class="sxs-lookup"><span data-stu-id="3db6a-109">&#8224;Conceptually, the IIS configuration described in this document also applies to hosting ASP.NET Core apps on Nano Server IIS.</span></span> <span data-ttu-id="3db6a-110">Para instrucciones específicas sobre Nano Server, consulte el tutorial [ASP.NET Core con IIS en Nano Server](xref:tutorials/nano-server).</span><span class="sxs-lookup"><span data-stu-id="3db6a-110">For instructions specific to Nano Server, see the [ASP.NET Core with IIS on Nano Server](xref:tutorials/nano-server) tutorial.</span></span>

<span data-ttu-id="3db6a-111">El [servidor HTTP.sys](xref:fundamentals/servers/httpsys) (anteriormente denominado [WebListener](xref:fundamentals/servers/weblistener)) no funciona en una configuración de proxy inverso con IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-111">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called [WebListener](xref:fundamentals/servers/weblistener)) doesn't work in a reverse proxy configuration with IIS.</span></span> <span data-ttu-id="3db6a-112">Use el [servidor Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="3db6a-112">Use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

## <a name="application-configuration"></a><span data-ttu-id="3db6a-113">Configuración de aplicación</span><span class="sxs-lookup"><span data-stu-id="3db6a-113">Application configuration</span></span>

### <a name="enable-the-iisintegration-components"></a><span data-ttu-id="3db6a-114">Habilitación de los componentes de integración con IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-114">Enable the IISIntegration components</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="3db6a-115">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="3db6a-115">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="3db6a-116">Los archivos *Program.cs* estándar llaman a [CreateDefaultBuilder](/dotnet/api/microsoft.aspnetcore.webhost.createdefaultbuilder) para empezar a configurar un host.</span><span class="sxs-lookup"><span data-stu-id="3db6a-116">A typical *Program.cs* calls [CreateDefaultBuilder](/dotnet/api/microsoft.aspnetcore.webhost.createdefaultbuilder) to begin setting up a host.</span></span> <span data-ttu-id="3db6a-117">`CreateDefaultBuilder` configura [Kestrel](xref:fundamentals/servers/kestrel) como el servidor web y habilita IIS Integration configurando la ruta de acceso base y el puerto para el [módulo ASP.NET Core](xref:fundamentals/servers/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="3db6a-117">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) as the web server and enables IIS integration by configuring the base path and port for the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module):</span></span>

```csharp
public static IWebHost BuildWebHost(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

<span data-ttu-id="3db6a-118">El módulo ASP.NET Core genera un puerto dinámico que se asigna al proceso back-end.</span><span class="sxs-lookup"><span data-stu-id="3db6a-118">The ASP.NET Core Module generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="3db6a-119">El método `UseIISIntegration` toma el puerto dinámico y configura Kestrel para que escuche en `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-119">The `UseIISIntegration` method picks up the dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="3db6a-120">Esto invalida otras configuraciones de URL, como las llamadas a `UseUrls` o a la [API Listen de Kestrel](xref:fundamentals/servers/kestrel#endpoint-configuration).</span><span class="sxs-lookup"><span data-stu-id="3db6a-120">This overrides other URL configurations, such as calls to `UseUrls` or [Kestrel's Listen API](xref:fundamentals/servers/kestrel#endpoint-configuration).</span></span> <span data-ttu-id="3db6a-121">Por lo tanto, no es necesario realizar llamadas a `UseUrls` o a la API `Listen` de Kestrel cuando se usa el módulo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-121">Therefore, calls to `UseUrls` or Kestrel's `Listen` API aren't required when using the module.</span></span> <span data-ttu-id="3db6a-122">Si se llama a `UseUrls` o `Listen`, Kestrel escucha en el puerto especificado cuando se ejecuta la aplicación sin IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-122">If `UseUrls` or `Listen` is called, Kestrel listens on the port specified when running the app without IIS.</span></span>

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="3db6a-123">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="3db6a-123">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="3db6a-124">Incluya una dependencia en el paquete [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) de dependencias de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-124">Include a dependency on the [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) package in the app's dependencies.</span></span> <span data-ttu-id="3db6a-125">Use el middleware de integración con IIS agregando el método de extensión [UseIISIntegration](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderiisextensions.useiisintegration) a [WebHostBuilder](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilder):</span><span class="sxs-lookup"><span data-stu-id="3db6a-125">Use IIS Integration middleware by adding the [UseIISIntegration](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderiisextensions.useiisintegration) extension method to [WebHostBuilder](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilder):</span></span>

```csharp
var host = new WebHostBuilder()
    .UseKestrel()
    .UseIISIntegration()
    ...
```

<span data-ttu-id="3db6a-126">Tanto [UseKestrel](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderkestrelextensions.usekestrel) como [UseIISIntegration](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderiisextensions.useiisintegration) son necesarios.</span><span class="sxs-lookup"><span data-stu-id="3db6a-126">Both [UseKestrel](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderkestrelextensions.usekestrel) and [UseIISIntegration](/dotnet/api/microsoft.aspnetcore.hosting.webhostbuilderiisextensions.useiisintegration) are required.</span></span> <span data-ttu-id="3db6a-127">La llamada al código `UseIISIntegration` no afecta a la portabilidad del código.</span><span class="sxs-lookup"><span data-stu-id="3db6a-127">Code calling `UseIISIntegration` doesn't affect code portability.</span></span> <span data-ttu-id="3db6a-128">Si la aplicación no se ejecuta detrás de IIS (por ejemplo, si se ejecuta directamente en Kestrel), `UseIISIntegration` no funciona.</span><span class="sxs-lookup"><span data-stu-id="3db6a-128">If the app isn't run behind IIS (for example, the app is run directly on Kestrel), `UseIISIntegration` doesn't operate.</span></span>

<span data-ttu-id="3db6a-129">El módulo ASP.NET Core genera un puerto dinámico que se asigna al proceso back-end.</span><span class="sxs-lookup"><span data-stu-id="3db6a-129">The ASP.NET Core Module generates a dynamic port to assign to the back-end process.</span></span> <span data-ttu-id="3db6a-130">El método `UseIISIntegration` toma el puerto dinámico y configura Kestrel para que escuche en `http://locahost:{dynamicPort}/`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-130">The `UseIISIntegration` method picks up the dynamic port and configures Kestrel to listen on `http://locahost:{dynamicPort}/`.</span></span> <span data-ttu-id="3db6a-131">Esto invalida otras configuraciones de URL, como las llamadas a `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-131">This overrides other URL configurations, such as calls to `UseUrls`.</span></span> <span data-ttu-id="3db6a-132">Por lo tanto, no es necesario realizar una llamada a `UseUrls` cuando se usa el módulo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-132">Therefore, a call to `UseUrls` isn't required when using the module.</span></span> <span data-ttu-id="3db6a-133">Si se llama a `UseUrls`, Kestrel escucha en el puerto especificado cuando se ejecuta la aplicación sin IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-133">If `UseUrls` is called, Kestrel listens on the port specified when running the app without IIS.</span></span>

<span data-ttu-id="3db6a-134">Si se llama a `UseUrls` en una aplicación de ASP.NET Core 1.0, hágalo **antes** de llamar a `UseIISIntegration` para que no se sobrescriba el puerto configurado por el módulo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-134">If `UseUrls` is called in an ASP.NET Core 1.0 app, call it **before** calling `UseIISIntegration` so that the module-configured port isn't overwritten.</span></span> <span data-ttu-id="3db6a-135">Este orden de llamada no es necesario en ASP.NET Core 1.1, ya que la configuración del módulo reemplaza a `UseUrls`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-135">This calling order isn't required with ASP.NET Core 1.1 because the module setting overrides `UseUrls`.</span></span>

---

<span data-ttu-id="3db6a-136">Para obtener más información sobre el hospedaje, consulte [Hosting in ASP.NET Core](xref:fundamentals/hosting) (Hospedaje en ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="3db6a-136">For more information on hosting, see [Hosting in ASP.NET Core](xref:fundamentals/hosting).</span></span>

### <a name="iis-options"></a><span data-ttu-id="3db6a-137">Opciones de IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-137">IIS options</span></span>

<span data-ttu-id="3db6a-138">Para configurar las opciones de IIS, incluya una configuración del servicio para [IISOptions](/dotnet/api/microsoft.aspnetcore.builder.iisoptions) en [ConfigureServices](/dotnet/api/microsoft.aspnetcore.hosting.istartup.configureservices).</span><span class="sxs-lookup"><span data-stu-id="3db6a-138">To configure IIS options, include a service configuration for [IISOptions](/dotnet/api/microsoft.aspnetcore.builder.iisoptions) in [ConfigureServices](/dotnet/api/microsoft.aspnetcore.hosting.istartup.configureservices).</span></span> <span data-ttu-id="3db6a-139">En el ejemplo siguiente, el reenvío de los certificados de cliente a la aplicación para rellenar `HttpContext.Connection.ClientCertificate` está deshabilitado:</span><span class="sxs-lookup"><span data-stu-id="3db6a-139">In the following example, forwarding client certificates to the app to populate `HttpContext.Connection.ClientCertificate` is disabled:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    options.ForwardClientCertificate = false;
});
```

| <span data-ttu-id="3db6a-140">Opción</span><span class="sxs-lookup"><span data-stu-id="3db6a-140">Option</span></span>                         | <span data-ttu-id="3db6a-141">Default</span><span class="sxs-lookup"><span data-stu-id="3db6a-141">Default</span></span> | <span data-ttu-id="3db6a-142">Parámetro</span><span class="sxs-lookup"><span data-stu-id="3db6a-142">Setting</span></span> |
| ------------------------------ | :-----: | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="3db6a-143">Si es `true`, el middleware de integración con IIS establece el `HttpContext.User` autenticado mediante [autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="3db6a-143">If `true`, IIS Integration Middleware sets the `HttpContext.User` authenticated by [Windows Authentication](xref:security/authentication/windowsauth).</span></span> <span data-ttu-id="3db6a-144">Si es `false`, el middleware solo proporciona una identidad para `HttpContext.User` y responde a los desafíos cuando se le solicita explícitamente mediante el `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-144">If `false`, the middleware only provides an identity for `HttpContext.User` and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="3db6a-145">Autenticación de Windows debe estar habilitado en IIS para que `AutomaticAuthentication` funcione.</span><span class="sxs-lookup"><span data-stu-id="3db6a-145">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> <span data-ttu-id="3db6a-146">Para más información, consulte el tema [Autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="3db6a-146">For more information, see the [Windows Authentication](xref:security/authentication/windowsauth) topic.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="3db6a-147">Establece el nombre para mostrar que se muestra a los usuarios en las páginas de inicio de sesión.</span><span class="sxs-lookup"><span data-stu-id="3db6a-147">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="3db6a-148">Si `HttpContext.Connection.ClientCertificate` y el encabezado de solicitud `true` está presente, se rellena `MS-ASPNETCORE-CLIENTCERT`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-148">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="proxy-server-and-load-balancer-scenarios"></a><span data-ttu-id="3db6a-149">Escenarios de servidor proxy y equilibrador de carga</span><span class="sxs-lookup"><span data-stu-id="3db6a-149">Proxy server and load balancer scenarios</span></span>

<span data-ttu-id="3db6a-150">El software intermedio de integración con IIS, que configura el software intermedio de encabezados reenviados, y el módulo de ASP.NET Core están configurados para reenviar el esquema (HTTP/HTTPS) y la dirección IP remota donde se originó la solicitud.</span><span class="sxs-lookup"><span data-stu-id="3db6a-150">The IIS Integration Middleware, which configures Forwarded Headers Middleware, and the ASP.NET Core Module are configured to forward the scheme (HTTP/HTTPS) and the remote IP address where the request originated.</span></span> <span data-ttu-id="3db6a-151">Podría ser necesario realizar una configuración adicional para las aplicaciones hospedadas detrás de servidores proxy y equilibradores de carga adicionales.</span><span class="sxs-lookup"><span data-stu-id="3db6a-151">Additional configuration might be required for apps hosted behind additional proxy servers and load balancers.</span></span> <span data-ttu-id="3db6a-152">Para más información, vea [Configurar ASP.NET Core para trabajar con servidores proxy y equilibradores de carga](xref:host-and-deploy/proxy-load-balancer).</span><span class="sxs-lookup"><span data-stu-id="3db6a-152">For more information, see [Configure ASP.NET Core to work with proxy servers and load balancers](xref:host-and-deploy/proxy-load-balancer).</span></span>

### <a name="webconfig-file"></a><span data-ttu-id="3db6a-153">Archivo web.config</span><span class="sxs-lookup"><span data-stu-id="3db6a-153">web.config file</span></span>

<span data-ttu-id="3db6a-154">El archivo *web.config* configura el [módulo ASP.NET Core](xref:fundamentals/servers/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="3db6a-154">The *web.config* file configures the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module).</span></span> <span data-ttu-id="3db6a-155">La creación, transformación y publicación de *web.config* se controlan con el SDK web de .NET Core (`Microsoft.NET.Sdk.Web`).</span><span class="sxs-lookup"><span data-stu-id="3db6a-155">Creating, transforming, and publishing *web.config* is handled by the .NET Core Web SDK (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="3db6a-156">El SDK se establece en la parte superior del archivo del proyecto:</span><span class="sxs-lookup"><span data-stu-id="3db6a-156">The SDK is set  at the top of the project file:</span></span>

```xml
<Project Sdk="Microsoft.NET.Sdk.Web">
```

<span data-ttu-id="3db6a-157">Si el proyecto no incluye un archivo *web.config*, el archivo se crea con los elementos *processPath* y *arguments* correctos para configurar el [módulo ASP.NET Core](xref:fundamentals/servers/aspnet-core-module) y se mueve a la [salida publicada](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="3db6a-157">If a *web.config* file isn't present the project, the file is created with the correct *processPath* and *arguments* to configure the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module) and moved to [published output](xref:host-and-deploy/directory-structure).</span></span>

<span data-ttu-id="3db6a-158">Si el proyecto incluye un archivo *web.config*, el archivo se transforma con los elementos *processPath* y *arguments* correctos para configurar el módulo ASP.NET Core y se mueve a la salida publicada.</span><span class="sxs-lookup"><span data-stu-id="3db6a-158">If a *web.config* file is present in the project, the file is transformed with the correct *processPath* and *arguments* to configure the ASP.NET Core Module and moved to published output.</span></span> <span data-ttu-id="3db6a-159">La transformación no modifica los valores de configuración de IIS del archivo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-159">The transformation doesn't modify IIS configuration settings in the file.</span></span>

<span data-ttu-id="3db6a-160">El archivo *web.config* puede proporcionar valores de configuración de IIS adicionales que controlan los módulos activos de IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-160">The *web.config* file may provide additional IIS configuration settings that control active IIS modules.</span></span> <span data-ttu-id="3db6a-161">Para información sobre los módulos de IIS que son capaces de procesar las solicitudes con aplicaciones ASP.NET Core, vea el tema [Módulos IIS](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="3db6a-161">For information on IIS modules that are capable of processing requests with ASP.NET Core apps, see the [IIS modules](xref:host-and-deploy/iis/modules) topic.</span></span>

<span data-ttu-id="3db6a-162">Para evitar que el SDK web transforme el archivo *web.config*, use la propiedad **\<IsTransformWebConfigDisabled>** en el archivo del proyecto:</span><span class="sxs-lookup"><span data-stu-id="3db6a-162">To prevent the Web SDK from transforming the *web.config* file, use the **\<IsTransformWebConfigDisabled>** property in the project file:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="3db6a-163">Al deshabilitar el SDK web para la transformación del archivo, el desarrollador debe establecer el elemento *processPath* y los *argumentos* manualmente.</span><span class="sxs-lookup"><span data-stu-id="3db6a-163">When disabling the Web SDK from transforming the file, the *processPath* and *arguments* should be manually set by the developer.</span></span> <span data-ttu-id="3db6a-164">Para más información, vea [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module) (Referencia de configuración del módulo de ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="3db6a-164">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module).</span></span>

### <a name="webconfig-file-location"></a><span data-ttu-id="3db6a-165">Ubicación del archivo web.config</span><span class="sxs-lookup"><span data-stu-id="3db6a-165">web.config file location</span></span>

<span data-ttu-id="3db6a-166">Las aplicaciones .NET Core se hospedan en un proxy inverso entre IIS y el servidor Kestrel.</span><span class="sxs-lookup"><span data-stu-id="3db6a-166">ASP.NET Core apps are hosted in a reverse proxy between IIS and the Kestrel server.</span></span> <span data-ttu-id="3db6a-167">Para crear el servidor proxy inverso, el archivo *web.config* debe estar presente en la ruta de acceso raíz del contenido (normalmente la ruta de acceso base de la aplicación) de la aplicación implementada.</span><span class="sxs-lookup"><span data-stu-id="3db6a-167">In order to create the reverse proxy, the *web.config* file must be present at the content root path (typically the app base path) of the deployed app.</span></span> <span data-ttu-id="3db6a-168">Se trata de la misma ubicación que la ruta de acceso física del sitio web proporcionada a IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-168">This is the same location as the website physical path provided to IIS.</span></span> <span data-ttu-id="3db6a-169">El archivo *web.config* debe estar en la raíz de la aplicación para habilitar la publicación de varias aplicaciones mediante Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="3db6a-169">The *web.config* file is required at the root of the app to enable the publishing of multiple apps using Web Deploy.</span></span>

<span data-ttu-id="3db6a-170">Los archivos confidenciales están en la ruta de acceso física de la aplicación, como *\<ensamblado>.runtimeconfig.json*, *\<ensamblado>.xml* (comentarios de documentación XML) y *\<ensamblado>.deps.json*.</span><span class="sxs-lookup"><span data-stu-id="3db6a-170">Sensitive files exist on the app's physical path, such as *\<assembly>.runtimeconfig.json*, *\<assembly>.xml* (XML Documentation comments), and *\<assembly>.deps.json*.</span></span> <span data-ttu-id="3db6a-171">Cuando el archivo *web.config* está presente y el sitio se inicia normalmente, IIS no sirve estos archivos confidenciales si se solicitan.</span><span class="sxs-lookup"><span data-stu-id="3db6a-171">When the *web.config* file is present and and the site starts normally, IIS doesn't serve these sensitive files if they're requested.</span></span> <span data-ttu-id="3db6a-172">Si el archivo *web.config* no está presente, se le asignó un nombre incorrecto o no se puede configurar el sitio para un inicio normal, IIS puede servir archivos confidenciales públicamente.</span><span class="sxs-lookup"><span data-stu-id="3db6a-172">If the *web.config* file is missing, incorrectly named, or unable to configure the site for normal startup, IIS may serve sensitive files publicly.</span></span>

<span data-ttu-id="3db6a-173">**El archivo *web.config* debe estar presente en la implementación en todo momento, se le debe asignar un nombre correcto y debe ser capaz de configurar el sitio para el inicio normal. Nunca quite el archivo *web.config* de una implementación de producción.**</span><span class="sxs-lookup"><span data-stu-id="3db6a-173">**The *web.config* file must be present in the deployment at all times, correctly named, and able to configure the site for normal start up. Never remove the *web.config* file from a production deployment.**</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="3db6a-174">Configuración de IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-174">IIS configuration</span></span>

<span data-ttu-id="3db6a-175">**Sistemas operativos de servidor Windows**</span><span class="sxs-lookup"><span data-stu-id="3db6a-175">**Windows Server operating systems**</span></span>

<span data-ttu-id="3db6a-176">Habilite el rol de servidor **Servidor web (IIS)** y establezca los servicios de rol.</span><span class="sxs-lookup"><span data-stu-id="3db6a-176">Enable the **Web Server (IIS)** server role and establish role services.</span></span>

1. <span data-ttu-id="3db6a-177">Use el asistente **Agregar roles y características** del menú **Administrar** o el vínculo de **Administrador del servidor**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-177">Use the **Add Roles and Features** wizard from the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="3db6a-178">En el paso **Roles de servidor**, active la casilla de **Servidor web (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-178">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

   ![El rol Servidor web (IIS) se activa en el paso Seleccionar roles de servidor.](index/_static/server-roles-ws2016.png)

1. <span data-ttu-id="3db6a-180">Después del paso **Características**, el paso **Servicios de rol** se carga para el servidor Web (IIS).</span><span class="sxs-lookup"><span data-stu-id="3db6a-180">After the **Features** step, the **Role services** step loads for Web Server (IIS).</span></span> <span data-ttu-id="3db6a-181">Seleccione los servicios de rol IIS que quiera o acepte los servicios de rol predeterminados proporcionados.</span><span class="sxs-lookup"><span data-stu-id="3db6a-181">Select the IIS role services desired or accept the default role services provided.</span></span>

   ![Los servicios de rol predeterminados se activan en el paso Seleccionar servicios de rol.](index/_static/role-services-ws2016.png)

   <span data-ttu-id="3db6a-183">**Autenticación de Windows (opcional)**</span><span class="sxs-lookup"><span data-stu-id="3db6a-183">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="3db6a-184">Para habilitar la autenticación de Windows, expanda los nodos siguientes: **Servidor web** > **Seguridad**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-184">To enable Windows Authentication, expand the following nodes: **Web Server** > **Security**.</span></span> <span data-ttu-id="3db6a-185">Seleccione la característica **Autenticación de Windows**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-185">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="3db6a-186">Para más información, consulte [Windows Authentication \<windowsAuthentication >](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) (Autenticación de Windows <windowsAuthentication>) y [Configure Windows authentication](xref:security/authentication/windowsauth) (Configurar la autenticación de Windows).</span><span class="sxs-lookup"><span data-stu-id="3db6a-186">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="3db6a-187">**WebSockets (opcional)**</span><span class="sxs-lookup"><span data-stu-id="3db6a-187">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="3db6a-188">WebSockets es compatible con ASP.NET Core 1.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="3db6a-188">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="3db6a-189">Para habilitar WebSockets, expanda los nodos siguientes: **Servidor web** > **Desarrollo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-189">To enable WebSockets, expand the following nodes: **Web Server** > **Application Development**.</span></span> <span data-ttu-id="3db6a-190">Seleccione la característica **Protocolo WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-190">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="3db6a-191">Para más información, vea [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="3db6a-191">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="3db6a-192">Continúe con el paso **Confirmación** para instalar el rol y los servicios de servidor web.</span><span class="sxs-lookup"><span data-stu-id="3db6a-192">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="3db6a-193">No es necesario reiniciar el servidor ni IIS después de instalar el rol **Servidor web (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-193">A server/IIS restart isn't required after installing the **Web Server (IIS)** role.</span></span>

<span data-ttu-id="3db6a-194">**Sistemas operativos de escritorio Windows**</span><span class="sxs-lookup"><span data-stu-id="3db6a-194">**Windows desktop operating systems**</span></span>

<span data-ttu-id="3db6a-195">Habilite **Consola de administración de IIS** y **Servicios World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-195">Enable the **IIS Management Console** and **World Wide Web Services**.</span></span>

1. <span data-ttu-id="3db6a-196">Vaya a **Panel de control** > **Programas** > **Programas y características** > **Activar o desactivar las características de Windows** (lado izquierdo de la pantalla).</span><span class="sxs-lookup"><span data-stu-id="3db6a-196">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span>

1. <span data-ttu-id="3db6a-197">Abra el nodo **Internet Information Services**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-197">Open the **Internet Information Services** node.</span></span> <span data-ttu-id="3db6a-198">Abra el nodo **Herramientas de administración web**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-198">Open the **Web Management Tools** node.</span></span>

1. <span data-ttu-id="3db6a-199">Active la casilla de **Consola de administración de IIS**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-199">Check the box for **IIS Management Console**.</span></span>

1. <span data-ttu-id="3db6a-200">Active la casilla de **Servicios World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-200">Check the box for **World Wide Web Services**.</span></span>

1. <span data-ttu-id="3db6a-201">Acepte las características predeterminadas de **Servicios World Wide Web** o personalice las características de IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-201">Accept the default features for **World Wide Web Services** or customize the IIS features.</span></span>

   <span data-ttu-id="3db6a-202">**Autenticación de Windows (opcional)**</span><span class="sxs-lookup"><span data-stu-id="3db6a-202">**Windows Authentication (Optional)**</span></span>  
   <span data-ttu-id="3db6a-203">Para habilitar la autenticación de Windows, expanda los nodos siguientes: **Servicios World Wide Web** > **Seguridad**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-203">To enable Windows Authentication, expand the following nodes: **World Wide Web Services** > **Security**.</span></span> <span data-ttu-id="3db6a-204">Seleccione la característica **Autenticación de Windows**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-204">Select the **Windows Authentication** feature.</span></span> <span data-ttu-id="3db6a-205">Para más información, consulte [Windows Authentication \<windowsAuthentication >](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) (Autenticación de Windows <windowsAuthentication>) y [Configure Windows authentication](xref:security/authentication/windowsauth) (Configurar la autenticación de Windows).</span><span class="sxs-lookup"><span data-stu-id="3db6a-205">For more information, see [Windows Authentication \<windowsAuthentication>](/iis/configuration/system.webServer/security/authentication/windowsAuthentication/) and [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

   <span data-ttu-id="3db6a-206">**WebSockets (opcional)**</span><span class="sxs-lookup"><span data-stu-id="3db6a-206">**WebSockets (Optional)**</span></span>  
   <span data-ttu-id="3db6a-207">WebSockets es compatible con ASP.NET Core 1.1 o posterior.</span><span class="sxs-lookup"><span data-stu-id="3db6a-207">WebSockets is supported with ASP.NET Core 1.1 or later.</span></span> <span data-ttu-id="3db6a-208">Para habilitar WebSockets, expanda los nodos siguientes: **Servicios World Wide Web** > **Características de desarrollo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-208">To enable WebSockets, expand the following nodes: **World Wide Web Services** > **Application Development Features**.</span></span> <span data-ttu-id="3db6a-209">Seleccione la característica **Protocolo WebSocket**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-209">Select the **WebSocket Protocol** feature.</span></span> <span data-ttu-id="3db6a-210">Para más información, vea [WebSockets](xref:fundamentals/websockets).</span><span class="sxs-lookup"><span data-stu-id="3db6a-210">For more information, see [WebSockets](xref:fundamentals/websockets).</span></span>

1. <span data-ttu-id="3db6a-211">Si la instalación de IIS requiere un reinicio, reinicie el sistema.</span><span class="sxs-lookup"><span data-stu-id="3db6a-211">If the IIS installation requires a restart, restart the system.</span></span>

![Consola de administración de IIS y Servicios World Wide Web se activan en Características de Windows.](index/_static/windows-features-win10.png)

---

## <a name="install-the-net-core-windows-server-hosting-bundle"></a><span data-ttu-id="3db6a-213">Instalación del lote de hospedaje .NET Core Windows Server</span><span class="sxs-lookup"><span data-stu-id="3db6a-213">Install the .NET Core Windows Server Hosting bundle</span></span>

1. <span data-ttu-id="3db6a-214">Instale el *lote de hospedaje .NET Core Windows Server* en el sistema host.</span><span class="sxs-lookup"><span data-stu-id="3db6a-214">Install the *.NET Core Windows Server Hosting bundle* on the hosting system.</span></span> <span data-ttu-id="3db6a-215">El lote instala .NET Core Runtime, .NET Core Library y el [módulo ASP.NET Core](xref:fundamentals/servers/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="3db6a-215">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module).</span></span> <span data-ttu-id="3db6a-216">El módulo crea el proxy inverso entre IIS y el servidor Kestrel.</span><span class="sxs-lookup"><span data-stu-id="3db6a-216">The module creates the reverse proxy between IIS and the Kestrel server.</span></span> <span data-ttu-id="3db6a-217">Si el sistema no tiene conexión a Internet, obtenga e instale [Microsoft Visual C++ 2015 Redistributable](https://www.microsoft.com/download/details.aspx?id=53840) antes de instalar el lote de hospedaje .NET Core Windows Server.</span><span class="sxs-lookup"><span data-stu-id="3db6a-217">If the system doesn't have an Internet connection, obtain and install the [Microsoft Visual C++ 2015 Redistributable](https://www.microsoft.com/download/details.aspx?id=53840) before installing the .NET Core Windows Server Hosting bundle.</span></span>

   1. <span data-ttu-id="3db6a-218">Vaya a la [página de todas las descargas de .NET](https://www.microsoft.com/net/download/all).</span><span class="sxs-lookup"><span data-stu-id="3db6a-218">Navigate to the [.NET All Downloads page](https://www.microsoft.com/net/download/all).</span></span>
   1. <span data-ttu-id="3db6a-219">Seleccione el tiempo de ejecución de .NET Core que no sea versión preliminar más reciente de la lista (**.NET Core** > **Tiempo de ejecución** > **Tiempo de ejecución de .NET Core x.y.z**).</span><span class="sxs-lookup"><span data-stu-id="3db6a-219">Select the latest non-preview .NET Core runtime from the list (**.NET Core** > **Runtime** > **.NET Core Runtime x.y.z**).</span></span> <span data-ttu-id="3db6a-220">A menos que vaya a trabajar con software de versión preliminar, evite los tiempos de ejecución que incluyan la palabra "preview" (versión preliminar) en el texto del vínculo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-220">Unless you intend to work with preview software, avoid runtimes that have the word "preview" in their link text.</span></span>
   1. <span data-ttu-id="3db6a-221">En la página de descarga de tiempos de ejecución de .NET Core, en **Windows**, haga clic en el vínculo del **instalador del hospedaje de servidor** para descargar la *agrupación de hospedaje de .NET Core Windows Server*.</span><span class="sxs-lookup"><span data-stu-id="3db6a-221">On the .NET Core runtime download page under **Windows**, select the **Server Hosting Installer** link to download the *.NET Core Windows Server Hosting bundle*.</span></span>

   <span data-ttu-id="3db6a-222">**¡Importante!**</span><span class="sxs-lookup"><span data-stu-id="3db6a-222">**Important!**</span></span> <span data-ttu-id="3db6a-223">Si el lote de hospedaje se instala antes que IIS, se debe reparar la instalación de dicho paquete.</span><span class="sxs-lookup"><span data-stu-id="3db6a-223">If the hosting bundle is installed before IIS, the bundle installation must be repaired.</span></span> <span data-ttu-id="3db6a-224">Ejecute el instalador del lote de hospedaje de nuevo después de instalar IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-224">Run the hosting bundle installer again after installing IIS.</span></span>
   
   <span data-ttu-id="3db6a-225">Para evitar que el instalador instale paquetes x86 en un sistema operativo x64, ejecute el instalador desde un símbolo del sistema de administrador con el modificador `OPT_NO_X86=1`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-225">To prevent the installer from installing x86 packages on an x64 OS, run the installer from an administrator command prompt with the switch `OPT_NO_X86=1`.</span></span>

1. <span data-ttu-id="3db6a-226">Reinicie el sistema o ejecute **net stop was /y** seguido de **net start w3svc** desde un símbolo del sistema.</span><span class="sxs-lookup"><span data-stu-id="3db6a-226">Restart the system or execute **net stop was /y** followed by **net start w3svc** from a command prompt.</span></span> <span data-ttu-id="3db6a-227">Al reiniciar IIS se recoge un cambio en la variable PATH del sistema realizado por el programa de instalación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-227">Restarting IIS picks up a change to the system PATH made by the installer.</span></span>

> [!NOTE]
> <span data-ttu-id="3db6a-228">Para obtener información sobre la configuración compartida de IIS, vea [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration) (Módulo de ASP.NET Core con configuración compartida de IIS).</span><span class="sxs-lookup"><span data-stu-id="3db6a-228">For information on IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:host-and-deploy/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="3db6a-229">Instalación de Web Deploy al publicar con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="3db6a-229">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="3db6a-230">Al implementar aplicaciones en servidores con [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy), instale la versión más reciente de Web Deploy en el servidor.</span><span class="sxs-lookup"><span data-stu-id="3db6a-230">When deploying apps to servers with [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy), install the latest version of Web Deploy on the server.</span></span> <span data-ttu-id="3db6a-231">Para instalar Web Deploy, use el [Instalador de plataforma web (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) u obtenga un instalador directamente desde el [Centro de descarga de Microsoft](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="3db6a-231">To install Web Deploy, use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="3db6a-232">El método preferido es usar WebPI.</span><span class="sxs-lookup"><span data-stu-id="3db6a-232">The preferred method is to use WebPI.</span></span> <span data-ttu-id="3db6a-233">WebPI ofrece una instalación independiente y una configuración para los proveedores de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="3db6a-233">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="create-the-iis-site"></a><span data-ttu-id="3db6a-234">Creación del sitio de IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-234">Create the IIS site</span></span>

1. <span data-ttu-id="3db6a-235">En el sistema de hospedaje, cree una carpeta para que contenga los archivos y las carpetas publicados de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-235">On the hosting system, create a folder to contain the app's published folders and files.</span></span> <span data-ttu-id="3db6a-236">En el tema [Estructura de directorios](xref:host-and-deploy/directory-structure) se describe el diseño de implementación de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-236">An app's deployment layout is described in the [Directory Structure](xref:host-and-deploy/directory-structure) topic.</span></span>

1. <span data-ttu-id="3db6a-237">Dentro de la nueva carpeta, cree una carpeta *logs* para hospedar los registros de stdout del módulo ASP.NET Core cuando esté habilitado el registro de stdout.</span><span class="sxs-lookup"><span data-stu-id="3db6a-237">Within the new folder, create a *logs* folder to hold ASP.NET Core Module stdout logs when stdout logging is enabled.</span></span> <span data-ttu-id="3db6a-238">Si la aplicación se ha implementado con una carpeta *logs* en la carga, omita este paso.</span><span class="sxs-lookup"><span data-stu-id="3db6a-238">If the app is deployed with a *logs* folder in the payload, skip this step.</span></span> <span data-ttu-id="3db6a-239">Para instrucciones sobre cómo habilitar MSBuild para crear la carpeta *logs* automáticamente cuando el proyecto se crea de forma local, consulte el tema [Estructura de directorios](xref:host-and-deploy/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="3db6a-239">For instructions on how to enable MSBuild to create the *logs* folder automatically when the project is built locally, see the [Directory structure](xref:host-and-deploy/directory-structure) topic.</span></span>

   <span data-ttu-id="3db6a-240">**¡Importante!**</span><span class="sxs-lookup"><span data-stu-id="3db6a-240">**Important!**</span></span> <span data-ttu-id="3db6a-241">Use solamente el registro de stdout para solucionar errores de inicio de aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-241">Only use the stdout log to troubleshoot app startup failures.</span></span> <span data-ttu-id="3db6a-242">Nunca use el registro de stdout para el registro de aplicaciones rutinarias.</span><span class="sxs-lookup"><span data-stu-id="3db6a-242">Never use stdout logging for routine app logging.</span></span> <span data-ttu-id="3db6a-243">No hay ningún límite en el tamaño del archivo de registro ni en el número de archivos de registro creados.</span><span class="sxs-lookup"><span data-stu-id="3db6a-243">There's no limit on log file size or the number of log files created.</span></span> <span data-ttu-id="3db6a-244">Para más información sobre el registro de stdout, consulte [Creación y redirección de registros](xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection).</span><span class="sxs-lookup"><span data-stu-id="3db6a-244">For more information on the stdout log, see [Log creation and redirection](xref:host-and-deploy/aspnet-core-module#log-creation-and-redirection).</span></span> <span data-ttu-id="3db6a-245">Para información sobre el registro en una aplicación ASP.NET Core, vea el tema [Registro](xref:fundamentals/logging/index).</span><span class="sxs-lookup"><span data-stu-id="3db6a-245">For information on logging in an ASP.NET Core app, see the [Logging](xref:fundamentals/logging/index) topic.</span></span>

1. <span data-ttu-id="3db6a-246">En **Administrador de IIS**, abra el nodo del servidor en el panel **Conexiones**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-246">In **IIS Manager**, open the server's node in the **Connections** panel.</span></span> <span data-ttu-id="3db6a-247">Haga clic con el botón derecho en la carpeta **Sitios**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-247">Right-click the **Sites** folder.</span></span> <span data-ttu-id="3db6a-248">Haga clic en **Agregar sitio web** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="3db6a-248">Select **Add Website** from the contextual menu.</span></span>

1. <span data-ttu-id="3db6a-249">Proporcione el **Nombre del sitio** y establezca la **Ruta de acceso física** a la carpeta de implementación de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-249">Provide a **Site name** and set the **Physical path** to the app's deployment folder.</span></span> <span data-ttu-id="3db6a-250">Proporcione la configuración de **Enlace** y cree el sitio web seleccionando **Aceptar**:</span><span class="sxs-lookup"><span data-stu-id="3db6a-250">Provide the **Binding** configuration and create the website by selecting **OK**:</span></span>

   ![Proporcione el nombre del sitio, la ruta de acceso física y el nombre de host en el paso Agregar sitio web.](index/_static/add-website-ws2016.png)

   > [!WARNING]
   > <span data-ttu-id="3db6a-252">Los enlaces de carácter comodín de nivel superior (`http://*:80/` y `http://+:80`) **no** se deben usar.</span><span class="sxs-lookup"><span data-stu-id="3db6a-252">Top-level wildcard bindings (`http://*:80/` and `http://+:80`) should **not** be used.</span></span> <span data-ttu-id="3db6a-253">Los enlaces de carácter comodín de nivel superior pueden exponer su aplicación a vulnerabilidades de seguridad.</span><span class="sxs-lookup"><span data-stu-id="3db6a-253">Top-level wildcard bindings can open up your app to security vulnerabilities.</span></span> <span data-ttu-id="3db6a-254">Esto se aplica tanto a los caracteres comodín fuertes como a los débiles.</span><span class="sxs-lookup"><span data-stu-id="3db6a-254">This applies to both strong and weak wildcards.</span></span> <span data-ttu-id="3db6a-255">Use nombres de host explícitos en lugar de caracteres comodín.</span><span class="sxs-lookup"><span data-stu-id="3db6a-255">Use explicit host names rather than wildcards.</span></span> <span data-ttu-id="3db6a-256">Los enlaces de carácter comodín de subdominio (por ejemplo, `*.mysub.com`) no suponen este riesgo de seguridad si se controla todo el dominio primario (a diferencia de `*.com`, que sí es vulnerable).</span><span class="sxs-lookup"><span data-stu-id="3db6a-256">Subdomain wildcard binding (for example, `*.mysub.com`) doesn't have this security risk if you control the entire parent domain (as opposed to `*.com`, which is vulnerable).</span></span> <span data-ttu-id="3db6a-257">Vea la [sección 5.4 de RFC 7230](https://tools.ietf.org/html/rfc7230#section-5.4) para obtener más información.</span><span class="sxs-lookup"><span data-stu-id="3db6a-257">See [rfc7230 section-5.4](https://tools.ietf.org/html/rfc7230#section-5.4) for more information.</span></span>

1. <span data-ttu-id="3db6a-258">En el nodo del servidor, seleccione **Grupos de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-258">Under the server's node, select **Application Pools**.</span></span>

1. <span data-ttu-id="3db6a-259">Haga clic con el botón derecho en el grupo de aplicaciones del sitio y seleccione **Configuración básica** en el menú contextual.</span><span class="sxs-lookup"><span data-stu-id="3db6a-259">Right-click the site's app pool and select **Basic Settings** from the contextual menu.</span></span>

1. <span data-ttu-id="3db6a-260">En la ventana **Modificar grupo de aplicaciones**, establezca **Versión de .NET CLR** en **Sin código administrado**:</span><span class="sxs-lookup"><span data-stu-id="3db6a-260">In the **Edit Application Pool** window, set the **.NET CLR version** to **No Managed Code**:</span></span>

   ![Establezca Sin código administrado para Versión de .NET CLR.](index/_static/edit-apppool-ws2016.png)

    <span data-ttu-id="3db6a-262">ASP.NET Core se ejecuta en un proceso independiente y administra el runtime.</span><span class="sxs-lookup"><span data-stu-id="3db6a-262">ASP.NET Core runs in a separate process and manages the runtime.</span></span> <span data-ttu-id="3db6a-263">ASP.NET Core no se basa en la carga de CLR de escritorio.</span><span class="sxs-lookup"><span data-stu-id="3db6a-263">ASP.NET Core doesn't rely on loading the desktop CLR.</span></span> <span data-ttu-id="3db6a-264">El establecimiento de **Versión de .NET CLR** en **Sin código administrado** es opcional.</span><span class="sxs-lookup"><span data-stu-id="3db6a-264">Setting the **.NET CLR version** to **No Managed Code** is optional.</span></span>

1. <span data-ttu-id="3db6a-265">Confirme que la identidad del modelo de proceso tiene los permisos adecuados.</span><span class="sxs-lookup"><span data-stu-id="3db6a-265">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="3db6a-266">Si cambia la identidad predeterminada del grupo de aplicaciones (**Modelo de proceso** > **Identidad**) de **ApplicationPoolIdentity** a otra identidad, compruebe que la nueva identidad tenga los permisos necesarios para obtener acceso a la carpeta de la aplicación, la base de datos y otros recursos necesarios.</span><span class="sxs-lookup"><span data-stu-id="3db6a-266">If the default identity of the app pool (**Process Model** > **Identity**) is changed from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span> <span data-ttu-id="3db6a-267">Por ejemplo, el grupo de aplicaciones requiere acceso de lectura y escritura a las carpetas donde la aplicación lee y escribe archivos.</span><span class="sxs-lookup"><span data-stu-id="3db6a-267">For example, the app pool requires read and write access to folders where the app reads and writes files.</span></span>

<span data-ttu-id="3db6a-268">**Configuración de la autenticación de Windows (opcional)**</span><span class="sxs-lookup"><span data-stu-id="3db6a-268">**Windows Authentication configuration (Optional)**</span></span>  
<span data-ttu-id="3db6a-269">Para más información, consulte [Configurar la autenticación de Windows](xref:security/authentication/windowsauth).</span><span class="sxs-lookup"><span data-stu-id="3db6a-269">For more information, see [Configure Windows authentication](xref:security/authentication/windowsauth).</span></span>

## <a name="deploy-the-app"></a><span data-ttu-id="3db6a-270">Implementación de la aplicación</span><span class="sxs-lookup"><span data-stu-id="3db6a-270">Deploy the app</span></span>

<span data-ttu-id="3db6a-271">Implemente la aplicación en la carpeta que ha creado en el sistema de hospedaje.</span><span class="sxs-lookup"><span data-stu-id="3db6a-271">Deploy the app to the folder created on the hosting system.</span></span> <span data-ttu-id="3db6a-272">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) es el mecanismo recomendado para la implementación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-272">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="3db6a-273">Web Deploy con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="3db6a-273">Web Deploy with Visual Studio</span></span>

<span data-ttu-id="3db6a-274">Vea el tema [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) (Perfiles de publicación de Visual Studio para la implementación de aplicaciones de ASP.NET Core) para obtener más información sobre cómo crear un perfil de publicación para su uso con Web Deploy.</span><span class="sxs-lookup"><span data-stu-id="3db6a-274">See the [Visual Studio publish profiles for ASP.NET Core app deployment](xref:host-and-deploy/visual-studio-publish-profiles#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="3db6a-275">Si el proveedor de hospedaje proporciona un perfil de publicación o admite la creación de uno, descargue su perfil e impórtelo mediante el cuadro de diálogo **Publicar** de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3db6a-275">If the hosting provider provides a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog.</span></span>

![Cuadro de diálogo Publicar](index/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="3db6a-277">Web Deploy fuera de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="3db6a-277">Web Deploy outside of Visual Studio</span></span>

<span data-ttu-id="3db6a-278">También puede usar [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) fuera de Visual Studio desde la línea de comandos.</span><span class="sxs-lookup"><span data-stu-id="3db6a-278">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) can also be used outside of Visual Studio from the command line.</span></span> <span data-ttu-id="3db6a-279">Para más información, vea [Web Deployment Tool (Herramienta de implementación web)](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="3db6a-279">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="3db6a-280">Alternativas a Web Deploy</span><span class="sxs-lookup"><span data-stu-id="3db6a-280">Alternatives to Web Deploy</span></span>

<span data-ttu-id="3db6a-281">Use cualquiera de los métodos disponibles para mover la aplicación al sistema de hospedaje, como copia manual, Xcopy, Robocopy o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="3db6a-281">Use any of several methods to move the app to the hosting system, such as manual copy, Xcopy, Robocopy, or PowerShell.</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="3db6a-282">Examinar el sitio web</span><span class="sxs-lookup"><span data-stu-id="3db6a-282">Browse the website</span></span>

![El explorador Microsoft Edge ha cargado la página de inicio de IIS.](index/_static/browsewebsite.png)

## <a name="locked-deployment-files"></a><span data-ttu-id="3db6a-284">Archivos de implementación bloqueados</span><span class="sxs-lookup"><span data-stu-id="3db6a-284">Locked deployment files</span></span>

<span data-ttu-id="3db6a-285">Los archivos de la carpeta de implementación se bloquean cuando se ejecuta la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-285">Files in the deployment folder are locked when the app is running.</span></span> <span data-ttu-id="3db6a-286">Los archivos bloqueados no se pueden sobrescribir durante la implementación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-286">Locked files can't be overwritten during deployment.</span></span> <span data-ttu-id="3db6a-287">Para liberar archivos bloqueados de una implementación, detenga el grupo de aplicaciones mediante **uno** de los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="3db6a-287">To release locked files in a deployment, stop the app pool using **one** of the following approaches:</span></span>

* <span data-ttu-id="3db6a-288">Use Web Deploy con una referencia a `Microsoft.NET.Sdk.Web` en el archivo de proyecto.</span><span class="sxs-lookup"><span data-stu-id="3db6a-288">Use Web Deploy and reference `Microsoft.NET.Sdk.Web` in the project file.</span></span> <span data-ttu-id="3db6a-289">Se coloca un archivo *app_offline.htm* en la raíz del directorio de aplicación web.</span><span class="sxs-lookup"><span data-stu-id="3db6a-289">An *app_offline.htm* file is placed at the root of the web app directory.</span></span> <span data-ttu-id="3db6a-290">Cuando el archivo está presente, el módulo de ASP.NET Core cierra correctamente la aplicación y proporciona el archivo *app_offline.htm* durante la implementación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-290">When the file is present, the ASP.NET Core Module gracefully shuts down the app and serves the *app_offline.htm* file during the deployment.</span></span> <span data-ttu-id="3db6a-291">Para más información, vea [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#appofflinehtm) (Referencia de configuración del módulo de ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="3db6a-291">For more information, see the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module#appofflinehtm).</span></span>
* <span data-ttu-id="3db6a-292">Detenga manualmente el grupo de aplicaciones en el Administrador de IIS en el servidor.</span><span class="sxs-lookup"><span data-stu-id="3db6a-292">Manually stop the app pool in the IIS Manager on the server.</span></span>
* <span data-ttu-id="3db6a-293">Use PowerShell para detener y reiniciar el grupo de aplicaciones (requiere PowerShell 5 o posterior):</span><span class="sxs-lookup"><span data-stu-id="3db6a-293">Use PowerShell to stop and restart the app pool (requires PowerShell 5 or later):</span></span>

  ```PowerShell
  $webAppPoolName = 'APP_POOL_NAME'

  # Stop the AppPool
  if((Get-WebAppPoolState $webAppPoolName).Value -ne 'Stopped') {
      Stop-WebAppPool -Name $webAppPoolName
      while((Get-WebAppPoolState $webAppPoolName).Value -ne 'Stopped') {
          Start-Sleep -s 1
      }
      Write-Host `-AppPool Stopped
  }

  # Provide script commands here to deploy the app

  # Restart the AppPool
  if((Get-WebAppPoolState $webAppPoolName).Value -ne 'Started') {
      Start-WebAppPool -Name $webAppPoolName
      while((Get-WebAppPoolState $webAppPoolName).Value -ne 'Started') {
          Start-Sleep -s 1
      }
      Write-Host `-AppPool Started
  }
  ```

## <a name="data-protection"></a><span data-ttu-id="3db6a-294">Protección de datos</span><span class="sxs-lookup"><span data-stu-id="3db6a-294">Data protection</span></span>

<span data-ttu-id="3db6a-295">La [pila de protección de datos de ASP.NET Core](xref:security/data-protection/index) la usan varios [middlewares](xref:fundamentals/middleware/index) de ASP.NET Core, incluidos los que se emplean en la autenticación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-295">The [ASP.NET Core Data Protection stack](xref:security/data-protection/index) is used by several ASP.NET Core [middlewares](xref:fundamentals/middleware/index), including middleware used in authentication.</span></span> <span data-ttu-id="3db6a-296">Aunque el código de usuario no llame a las API de protección de datos, la protección de datos se debe configurar con un script de implementación o en el código de usuario para crear un [almacén de claves](xref:security/data-protection/implementation/key-management) criptográficas persistente.</span><span class="sxs-lookup"><span data-stu-id="3db6a-296">Even if Data Protection APIs aren't called by user code, data protection should be configured with a deployment script or in user code to create a persistent cryptographic [key store](xref:security/data-protection/implementation/key-management).</span></span> <span data-ttu-id="3db6a-297">Si no se configura la protección de datos, las claves se conservan en memoria y se descartan cuando se reinicia la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-297">If data protection isn't configured, the keys are held in memory and discarded when the app restarts.</span></span>

<span data-ttu-id="3db6a-298">Si el conjunto de claves se almacena en memoria cuando se reinicia la aplicación:</span><span class="sxs-lookup"><span data-stu-id="3db6a-298">If the key ring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="3db6a-299">Todos los tokens de autenticación basados en cookies se invalidan.</span><span class="sxs-lookup"><span data-stu-id="3db6a-299">All cookie-based authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="3db6a-300">Los usuarios tienen que iniciar sesión de nuevo en la siguiente solicitud.</span><span class="sxs-lookup"><span data-stu-id="3db6a-300">Users are required to sign in again on their next request.</span></span> 
* <span data-ttu-id="3db6a-301">Ya no se pueden descifrar los datos protegidos con el conjunto de claves.</span><span class="sxs-lookup"><span data-stu-id="3db6a-301">Any data protected with the key ring can no longer be decrypted.</span></span> <span data-ttu-id="3db6a-302">Esto puede incluir [tokens CSRF](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) y [cookies de TempData de ASP.NET Core MVC](xref:fundamentals/app-state#tempdata).</span><span class="sxs-lookup"><span data-stu-id="3db6a-302">This may include [CSRF tokens](xref:security/anti-request-forgery#aspnet-core-antiforgery-configuration) and [ASP.NET Core MVC TempData cookies](xref:fundamentals/app-state#tempdata).</span></span>

<span data-ttu-id="3db6a-303">Para configurar la protección de datos en IIS para conservar el conjunto de claves, use **uno** de los enfoques siguientes:</span><span class="sxs-lookup"><span data-stu-id="3db6a-303">To configure data protection under IIS to persist the key ring, use **one** of the following approaches:</span></span>

* <span data-ttu-id="3db6a-304">**Crear claves del Registro de protección de datos**</span><span class="sxs-lookup"><span data-stu-id="3db6a-304">**Create Data Protection Registry Keys**</span></span>

  <span data-ttu-id="3db6a-305">Las claves de protección de datos que las aplicaciones de ASP.NET usan se almacenan en el Registro externo a las aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="3db6a-305">Data protection keys used by ASP.NET Core apps are stored in the registry external to the apps.</span></span> <span data-ttu-id="3db6a-306">Para conservar las claves de una determinada aplicación, cree claves del Registro para el grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="3db6a-306">To persist the keys for a given app, create registry keys for the app pool.</span></span>

  <span data-ttu-id="3db6a-307">En las instalaciones independientes de IIS que no son de granja de servidores web, puede usar el [script de PowerShell Provision-AutoGenKeys.ps1 de protección de datos](https://github.com/aspnet/DataProtection/blob/dev/Provision-AutoGenKeys.ps1) para cada grupo de aplicaciones usado con una aplicación de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="3db6a-307">For standalone, non-webfarm IIS installations, the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/aspnet/DataProtection/blob/dev/Provision-AutoGenKeys.ps1) can be used for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="3db6a-308">Este script crea una clave del Registro en el registro HKLM que solo es accesible a la cuenta de proceso de trabajo del grupo de aplicaciones de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-308">This script creates a registry key in the HKLM registry that's accessible only to the worker process account of the app's app pool.</span></span> <span data-ttu-id="3db6a-309">Las claves se cifran en reposo mediante DPAPI con una clave de equipo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-309">Keys are encrypted at rest using DPAPI with a machine-wide key.</span></span>

  <span data-ttu-id="3db6a-310">En escenarios de granja de servidores web, una aplicación puede configurarse para usar una ruta de acceso UNC para almacenar su conjunto de claves de protección de datos.</span><span class="sxs-lookup"><span data-stu-id="3db6a-310">In web farm scenarios, an app can be configured to use a UNC path to store its data protection key ring.</span></span> <span data-ttu-id="3db6a-311">De forma predeterminada, las claves de protección de datos no se cifran.</span><span class="sxs-lookup"><span data-stu-id="3db6a-311">By default, the data protection keys aren't encrypted.</span></span> <span data-ttu-id="3db6a-312">Asegúrese de que los permisos de archivo de un recurso compartido de red se limitan a la cuenta de Windows bajo la que se ejecuta la aplicación.</span><span class="sxs-lookup"><span data-stu-id="3db6a-312">Ensure that the file permissions for the network share are limited to the Windows account the app runs under.</span></span> <span data-ttu-id="3db6a-313">Puede usar un certificado X509 para proteger las claves en reposo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-313">An X509 certificate can be used to protect keys at rest.</span></span> <span data-ttu-id="3db6a-314">Considere un mecanismo que permita a los usuarios cargar certificados: coloque los certificados en el almacén de certificados de confianza del usuario y asegúrese de que están disponibles en todos los equipos en los que se ejecuta la aplicación del usuario.</span><span class="sxs-lookup"><span data-stu-id="3db6a-314">Consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="3db6a-315">Vea [Configurar la protección de datos en ASP.NET Core](xref:security/data-protection/configuration/overview) para más información.</span><span class="sxs-lookup"><span data-stu-id="3db6a-315">See [Configure ASP.NET Core Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

* <span data-ttu-id="3db6a-316">**Configurar el grupo de aplicaciones de IIS para cargar el perfil de usuario**</span><span class="sxs-lookup"><span data-stu-id="3db6a-316">**Configure the IIS Application Pool to load the user profile**</span></span>

  <span data-ttu-id="3db6a-317">Esta opción está en la sección **Modelo de proceso**, en la **Configuración avanzada** del grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="3db6a-317">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="3db6a-318">Establezca Cargar perfil de usuario en `True`.</span><span class="sxs-lookup"><span data-stu-id="3db6a-318">Set Load User Profile to `True`.</span></span> <span data-ttu-id="3db6a-319">Esto almacena las claves en el directorio del perfil de usuario y las protege mediante DPAPI con una clave específica de la cuenta de usuario que el grupo de aplicaciones usa.</span><span class="sxs-lookup"><span data-stu-id="3db6a-319">This stores keys under the user profile directory and protects them using DPAPI with a key specific to the user account used by the app pool.</span></span>

* <span data-ttu-id="3db6a-320">**Usar el sistema de archivos como un almacén de conjunto de claves**</span><span class="sxs-lookup"><span data-stu-id="3db6a-320">**Use the file system as a key ring store**</span></span>

  <span data-ttu-id="3db6a-321">Ajuste el código de la aplicación para [usar el sistema de archivos como un almacén de conjunto de claves](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="3db6a-321">Adjust the app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="3db6a-322">Use un certificado X509 para proteger el conjunto de claves y asegúrese de que sea un certificado de confianza.</span><span class="sxs-lookup"><span data-stu-id="3db6a-322">Use an X509 certificate to protect the key ring and ensure the certificate is a trusted certificate.</span></span> <span data-ttu-id="3db6a-323">Si es un certificado autofirmado, colóquelo en el almacén raíz de confianza.</span><span class="sxs-lookup"><span data-stu-id="3db6a-323">If the certificate is self-signed, place the certificate in the Trusted Root store.</span></span>

  <span data-ttu-id="3db6a-324">Cuando se usa IIS en una granja de servidores web:</span><span class="sxs-lookup"><span data-stu-id="3db6a-324">When using IIS in a web farm:</span></span>

  * <span data-ttu-id="3db6a-325">Use un recurso compartido de archivos al que puedan acceder todos los equipos.</span><span class="sxs-lookup"><span data-stu-id="3db6a-325">Use a file share that all machines can access.</span></span>
  * <span data-ttu-id="3db6a-326">Implemente un certificado X509 en cada equipo.</span><span class="sxs-lookup"><span data-stu-id="3db6a-326">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="3db6a-327">Configure la [protección de datos en el código](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="3db6a-327">Configure [data protection in code](xref:security/data-protection/configuration/overview).</span></span>

* <span data-ttu-id="3db6a-328">**Establecer una directiva para todo el equipo para la protección de datos**</span><span class="sxs-lookup"><span data-stu-id="3db6a-328">**Set a machine-wide policy for data protection**</span></span>

  <span data-ttu-id="3db6a-329">El sistema de protección de datos tiene compatibilidad limitada con el establecimiento de una [directiva de equipo](xref:security/data-protection/configuration/machine-wide-policy) predeterminada para todas las aplicaciones que usan las API de protección de datos.</span><span class="sxs-lookup"><span data-stu-id="3db6a-329">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="3db6a-330">Vea la [documentación de protección de datos](xref:security/data-protection/index) para más detalles.</span><span class="sxs-lookup"><span data-stu-id="3db6a-330">See the [data protection documentation](xref:security/data-protection/index) for details.</span></span>

## <a name="sub-application-configuration"></a><span data-ttu-id="3db6a-331">Configuración de aplicaciones secundarias</span><span class="sxs-lookup"><span data-stu-id="3db6a-331">Sub-application configuration</span></span>

<span data-ttu-id="3db6a-332">Las aplicaciones secundarias agregadas bajo la aplicación raíz no deben incluir el módulo de ASP.NET Core como controlador.</span><span class="sxs-lookup"><span data-stu-id="3db6a-332">Sub-apps added under the root app shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="3db6a-333">Si se agrega el módulo como controlador al archivo *web.config* de una aplicación secundaria, aparece un *error 500.19 (Error interno del servidor)* que hace referencia al archivo de configuración erróneo al intentar examinar la aplicación secundaria.</span><span class="sxs-lookup"><span data-stu-id="3db6a-333">If the module is added as a handler in a sub-app's *web.config* file, a *500.19 Internal Server Error* referencing the faulty config file is received when attempting to browse the sub-app.</span></span>

<span data-ttu-id="3db6a-334">En el ejemplo siguiente se muestra un archivo *web.config* publicado para una aplicación secundaria ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="3db6a-334">The following example shows a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\<assembly_name>.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="3db6a-335">Al hospedar una aplicación secundaria que no es de ASP.NET Core bajo una aplicación de ASP.NET Core, quite explícitamente el controlador heredado del archivo *web.config* de la aplicación secundaria:</span><span class="sxs-lookup"><span data-stu-id="3db6a-335">When hosting a non-ASP.NET Core sub-app underneath an ASP.NET Core app, explicitly remove the inherited handler in the sub-app *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore" />
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\<assembly_name>.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="3db6a-336">Para más información sobre la configuración del módulo de ASP.NET Core, vea el tema [Introducción al módulo de ASP.NET Core](xref:fundamentals/servers/aspnet-core-module) y [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module) (Referencia de configuración del módulo de ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="3db6a-336">For more information on configuring the ASP.NET Core Module, see the [Introduction to ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module) topic and the [ASP.NET Core Module configuration reference](xref:host-and-deploy/aspnet-core-module).</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="3db6a-337">Configuración de IIS con web.config</span><span class="sxs-lookup"><span data-stu-id="3db6a-337">Configuration of IIS with web.config</span></span>

<span data-ttu-id="3db6a-338">La configuración de IIS aún se ve afectada por la sección **\<system.webServer>** de *web.config* en las características de IIS que se aplican a una configuración de proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="3db6a-338">IIS configuration is influenced by the **\<system.webServer>** section of *web.config* for those IIS features that apply to a reverse proxy configuration.</span></span> <span data-ttu-id="3db6a-339">Si IIS está configurado en el nivel de servidor para usar compresión dinámica, el elemento **\<urlCompression>** del archivo *web.config* de la aplicación puede deshabilitarla.</span><span class="sxs-lookup"><span data-stu-id="3db6a-339">If IIS is configured at the server level to use dynamic compression, the **\<urlCompression>** element in the app's *web.config* file can disable it.</span></span>

<span data-ttu-id="3db6a-340">Para más información, vea la [referencia de configuración para \<system.webServer>](/iis/configuration/system.webServer/), [Referencia de configuración del módulo de ASP.NET Core](xref:host-and-deploy/aspnet-core-module) y [Módulos IIS con ASP.NET Core](xref:host-and-deploy/iis/modules).</span><span class="sxs-lookup"><span data-stu-id="3db6a-340">For more information, see the [configuration reference for \<system.webServer>](/iis/configuration/system.webServer/), [ASP.NET Core Module Configuration Reference](xref:host-and-deploy/aspnet-core-module), and [IIS Modules with ASP.NET Core](xref:host-and-deploy/iis/modules).</span></span> <span data-ttu-id="3db6a-341">Para establecer variables de entorno para aplicaciones individuales que se ejecutan en grupos de aplicaciones aislados (se admite para IIS 10.0 o posterior), vea la sección *AppCmd.exe command* (Comando AppCmd.exe) del tema [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) (Variables de entorno <environmentVariables>) de la documentación de referencia de IIS.</span><span class="sxs-lookup"><span data-stu-id="3db6a-341">To set environment variables for individual apps running in isolated app pools (supported for IIS 10.0 or later), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="3db6a-342">Secciones de configuración de web.config</span><span class="sxs-lookup"><span data-stu-id="3db6a-342">Configuration sections of web.config</span></span>

<span data-ttu-id="3db6a-343">Las aplicaciones ASP.NET Core no usan las secciones de configuración de aplicaciones ASP.NET 4.x en *web.config* para la configuración:</span><span class="sxs-lookup"><span data-stu-id="3db6a-343">Configuration sections of ASP.NET 4.x apps in *web.config* aren't used by ASP.NET Core apps for configuration:</span></span>

* <span data-ttu-id="3db6a-344">**\<system.web>**</span><span class="sxs-lookup"><span data-stu-id="3db6a-344">**\<system.web>**</span></span>
* <span data-ttu-id="3db6a-345">**\<appSettings>**</span><span class="sxs-lookup"><span data-stu-id="3db6a-345">**\<appSettings>**</span></span>
* <span data-ttu-id="3db6a-346">**\<connectionStrings>**</span><span class="sxs-lookup"><span data-stu-id="3db6a-346">**\<connectionStrings>**</span></span>
* <span data-ttu-id="3db6a-347">**\<location>**</span><span class="sxs-lookup"><span data-stu-id="3db6a-347">**\<location>**</span></span>

<span data-ttu-id="3db6a-348">Las aplicaciones de ASP.NET Core se configuran mediante otros proveedores de configuración.</span><span class="sxs-lookup"><span data-stu-id="3db6a-348">ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="3db6a-349">Para obtener más información, vea [Configuración](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="3db6a-349">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="3db6a-350">Grupos de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="3db6a-350">Application Pools</span></span>

<span data-ttu-id="3db6a-351">Al hospedar varios sitios web en un servidor, aísle las aplicaciones entre sí mediante la ejecución de cada una de ellas en su propio grupo de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="3db6a-351">When hosting multiple websites on a server, isolate the apps from each other by running each app in its own app pool.</span></span> <span data-ttu-id="3db6a-352">El valor predeterminado del cuadro de diálogo **Agregar sitio web** es esta configuración.</span><span class="sxs-lookup"><span data-stu-id="3db6a-352">The IIS **Add Website** dialog defaults to this configuration.</span></span> <span data-ttu-id="3db6a-353">Cuando se proporciona el **Nombre del sitio**, el texto se transfiere automáticamente al cuadro de texto **Grupo de aplicaciones**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-353">When **Site name** is provided, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="3db6a-354">Al agregar el sitio se crea un grupo de aplicaciones con el nombre del sitio.</span><span class="sxs-lookup"><span data-stu-id="3db6a-354">A new app pool is created using the site name when the site is added.</span></span>

## <a name="application-pool-identity"></a><span data-ttu-id="3db6a-355">Identidad del grupo de aplicaciones</span><span class="sxs-lookup"><span data-stu-id="3db6a-355">Application Pool Identity</span></span>

<span data-ttu-id="3db6a-356">Una cuenta de identidad del grupo de aplicaciones permite ejecutar una aplicación en una cuenta única sin tener que crear ni administrar dominios o cuentas locales.</span><span class="sxs-lookup"><span data-stu-id="3db6a-356">An app pool identity account allows an app to run under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="3db6a-357">En IIS 8.0 o versiones posteriores, el proceso de trabajo de administración de IIS (WAS) crea una cuenta virtual con el nombre del nuevo grupo de aplicaciones y ejecuta los procesos de trabajo del grupo de aplicaciones en esta cuenta de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="3db6a-357">On IIS 8.0 or later, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new app pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="3db6a-358">En la Consola de administración de IIS, en la opción **Configuración avanzada** del grupo de aplicaciones, asegúrese de que la **Identidad** está establecida para usar **ApplicationPoolIdentity**:</span><span class="sxs-lookup"><span data-stu-id="3db6a-358">In the IIS Management Console under **Advanced Settings** for the app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity**:</span></span>

![Cuadro de diálogo Configuración avanzada del grupo de aplicaciones](index/_static/apppool-identity.png)

<span data-ttu-id="3db6a-360">El proceso de administración de IIS crea un identificador seguro con el nombre del grupo de aplicaciones en el sistema de seguridad de Windows.</span><span class="sxs-lookup"><span data-stu-id="3db6a-360">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="3db6a-361">Los recursos se pueden proteger mediante esta identidad.</span><span class="sxs-lookup"><span data-stu-id="3db6a-361">Resources can be secured using this identity.</span></span> <span data-ttu-id="3db6a-362">Sin embargo, no es una cuenta de usuario real ni se muestra en la consola de administración de usuario de Windows.</span><span class="sxs-lookup"><span data-stu-id="3db6a-362">However, this identity isn't a real user account and doesn't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="3db6a-363">Si el proceso de trabajo de IIS requiere acceso con privilegios elevados a la aplicación, modifique la lista de control de acceso (ACL) del directorio que contiene la aplicación:</span><span class="sxs-lookup"><span data-stu-id="3db6a-363">If the IIS worker process requires elevated access to the app, modify the Access Control List (ACL) for the directory containing the app:</span></span>

1. <span data-ttu-id="3db6a-364">Abra el Explorador de Windows y vaya al directorio.</span><span class="sxs-lookup"><span data-stu-id="3db6a-364">Open Windows Explorer and navigate to the directory.</span></span>

1. <span data-ttu-id="3db6a-365">Haga clic con el botón derecho en el directorio y seleccione **Propiedades**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-365">Right-click on the directory and select **Properties**.</span></span>

1. <span data-ttu-id="3db6a-366">En la pestaña **Seguridad**, haga clic en el botón **Editar** y en el botón **Agregar**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-366">Under the **Security** tab, select the **Edit** button and then the **Add** button.</span></span>

1. <span data-ttu-id="3db6a-367">Haga clic en el botón **Ubicaciones** y asegúrese de seleccionar el sistema.</span><span class="sxs-lookup"><span data-stu-id="3db6a-367">Select the **Locations** button and make sure the system is selected.</span></span>

1. <span data-ttu-id="3db6a-368">Escriba **IIS AppPool\\<nombre_del_grupo_de_aplicaciones>** en el área **Escribir los nombres de objeto para seleccionar**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-368">Enter **IIS AppPool\\<app_pool_name>** in **Enter the object names to select** area.</span></span> <span data-ttu-id="3db6a-369">Haga clic en el botón **Comprobar nombres**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-369">Select the **Check Names** button.</span></span> <span data-ttu-id="3db6a-370">Para *DefaultAppPool* compruebe los nombres con **IIS AppPool\DefaultAppPool**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-370">For the *DefaultAppPool* check the names using **IIS AppPool\DefaultAppPool**.</span></span> <span data-ttu-id="3db6a-371">Cuando el botón **Comprobar nombres** está seleccionado, un valor de **DefaultAppPool** se indica en el área de los nombres de objeto.</span><span class="sxs-lookup"><span data-stu-id="3db6a-371">When the **Check Names** button is selected, a value of **DefaultAppPool** is indicated in the object names area.</span></span> <span data-ttu-id="3db6a-372">No es posible escribir el nombre del grupo de aplicaciones directamente en el área de los nombres de objeto.</span><span class="sxs-lookup"><span data-stu-id="3db6a-372">It isn't possible to enter the app pool name directly into the object names area.</span></span> <span data-ttu-id="3db6a-373">Use el formato **IIS AppPool\\<nombre_del_grupo_de_aplicaciones>** cuando compruebe el nombre del objeto.</span><span class="sxs-lookup"><span data-stu-id="3db6a-373">Use the **IIS AppPool\\<app_pool_name>** format when checking for the object name.</span></span>

   ![Cuadro de diálogo Seleccionar usuarios o grupos para la carpeta de la aplicación: el nombre del grupo de aplicaciones de "DefaultAppPool" se anexa al "IIS AppPool\" en el área de los nombres de objeto antes de seleccionar "Comprobar nombres".](index/_static/select-users-or-groups-1.png)

1. <span data-ttu-id="3db6a-375">Seleccione **Aceptar**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-375">Select **OK**.</span></span>

   ![Cuadro de diálogo Seleccionar usuarios o grupos para la carpeta de la aplicación: después de seleccionar "Comprobar nombres", el nombre del objeto "DefaultAppPool" se muestra en el área de los nombres de objeto.](index/_static/select-users-or-groups-2.png)

1. <span data-ttu-id="3db6a-377">Los permisos de lectura y ejecución se deben conceder de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="3db6a-377">Read &amp; execute permissions should be granted by default.</span></span> <span data-ttu-id="3db6a-378">Proporcione permisos adicionales según sea necesario.</span><span class="sxs-lookup"><span data-stu-id="3db6a-378">Provide additional permissions as needed.</span></span>

<span data-ttu-id="3db6a-379">El acceso también se puede conceder mediante un símbolo del sistema con la herramienta **ICACLS**.</span><span class="sxs-lookup"><span data-stu-id="3db6a-379">Access can also be granted at a command prompt using the **ICACLS** tool.</span></span> <span data-ttu-id="3db6a-380">En el siguiente comando se usa *DefaultAppPool* como ejemplo:</span><span class="sxs-lookup"><span data-stu-id="3db6a-380">Using the *DefaultAppPool* as an example, the following command is used:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

<span data-ttu-id="3db6a-381">Para más información, consulte el tema [icacls](/windows-server/administration/windows-commands/icacls).</span><span class="sxs-lookup"><span data-stu-id="3db6a-381">For more information, see the [icacls](/windows-server/administration/windows-commands/icacls) topic.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3db6a-382">Recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="3db6a-382">Additional resources</span></span>

* [<span data-ttu-id="3db6a-383">Solución de problemas de ASP.NET Core en IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-383">Troubleshoot ASP.NET Core on IIS</span></span>](xref:host-and-deploy/iis/troubleshoot)
* [<span data-ttu-id="3db6a-384">Referencia de errores comunes de Azure App Service e IIS con ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3db6a-384">Common errors reference for Azure App Service and IIS with ASP.NET Core</span></span>](xref:host-and-deploy/azure-iis-errors-reference)
* [<span data-ttu-id="3db6a-385">Introducción al módulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3db6a-385">Introduction to ASP.NET Core Module</span></span>](xref:fundamentals/servers/aspnet-core-module)
* [<span data-ttu-id="3db6a-386">Referencia de configuración del módulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3db6a-386">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)
* [<span data-ttu-id="3db6a-387">Módulos de IIS con ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3db6a-387">IIS Modules with ASP.NET Core</span></span>](xref:host-and-deploy/iis/modules)
* [<span data-ttu-id="3db6a-388">Introducción a ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3db6a-388">Introduction to ASP.NET Core</span></span>](../index.md)
* [<span data-ttu-id="3db6a-389">Sitio oficial de Microsoft IIS</span><span class="sxs-lookup"><span data-stu-id="3db6a-389">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="3db6a-390">Biblioteca de TechNet de Microsoft: Windows Server</span><span class="sxs-lookup"><span data-stu-id="3db6a-390">Microsoft TechNet Library: Windows Server</span></span>](/windows-server/windows-server-versions)
